<html>
<head>
<title>6974.72edf80a5e596a8c93cd.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #6aab73;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #2aacb8;}
.s4 { color: #cf8e6d;}
.ln { color: #4b5059; font-weight: normal; font-style: normal; }
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
6974.72edf80a5e596a8c93cd.js</font>
</center></td></tr></table>
<pre><a name="l1"><span class="ln">1    </span></a><span class="s0">&quot;use strict&quot;</span><span class="s1">;(</span><span class="s2">self</span><span class="s1">[</span><span class="s0">&quot;webpackChunk_jupyterlab_application_top&quot;</span><span class="s1">]=</span><span class="s2">self</span><span class="s1">[</span><span class="s0">&quot;webpackChunk_jupyterlab_application_top&quot;</span><span class="s1">]||[]).</span><span class="s2">push</span><span class="s1">([[</span><span class="s3">6974</span><span class="s1">],{</span><span class="s3">97134</span><span class="s1">:(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)=&gt;{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">d</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,{</span><span class="s2">A</span><span class="s1">:()=&gt;</span><span class="s2">o</span><span class="s1">});</span><span class="s4">var </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">59386</span><span class="s1">);</span><span class="s4">var </span><span class="s2">a</span><span class="s1">=</span><span class="s3">4</span><span class="s1">;</span><span class="s4">function </span><span class="s2">i</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">A</span><span class="s1">)(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">a</span><span class="s1">)}</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">i</span><span class="s1">},</span><span class="s3">66974</span><span class="s1">:(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)=&gt;{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">d</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,{</span><span class="s2">render</span><span class="s1">:()=&gt;</span><span class="s2">J</span><span class="s1">});</span><span class="s4">var </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">33416</span><span class="s1">);</span><span class="s4">var </span><span class="s2">a</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">94746</span><span class="s1">);</span><span class="s4">var </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">98397</span><span class="s1">);</span><span class="s4">var </span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">57590</span><span class="s1">);</span><span class="s4">var </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">68232</span><span class="s1">);</span><span class="s4">var </span><span class="s2">d</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">76261</span><span class="s1">);</span><span class="s4">var </span><span class="s2">c</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">96049</span><span class="s1">);</span><span class="s4">var </span><span class="s2">l</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">75905</span><span class="s1">);</span><span class="s4">var </span><span class="s2">g</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">82211</span><span class="s1">);</span><span class="s4">var </span><span class="s2">f</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">89523</span><span class="s1">);</span><span class="s4">var </span><span class="s2">u</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">97134</span><span class="s1">);</span><span class="s4">var </span><span class="s2">p</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">8937</span><span class="s1">);</span><span class="s4">var </span><span class="s2">h</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">65791</span><span class="s1">);</span><span class="s4">function </span><span class="s2">m</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">var </span><span class="s2">n</span><span class="s1">={</span><span class="s2">options</span><span class="s1">:{</span><span class="s2">directed</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">isDirected</span><span class="s1">(),</span><span class="s2">multigraph</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">isMultigraph</span><span class="s1">(),</span><span class="s2">compound</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">isCompound</span><span class="s1">()},</span><span class="s2">nodes</span><span class="s1">:</span><span class="s2">w</span><span class="s1">(</span><span class="s2">e</span><span class="s1">),</span><span class="s2">edges</span><span class="s1">:</span><span class="s2">v</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)};</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">f</span><span class="s1">.</span><span class="s2">A</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">graph</span><span class="s1">())){</span><span class="s2">n</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s2">u</span><span class="s1">.</span><span class="s2">A</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">graph</span><span class="s1">())}</span><span class="s4">return </span><span class="s2">n</span><span class="s1">}</span><span class="s4">function </span><span class="s2">w</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return </span><span class="s2">p</span><span class="s1">.</span><span class="s2">A</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">nodes</span><span class="s1">(),(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">n</span><span class="s1">){</span><span class="s4">var </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s4">var </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s4">var </span><span class="s2">a</span><span class="s1">={</span><span class="s2">v</span><span class="s1">:</span><span class="s2">n</span><span class="s1">};</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">f</span><span class="s1">.</span><span class="s2">A</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s2">a</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">f</span><span class="s1">.</span><span class="s2">A</span><span class="s1">(</span><span class="s2">r</span><span class="s1">)){</span><span class="s2">a</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">=</span><span class="s2">r</span><span class="s1">}</span><span class="s4">return </span><span class="s2">a</span><span class="s1">}))}</span><span class="s4">function </span><span class="s2">v</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return </span><span class="s2">p</span><span class="s1">.</span><span class="s2">A</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">(),(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">n</span><span class="s1">){</span><span class="s4">var </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">edge</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s4">var </span><span class="s2">r</span><span class="s1">={</span><span class="s2">v</span><span class="s1">:</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">w</span><span class="s1">:</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">};</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">f</span><span class="s1">.</span><span class="s2">A</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">name</span><span class="s1">)){</span><span class="s2">r</span><span class="s1">.</span><span class="s2">name</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">name</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">f</span><span class="s1">.</span><span class="s2">A</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s2">r</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">return </span><span class="s2">r</span><span class="s1">}))}</span><span class="s4">function </span><span class="s2">R</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">var </span><span class="s2">n</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Graph</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">options</span><span class="s1">).</span><span class="s2">setGraph</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">value</span><span class="s1">);</span><span class="s2">_</span><span class="s1">.</span><span class="s2">each</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">nodes</span><span class="s1">,(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">n</span><span class="s1">.</span><span class="s2">setNode</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">value</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">){</span><span class="s2">n</span><span class="s1">.</span><span class="s2">setParent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">)}}));</span><span class="s2">_</span><span class="s1">.</span><span class="s2">each</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">,(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">n</span><span class="s1">.</span><span class="s2">setEdge</span><span class="s1">({</span><span class="s2">v</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">w</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">,</span><span class="s2">name</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">name</span><span class="s1">},</span><span class="s2">e</span><span class="s1">.</span><span class="s2">value</span><span class="s1">)}));</span><span class="s4">return </span><span class="s2">n</span><span class="s1">}</span><span class="s4">var </span><span class="s2">y</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s3">84416</span><span class="s1">);</span><span class="s4">var </span><span class="s2">X</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Map</span><span class="s1">;</span><span class="s4">var </span><span class="s2">b</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Map</span><span class="s1">;</span><span class="s4">var </span><span class="s2">E</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Map</span><span class="s1">;</span><span class="s4">var </span><span class="s2">N</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)((()=&gt;{</span><span class="s2">b</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">();</span><span class="s2">E</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">();</span><span class="s2">X</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">()}),</span><span class="s0">&quot;clear&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">C</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)(((</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)=&gt;{</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">b</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)||[];</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">trace</span><span class="s1">(</span><span class="s0">&quot;In isDescendant&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s0">&quot; &quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s0">&quot; = &quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">includes</span><span class="s1">(</span><span class="s2">e</span><span class="s1">));</span><span class="s4">return </span><span class="s2">t</span><span class="s1">.</span><span class="s2">includes</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}),</span><span class="s0">&quot;isDescendant&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">S</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)(((</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)=&gt;{</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">b</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)||[];</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Descendants of &quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s0">&quot; is &quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Edge is &quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">===</span><span class="s2">n</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">===</span><span class="s2">n</span><span class="s1">){</span><span class="s4">return false</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Tilt, &quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s0">&quot;,not in descendants&quot;</span><span class="s1">);</span><span class="s4">return false</span><span class="s1">}</span><span class="s4">return </span><span class="s2">t</span><span class="s1">.</span><span class="s2">includes</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">)||</span><span class="s2">C</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)||</span><span class="s2">C</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)||</span><span class="s2">t</span><span class="s1">.</span><span class="s2">includes</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">)}),</span><span class="s0">&quot;edgeInCluster&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">x</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)(((</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)=&gt;{</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Copying children of &quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s0">&quot;root&quot;</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s0">&quot;data&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">e</span><span class="s1">),</span><span class="s2">r</span><span class="s1">);</span><span class="s4">const </span><span class="s2">a</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)||[];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">!==</span><span class="s2">r</span><span class="s1">){</span><span class="s2">a</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Copying (nodes) clusterId&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s0">&quot;nodes&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">);</span><span class="s2">a</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">a</span><span class="s1">=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">a</span><span class="s1">).</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">x</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">a</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;cp &quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s0">&quot; to &quot;</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s0">&quot; with parent &quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setNode</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">!==</span><span class="s2">n</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">(</span><span class="s2">a</span><span class="s1">)){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Setting parent&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">(</span><span class="s2">a</span><span class="s1">));</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setParent</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">(</span><span class="s2">a</span><span class="s1">))}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">!==</span><span class="s2">r</span><span class="s1">&amp;&amp;</span><span class="s2">a</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Setting parent&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setParent</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;In copy &quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s0">&quot;root&quot;</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s0">&quot;data&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">e</span><span class="s1">),</span><span class="s2">r</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Not Setting parent for node=&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s0">&quot;cluster!==rootId&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">!==</span><span class="s2">r</span><span class="s1">,</span><span class="s0">&quot;node!==clusterId&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">(</span><span class="s2">a</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Copying Edges&quot;</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s2">o</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">a</span><span class="s1">=&gt;{</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Edge&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">);</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">edge</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">a</span><span class="s1">.</span><span class="s2">w</span><span class="s1">,</span><span class="s2">a</span><span class="s1">.</span><span class="s2">name</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Edge data&quot;</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">try</span><span class="s1">{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">S</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Copying as &quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">a</span><span class="s1">.</span><span class="s2">w</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">a</span><span class="s1">.</span><span class="s2">name</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setEdge</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">a</span><span class="s1">.</span><span class="s2">w</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">a</span><span class="s1">.</span><span class="s2">name</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;newGraph edges &quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">(),</span><span class="s2">t</span><span class="s1">.</span><span class="s2">edge</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">()[</span><span class="s3">0</span><span class="s1">]))}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Skipping copy of edge &quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s0">&quot;--</span><span class="s4">\x3e</span><span class="s0">&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">.</span><span class="s2">w</span><span class="s1">,</span><span class="s0">&quot; rootId: &quot;</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s0">&quot; clusterId:&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}}</span><span class="s4">catch</span><span class="s1">(</span><span class="s2">o</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s2">o</span><span class="s1">)}}))}</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Removing node&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">);</span><span class="s2">n</span><span class="s1">.</span><span class="s2">removeNode</span><span class="s1">(</span><span class="s2">a</span><span class="s1">)}))}),</span><span class="s0">&quot;copy&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">I</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)(((</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)=&gt;{</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=[</span><span class="s2">...t</span><span class="s1">];</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">a of t</span><span class="s1">){</span><span class="s2">E</span><span class="s1">.</span><span class="s2">set</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s2">r</span><span class="s1">=[</span><span class="s2">...r</span><span class="s1">,</span><span class="s2">...I</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)]}</span><span class="s4">return </span><span class="s2">r</span><span class="s1">}),</span><span class="s0">&quot;extractDescendants&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">D</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)(((</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)=&gt;{</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">().</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">===</span><span class="s2">n</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">===</span><span class="s2">n</span><span class="s1">));</span><span class="s4">const </span><span class="s2">a</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">().</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">===</span><span class="s2">t</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">===</span><span class="s2">t</span><span class="s1">));</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">map</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;({</span><span class="s2">v</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">===</span><span class="s2">n</span><span class="s1">?</span><span class="s2">t</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">w</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">===</span><span class="s2">n</span><span class="s1">?</span><span class="s2">n</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">})));</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">map</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;({</span><span class="s2">v</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">w</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">})));</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">some</span><span class="s1">((</span><span class="s2">n</span><span class="s1">=&gt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">===</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">===</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">))));</span><span class="s4">return </span><span class="s2">s</span><span class="s1">}),</span><span class="s0">&quot;findCommonEdges&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">A</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)(((</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)=&gt;{</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">trace</span><span class="s1">(</span><span class="s0">&quot;Searching children of id &quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&lt;</span><span class="s3">1</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s4">let </span><span class="s2">a</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">i of r</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">A</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">D</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">a</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}}}</span><span class="s4">return </span><span class="s2">a</span><span class="s1">}),</span><span class="s0">&quot;findNonClusterChild&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">O</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)((</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">X</span><span class="s1">.</span><span class="s2">has</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">externalConnections</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">X</span><span class="s1">.</span><span class="s2">has</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">return </span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">id</span><span class="s1">}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}),</span><span class="s0">&quot;getAnchorId&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">k</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)(((</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)=&gt;{</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">||</span><span class="s2">n</span><span class="s1">&gt;</span><span class="s3">10</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Opting out, no graph &quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Opting in, graph &quot;</span><span class="s1">)}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">nodes</span><span class="s1">().</span><span class="s2">forEach</span><span class="s1">((</span><span class="s4">function</span><span class="s1">(</span><span class="s2">n</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Cluster identified&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s0">&quot; Replacement id in edges: &quot;</span><span class="s1">,</span><span class="s2">A</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">));</span><span class="s2">b</span><span class="s1">.</span><span class="s2">set</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">I</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">e</span><span class="s1">));</span><span class="s2">X</span><span class="s1">.</span><span class="s2">set</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,{</span><span class="s2">id</span><span class="s1">:</span><span class="s2">A</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">),</span><span class="s2">clusterData</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)})}}));</span><span class="s2">e</span><span class="s1">.</span><span class="s2">nodes</span><span class="s1">().</span><span class="s2">forEach</span><span class="s1">((</span><span class="s4">function</span><span class="s1">(</span><span class="s2">n</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Cluster identified&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">b</span><span class="s1">);</span><span class="s2">r</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">C</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">C</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">^</span><span class="s2">r</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Edge: &quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s0">&quot; leaves cluster &quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Descendants of XXX &quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s0">&quot;: &quot;</span><span class="s1">,</span><span class="s2">b</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">n</span><span class="s1">));</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">n</span><span class="s1">).</span><span class="s2">externalConnections</span><span class="s1">=</span><span class="s4">true</span><span class="s1">}}))}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Not a cluster &quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">b</span><span class="s1">)}}));</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">t of X</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">()){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">t</span><span class="s1">).</span><span class="s2">id</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">!==</span><span class="s2">t</span><span class="s1">&amp;&amp;</span><span class="s2">X</span><span class="s1">.</span><span class="s2">has</span><span class="s1">(</span><span class="s2">r</span><span class="s1">)&amp;&amp;!</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">r</span><span class="s1">).</span><span class="s2">externalConnections</span><span class="s1">){</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">t</span><span class="s1">).</span><span class="s2">id</span><span class="s1">=</span><span class="s2">r</span><span class="s1">}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">().</span><span class="s2">forEach</span><span class="s1">((</span><span class="s4">function</span><span class="s1">(</span><span class="s2">n</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">edge</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Edge &quot;</span><span class="s1">+</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">+</span><span class="s0">&quot; -&gt; &quot;</span><span class="s1">+</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">+</span><span class="s0">&quot;: &quot;</span><span class="s1">+</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">n</span><span class="s1">));</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Edge &quot;</span><span class="s1">+</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">+</span><span class="s0">&quot; -&gt; &quot;</span><span class="s1">+</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">+</span><span class="s0">&quot;: &quot;</span><span class="s1">+</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">edge</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)));</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">;</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Fix XXX&quot;</span><span class="s1">,</span><span class="s2">X</span><span class="s1">,</span><span class="s0">&quot;ids:&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">,</span><span class="s0">&quot;Translating: &quot;</span><span class="s1">,</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">),</span><span class="s0">&quot; --- &quot;</span><span class="s1">,</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">));</span><span class="s4">if</span><span class="s1">(</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">)||</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">)){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Fixing and trying - removing XXX&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">name</span><span class="s1">);</span><span class="s2">r</span><span class="s1">=</span><span class="s2">O</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">);</span><span class="s2">a</span><span class="s1">=</span><span class="s2">O</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">removeEdge</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">name</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">!==</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">){</span><span class="s4">const </span><span class="s2">a</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">(</span><span class="s2">r</span><span class="s1">);</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">a</span><span class="s1">).</span><span class="s2">externalConnections</span><span class="s1">=</span><span class="s4">true</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">fromCluster</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">v</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">!==</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">){</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">(</span><span class="s2">a</span><span class="s1">);</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">r</span><span class="s1">).</span><span class="s2">externalConnections</span><span class="s1">=</span><span class="s4">true</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">toCluster</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">w</span><span class="s1">}</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Fix Replacing with XXX&quot;</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">name</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">setEdge</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">name</span><span class="s1">)}}));</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Adjusted Graph&quot;</span><span class="s1">,</span><span class="s2">m</span><span class="s1">(</span><span class="s2">e</span><span class="s1">));</span><span class="s2">G</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">trace</span><span class="s1">(</span><span class="s2">X</span><span class="s1">)}),</span><span class="s0">&quot;adjustClustersAndEdges&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">G</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)(((</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)=&gt;{</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;extractor - &quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">m</span><span class="s1">(</span><span class="s2">e</span><span class="s1">),</span><span class="s2">e</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s0">&quot;D&quot;</span><span class="s1">));</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&gt;</span><span class="s3">10</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s0">&quot;Bailing out&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">nodes</span><span class="s1">();</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">a of t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">a</span><span class="s1">);</span><span class="s2">r</span><span class="s1">=</span><span class="s2">r</span><span class="s1">||</span><span class="s2">n</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">r</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Done, no node has children&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">nodes</span><span class="s1">());</span><span class="s4">return</span><span class="s1">}</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Nodes = &quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">a of t</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Extracting node&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">X</span><span class="s1">,</span><span class="s2">X</span><span class="s1">.</span><span class="s2">has</span><span class="s1">(</span><span class="s2">a</span><span class="s1">)&amp;&amp;!</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">a</span><span class="s1">).</span><span class="s2">externalConnections</span><span class="s1">,!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">(</span><span class="s2">a</span><span class="s1">),</span><span class="s2">e</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">a</span><span class="s1">),</span><span class="s2">e</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s0">&quot;D&quot;</span><span class="s1">),</span><span class="s0">&quot; Depth &quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">X</span><span class="s1">.</span><span class="s2">has</span><span class="s1">(</span><span class="s2">a</span><span class="s1">)){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Not a cluster&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(!</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">a</span><span class="s1">).</span><span class="s2">externalConnections</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">a</span><span class="s1">)&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">a</span><span class="s1">).</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Cluster without external connections, without a parent and with children&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">graph</span><span class="s1">();</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">rankdir</span><span class="s1">===</span><span class="s0">&quot;TB&quot;</span><span class="s1">?</span><span class="s0">&quot;LR&quot;</span><span class="s1">:</span><span class="s0">&quot;TB&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">a</span><span class="s1">)?.</span><span class="s2">clusterData</span><span class="s1">?.</span><span class="s2">dir</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">a</span><span class="s1">).</span><span class="s2">clusterData</span><span class="s1">.</span><span class="s2">dir</span><span class="s1">;</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Fixing dir&quot;</span><span class="s1">,</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">a</span><span class="s1">).</span><span class="s2">clusterData</span><span class="s1">.</span><span class="s2">dir</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">new </span><span class="s2">y</span><span class="s1">.</span><span class="s2">T</span><span class="s1">({</span><span class="s2">multigraph</span><span class="s1">:</span><span class="s4">true</span><span class="s1">,</span><span class="s2">compound</span><span class="s1">:</span><span class="s4">true</span><span class="s1">}).</span><span class="s2">setGraph</span><span class="s1">({</span><span class="s2">rankdir</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">nodesep</span><span class="s1">:</span><span class="s3">50</span><span class="s1">,</span><span class="s2">ranksep</span><span class="s1">:</span><span class="s3">50</span><span class="s1">,</span><span class="s2">marginx</span><span class="s1">:</span><span class="s3">8</span><span class="s1">,</span><span class="s2">marginy</span><span class="s1">:</span><span class="s3">8</span><span class="s1">}).</span><span class="s2">setDefaultEdgeLabel</span><span class="s1">((</span><span class="s4">function</span><span class="s1">(){</span><span class="s4">return</span><span class="s1">{}}));</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Old graph before copy&quot;</span><span class="s1">,</span><span class="s2">m</span><span class="s1">(</span><span class="s2">e</span><span class="s1">));</span><span class="s2">x</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">a</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">setNode</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,{</span><span class="s2">clusterNode</span><span class="s1">:</span><span class="s4">true</span><span class="s1">,</span><span class="s2">id</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">clusterData</span><span class="s1">:</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">a</span><span class="s1">).</span><span class="s2">clusterData</span><span class="s1">,</span><span class="s2">label</span><span class="s1">:</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">a</span><span class="s1">).</span><span class="s2">label</span><span class="s1">,</span><span class="s2">graph</span><span class="s1">:</span><span class="s2">i</span><span class="s1">});</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;New graph after copy node: (&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s0">&quot;)&quot;</span><span class="s1">,</span><span class="s2">m</span><span class="s1">(</span><span class="s2">i</span><span class="s1">));</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Old graph after copy&quot;</span><span class="s1">,</span><span class="s2">m</span><span class="s1">(</span><span class="s2">e</span><span class="s1">))}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Cluster ** &quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s0">&quot; **not meeting the criteria !externalConnections:&quot;</span><span class="s1">,!</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">a</span><span class="s1">).</span><span class="s2">externalConnections</span><span class="s1">,</span><span class="s0">&quot; no parent: &quot;</span><span class="s1">,!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">(</span><span class="s2">a</span><span class="s1">),</span><span class="s0">&quot; children &quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">a</span><span class="s1">)&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">a</span><span class="s1">).</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s0">&quot;D&quot;</span><span class="s1">),</span><span class="s2">n</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s2">X</span><span class="s1">)}}</span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">nodes</span><span class="s1">();</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;New list of nodes&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">a of t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">a</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot; Now next level&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">?.</span><span class="s2">clusterNode</span><span class="s1">){</span><span class="s2">G</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">graph</span><span class="s1">,</span><span class="s2">n</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)}}}),</span><span class="s0">&quot;extractor&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">K</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)(((</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">[]}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">Object</span><span class="s1">.</span><span class="s2">assign</span><span class="s1">([],</span><span class="s2">n</span><span class="s1">);</span><span class="s2">n</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">n</span><span class="s1">=&gt;{</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s4">const </span><span class="s2">a</span><span class="s1">=</span><span class="s2">K</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s2">t</span><span class="s1">=[</span><span class="s2">...t</span><span class="s1">,</span><span class="s2">...a</span><span class="s1">]}));</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}),</span><span class="s0">&quot;sorter&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">P</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">K</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">children</span><span class="s1">())),</span><span class="s0">&quot;sortNodesByHierarchy&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">T</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)((</span><span class="s2">async</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">d</span><span class="s1">)=&gt;{</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Graph in recursive render:XAX&quot;</span><span class="s1">,</span><span class="s2">m</span><span class="s1">(</span><span class="s2">n</span><span class="s1">),</span><span class="s2">s</span><span class="s1">);</span><span class="s4">const </span><span class="s2">c</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">graph</span><span class="s1">().</span><span class="s2">rankdir</span><span class="s1">;</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">trace</span><span class="s1">(</span><span class="s0">&quot;Dir in recursive render - dir:&quot;</span><span class="s1">,</span><span class="s2">c</span><span class="s1">);</span><span class="s4">const </span><span class="s2">f</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s0">&quot;g&quot;</span><span class="s1">).</span><span class="s2">attr</span><span class="s1">(</span><span class="s0">&quot;class&quot;</span><span class="s1">,</span><span class="s0">&quot;root&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">n</span><span class="s1">.</span><span class="s2">nodes</span><span class="s1">()){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;No nodes found for&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Recursive render XXX&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">nodes</span><span class="s1">())}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">().</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Recursive edges&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">edge</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">()[</span><span class="s3">0</span><span class="s1">]))}</span><span class="s4">const </span><span class="s2">u</span><span class="s1">=</span><span class="s2">f</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s0">&quot;g&quot;</span><span class="s1">).</span><span class="s2">attr</span><span class="s1">(</span><span class="s0">&quot;class&quot;</span><span class="s1">,</span><span class="s0">&quot;clusters&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">p</span><span class="s1">=</span><span class="s2">f</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s0">&quot;g&quot;</span><span class="s1">).</span><span class="s2">attr</span><span class="s1">(</span><span class="s0">&quot;class&quot;</span><span class="s1">,</span><span class="s0">&quot;edgePaths&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">h</span><span class="s1">=</span><span class="s2">f</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s0">&quot;g&quot;</span><span class="s1">).</span><span class="s2">attr</span><span class="s1">(</span><span class="s0">&quot;class&quot;</span><span class="s1">,</span><span class="s0">&quot;edgeLabels&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">w</span><span class="s1">=</span><span class="s2">f</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s0">&quot;g&quot;</span><span class="s1">).</span><span class="s2">attr</span><span class="s1">(</span><span class="s0">&quot;class&quot;</span><span class="s1">,</span><span class="s0">&quot;nodes&quot;</span><span class="s1">);</span><span class="s4">await </span><span class="s2">Promise</span><span class="s1">.</span><span class="s2">all</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">nodes</span><span class="s1">().</span><span class="s2">map</span><span class="s1">((</span><span class="s2">async </span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">!==</span><span class="s4">void </span><span class="s3">0</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">(</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">clusterData</span><span class="s1">));</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">trace</span><span class="s1">(</span><span class="s0">&quot;Setting data for parent cluster XXX</span><span class="s4">\n </span><span class="s0">Node.id = &quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s0">&quot;</span><span class="s4">\n </span><span class="s0">data=&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">,</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">Parent cluster&quot;</span><span class="s1">,</span><span class="s2">s</span><span class="s1">.</span><span class="s2">height</span><span class="s1">);</span><span class="s2">n</span><span class="s1">.</span><span class="s2">setNode</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">id</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">n</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">trace</span><span class="s1">(</span><span class="s0">&quot;Setting parent&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">s</span><span class="s1">.</span><span class="s2">id</span><span class="s1">);</span><span class="s2">n</span><span class="s1">.</span><span class="s2">setParent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">s</span><span class="s1">.</span><span class="s2">id</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}}</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;(Insert) Node XXX&quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">+</span><span class="s0">&quot;: &quot;</span><span class="s1">+</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)));</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">?.</span><span class="s2">clusterNode</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Cluster identified XBX&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">e</span><span class="s1">));</span><span class="s4">const</span><span class="s1">{</span><span class="s2">ranksep</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">nodesep</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">graph</span><span class="s1">();</span><span class="s2">r</span><span class="s1">.</span><span class="s2">graph</span><span class="s1">.</span><span class="s2">setGraph</span><span class="s1">({</span><span class="s2">...r</span><span class="s1">.</span><span class="s2">graph</span><span class="s1">.</span><span class="s2">graph</span><span class="s1">(),</span><span class="s2">ranksep</span><span class="s1">:</span><span class="s2">o</span><span class="s1">+</span><span class="s3">25</span><span class="s1">,</span><span class="s2">nodesep</span><span class="s1">:</span><span class="s2">s</span><span class="s1">});</span><span class="s4">const </span><span class="s2">c</span><span class="s1">=</span><span class="s4">await </span><span class="s2">T</span><span class="s1">(</span><span class="s2">w</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">graph</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">e</span><span class="s1">),</span><span class="s2">d</span><span class="s1">);</span><span class="s4">const </span><span class="s2">g</span><span class="s1">=</span><span class="s2">c</span><span class="s1">.</span><span class="s2">elem</span><span class="s1">;(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">lC</span><span class="s1">)(</span><span class="s2">r</span><span class="s1">,</span><span class="s2">g</span><span class="s1">);</span><span class="s2">r</span><span class="s1">.</span><span class="s2">diff</span><span class="s1">=</span><span class="s2">c</span><span class="s1">.</span><span class="s2">diff</span><span class="s1">||</span><span class="s3">0</span><span class="s1">;</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;New compound node after recursive render XAX&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s0">&quot;width&quot;</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s0">&quot;height&quot;</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">height</span><span class="s1">);(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">U7</span><span class="s1">)(</span><span class="s2">g</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">trace</span><span class="s1">(</span><span class="s0">&quot;Cluster - the non recursive path XBX&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">id</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s0">&quot;Graph:&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">trace</span><span class="s1">(</span><span class="s2">A</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">id</span><span class="s1">,</span><span class="s2">n</span><span class="s1">));</span><span class="s2">X</span><span class="s1">.</span><span class="s2">set</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">id</span><span class="s1">,{</span><span class="s2">id</span><span class="s1">:</span><span class="s2">A</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">id</span><span class="s1">,</span><span class="s2">n</span><span class="s1">),</span><span class="s2">node</span><span class="s1">:</span><span class="s2">r</span><span class="s1">})}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">trace</span><span class="s1">(</span><span class="s0">&quot;Node - the non recursive path XAX&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">w</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">e</span><span class="s1">),</span><span class="s2">c</span><span class="s1">);</span><span class="s4">await</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">on</span><span class="s1">)(</span><span class="s2">w</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">e</span><span class="s1">),{</span><span class="s2">config</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">dir</span><span class="s1">:</span><span class="s2">c</span><span class="s1">})}}})));</span><span class="s4">const </span><span class="s2">v</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)((</span><span class="s2">async</span><span class="s1">()=&gt;{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">().</span><span class="s2">map</span><span class="s1">((</span><span class="s2">async </span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">edge</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">name</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Edge &quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">+</span><span class="s0">&quot; -&gt; &quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">+</span><span class="s0">&quot;: &quot;</span><span class="s1">+</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">e</span><span class="s1">));</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Edge &quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">+</span><span class="s0">&quot; -&gt; &quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">+</span><span class="s0">&quot;: &quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s0">&quot; &quot;</span><span class="s1">,</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">edge</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)));</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Fix&quot;</span><span class="s1">,</span><span class="s2">X</span><span class="s1">,</span><span class="s0">&quot;ids:&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">,</span><span class="s0">&quot;Translating: &quot;</span><span class="s1">,</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">),</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">));</span><span class="s4">await</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">jP</span><span class="s1">)(</span><span class="s2">h</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}));</span><span class="s4">await </span><span class="s2">Promise</span><span class="s1">.</span><span class="s2">all</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}),</span><span class="s0">&quot;processEdges&quot;</span><span class="s1">);</span><span class="s4">await </span><span class="s2">v</span><span class="s1">();</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Graph before layout:&quot;</span><span class="s1">,</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">m</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)));</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;############################################# XXX&quot;</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;###                Layout                 ### XXX&quot;</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;############################################# XXX&quot;</span><span class="s1">);(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">g</span><span class="s1">.</span><span class="s2">Zp</span><span class="s1">)(</span><span class="s2">n</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Graph after layout:&quot;</span><span class="s1">,</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">m</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)));</span><span class="s4">let </span><span class="s2">R</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let</span><span class="s1">{</span><span class="s2">subGraphTitleTotalMargin</span><span class="s1">:</span><span class="s2">y</span><span class="s1">}=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">o</span><span class="s1">.</span><span class="s2">O</span><span class="s1">)(</span><span class="s2">d</span><span class="s1">);</span><span class="s4">await </span><span class="s2">Promise</span><span class="s1">.</span><span class="s2">all</span><span class="s1">(</span><span class="s2">P</span><span class="s1">(</span><span class="s2">n</span><span class="s1">).</span><span class="s2">map</span><span class="s1">((</span><span class="s2">async </span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Position XBX =&gt; &quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">+</span><span class="s0">&quot;: (&quot;</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s0">&quot;,&quot;</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s0">&quot;) width: &quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s0">&quot; height: &quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">?.</span><span class="s2">clusterNode</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+=</span><span class="s2">y</span><span class="s1">;</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;A tainted cluster node XBX1&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">id</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">));</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">id</span><span class="s1">).</span><span class="s2">node</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">U_</span><span class="s1">)(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">children</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;A pure cluster node XBX1&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">id</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">));</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">+=</span><span class="s2">y</span><span class="s1">;</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">parentId</span><span class="s1">);</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">?.</span><span class="s2">padding</span><span class="s1">/</span><span class="s3">2</span><span class="s1">||</span><span class="s3">0</span><span class="s1">;</span><span class="s4">const </span><span class="s2">a</span><span class="s1">=</span><span class="s2">t</span><span class="s1">?.</span><span class="s2">labelBBox</span><span class="s1">?.</span><span class="s2">height</span><span class="s1">||</span><span class="s3">0</span><span class="s1">;</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">a</span><span class="s1">-</span><span class="s2">r</span><span class="s1">||</span><span class="s3">0</span><span class="s1">;</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;OffsetY&quot;</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s0">&quot;labelHeight&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s0">&quot;halfPadding&quot;</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">await</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">U</span><span class="s1">)(</span><span class="s2">u</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s2">X</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">id</span><span class="s1">).</span><span class="s2">node</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">parentId</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+=</span><span class="s2">y</span><span class="s1">/</span><span class="s3">2</span><span class="s1">;</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;A regular node XBX1 - using the padding&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">id</span><span class="s1">,</span><span class="s0">&quot;parent&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">parentId</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s0">&quot;offsetY&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">offsetY</span><span class="s1">,</span><span class="s0">&quot;parent&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">e</span><span class="s1">?.</span><span class="s2">offsetY</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">U_</span><span class="s1">)(</span><span class="s2">t</span><span class="s1">)}}})));</span><span class="s2">n</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">().</span><span class="s2">forEach</span><span class="s1">((</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">edge</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s0">&quot;Edge &quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">+</span><span class="s0">&quot; -&gt; &quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">+</span><span class="s0">&quot;: &quot;</span><span class="s1">+</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">i</span><span class="s1">),</span><span class="s2">i</span><span class="s1">);</span><span class="s2">i</span><span class="s1">.</span><span class="s2">points</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+=</span><span class="s2">y</span><span class="s1">/</span><span class="s3">2</span><span class="s1">));</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">v</span><span class="s1">);</span><span class="s4">var </span><span class="s2">s</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">w</span><span class="s1">);</span><span class="s4">const </span><span class="s2">d</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">Jo</span><span class="s1">)(</span><span class="s2">p</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">X</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">a</span><span class="s1">);(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">T_</span><span class="s1">)(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">d</span><span class="s1">)}));</span><span class="s2">n</span><span class="s1">.</span><span class="s2">nodes</span><span class="s1">().</span><span class="s2">forEach</span><span class="s1">((</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">info</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">type</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">diff</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">isGroup</span><span class="s1">){</span><span class="s2">R</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">diff</span><span class="s1">}}));</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Returning from recursive render XAX&quot;</span><span class="s1">,</span><span class="s2">f</span><span class="s1">,</span><span class="s2">R</span><span class="s1">);</span><span class="s4">return</span><span class="s1">{</span><span class="s2">elem</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">diff</span><span class="s1">:</span><span class="s2">R</span><span class="s1">}}),</span><span class="s0">&quot;recursiveRender&quot;</span><span class="s1">);</span><span class="s4">var </span><span class="s2">J</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">K2</span><span class="s1">)((</span><span class="s2">async</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)=&gt;{</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">new </span><span class="s2">y</span><span class="s1">.</span><span class="s2">T</span><span class="s1">({</span><span class="s2">multigraph</span><span class="s1">:</span><span class="s4">true</span><span class="s1">,</span><span class="s2">compound</span><span class="s1">:</span><span class="s4">true</span><span class="s1">}).</span><span class="s2">setGraph</span><span class="s1">({</span><span class="s2">rankdir</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">direction</span><span class="s1">,</span><span class="s2">nodesep</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">config</span><span class="s1">?.</span><span class="s2">nodeSpacing</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">config</span><span class="s1">?.</span><span class="s2">flowchart</span><span class="s1">?.</span><span class="s2">nodeSpacing</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">nodeSpacing</span><span class="s1">,</span><span class="s2">ranksep</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">config</span><span class="s1">?.</span><span class="s2">rankSpacing</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">config</span><span class="s1">?.</span><span class="s2">flowchart</span><span class="s1">?.</span><span class="s2">rankSpacing</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rankSpacing</span><span class="s1">,</span><span class="s2">marginx</span><span class="s1">:</span><span class="s3">8</span><span class="s1">,</span><span class="s2">marginy</span><span class="s1">:</span><span class="s3">8</span><span class="s1">}).</span><span class="s2">setDefaultEdgeLabel</span><span class="s1">((</span><span class="s4">function</span><span class="s1">(){</span><span class="s4">return</span><span class="s1">{}}));</span><span class="s4">const </span><span class="s2">a</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">select</span><span class="s1">(</span><span class="s0">&quot;g&quot;</span><span class="s1">);(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">g0</span><span class="s1">)(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">markers</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">diagramId</span><span class="s1">);(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">gh</span><span class="s1">)();(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">IU</span><span class="s1">)();(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">IU</span><span class="s1">)();</span><span class="s2">N</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">nodes</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setNode</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">id</span><span class="s1">,{</span><span class="s2">...e</span><span class="s1">});</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">parentId</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setParent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">id</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">parentId</span><span class="s1">)}}));</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">debug</span><span class="s1">(</span><span class="s0">&quot;Edges:&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">edges</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">start</span><span class="s1">===</span><span class="s2">e</span><span class="s1">.</span><span class="s2">end</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">start</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot;---&quot;</span><span class="s1">+</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot;---1&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">a</span><span class="s1">=</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot;---&quot;</span><span class="s1">+</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot;---2&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">node</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setNode</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,{</span><span class="s2">domId</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">id</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">parentId</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">parentId</span><span class="s1">,</span><span class="s2">labelStyle</span><span class="s1">:</span><span class="s0">&quot;&quot;</span><span class="s1">,</span><span class="s2">label</span><span class="s1">:</span><span class="s0">&quot;&quot;</span><span class="s1">,</span><span class="s2">padding</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">shape</span><span class="s1">:</span><span class="s0">&quot;labelRect&quot;</span><span class="s1">,</span><span class="s2">style</span><span class="s1">:</span><span class="s0">&quot;&quot;</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s3">10</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s3">10</span><span class="s1">});</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setParent</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">parentId</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setNode</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,{</span><span class="s2">domId</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">id</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">parentId</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">parentId</span><span class="s1">,</span><span class="s2">labelStyle</span><span class="s1">:</span><span class="s0">&quot;&quot;</span><span class="s1">,</span><span class="s2">padding</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">shape</span><span class="s1">:</span><span class="s0">&quot;labelRect&quot;</span><span class="s1">,</span><span class="s2">label</span><span class="s1">:</span><span class="s0">&quot;&quot;</span><span class="s1">,</span><span class="s2">style</span><span class="s1">:</span><span class="s0">&quot;&quot;</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s3">10</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s3">10</span><span class="s1">});</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setParent</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">parentId</span><span class="s1">);</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">structuredClone</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">structuredClone</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">const </span><span class="s2">d</span><span class="s1">=</span><span class="s2">structuredClone</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s2">o</span><span class="s1">.</span><span class="s2">label</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">arrowTypeEnd</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">id</span><span class="s1">=</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot;-cyclic-special-1&quot;</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">arrowTypeStart</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">arrowTypeEnd</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">id</span><span class="s1">=</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot;-cyclic-special-mid&quot;</span><span class="s1">;</span><span class="s2">d</span><span class="s1">.</span><span class="s2">label</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">isGroup</span><span class="s1">){</span><span class="s2">o</span><span class="s1">.</span><span class="s2">fromCluster</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">d</span><span class="s1">.</span><span class="s2">toCluster</span><span class="s1">=</span><span class="s2">n</span><span class="s1">}</span><span class="s2">d</span><span class="s1">.</span><span class="s2">id</span><span class="s1">=</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot;-cyclic-special-2&quot;</span><span class="s1">;</span><span class="s2">d</span><span class="s1">.</span><span class="s2">arrowTypeStart</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setEdge</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot;-cyclic-special-0&quot;</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setEdge</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot;-cyclic-special-1&quot;</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setEdge</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot;-cyc&lt;lic-special-2&quot;</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setEdge</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">start</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">end</span><span class="s1">,{</span><span class="s2">...e</span><span class="s1">},</span><span class="s2">e</span><span class="s1">.</span><span class="s2">id</span><span class="s1">)}}));</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Graph at first:&quot;</span><span class="s1">,</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">m</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)));</span><span class="s2">k</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Rm</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;Graph after XAX:&quot;</span><span class="s1">,</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">m</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)));</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">D7</span><span class="s1">)();</span><span class="s4">await </span><span class="s2">T</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">diagramId</span><span class="s1">,</span><span class="s4">void </span><span class="s3">0</span><span class="s1">,</span><span class="s2">o</span><span class="s1">)}),</span><span class="s0">&quot;render&quot;</span><span class="s1">)}}]);</span></pre>
</body>
</html>