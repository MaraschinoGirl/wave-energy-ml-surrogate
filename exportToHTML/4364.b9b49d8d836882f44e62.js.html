<html>
<head>
<title>4364.b9b49d8d836882f44e62.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #6aab73;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #2aacb8;}
.s4 { color: #cf8e6d;}
.s5 { color: #42c3d4;}
.ln { color: #4b5059; font-weight: normal; font-style: normal; }
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
4364.b9b49d8d836882f44e62.js</font>
</center></td></tr></table>
<pre><a name="l1"><span class="ln">1    </span></a><span class="s0">&quot;use strict&quot;</span><span class="s1">;(</span><span class="s2">self</span><span class="s1">[</span><span class="s0">&quot;webpackChunk_jupyterlab_application_top&quot;</span><span class="s1">]=</span><span class="s2">self</span><span class="s1">[</span><span class="s0">&quot;webpackChunk_jupyterlab_application_top&quot;</span><span class="s1">]||[]).</span><span class="s2">push</span><span class="s1">([[</span><span class="s3">4364</span><span class="s1">],{</span><span class="s3">54364</span><span class="s1">:(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)=&gt;{</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s2">n</span><span class="s1">.</span><span class="s2">d</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,{</span><span class="s2">Hooks</span><span class="s1">:()=&gt;</span><span class="s2">ze</span><span class="s1">,</span><span class="s2">Lexer</span><span class="s1">:()=&gt;</span><span class="s2">$e</span><span class="s1">,</span><span class="s2">Marked</span><span class="s1">:()=&gt;</span><span class="s2">Ae</span><span class="s1">,</span><span class="s2">Parser</span><span class="s1">:()=&gt;</span><span class="s2">Te</span><span class="s1">,</span><span class="s2">Renderer</span><span class="s1">:()=&gt;</span><span class="s2">Re</span><span class="s1">,</span><span class="s2">TextRenderer</span><span class="s1">:()=&gt;</span><span class="s2">Se</span><span class="s1">,</span><span class="s2">Tokenizer</span><span class="s1">:()=&gt;</span><span class="s2">ye</span><span class="s1">,</span><span class="s2">defaults</span><span class="s1">:()=&gt;</span><span class="s2">r</span><span class="s1">,</span><span class="s2">getDefaults</span><span class="s1">:()=&gt;</span><span class="s2">s</span><span class="s1">,</span><span class="s2">lexer</span><span class="s1">:()=&gt;</span><span class="s2">ve</span><span class="s1">,</span><span class="s2">marked</span><span class="s1">:()=&gt;</span><span class="s2">Ie</span><span class="s1">,</span><span class="s2">options</span><span class="s1">:()=&gt;</span><span class="s2">Pe</span><span class="s1">,</span><span class="s2">parse</span><span class="s1">:()=&gt;</span><span class="s2">Ee</span><span class="s1">,</span><span class="s2">parseInline</span><span class="s1">:()=&gt;</span><span class="s2">qe</span><span class="s1">,</span><span class="s2">parser</span><span class="s1">:()=&gt;</span><span class="s2">Ze</span><span class="s1">,</span><span class="s2">setOptions</span><span class="s1">:()=&gt;</span><span class="s2">Le</span><span class="s1">,</span><span class="s2">use</span><span class="s1">:()=&gt;</span><span class="s2">Ce</span><span class="s1">,</span><span class="s2">walkTokens</span><span class="s1">:()=&gt;</span><span class="s2">Be</span><span class="s1">});</span><span class="s4">function </span><span class="s2">s</span><span class="s1">(){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">async</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">breaks</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">extensions</span><span class="s1">:</span><span class="s4">null</span><span class="s1">,</span><span class="s2">gfm</span><span class="s1">:</span><span class="s4">true</span><span class="s1">,</span><span class="s2">hooks</span><span class="s1">:</span><span class="s4">null</span><span class="s1">,</span><span class="s2">pedantic</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">renderer</span><span class="s1">:</span><span class="s4">null</span><span class="s1">,</span><span class="s2">silent</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">tokenizer</span><span class="s1">:</span><span class="s4">null</span><span class="s1">,</span><span class="s2">walkTokens</span><span class="s1">:</span><span class="s4">null</span><span class="s1">}}</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">();</span><span class="s4">function </span><span class="s2">i</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">const </span><span class="s2">l</span><span class="s1">={</span><span class="s2">exec</span><span class="s1">:()=&gt;</span><span class="s4">null</span><span class="s1">};</span><span class="s4">function </span><span class="s2">o</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">){</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">typeof </span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;string&quot;</span><span class="s1">?</span><span class="s2">e</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">source</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">={</span><span class="s2">replace</span><span class="s1">:(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)=&gt;{</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">typeof </span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;string&quot;</span><span class="s1">?</span><span class="s2">t</span><span class="s1">:</span><span class="s2">t</span><span class="s1">.</span><span class="s2">source</span><span class="s1">;</span><span class="s2">r</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">caret</span><span class="s1">,</span><span class="s0">&quot;$1&quot;</span><span class="s1">);</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">return </span><span class="s2">s</span><span class="s1">},</span><span class="s2">getRegex</span><span class="s1">:()=&gt;</span><span class="s4">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)};</span><span class="s4">return </span><span class="s2">s</span><span class="s1">}</span><span class="s4">const </span><span class="s2">a</span><span class="s1">={</span><span class="s2">codeRemoveIndent</span><span class="s1">:</span><span class="s5">/^(?: {1,4}| {0,3}\t)/gm</span><span class="s1">,</span><span class="s2">outputLinkReplace</span><span class="s1">:</span><span class="s5">/\\([\[\]])/g</span><span class="s1">,</span><span class="s2">indentCodeCompensation</span><span class="s1">:</span><span class="s5">/^(\s+)(?:```)/</span><span class="s1">,</span><span class="s2">beginningSpace</span><span class="s1">:</span><span class="s5">/^\s+/</span><span class="s1">,</span><span class="s2">endingHash</span><span class="s1">:</span><span class="s5">/#$/</span><span class="s1">,</span><span class="s2">startingSpaceChar</span><span class="s1">:</span><span class="s5">/^ /</span><span class="s1">,</span><span class="s2">endingSpaceChar</span><span class="s1">:</span><span class="s5">/ $/</span><span class="s1">,</span><span class="s2">nonSpaceChar</span><span class="s1">:</span><span class="s5">/[^ ]/</span><span class="s1">,</span><span class="s2">newLineCharGlobal</span><span class="s1">:</span><span class="s5">/\n/g</span><span class="s1">,</span><span class="s2">tabCharGlobal</span><span class="s1">:</span><span class="s5">/\t/g</span><span class="s1">,</span><span class="s2">multipleSpaceGlobal</span><span class="s1">:</span><span class="s5">/\s+/g</span><span class="s1">,</span><span class="s2">blankLine</span><span class="s1">:</span><span class="s5">/^[ \t]*$/</span><span class="s1">,</span><span class="s2">doubleBlankLine</span><span class="s1">:</span><span class="s5">/\n[ \t]*\n[ \t]*$/</span><span class="s1">,</span><span class="s2">blockquoteStart</span><span class="s1">:</span><span class="s5">/^ {0,3}&gt;/</span><span class="s1">,</span><span class="s2">blockquoteSetextReplace</span><span class="s1">:</span><span class="s5">/\n {0,3}((?:=+|-+) *)(?=\n|$)/g</span><span class="s1">,</span><span class="s2">blockquoteSetextReplace2</span><span class="s1">:</span><span class="s5">/^ {0,3}&gt;[ \t]?/gm</span><span class="s1">,</span><span class="s2">listReplaceTabs</span><span class="s1">:</span><span class="s5">/^\t+/</span><span class="s1">,</span><span class="s2">listReplaceNesting</span><span class="s1">:</span><span class="s5">/^ {1,4}(?=( {4})*[^ ])/g</span><span class="s1">,</span><span class="s2">listIsTask</span><span class="s1">:</span><span class="s5">/^\[[ xX]\] /</span><span class="s1">,</span><span class="s2">listReplaceTask</span><span class="s1">:</span><span class="s5">/^\[[ xX]\] +/</span><span class="s1">,</span><span class="s2">anyLine</span><span class="s1">:</span><span class="s5">/\n.*\n/</span><span class="s1">,</span><span class="s2">hrefBrackets</span><span class="s1">:</span><span class="s5">/^&lt;(.*)&gt;$/</span><span class="s1">,</span><span class="s2">tableDelimiter</span><span class="s1">:</span><span class="s5">/[:|]/</span><span class="s1">,</span><span class="s2">tableAlignChars</span><span class="s1">:</span><span class="s5">/^\||\| *$/g</span><span class="s1">,</span><span class="s2">tableRowBlankLine</span><span class="s1">:</span><span class="s5">/\n[ \t]*$/</span><span class="s1">,</span><span class="s2">tableAlignRight</span><span class="s1">:</span><span class="s5">/^ *-+: *$/</span><span class="s1">,</span><span class="s2">tableAlignCenter</span><span class="s1">:</span><span class="s5">/^ *:-+: *$/</span><span class="s1">,</span><span class="s2">tableAlignLeft</span><span class="s1">:</span><span class="s5">/^ *:-+ *$/</span><span class="s1">,</span><span class="s2">startATag</span><span class="s1">:</span><span class="s5">/^&lt;a /i</span><span class="s1">,</span><span class="s2">endATag</span><span class="s1">:</span><span class="s5">/^&lt;\/a&gt;/i</span><span class="s1">,</span><span class="s2">startPreScriptTag</span><span class="s1">:</span><span class="s5">/^&lt;(pre|code|kbd|script)(\s|&gt;)/i</span><span class="s1">,</span><span class="s2">endPreScriptTag</span><span class="s1">:</span><span class="s5">/^&lt;\/(pre|code|kbd|script)(\s|&gt;)/i</span><span class="s1">,</span><span class="s2">startAngleBracket</span><span class="s1">:</span><span class="s5">/^&lt;/</span><span class="s1">,</span><span class="s2">endAngleBracket</span><span class="s1">:</span><span class="s5">/&gt;$/</span><span class="s1">,</span><span class="s2">pedanticHrefTitle</span><span class="s1">:</span><span class="s5">/^([^'&quot;]*[^\s])\s+(['&quot;])(.*)\2/</span><span class="s1">,</span><span class="s2">unicodeAlphaNumeric</span><span class="s1">:</span><span class="s5">/[\p{L}\p{N}]/u</span><span class="s1">,</span><span class="s2">escapeTest</span><span class="s1">:</span><span class="s5">/[&amp;&lt;&gt;&quot;']/</span><span class="s1">,</span><span class="s2">escapeReplace</span><span class="s1">:</span><span class="s5">/[&amp;&lt;&gt;&quot;']/g</span><span class="s1">,</span><span class="s2">escapeTestNoEncode</span><span class="s1">:</span><span class="s5">/[&lt;&gt;&quot;']|&amp;(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/</span><span class="s1">,</span><span class="s2">escapeReplaceNoEncode</span><span class="s1">:</span><span class="s5">/[&lt;&gt;&quot;']|&amp;(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g</span><span class="s1">,</span><span class="s2">unescapeTest</span><span class="s1">:</span><span class="s5">/&amp;(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi</span><span class="s1">,</span><span class="s2">caret</span><span class="s1">:</span><span class="s5">/(^|[^\[])\^/g</span><span class="s1">,</span><span class="s2">percentDecode</span><span class="s1">:</span><span class="s5">/%25/g</span><span class="s1">,</span><span class="s2">findPipe</span><span class="s1">:</span><span class="s5">/\|/g</span><span class="s1">,</span><span class="s2">splitPipe</span><span class="s1">:</span><span class="s5">/ \|/</span><span class="s1">,</span><span class="s2">slashPipe</span><span class="s1">:</span><span class="s5">/\\\|/g</span><span class="s1">,</span><span class="s2">carriageReturn</span><span class="s1">:</span><span class="s5">/\r\n|\r/g</span><span class="s1">,</span><span class="s2">spaceLine</span><span class="s1">:</span><span class="s5">/^ +$/gm</span><span class="s1">,</span><span class="s2">notSpaceStart</span><span class="s1">:</span><span class="s5">/^\S*/</span><span class="s1">,</span><span class="s2">endingNewline</span><span class="s1">:</span><span class="s5">/\n$/</span><span class="s1">,</span><span class="s2">listItemRegex</span><span class="s1">:</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s4">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">`^( {0,3}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">e</span><span class="s1">}</span><span class="s0">)((?:[</span><span class="s4">\t </span><span class="s0">][^</span><span class="s4">\\</span><span class="s0">n]*)?(?:</span><span class="s4">\\</span><span class="s0">n|$))`</span><span class="s1">),</span><span class="s2">nextBulletRegex</span><span class="s1">:</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s4">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">`^ {0,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s3">3</span><span class="s1">,</span><span class="s2">e</span><span class="s1">-</span><span class="s3">1</span><span class="s1">)}</span><span class="s0">}(?:[*+-]|</span><span class="s4">\\</span><span class="s0">d{1,9}[.)])((?:[ </span><span class="s4">\t</span><span class="s0">][^</span><span class="s4">\\</span><span class="s0">n]*)?(?:</span><span class="s4">\\</span><span class="s0">n|$))`</span><span class="s1">),</span><span class="s2">hrRegex</span><span class="s1">:</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s4">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">`^ {0,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s3">3</span><span class="s1">,</span><span class="s2">e</span><span class="s1">-</span><span class="s3">1</span><span class="s1">)}</span><span class="s0">}((?:- *){3,}|(?:_ *){3,}|(?:</span><span class="s4">\\</span><span class="s0">* *){3,})(?:</span><span class="s4">\\</span><span class="s0">n+|$)`</span><span class="s1">),</span><span class="s2">fencesBeginRegex</span><span class="s1">:</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s4">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">`^ {0,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s3">3</span><span class="s1">,</span><span class="s2">e</span><span class="s1">-</span><span class="s3">1</span><span class="s1">)}</span><span class="s0">}(?:</span><span class="s4">\`\`\`</span><span class="s0">|~~~)`</span><span class="s1">),</span><span class="s2">headingBeginRegex</span><span class="s1">:</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s4">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">`^ {0,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s3">3</span><span class="s1">,</span><span class="s2">e</span><span class="s1">-</span><span class="s3">1</span><span class="s1">)}</span><span class="s0">}#`</span><span class="s1">),</span><span class="s2">htmlBeginRegex</span><span class="s1">:</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s4">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">`^ {0,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s3">3</span><span class="s1">,</span><span class="s2">e</span><span class="s1">-</span><span class="s3">1</span><span class="s1">)}</span><span class="s0">}&lt;(?:[a-z].*&gt;|!--)`</span><span class="s1">,</span><span class="s0">&quot;i&quot;</span><span class="s1">)};</span><span class="s4">const </span><span class="s2">c</span><span class="s1">=</span><span class="s5">/^(?:[ \t]*(?:\n|$))+/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">h</span><span class="s1">=</span><span class="s5">/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">p</span><span class="s1">=</span><span class="s5">/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">u</span><span class="s1">=</span><span class="s5">/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">f</span><span class="s1">=</span><span class="s5">/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">g</span><span class="s1">=</span><span class="s5">/(?:[*+-]|\d{1,9}[.)])/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">k</span><span class="s1">=</span><span class="s5">/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">d</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s2">k</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/bull/g</span><span class="s1">,</span><span class="s2">g</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/blockCode/g</span><span class="s1">,</span><span class="s5">/(?: {4}| {0,3}\t)/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/fences/g</span><span class="s1">,</span><span class="s5">/ {0,3}(?:`{3,}|~{3,})/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/blockquote/g</span><span class="s1">,</span><span class="s5">/ {0,3}&gt;/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/heading/g</span><span class="s1">,</span><span class="s5">/ {0,3}#{1,6}/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/html/g</span><span class="s1">,</span><span class="s5">/ {0,3}&lt;[^\n&gt;]+&gt;\n/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/\|table/g</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">x</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s2">k</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/bull/g</span><span class="s1">,</span><span class="s2">g</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/blockCode/g</span><span class="s1">,</span><span class="s5">/(?: {4}| {0,3}\t)/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/fences/g</span><span class="s1">,</span><span class="s5">/ {0,3}(?:`{3,}|~{3,})/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/blockquote/g</span><span class="s1">,</span><span class="s5">/ {0,3}&gt;/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/heading/g</span><span class="s1">,</span><span class="s5">/ {0,3}#{1,6}/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/html/g</span><span class="s1">,</span><span class="s5">/ {0,3}&lt;[^\n&gt;]+&gt;\n/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/table/g</span><span class="s1">,</span><span class="s5">/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">b</span><span class="s1">=</span><span class="s5">/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">w</span><span class="s1">=</span><span class="s5">/^[^\n]+/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">m</span><span class="s1">=</span><span class="s5">/(?!\s*\])(?:\\.|[^\[\]\\])+/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">y</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s5">/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^&lt;\s][^\s]*|&lt;.*?&gt;)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;label&quot;</span><span class="s1">,</span><span class="s2">m</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;title&quot;</span><span class="s1">,</span><span class="s5">/(?:&quot;(?:\\&quot;?|[^&quot;\\])*&quot;|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">$</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s5">/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/bull/g</span><span class="s1">,</span><span class="s2">g</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">R</span><span class="s1">=</span><span class="s0">&quot;address|article|aside|base|basefont|blockquote|body|caption&quot;</span><span class="s1">+</span><span class="s0">&quot;|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption&quot;</span><span class="s1">+</span><span class="s0">&quot;|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe&quot;</span><span class="s1">+</span><span class="s0">&quot;|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option&quot;</span><span class="s1">+</span><span class="s0">&quot;|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title&quot;</span><span class="s1">+</span><span class="s0">&quot;|tr|track|ul&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">S</span><span class="s1">=</span><span class="s5">/&lt;!--(?:-?&gt;|[\s\S]*?(?:--&gt;|$))/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">T</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s0">&quot;^ {0,3}(?:&quot;</span><span class="s1">+</span><span class="s0">&quot;&lt;(script|pre|style|textarea)[</span><span class="s4">\\</span><span class="s0">s&gt;][</span><span class="s4">\\</span><span class="s0">s</span><span class="s4">\\</span><span class="s0">S]*?(?:&lt;/</span><span class="s4">\\</span><span class="s0">1&gt;[^</span><span class="s4">\\</span><span class="s0">n]*</span><span class="s4">\\</span><span class="s0">n+|$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|comment[^</span><span class="s4">\\</span><span class="s0">n]*(</span><span class="s4">\\</span><span class="s0">n+|$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|&lt;</span><span class="s4">\\</span><span class="s0">?[</span><span class="s4">\\</span><span class="s0">s</span><span class="s4">\\</span><span class="s0">S]*?(?:</span><span class="s4">\\</span><span class="s0">?&gt;</span><span class="s4">\\</span><span class="s0">n*|$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|&lt;![A-Z][</span><span class="s4">\\</span><span class="s0">s</span><span class="s4">\\</span><span class="s0">S]*?(?:&gt;</span><span class="s4">\\</span><span class="s0">n*|$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|&lt;!</span><span class="s4">\\</span><span class="s0">[CDATA</span><span class="s4">\\</span><span class="s0">[[</span><span class="s4">\\</span><span class="s0">s</span><span class="s4">\\</span><span class="s0">S]*?(?:</span><span class="s4">\\</span><span class="s0">]</span><span class="s4">\\</span><span class="s0">]&gt;</span><span class="s4">\\</span><span class="s0">n*|$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|&lt;/?(tag)(?: +|</span><span class="s4">\\</span><span class="s0">n|/?&gt;)[</span><span class="s4">\\</span><span class="s0">s</span><span class="s4">\\</span><span class="s0">S]*?(?:(?:</span><span class="s4">\\</span><span class="s0">n[ </span><span class="s4">\t</span><span class="s0">]*)+</span><span class="s4">\\</span><span class="s0">n|$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|&lt;(?!script|pre|style|textarea)([a-z][</span><span class="s4">\\</span><span class="s0">w-]*)(?:attribute)*? */?&gt;(?=[ </span><span class="s4">\\</span><span class="s0">t]*(?:</span><span class="s4">\\</span><span class="s0">n|$))[</span><span class="s4">\\</span><span class="s0">s</span><span class="s4">\\</span><span class="s0">S]*?(?:(?:</span><span class="s4">\\</span><span class="s0">n[ </span><span class="s4">\t</span><span class="s0">]*)+</span><span class="s4">\\</span><span class="s0">n|$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|&lt;/(?!script|pre|style|textarea)[a-z][</span><span class="s4">\\</span><span class="s0">w-]*</span><span class="s4">\\</span><span class="s0">s*&gt;(?=[ </span><span class="s4">\\</span><span class="s0">t]*(?:</span><span class="s4">\\</span><span class="s0">n|$))[</span><span class="s4">\\</span><span class="s0">s</span><span class="s4">\\</span><span class="s0">S]*?(?:(?:</span><span class="s4">\\</span><span class="s0">n[ </span><span class="s4">\t</span><span class="s0">]*)+</span><span class="s4">\\</span><span class="s0">n|$)&quot;</span><span class="s1">+</span><span class="s0">&quot;)&quot;</span><span class="s1">,</span><span class="s0">&quot;i&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;comment&quot;</span><span class="s1">,</span><span class="s2">S</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;tag&quot;</span><span class="s1">,</span><span class="s2">R</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;attribute&quot;</span><span class="s1">,</span><span class="s5">/ +[a-zA-Z:_][\w.:-]*(?: *= *&quot;[^&quot;\n]*&quot;| *= *'[^'\n]*'| *= *[^\s&quot;'=&lt;&gt;`]+)?/</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">z</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s2">b</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;hr&quot;</span><span class="s1">,</span><span class="s2">u</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;heading&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}#{1,6}(?:</span><span class="s4">\\</span><span class="s0">s|$)&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;|lheading&quot;</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;|table&quot;</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;blockquote&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}&gt;&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;fences&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}(?:`{3,}(?=[^`</span><span class="s4">\\</span><span class="s0">n]*</span><span class="s4">\\</span><span class="s0">n)|~{3,})[^</span><span class="s4">\\</span><span class="s0">n]*</span><span class="s4">\\</span><span class="s0">n&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;list&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}(?:[*+-]|1[.)]) &quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;html&quot;</span><span class="s1">,</span><span class="s0">&quot;&lt;/?(?:tag)(?: +|</span><span class="s4">\\</span><span class="s0">n|/?&gt;)|&lt;(?:script|pre|style|textarea|!--)&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;tag&quot;</span><span class="s1">,</span><span class="s2">R</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">A</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s5">/^( {0,3}&gt; ?(paragraph|[^\n]*)(?:\n|$))+/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;paragraph&quot;</span><span class="s1">,</span><span class="s2">z</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">_</span><span class="s1">={</span><span class="s2">blockquote</span><span class="s1">:</span><span class="s2">A</span><span class="s1">,</span><span class="s2">code</span><span class="s1">:</span><span class="s2">h</span><span class="s1">,</span><span class="s2">def</span><span class="s1">:</span><span class="s2">y</span><span class="s1">,</span><span class="s2">fences</span><span class="s1">:</span><span class="s2">p</span><span class="s1">,</span><span class="s2">heading</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">hr</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">html</span><span class="s1">:</span><span class="s2">T</span><span class="s1">,</span><span class="s2">lheading</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">list</span><span class="s1">:</span><span class="s2">$</span><span class="s1">,</span><span class="s2">newline</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">paragraph</span><span class="s1">:</span><span class="s2">z</span><span class="s1">,</span><span class="s2">table</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">w</span><span class="s1">};</span><span class="s4">const </span><span class="s2">I</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s0">&quot;^ *([^</span><span class="s4">\\</span><span class="s0">n ].*)</span><span class="s4">\\</span><span class="s0">n&quot;</span><span class="s1">+</span><span class="s0">&quot; {0,3}((?:</span><span class="s4">\\</span><span class="s0">| *)?:?-+:? *(?:</span><span class="s4">\\</span><span class="s0">| *:?-+:? *)*(?:</span><span class="s4">\\</span><span class="s0">| *)?)&quot;</span><span class="s1">+</span><span class="s0">&quot;(?:</span><span class="s4">\\</span><span class="s0">n((?:(?! *</span><span class="s4">\\</span><span class="s0">n|hr|heading|blockquote|code|fences|list|html).*(?:</span><span class="s4">\\</span><span class="s0">n|$))*)</span><span class="s4">\\</span><span class="s0">n*|$)&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;hr&quot;</span><span class="s1">,</span><span class="s2">u</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;heading&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}#{1,6}(?:</span><span class="s4">\\</span><span class="s0">s|$)&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;blockquote&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}&gt;&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;code&quot;</span><span class="s1">,</span><span class="s0">&quot;(?: {4}| {0,3}</span><span class="s4">\t</span><span class="s0">)[^</span><span class="s4">\\</span><span class="s0">n]&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;fences&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}(?:`{3,}(?=[^`</span><span class="s4">\\</span><span class="s0">n]*</span><span class="s4">\\</span><span class="s0">n)|~{3,})[^</span><span class="s4">\\</span><span class="s0">n]*</span><span class="s4">\\</span><span class="s0">n&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;list&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}(?:[*+-]|1[.)]) &quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;html&quot;</span><span class="s1">,</span><span class="s0">&quot;&lt;/?(?:tag)(?: +|</span><span class="s4">\\</span><span class="s0">n|/?&gt;)|&lt;(?:script|pre|style|textarea|!--)&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;tag&quot;</span><span class="s1">,</span><span class="s2">R</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">P</span><span class="s1">={</span><span class="s2">..._</span><span class="s1">,</span><span class="s2">lheading</span><span class="s1">:</span><span class="s2">x</span><span class="s1">,</span><span class="s2">table</span><span class="s1">:</span><span class="s2">I</span><span class="s1">,</span><span class="s2">paragraph</span><span class="s1">:</span><span class="s2">o</span><span class="s1">(</span><span class="s2">b</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;hr&quot;</span><span class="s1">,</span><span class="s2">u</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;heading&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}#{1,6}(?:</span><span class="s4">\\</span><span class="s0">s|$)&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;|lheading&quot;</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;table&quot;</span><span class="s1">,</span><span class="s2">I</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;blockquote&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}&gt;&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;fences&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}(?:`{3,}(?=[^`</span><span class="s4">\\</span><span class="s0">n]*</span><span class="s4">\\</span><span class="s0">n)|~{3,})[^</span><span class="s4">\\</span><span class="s0">n]*</span><span class="s4">\\</span><span class="s0">n&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;list&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}(?:[*+-]|1[.)]) &quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;html&quot;</span><span class="s1">,</span><span class="s0">&quot;&lt;/?(?:tag)(?: +|</span><span class="s4">\\</span><span class="s0">n|/?&gt;)|&lt;(?:script|pre|style|textarea|!--)&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;tag&quot;</span><span class="s1">,</span><span class="s2">R</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">()};</span><span class="s4">const </span><span class="s2">L</span><span class="s1">={</span><span class="s2">..._</span><span class="s1">,</span><span class="s2">html</span><span class="s1">:</span><span class="s2">o</span><span class="s1">(</span><span class="s0">&quot;^ *(?:comment *(?:</span><span class="s4">\\</span><span class="s0">n|</span><span class="s4">\\</span><span class="s0">s*$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|&lt;(tag)[</span><span class="s4">\\</span><span class="s0">s</span><span class="s4">\\</span><span class="s0">S]+?&lt;/</span><span class="s4">\\</span><span class="s0">1&gt; *(?:</span><span class="s4">\\</span><span class="s0">n{2,}|</span><span class="s4">\\</span><span class="s0">s*$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|&lt;tag(?:</span><span class="s4">\&quot;</span><span class="s0">[^</span><span class="s4">\&quot;</span><span class="s0">]*</span><span class="s4">\&quot;</span><span class="s0">|'[^']*'|</span><span class="s4">\\</span><span class="s0">s[^'</span><span class="s4">\&quot;</span><span class="s0">/&gt;</span><span class="s4">\\</span><span class="s0">s]*)*?/?&gt; *(?:</span><span class="s4">\\</span><span class="s0">n{2,}|</span><span class="s4">\\</span><span class="s0">s*$))&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;comment&quot;</span><span class="s1">,</span><span class="s2">S</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/tag/g</span><span class="s1">,</span><span class="s0">&quot;(?!(?:&quot;</span><span class="s1">+</span><span class="s0">&quot;a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub&quot;</span><span class="s1">+</span><span class="s0">&quot;|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)&quot;</span><span class="s1">+</span><span class="s0">&quot;</span><span class="s4">\\</span><span class="s0">b)</span><span class="s4">\\</span><span class="s0">w+(?!:|[^</span><span class="s4">\\</span><span class="s0">w</span><span class="s4">\\</span><span class="s0">s@]*@)</span><span class="s4">\\</span><span class="s0">b&quot;</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">(),</span><span class="s2">def</span><span class="s1">:</span><span class="s5">/^ *\[([^\]]+)\]: *&lt;?([^\s&gt;]+)&gt;?(?: +([&quot;(][^\n]+[&quot;)]))? *(?:\n+|$)/</span><span class="s1">,</span><span class="s2">heading</span><span class="s1">:</span><span class="s5">/^(#{1,6})(.*)(?:\n+|$)/</span><span class="s1">,</span><span class="s2">fences</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">lheading</span><span class="s1">:</span><span class="s5">/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/</span><span class="s1">,</span><span class="s2">paragraph</span><span class="s1">:</span><span class="s2">o</span><span class="s1">(</span><span class="s2">b</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;hr&quot;</span><span class="s1">,</span><span class="s2">u</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;heading&quot;</span><span class="s1">,</span><span class="s0">&quot; *#{1,6} *[^</span><span class="s4">\n</span><span class="s0">]&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;lheading&quot;</span><span class="s1">,</span><span class="s2">d</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;|table&quot;</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;blockquote&quot;</span><span class="s1">,</span><span class="s0">&quot; {0,3}&gt;&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;|fences&quot;</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;|list&quot;</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;|html&quot;</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;|tag&quot;</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">()};</span><span class="s4">const </span><span class="s2">C</span><span class="s1">=</span><span class="s5">/^\\([!&quot;#$%&amp;'()*+,\-./:;&lt;=&gt;?@\[\]\\^_`{|}~])/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">B</span><span class="s1">=</span><span class="s5">/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">q</span><span class="s1">=</span><span class="s5">/^( {2,}|\\)\n(?!\s*$)/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">E</span><span class="s1">=</span><span class="s5">/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\&lt;!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">Z</span><span class="s1">=</span><span class="s5">/[\p{P}\p{S}]/u</span><span class="s1">;</span><span class="s4">const </span><span class="s2">v</span><span class="s1">=</span><span class="s5">/[\s\p{P}\p{S}]/u</span><span class="s1">;</span><span class="s4">const </span><span class="s2">D</span><span class="s1">=</span><span class="s5">/[^\s\p{P}\p{S}]/u</span><span class="s1">;</span><span class="s4">const </span><span class="s2">M</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s5">/^((?![*_])punctSpace)/</span><span class="s1">,</span><span class="s0">&quot;u&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/punctSpace/g</span><span class="s1">,</span><span class="s2">v</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">j</span><span class="s1">=</span><span class="s5">/(?!~)[\p{P}\p{S}]/u</span><span class="s1">;</span><span class="s4">const </span><span class="s2">O</span><span class="s1">=</span><span class="s5">/(?!~)[\s\p{P}\p{S}]/u</span><span class="s1">;</span><span class="s4">const </span><span class="s2">Q</span><span class="s1">=</span><span class="s5">/(?:[^\s\p{P}\p{S}]|~)/u</span><span class="s1">;</span><span class="s4">const </span><span class="s2">N</span><span class="s1">=</span><span class="s5">/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|&lt;[^&lt;&gt;]*?&gt;/g</span><span class="s1">;</span><span class="s4">const </span><span class="s2">G</span><span class="s1">=</span><span class="s5">/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">H</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s2">G</span><span class="s1">,</span><span class="s0">&quot;u&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/punct/g</span><span class="s1">,</span><span class="s2">Z</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">X</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s2">G</span><span class="s1">,</span><span class="s0">&quot;u&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/punct/g</span><span class="s1">,</span><span class="s2">j</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">F</span><span class="s1">=</span><span class="s0">&quot;^[^_*]*?__[^_*]*?</span><span class="s4">\\</span><span class="s0">*[^_*]*?(?=__)&quot;</span><span class="s1">+</span><span class="s0">&quot;|[^*]+(?=[^*])&quot;</span><span class="s1">+</span><span class="s0">&quot;|(?!</span><span class="s4">\\</span><span class="s0">*)punct(</span><span class="s4">\\</span><span class="s0">*+)(?=[</span><span class="s4">\\</span><span class="s0">s]|$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|notPunctSpace(</span><span class="s4">\\</span><span class="s0">*+)(?!</span><span class="s4">\\</span><span class="s0">*)(?=punctSpace|$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|(?!</span><span class="s4">\\</span><span class="s0">*)punctSpace(</span><span class="s4">\\</span><span class="s0">*+)(?=notPunctSpace)&quot;</span><span class="s1">+</span><span class="s0">&quot;|[</span><span class="s4">\\</span><span class="s0">s](</span><span class="s4">\\</span><span class="s0">*+)(?!</span><span class="s4">\\</span><span class="s0">*)(?=punct)&quot;</span><span class="s1">+</span><span class="s0">&quot;|(?!</span><span class="s4">\\</span><span class="s0">*)punct(</span><span class="s4">\\</span><span class="s0">*+)(?!</span><span class="s4">\\</span><span class="s0">*)(?=punct)&quot;</span><span class="s1">+</span><span class="s0">&quot;|notPunctSpace(</span><span class="s4">\\</span><span class="s0">*+)(?=notPunctSpace)&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">U</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s2">F</span><span class="s1">,</span><span class="s0">&quot;gu&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/notPunctSpace/g</span><span class="s1">,</span><span class="s2">D</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/punctSpace/g</span><span class="s1">,</span><span class="s2">v</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/punct/g</span><span class="s1">,</span><span class="s2">Z</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">J</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s2">F</span><span class="s1">,</span><span class="s0">&quot;gu&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/notPunctSpace/g</span><span class="s1">,</span><span class="s2">Q</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/punctSpace/g</span><span class="s1">,</span><span class="s2">O</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/punct/g</span><span class="s1">,</span><span class="s2">j</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">K</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s0">&quot;^[^_*]*?</span><span class="s4">\\</span><span class="s0">*</span><span class="s4">\\</span><span class="s0">*[^_*]*?_[^_*]*?(?=</span><span class="s4">\\</span><span class="s0">*</span><span class="s4">\\</span><span class="s0">*)&quot;</span><span class="s1">+</span><span class="s0">&quot;|[^_]+(?=[^_])&quot;</span><span class="s1">+</span><span class="s0">&quot;|(?!_)punct(_+)(?=[</span><span class="s4">\\</span><span class="s0">s]|$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|notPunctSpace(_+)(?!_)(?=punctSpace|$)&quot;</span><span class="s1">+</span><span class="s0">&quot;|(?!_)punctSpace(_+)(?=notPunctSpace)&quot;</span><span class="s1">+</span><span class="s0">&quot;|[</span><span class="s4">\\</span><span class="s0">s](_+)(?!_)(?=punct)&quot;</span><span class="s1">+</span><span class="s0">&quot;|(?!_)punct(_+)(?!_)(?=punct)&quot;</span><span class="s1">,</span><span class="s0">&quot;gu&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/notPunctSpace/g</span><span class="s1">,</span><span class="s2">D</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/punctSpace/g</span><span class="s1">,</span><span class="s2">v</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/punct/g</span><span class="s1">,</span><span class="s2">Z</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">V</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s5">/\\(punct)/</span><span class="s1">,</span><span class="s0">&quot;gu&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/punct/g</span><span class="s1">,</span><span class="s2">Z</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">W</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s5">/^&lt;(scheme:[^\s\x00-\x1f&lt;&gt;]*|email)&gt;/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;scheme&quot;</span><span class="s1">,</span><span class="s5">/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;email&quot;</span><span class="s1">,</span><span class="s5">/[a-zA-Z0-9.!#$%&amp;'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">Y</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s2">S</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;(?:--</span><span class="s4">\x3e</span><span class="s0">|$)&quot;</span><span class="s1">,</span><span class="s0">&quot;--</span><span class="s4">\x3e</span><span class="s0">&quot;</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">ee</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s0">&quot;^comment&quot;</span><span class="s1">+</span><span class="s0">&quot;|^&lt;/[a-zA-Z][</span><span class="s4">\\</span><span class="s0">w:-]*</span><span class="s4">\\</span><span class="s0">s*&gt;&quot;</span><span class="s1">+</span><span class="s0">&quot;|^&lt;[a-zA-Z][</span><span class="s4">\\</span><span class="s0">w-]*(?:attribute)*?</span><span class="s4">\\</span><span class="s0">s*/?&gt;&quot;</span><span class="s1">+</span><span class="s0">&quot;|^&lt;</span><span class="s4">\\</span><span class="s0">?[</span><span class="s4">\\</span><span class="s0">s</span><span class="s4">\\</span><span class="s0">S]*?</span><span class="s4">\\</span><span class="s0">?&gt;&quot;</span><span class="s1">+</span><span class="s0">&quot;|^&lt;![a-zA-Z]+</span><span class="s4">\\</span><span class="s0">s[</span><span class="s4">\\</span><span class="s0">s</span><span class="s4">\\</span><span class="s0">S]*?&gt;&quot;</span><span class="s1">+</span><span class="s0">&quot;|^&lt;!</span><span class="s4">\\</span><span class="s0">[CDATA</span><span class="s4">\\</span><span class="s0">[[</span><span class="s4">\\</span><span class="s0">s</span><span class="s4">\\</span><span class="s0">S]*?</span><span class="s4">\\</span><span class="s0">]</span><span class="s4">\\</span><span class="s0">]&gt;&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;comment&quot;</span><span class="s1">,</span><span class="s2">Y</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;attribute&quot;</span><span class="s1">,</span><span class="s5">/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*&quot;[^&quot;]*&quot;|\s*=\s*'[^']*'|\s*=\s*[^\s&quot;'=&lt;&gt;`]+)?/</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">te</span><span class="s1">=</span><span class="s5">/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">ne</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s5">/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;label&quot;</span><span class="s1">,</span><span class="s2">te</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;href&quot;</span><span class="s1">,</span><span class="s5">/&lt;(?:\\.|[^\n&lt;&gt;\\])+&gt;|[^\s\x00-\x1f]*/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;title&quot;</span><span class="s1">,</span><span class="s5">/&quot;(?:\\&quot;?|[^&quot;\\])*&quot;|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">se</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s5">/^!?\[(label)\]\[(ref)\]/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;label&quot;</span><span class="s1">,</span><span class="s2">te</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;ref&quot;</span><span class="s1">,</span><span class="s2">m</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">re</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s5">/^!?\[(ref)\](?:\[\])?/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;ref&quot;</span><span class="s1">,</span><span class="s2">m</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">ie</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s0">&quot;reflink|nolink(?!</span><span class="s4">\\</span><span class="s0">()&quot;</span><span class="s1">,</span><span class="s0">&quot;g&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;reflink&quot;</span><span class="s1">,</span><span class="s2">se</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;nolink&quot;</span><span class="s1">,</span><span class="s2">re</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">();</span><span class="s4">const </span><span class="s2">le</span><span class="s1">={</span><span class="s2">_backpedal</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">anyPunctuation</span><span class="s1">:</span><span class="s2">V</span><span class="s1">,</span><span class="s2">autolink</span><span class="s1">:</span><span class="s2">W</span><span class="s1">,</span><span class="s2">blockSkip</span><span class="s1">:</span><span class="s2">N</span><span class="s1">,</span><span class="s2">br</span><span class="s1">:</span><span class="s2">q</span><span class="s1">,</span><span class="s2">code</span><span class="s1">:</span><span class="s2">B</span><span class="s1">,</span><span class="s2">del</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">emStrongLDelim</span><span class="s1">:</span><span class="s2">H</span><span class="s1">,</span><span class="s2">emStrongRDelimAst</span><span class="s1">:</span><span class="s2">U</span><span class="s1">,</span><span class="s2">emStrongRDelimUnd</span><span class="s1">:</span><span class="s2">K</span><span class="s1">,</span><span class="s2">escape</span><span class="s1">:</span><span class="s2">C</span><span class="s1">,</span><span class="s2">link</span><span class="s1">:</span><span class="s2">ne</span><span class="s1">,</span><span class="s2">nolink</span><span class="s1">:</span><span class="s2">re</span><span class="s1">,</span><span class="s2">punctuation</span><span class="s1">:</span><span class="s2">M</span><span class="s1">,</span><span class="s2">reflink</span><span class="s1">:</span><span class="s2">se</span><span class="s1">,</span><span class="s2">reflinkSearch</span><span class="s1">:</span><span class="s2">ie</span><span class="s1">,</span><span class="s2">tag</span><span class="s1">:</span><span class="s2">ee</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">E</span><span class="s1">,</span><span class="s2">url</span><span class="s1">:</span><span class="s2">l</span><span class="s1">};</span><span class="s4">const </span><span class="s2">oe</span><span class="s1">={</span><span class="s2">...le</span><span class="s1">,</span><span class="s2">link</span><span class="s1">:</span><span class="s2">o</span><span class="s1">(</span><span class="s5">/^!?\[(label)\]\((.*?)\)/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;label&quot;</span><span class="s1">,</span><span class="s2">te</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">(),</span><span class="s2">reflink</span><span class="s1">:</span><span class="s2">o</span><span class="s1">(</span><span class="s5">/^!?\[(label)\]\s*\[([^\]]*)\]/</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;label&quot;</span><span class="s1">,</span><span class="s2">te</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">()};</span><span class="s4">const </span><span class="s2">ae</span><span class="s1">={</span><span class="s2">...le</span><span class="s1">,</span><span class="s2">emStrongRDelimAst</span><span class="s1">:</span><span class="s2">J</span><span class="s1">,</span><span class="s2">emStrongLDelim</span><span class="s1">:</span><span class="s2">X</span><span class="s1">,</span><span class="s2">url</span><span class="s1">:</span><span class="s2">o</span><span class="s1">(</span><span class="s5">/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s&lt;]*|^email/</span><span class="s1">,</span><span class="s0">&quot;i&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;email&quot;</span><span class="s1">,</span><span class="s5">/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">(),</span><span class="s2">_backpedal</span><span class="s1">:</span><span class="s5">/(?:[^?!.,:;*_'&quot;~()&amp;]+|\([^)]*\)|&amp;(?![a-zA-Z0-9]+;$)|[?!.,:;*_'&quot;~)]+(?!$))+/</span><span class="s1">,</span><span class="s2">del</span><span class="s1">:</span><span class="s5">/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s5">/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&amp;'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\&lt;!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&amp;'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&amp;'*+\/=?_`{\|}~-]+@)))/</span><span class="s1">};</span><span class="s4">const </span><span class="s2">ce</span><span class="s1">={</span><span class="s2">...ae</span><span class="s1">,</span><span class="s2">br</span><span class="s1">:</span><span class="s2">o</span><span class="s1">(</span><span class="s2">q</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;{2,}&quot;</span><span class="s1">,</span><span class="s0">&quot;*&quot;</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">(),</span><span class="s2">text</span><span class="s1">:</span><span class="s2">o</span><span class="s1">(</span><span class="s2">ae</span><span class="s1">.</span><span class="s2">text</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\\</span><span class="s0">b_&quot;</span><span class="s1">,</span><span class="s0">&quot;</span><span class="s4">\\</span><span class="s0">b_| {2,}</span><span class="s4">\\</span><span class="s0">n&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s5">/\{2,\}/g</span><span class="s1">,</span><span class="s0">&quot;*&quot;</span><span class="s1">).</span><span class="s2">getRegex</span><span class="s1">()};</span><span class="s4">const </span><span class="s2">he</span><span class="s1">={</span><span class="s2">normal</span><span class="s1">:</span><span class="s2">_</span><span class="s1">,</span><span class="s2">gfm</span><span class="s1">:</span><span class="s2">P</span><span class="s1">,</span><span class="s2">pedantic</span><span class="s1">:</span><span class="s2">L</span><span class="s1">};</span><span class="s4">const </span><span class="s2">pe</span><span class="s1">={</span><span class="s2">normal</span><span class="s1">:</span><span class="s2">le</span><span class="s1">,</span><span class="s2">gfm</span><span class="s1">:</span><span class="s2">ae</span><span class="s1">,</span><span class="s2">breaks</span><span class="s1">:</span><span class="s2">ce</span><span class="s1">,</span><span class="s2">pedantic</span><span class="s1">:</span><span class="s2">oe</span><span class="s1">};</span><span class="s4">const </span><span class="s2">ue</span><span class="s1">={</span><span class="s0">&quot;&amp;&quot;</span><span class="s1">:</span><span class="s0">&quot;&amp;amp;&quot;</span><span class="s1">,</span><span class="s0">&quot;&lt;&quot;</span><span class="s1">:</span><span class="s0">&quot;&amp;lt;&quot;</span><span class="s1">,</span><span class="s0">&quot;&gt;&quot;</span><span class="s1">:</span><span class="s0">&quot;&amp;gt;&quot;</span><span class="s1">,</span><span class="s0">'&quot;'</span><span class="s1">:</span><span class="s0">&quot;&amp;quot;&quot;</span><span class="s1">,</span><span class="s0">&quot;'&quot;</span><span class="s1">:</span><span class="s0">&quot;&amp;#39;&quot;</span><span class="s1">};</span><span class="s4">const </span><span class="s2">fe</span><span class="s1">=</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">ue</span><span class="s1">[</span><span class="s2">e</span><span class="s1">];</span><span class="s4">function </span><span class="s2">ge</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">escapeTest</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">escapeReplace</span><span class="s1">,</span><span class="s2">fe</span><span class="s1">)}}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">escapeTestNoEncode</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">escapeReplaceNoEncode</span><span class="s1">,</span><span class="s2">fe</span><span class="s1">)}}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s4">function </span><span class="s2">ke</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">try</span><span class="s1">{</span><span class="s2">e</span><span class="s1">=</span><span class="s2">encodeURI</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">percentDecode</span><span class="s1">,</span><span class="s0">&quot;%&quot;</span><span class="s1">)}</span><span class="s4">catch</span><span class="s1">{</span><span class="s4">return null</span><span class="s1">}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s4">function </span><span class="s2">de</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">findPipe</span><span class="s1">,((</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)=&gt;{</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">while</span><span class="s1">(--</span><span class="s2">r</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">n</span><span class="s1">[</span><span class="s2">r</span><span class="s1">]===</span><span class="s0">&quot;</span><span class="s4">\\</span><span class="s0">&quot;</span><span class="s1">)</span><span class="s2">s</span><span class="s1">=!</span><span class="s2">s</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;|&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">return</span><span class="s0">&quot; |&quot;</span><span class="s1">}})),</span><span class="s2">s</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">split</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">splitPipe</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">s</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">()){</span><span class="s2">s</span><span class="s1">.</span><span class="s2">shift</span><span class="s1">()}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;!</span><span class="s2">s</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">)?.</span><span class="s2">trim</span><span class="s1">()){</span><span class="s2">s</span><span class="s1">.</span><span class="s2">pop</span><span class="s1">()}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s2">t</span><span class="s1">){</span><span class="s2">s</span><span class="s1">.</span><span class="s2">splice</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">while</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&lt;</span><span class="s2">t</span><span class="s1">)</span><span class="s2">s</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">&quot;&quot;</span><span class="s1">)}}</span><span class="s4">for</span><span class="s1">(;</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">r</span><span class="s1">++){</span><span class="s2">s</span><span class="s1">[</span><span class="s2">r</span><span class="s1">]=</span><span class="s2">s</span><span class="s1">[</span><span class="s2">r</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">().</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">slashPipe</span><span class="s1">,</span><span class="s0">&quot;|&quot;</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">s</span><span class="s1">}</span><span class="s4">function </span><span class="s2">xe</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">n</span><span class="s1">){</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">while</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">s</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">charAt</span><span class="s1">(</span><span class="s2">s</span><span class="s1">-</span><span class="s2">r</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s2">t</span><span class="s1">&amp;&amp;</span><span class="s4">true</span><span class="s1">){</span><span class="s2">r</span><span class="s1">++}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">break</span><span class="s1">}}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">s</span><span class="s1">-</span><span class="s2">r</span><span class="s1">)}</span><span class="s4">function </span><span class="s2">be</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">])===-</span><span class="s3">1</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">s</span><span class="s1">++){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">[</span><span class="s2">s</span><span class="s1">]===</span><span class="s0">&quot;</span><span class="s4">\\</span><span class="s0">&quot;</span><span class="s1">){</span><span class="s2">s</span><span class="s1">++}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">[</span><span class="s2">s</span><span class="s1">]===</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]){</span><span class="s2">n</span><span class="s1">++}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">[</span><span class="s2">s</span><span class="s1">]===</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">]){</span><span class="s2">n</span><span class="s1">--;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return </span><span class="s2">s</span><span class="s1">}}}</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">function </span><span class="s2">we</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">r</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">href</span><span class="s1">;</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">title</span><span class="s1">||</span><span class="s4">null</span><span class="s1">;</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">[</span><span class="s3">1</span><span class="s1">].</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">outputLinkReplace</span><span class="s1">,</span><span class="s0">&quot;$1&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">charAt</span><span class="s1">(</span><span class="s3">0</span><span class="s1">)!==</span><span class="s0">&quot;!&quot;</span><span class="s1">){</span><span class="s2">s</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inLink</span><span class="s1">=</span><span class="s4">true</span><span class="s1">;</span><span class="s4">const </span><span class="s2">e</span><span class="s1">={</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;link&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">href</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">title</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:</span><span class="s2">s</span><span class="s1">.</span><span class="s2">inlineTokens</span><span class="s1">(</span><span class="s2">o</span><span class="s1">)};</span><span class="s2">s</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inLink</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;image&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">href</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">title</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">o</span><span class="s1">}}</span><span class="s4">function </span><span class="s2">me</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">n</span><span class="s1">){</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">indentCodeCompensation</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">===</span><span class="s4">null</span><span class="s1">){</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">[</span><span class="s3">1</span><span class="s1">];</span><span class="s4">return </span><span class="s2">t</span><span class="s1">.</span><span class="s2">split</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">).</span><span class="s2">map</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">beginningSpace</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s4">null</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s4">const</span><span class="s1">[</span><span class="s2">s</span><span class="s1">]=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">length</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">length</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">})).</span><span class="s2">join</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">)}</span><span class="s4">class </span><span class="s2">ye</span><span class="s1">{</span><span class="s2">options</span><span class="s1">;</span><span class="s2">rules</span><span class="s1">;</span><span class="s2">lexer</span><span class="s1">;</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">=</span><span class="s2">e</span><span class="s1">||</span><span class="s2">r</span><span class="s1">}</span><span class="s2">space</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">newline</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;space&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]}}}</span><span class="s2">code</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">code</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">codeRemoveIndent</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;code&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">codeBlockStyle</span><span class="s1">:</span><span class="s0">&quot;indented&quot;</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">pedantic</span><span class="s1">?</span><span class="s2">xe</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">):</span><span class="s2">e</span><span class="s1">}}}</span><span class="s2">fences</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">fences</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">];</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">me</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">[</span><span class="s3">3</span><span class="s1">]||</span><span class="s0">&quot;&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">);</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;code&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">lang</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">]?</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">().</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">anyPunctuation</span><span class="s1">,</span><span class="s0">&quot;$1&quot;</span><span class="s1">):</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">],</span><span class="s2">text</span><span class="s1">:</span><span class="s2">n</span><span class="s1">}}}</span><span class="s2">heading</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">heading</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">endingHash</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">xe</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s0">&quot;#&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">pedantic</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()}</span><span class="s4">else if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">endingSpaceChar</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()}}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;heading&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">depth</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">].</span><span class="s2">length</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}}}</span><span class="s2">hr</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">hr</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;hr&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">xe</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">)}}}</span><span class="s2">blockquote</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">blockquote</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">xe</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">).</span><span class="s2">split</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">);</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=[];</span><span class="s4">while</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=[];</span><span class="s4">let </span><span class="s2">l</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s2">l</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">l</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">l</span><span class="s1">++){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">blockquoteStart</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">e</span><span class="s1">[</span><span class="s2">l</span><span class="s1">])){</span><span class="s2">i</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">e</span><span class="s1">[</span><span class="s2">l</span><span class="s1">]);</span><span class="s2">t</span><span class="s1">=</span><span class="s4">true</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s2">i</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">e</span><span class="s1">[</span><span class="s2">l</span><span class="s1">])}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">l</span><span class="s1">);</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">a</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">blockquoteSetextReplace</span><span class="s1">,</span><span class="s0">&quot;</span><span class="s4">\n    </span><span class="s0">$1&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">blockquoteSetextReplace2</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">);</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">?</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">n</span><span class="s1">}</span><span class="s4">\n</span><span class="s2">$</span><span class="s1">{</span><span class="s2">o</span><span class="s1">}</span><span class="s0">`</span><span class="s1">:</span><span class="s2">o</span><span class="s1">;</span><span class="s2">s</span><span class="s1">=</span><span class="s2">s</span><span class="s1">?</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">s</span><span class="s1">}</span><span class="s4">\n</span><span class="s2">$</span><span class="s1">{</span><span class="s2">a</span><span class="s1">}</span><span class="s0">`</span><span class="s1">:</span><span class="s2">a</span><span class="s1">;</span><span class="s4">const </span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">top</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s4">true</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">blockTokens</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s4">true</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">break</span><span class="s1">}</span><span class="s4">const </span><span class="s2">h</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">?.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;code&quot;</span><span class="s1">){</span><span class="s4">break</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">?.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;blockquote&quot;</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">+</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">blockquote</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s2">r</span><span class="s1">[</span><span class="s2">r</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">]=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s2">t</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">)+</span><span class="s2">l</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">;</span><span class="s2">s</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">s</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s2">t</span><span class="s1">.</span><span class="s2">text</span><span class="s1">.</span><span class="s2">length</span><span class="s1">)+</span><span class="s2">l</span><span class="s1">.</span><span class="s2">text</span><span class="s1">;</span><span class="s4">break</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">?.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;list&quot;</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">+</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">list</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s2">r</span><span class="s1">[</span><span class="s2">r</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">]=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s2">h</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">)+</span><span class="s2">l</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">;</span><span class="s2">s</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">s</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s2">t</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">)+</span><span class="s2">l</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">;</span><span class="s2">e</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">).</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">).</span><span class="s2">split</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;blockquote&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}}}</span><span class="s2">list</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">list</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">();</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">1</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">={</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;list&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s0">&quot;&quot;</span><span class="s1">,</span><span class="s2">ordered</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">start</span><span class="s1">:</span><span class="s2">s</span><span class="s1">?+</span><span class="s2">n</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,-</span><span class="s3">1</span><span class="s1">):</span><span class="s0">&quot;&quot;</span><span class="s1">,</span><span class="s2">loose</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">items</span><span class="s1">:[]};</span><span class="s2">n</span><span class="s1">=</span><span class="s2">s</span><span class="s1">?</span><span class="s0">`</span><span class="s4">\\</span><span class="s0">d{1,9}</span><span class="s4">\\</span><span class="s2">$</span><span class="s1">{</span><span class="s2">n</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">:</span><span class="s0">`</span><span class="s4">\\</span><span class="s2">$</span><span class="s1">{</span><span class="s2">n</span><span class="s1">}</span><span class="s0">`</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">pedantic</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">s</span><span class="s1">?</span><span class="s2">n</span><span class="s1">:</span><span class="s0">&quot;[*+-]&quot;</span><span class="s1">}</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">listItemRegex</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">while</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!(</span><span class="s2">t</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">))){</span><span class="s4">break</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">hr</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">break</span><span class="s1">}</span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">];</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">].</span><span class="s2">split</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">,</span><span class="s3">1</span><span class="s1">)[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">listReplaceTabs</span><span class="s1">,(</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s0">&quot; &quot;</span><span class="s1">.</span><span class="s2">repeat</span><span class="s1">(</span><span class="s3">3</span><span class="s1">*</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">)));</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">split</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">,</span><span class="s3">1</span><span class="s1">)[</span><span class="s3">0</span><span class="s1">];</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=!</span><span class="s2">a</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">();</span><span class="s4">let </span><span class="s2">p</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">pedantic</span><span class="s1">){</span><span class="s2">p</span><span class="s1">=</span><span class="s3">2</span><span class="s1">;</span><span class="s2">o</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">trimStart</span><span class="s1">()}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">){</span><span class="s2">p</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">].</span><span class="s2">length</span><span class="s1">+</span><span class="s3">1</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">p</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">].</span><span class="s2">search</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">nonSpaceChar</span><span class="s1">);</span><span class="s2">p</span><span class="s1">=</span><span class="s2">p</span><span class="s1">&gt;</span><span class="s3">4</span><span class="s1">?</span><span class="s3">1</span><span class="s1">:</span><span class="s2">p</span><span class="s1">;</span><span class="s2">o</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">p</span><span class="s1">);</span><span class="s2">p</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">].</span><span class="s2">length</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">blankLine</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">c</span><span class="s1">)){</span><span class="s2">s</span><span class="s1">+=</span><span class="s2">c</span><span class="s1">+</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">;</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">c</span><span class="s1">.</span><span class="s2">length</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s2">n</span><span class="s1">=</span><span class="s4">true</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">n</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">nextBulletRegex</span><span class="s1">(</span><span class="s2">p</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">hrRegex</span><span class="s1">(</span><span class="s2">p</span><span class="s1">);</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">fencesBeginRegex</span><span class="s1">(</span><span class="s2">p</span><span class="s1">);</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">headingBeginRegex</span><span class="s1">(</span><span class="s2">p</span><span class="s1">);</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">htmlBeginRegex</span><span class="s1">(</span><span class="s2">p</span><span class="s1">);</span><span class="s4">while</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">u</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">split</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">,</span><span class="s3">1</span><span class="s1">)[</span><span class="s3">0</span><span class="s1">];</span><span class="s4">let </span><span class="s2">f</span><span class="s1">;</span><span class="s2">c</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">pedantic</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">c</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">listReplaceNesting</span><span class="s1">,</span><span class="s0">&quot;  &quot;</span><span class="s1">);</span><span class="s2">f</span><span class="s1">=</span><span class="s2">c</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">f</span><span class="s1">=</span><span class="s2">c</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">tabCharGlobal</span><span class="s1">,</span><span class="s0">&quot;    &quot;</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">c</span><span class="s1">)){</span><span class="s4">break</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">c</span><span class="s1">)){</span><span class="s4">break</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">c</span><span class="s1">)){</span><span class="s4">break</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">c</span><span class="s1">)){</span><span class="s4">break</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">c</span><span class="s1">)){</span><span class="s4">break</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">f</span><span class="s1">.</span><span class="s2">search</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">nonSpaceChar</span><span class="s1">)&gt;=</span><span class="s2">p</span><span class="s1">||!</span><span class="s2">c</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()){</span><span class="s2">o</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">f</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">p</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">){</span><span class="s4">break</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">tabCharGlobal</span><span class="s1">,</span><span class="s0">&quot;    &quot;</span><span class="s1">).</span><span class="s2">search</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">nonSpaceChar</span><span class="s1">)&gt;=</span><span class="s3">4</span><span class="s1">){</span><span class="s4">break</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">a</span><span class="s1">)){</span><span class="s4">break</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">a</span><span class="s1">)){</span><span class="s4">break</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">a</span><span class="s1">)){</span><span class="s4">break</span><span class="s1">}</span><span class="s2">o</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">c</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">h</span><span class="s1">&amp;&amp;!</span><span class="s2">c</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()){</span><span class="s2">h</span><span class="s1">=</span><span class="s4">true</span><span class="s1">}</span><span class="s2">s</span><span class="s1">+=</span><span class="s2">u</span><span class="s1">+</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">;</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">u</span><span class="s1">.</span><span class="s2">length</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s2">a</span><span class="s1">=</span><span class="s2">f</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">p</span><span class="s1">)}}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">r</span><span class="s1">.</span><span class="s2">loose</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">){</span><span class="s2">r</span><span class="s1">.</span><span class="s2">loose</span><span class="s1">=</span><span class="s4">true</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">doubleBlankLine</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)){</span><span class="s2">l</span><span class="s1">=</span><span class="s4">true</span><span class="s1">}}</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">gfm</span><span class="s1">){</span><span class="s2">u</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">listIsTask</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">o</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">u</span><span class="s1">){</span><span class="s2">f</span><span class="s1">=</span><span class="s2">u</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]!==</span><span class="s0">&quot;[ ] &quot;</span><span class="s1">;</span><span class="s2">o</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">listReplaceTask</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">)}}</span><span class="s2">r</span><span class="s1">.</span><span class="s2">items</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;list_item&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">task</span><span class="s1">:!!</span><span class="s2">u</span><span class="s1">,</span><span class="s2">checked</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">loose</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:[]});</span><span class="s2">r</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">+=</span><span class="s2">s</span><span class="s1">}</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">items</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">){</span><span class="s2">o</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">trimEnd</span><span class="s1">();</span><span class="s2">o</span><span class="s1">.</span><span class="s2">text</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">text</span><span class="s1">.</span><span class="s2">trimEnd</span><span class="s1">()}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">return</span><span class="s1">}</span><span class="s2">r</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">trimEnd</span><span class="s1">();</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s2">r</span><span class="s1">.</span><span class="s2">items</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">e</span><span class="s1">++){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s2">r</span><span class="s1">.</span><span class="s2">items</span><span class="s1">[</span><span class="s2">e</span><span class="s1">].</span><span class="s2">tokens</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">blockTokens</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">items</span><span class="s1">[</span><span class="s2">e</span><span class="s1">].</span><span class="s2">text</span><span class="s1">,[]);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">r</span><span class="s1">.</span><span class="s2">loose</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">items</span><span class="s1">[</span><span class="s2">e</span><span class="s1">].</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;space&quot;</span><span class="s1">));</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">some</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">anyLine</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">)));</span><span class="s2">r</span><span class="s1">.</span><span class="s2">loose</span><span class="s1">=</span><span class="s2">n</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">loose</span><span class="s1">){</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s2">r</span><span class="s1">.</span><span class="s2">items</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">e</span><span class="s1">++){</span><span class="s2">r</span><span class="s1">.</span><span class="s2">items</span><span class="s1">[</span><span class="s2">e</span><span class="s1">].</span><span class="s2">loose</span><span class="s1">=</span><span class="s4">true</span><span class="s1">}}</span><span class="s4">return </span><span class="s2">r</span><span class="s1">}}</span><span class="s2">html</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">html</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">={</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;html&quot;</span><span class="s1">,</span><span class="s2">block</span><span class="s1">:</span><span class="s4">true</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">pre</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">]===</span><span class="s0">&quot;pre&quot;</span><span class="s1">||</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">]===</span><span class="s0">&quot;script&quot;</span><span class="s1">||</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">]===</span><span class="s0">&quot;style&quot;</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]};</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}}</span><span class="s2">def</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">def</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">].</span><span class="s2">toLowerCase</span><span class="s1">().</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">multipleSpaceGlobal</span><span class="s1">,</span><span class="s0">&quot; &quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">]?</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">].</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">hrefBrackets</span><span class="s1">,</span><span class="s0">&quot;$1&quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">anyPunctuation</span><span class="s1">,</span><span class="s0">&quot;$1&quot;</span><span class="s1">):</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">3</span><span class="s1">]?</span><span class="s2">t</span><span class="s1">[</span><span class="s3">3</span><span class="s1">].</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,</span><span class="s2">t</span><span class="s1">[</span><span class="s3">3</span><span class="s1">].</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">anyPunctuation</span><span class="s1">,</span><span class="s0">&quot;$1&quot;</span><span class="s1">):</span><span class="s2">t</span><span class="s1">[</span><span class="s3">3</span><span class="s1">];</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;def&quot;</span><span class="s1">,</span><span class="s2">tag</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">href</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">title</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}}}</span><span class="s2">table</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">table</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">tableDelimiter</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">])){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">de</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">]);</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">].</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">tableAlignChars</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">).</span><span class="s2">split</span><span class="s1">(</span><span class="s0">&quot;|&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">3</span><span class="s1">]?.</span><span class="s2">trim</span><span class="s1">()?</span><span class="s2">t</span><span class="s1">[</span><span class="s3">3</span><span class="s1">].</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">tableRowBlankLine</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">).</span><span class="s2">split</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">):[];</span><span class="s4">const </span><span class="s2">i</span><span class="s1">={</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;table&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">header</span><span class="s1">:[],</span><span class="s2">align</span><span class="s1">:[],</span><span class="s2">rows</span><span class="s1">:[]};</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">length</span><span class="s1">!==</span><span class="s2">s</span><span class="s1">.</span><span class="s2">length</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">l of s</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">tableAlignRight</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">l</span><span class="s1">)){</span><span class="s2">i</span><span class="s1">.</span><span class="s2">align</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">&quot;right&quot;</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">tableAlignCenter</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">l</span><span class="s1">)){</span><span class="s2">i</span><span class="s1">.</span><span class="s2">align</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">&quot;center&quot;</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">tableAlignLeft</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">l</span><span class="s1">)){</span><span class="s2">i</span><span class="s1">.</span><span class="s2">align</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">&quot;left&quot;</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">i</span><span class="s1">.</span><span class="s2">align</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s4">null</span><span class="s1">)}}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">l</span><span class="s1">&lt;</span><span class="s2">n</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">l</span><span class="s1">++){</span><span class="s2">i</span><span class="s1">.</span><span class="s2">header</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">n</span><span class="s1">[</span><span class="s2">l</span><span class="s1">],</span><span class="s2">tokens</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">(</span><span class="s2">n</span><span class="s1">[</span><span class="s2">l</span><span class="s1">]),</span><span class="s2">header</span><span class="s1">:</span><span class="s4">true</span><span class="s1">,</span><span class="s2">align</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">align</span><span class="s1">[</span><span class="s2">l</span><span class="s1">]})}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">l of r</span><span class="s1">){</span><span class="s2">i</span><span class="s1">.</span><span class="s2">rows</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">de</span><span class="s1">(</span><span class="s2">l</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">header</span><span class="s1">.</span><span class="s2">length</span><span class="s1">).</span><span class="s2">map</span><span class="s1">(((</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)=&gt;({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">),</span><span class="s2">header</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">align</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">align</span><span class="s1">[</span><span class="s2">t</span><span class="s1">]}))))}</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s2">lheading</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">lheading</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;heading&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">depth</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">].</span><span class="s2">charAt</span><span class="s1">(</span><span class="s3">0</span><span class="s1">)===</span><span class="s0">&quot;=&quot;</span><span class="s1">?</span><span class="s3">1</span><span class="s1">:</span><span class="s3">2</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">],</span><span class="s2">tokens</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">])}}}</span><span class="s2">paragraph</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">paragraph</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">].</span><span class="s2">charAt</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">].</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">)===</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">?</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">].</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,-</span><span class="s3">1</span><span class="s1">):</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">];</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;paragraph&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}}}</span><span class="s2">text</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">block</span><span class="s1">.</span><span class="s2">text</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;text&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">text</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">tokens</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">])}}}</span><span class="s2">escape</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">escape</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;escape&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">text</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">]}}}</span><span class="s2">tag</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inLink</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">startATag</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">])){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inLink</span><span class="s1">=</span><span class="s4">true</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inLink</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">endATag</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">])){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inLink</span><span class="s1">=</span><span class="s4">false</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inRawBlock</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">startPreScriptTag</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">])){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inRawBlock</span><span class="s1">=</span><span class="s4">true</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inRawBlock</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">endPreScriptTag</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">])){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inRawBlock</span><span class="s1">=</span><span class="s4">false</span><span class="s1">}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;html&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">inLink</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inLink</span><span class="s1">,</span><span class="s2">inRawBlock</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inRawBlock</span><span class="s1">,</span><span class="s2">block</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]}}}</span><span class="s2">link</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">link</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">pedantic</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">startAngleBracket</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">endAngleBracket</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">xe</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,-</span><span class="s3">1</span><span class="s1">),</span><span class="s0">&quot;</span><span class="s4">\\</span><span class="s0">&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">((</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s2">t</span><span class="s1">.</span><span class="s2">length</span><span class="s1">)%</span><span class="s3">2</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">be</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">],</span><span class="s0">&quot;()&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&gt;-</span><span class="s3">1</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">&quot;!&quot;</span><span class="s1">)===</span><span class="s3">0</span><span class="s1">?</span><span class="s3">5</span><span class="s1">:</span><span class="s3">4</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">n</span><span class="s1">+</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">].</span><span class="s2">length</span><span class="s1">+</span><span class="s2">e</span><span class="s1">;</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">]=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">].</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">s</span><span class="s1">).</span><span class="s2">trim</span><span class="s1">();</span><span class="s2">t</span><span class="s1">[</span><span class="s3">3</span><span class="s1">]=</span><span class="s0">&quot;&quot;</span><span class="s1">}}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">];</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">pedantic</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">pedanticHrefTitle</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">[</span><span class="s3">1</span><span class="s1">];</span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">[</span><span class="s3">3</span><span class="s1">]}}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">3</span><span class="s1">]?</span><span class="s2">t</span><span class="s1">[</span><span class="s3">3</span><span class="s1">].</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,-</span><span class="s3">1</span><span class="s1">):</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">startAngleBracket</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">pedantic</span><span class="s1">&amp;&amp;!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">endAngleBracket</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">1</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,-</span><span class="s3">1</span><span class="s1">)}}</span><span class="s4">return </span><span class="s2">we</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,{</span><span class="s2">href</span><span class="s1">:</span><span class="s2">n</span><span class="s1">?</span><span class="s2">n</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">anyPunctuation</span><span class="s1">,</span><span class="s0">&quot;$1&quot;</span><span class="s1">):</span><span class="s2">n</span><span class="s1">,</span><span class="s2">title</span><span class="s1">:</span><span class="s2">s</span><span class="s1">?</span><span class="s2">s</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">anyPunctuation</span><span class="s1">,</span><span class="s0">&quot;$1&quot;</span><span class="s1">):</span><span class="s2">s</span><span class="s1">},</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">)}}</span><span class="s2">reflink</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">n</span><span class="s1">;</span><span class="s4">if</span><span class="s1">((</span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">reflink</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">))||(</span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">nolink</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">))){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=(</span><span class="s2">n</span><span class="s1">[</span><span class="s3">2</span><span class="s1">]||</span><span class="s2">n</span><span class="s1">[</span><span class="s3">1</span><span class="s1">]).</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">multipleSpaceGlobal</span><span class="s1">,</span><span class="s0">&quot; &quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">toLowerCase</span><span class="s1">()];</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">s</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">n</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">charAt</span><span class="s1">(</span><span class="s3">0</span><span class="s1">);</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;text&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}}</span><span class="s4">return </span><span class="s2">we</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">n</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">)}}</span><span class="s2">emStrong</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">n</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">emStrongLDelim</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">s</span><span class="s1">)</span><span class="s4">return</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">[</span><span class="s3">3</span><span class="s1">]&amp;&amp;</span><span class="s2">n</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">unicodeAlphaNumeric</span><span class="s1">))</span><span class="s4">return</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">[</span><span class="s3">1</span><span class="s1">]||</span><span class="s2">s</span><span class="s1">[</span><span class="s3">2</span><span class="s1">]||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">r</span><span class="s1">||!</span><span class="s2">n</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">punctuation</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=[</span><span class="s2">...s</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]].</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">l</span><span class="s1">=</span><span class="s2">n</span><span class="s1">,</span><span class="s2">o</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">const </span><span class="s2">a</span><span class="s1">=</span><span class="s2">s</span><span class="s1">[</span><span class="s3">0</span><span class="s1">][</span><span class="s3">0</span><span class="s1">]===</span><span class="s0">&quot;*&quot;</span><span class="s1">?</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">emStrongRDelimAst</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">emStrongRDelimUnd</span><span class="s1">;</span><span class="s2">a</span><span class="s1">.</span><span class="s2">lastIndex</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">t</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">*</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">+</span><span class="s2">n</span><span class="s1">);</span><span class="s4">while</span><span class="s1">((</span><span class="s2">s</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">t</span><span class="s1">))!=</span><span class="s4">null</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">[</span><span class="s3">1</span><span class="s1">]||</span><span class="s2">s</span><span class="s1">[</span><span class="s3">2</span><span class="s1">]||</span><span class="s2">s</span><span class="s1">[</span><span class="s3">3</span><span class="s1">]||</span><span class="s2">s</span><span class="s1">[</span><span class="s3">4</span><span class="s1">]||</span><span class="s2">s</span><span class="s1">[</span><span class="s3">5</span><span class="s1">]||</span><span class="s2">s</span><span class="s1">[</span><span class="s3">6</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">r</span><span class="s1">)</span><span class="s4">continue</span><span class="s1">;</span><span class="s2">i</span><span class="s1">=[</span><span class="s2">...r</span><span class="s1">].</span><span class="s2">length</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">[</span><span class="s3">3</span><span class="s1">]||</span><span class="s2">s</span><span class="s1">[</span><span class="s3">4</span><span class="s1">]){</span><span class="s2">l</span><span class="s1">+=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">[</span><span class="s3">5</span><span class="s1">]||</span><span class="s2">s</span><span class="s1">[</span><span class="s3">6</span><span class="s1">]){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">%</span><span class="s3">3</span><span class="s1">&amp;&amp;!((</span><span class="s2">n</span><span class="s1">+</span><span class="s2">i</span><span class="s1">)%</span><span class="s3">3</span><span class="s1">)){</span><span class="s2">o</span><span class="s1">+=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">continue</span><span class="s1">}}</span><span class="s2">l</span><span class="s1">-=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">)</span><span class="s4">continue</span><span class="s1">;</span><span class="s2">i</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">i</span><span class="s1">+</span><span class="s2">l</span><span class="s1">+</span><span class="s2">o</span><span class="s1">);</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=[</span><span class="s2">...s</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]][</span><span class="s3">0</span><span class="s1">].</span><span class="s2">length</span><span class="s1">;</span><span class="s4">const </span><span class="s2">a</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">+</span><span class="s2">s</span><span class="s1">.</span><span class="s2">index</span><span class="s1">+</span><span class="s2">t</span><span class="s1">+</span><span class="s2">i</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)%</span><span class="s3">2</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;em&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">inlineTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}}</span><span class="s4">const </span><span class="s2">c</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">2</span><span class="s1">,-</span><span class="s3">2</span><span class="s1">);</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;strong&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">inlineTokens</span><span class="s1">(</span><span class="s2">c</span><span class="s1">)}}}}</span><span class="s2">codespan</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">code</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">].</span><span class="s2">replace</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">newLineCharGlobal</span><span class="s1">,</span><span class="s0">&quot; &quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">nonSpaceChar</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">startingSpaceChar</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">other</span><span class="s1">.</span><span class="s2">endingSpaceChar</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">)}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;codespan&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}}}</span><span class="s2">br</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">br</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;br&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]}}}</span><span class="s2">del</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">del</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;del&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">text</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">],</span><span class="s2">tokens</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">inlineTokens</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">])}}}</span><span class="s2">autolink</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">autolink</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">]===</span><span class="s0">&quot;@&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">];</span><span class="s2">n</span><span class="s1">=</span><span class="s0">&quot;mailto:&quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">];</span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;link&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">href</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:[{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;text&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}]}}}</span><span class="s2">url</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">url</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">2</span><span class="s1">]===</span><span class="s0">&quot;@&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">];</span><span class="s2">n</span><span class="s1">=</span><span class="s0">&quot;mailto:&quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">let </span><span class="s2">s</span><span class="s1">;</span><span class="s4">do</span><span class="s1">{</span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">];</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">_backpedal</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">])?.[</span><span class="s3">0</span><span class="s1">]??</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s4">while</span><span class="s1">(</span><span class="s2">s</span><span class="s1">!==</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]);</span><span class="s2">e</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s3">1</span><span class="s1">]===</span><span class="s0">&quot;www.&quot;</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s0">&quot;http://&quot;</span><span class="s1">+</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]}}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;link&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">href</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:[{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;text&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}]}}}</span><span class="s2">inlineText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">text</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inRawBlock</span><span class="s1">;</span><span class="s4">return</span><span class="s1">{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;text&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">text</span><span class="s1">:</span><span class="s2">t</span><span class="s1">[</span><span class="s3">0</span><span class="s1">],</span><span class="s2">escaped</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}}}}</span><span class="s4">class </span><span class="s2">$e</span><span class="s1">{</span><span class="s2">tokens</span><span class="s1">;</span><span class="s2">options</span><span class="s1">;</span><span class="s2">state</span><span class="s1">;</span><span class="s2">tokenizer</span><span class="s1">;</span><span class="s2">inlineQueue</span><span class="s1">;</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">=[];</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">links</span><span class="s1">=</span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s4">null</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">=</span><span class="s2">e</span><span class="s1">||</span><span class="s2">r</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">||</span><span class="s4">new </span><span class="s2">ye</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">options</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">=</span><span class="s4">this</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inlineQueue</span><span class="s1">=[];</span><span class="s4">this</span><span class="s1">.</span><span class="s2">state</span><span class="s1">={</span><span class="s2">inLink</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">inRawBlock</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">top</span><span class="s1">:</span><span class="s4">true</span><span class="s1">};</span><span class="s4">const </span><span class="s2">t</span><span class="s1">={</span><span class="s2">other</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">block</span><span class="s1">:</span><span class="s2">he</span><span class="s1">.</span><span class="s2">normal</span><span class="s1">,</span><span class="s2">inline</span><span class="s1">:</span><span class="s2">pe</span><span class="s1">.</span><span class="s2">normal</span><span class="s1">};</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">pedantic</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">block</span><span class="s1">=</span><span class="s2">he</span><span class="s1">.</span><span class="s2">pedantic</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">=</span><span class="s2">pe</span><span class="s1">.</span><span class="s2">pedantic</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">gfm</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">block</span><span class="s1">=</span><span class="s2">he</span><span class="s1">.</span><span class="s2">gfm</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">breaks</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">=</span><span class="s2">pe</span><span class="s1">.</span><span class="s2">breaks</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">=</span><span class="s2">pe</span><span class="s1">.</span><span class="s2">gfm</span><span class="s1">}}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">static </span><span class="s2">get rules</span><span class="s1">(){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">block</span><span class="s1">:</span><span class="s2">he</span><span class="s1">,</span><span class="s2">inline</span><span class="s1">:</span><span class="s2">pe</span><span class="s1">}}</span><span class="s4">static </span><span class="s2">lex</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s4">new </span><span class="s2">$e</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">return </span><span class="s2">n</span><span class="s1">.</span><span class="s2">lex</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">static </span><span class="s2">lexInline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s4">new </span><span class="s2">$e</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">return </span><span class="s2">n</span><span class="s1">.</span><span class="s2">inlineTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">lex</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">carriageReturn</span><span class="s1">,</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">blockTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inlineQueue</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">t</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inlineQueue</span><span class="s1">[</span><span class="s2">t</span><span class="s1">];</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inlineTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">src</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inlineQueue</span><span class="s1">=[];</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">}</span><span class="s2">blockTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">=[],</span><span class="s2">n</span><span class="s1">=</span><span class="s4">false</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">pedantic</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">tabCharGlobal</span><span class="s1">,</span><span class="s0">&quot;    &quot;</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">spaceLine</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">)}</span><span class="s4">while</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">?.</span><span class="s2">block</span><span class="s1">?.</span><span class="s2">some</span><span class="s1">((</span><span class="s2">n</span><span class="s1">=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">call</span><span class="s1">({</span><span class="s2">lexer</span><span class="s1">:</span><span class="s4">this</span><span class="s1">},</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">return true</span><span class="s1">}</span><span class="s4">return false</span><span class="s1">}))){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">space</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">1</span><span class="s1">&amp;&amp;</span><span class="s2">n</span><span class="s1">!==</span><span class="s2">undefined</span><span class="s1">){</span><span class="s2">n</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">code</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">?.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;paragraph&quot;</span><span class="s1">||</span><span class="s2">n</span><span class="s1">?.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;text&quot;</span><span class="s1">){</span><span class="s2">n</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">;</span><span class="s2">n</span><span class="s1">.</span><span class="s2">text</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">s</span><span class="s1">.</span><span class="s2">text</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inlineQueue</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">).</span><span class="s2">src</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">text</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">fences</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">heading</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">hr</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">blockquote</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">list</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">html</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">def</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">?.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;paragraph&quot;</span><span class="s1">||</span><span class="s2">n</span><span class="s1">?.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;text&quot;</span><span class="s1">){</span><span class="s2">n</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">;</span><span class="s2">n</span><span class="s1">.</span><span class="s2">text</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inlineQueue</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">).</span><span class="s2">src</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">text</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">links</span><span class="s1">[</span><span class="s2">s</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">]){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">links</span><span class="s1">[</span><span class="s2">s</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">]={</span><span class="s2">href</span><span class="s1">:</span><span class="s2">s</span><span class="s1">.</span><span class="s2">href</span><span class="s1">,</span><span class="s2">title</span><span class="s1">:</span><span class="s2">s</span><span class="s1">.</span><span class="s2">title</span><span class="s1">}}</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">table</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">lheading</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">?.</span><span class="s2">startBlock</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">.</span><span class="s2">startBlock</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">call</span><span class="s1">({</span><span class="s2">lexer</span><span class="s1">:</span><span class="s4">this</span><span class="s1">},</span><span class="s2">n</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s4">typeof </span><span class="s2">s</span><span class="s1">===</span><span class="s0">&quot;number&quot;</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}}));</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s2">Infinity</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">t</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)}}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">top</span><span class="s1">&amp;&amp;(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">paragraph</span><span class="s1">(</span><span class="s2">r</span><span class="s1">))){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&amp;&amp;</span><span class="s2">i</span><span class="s1">?.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;paragraph&quot;</span><span class="s1">){</span><span class="s2">i</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">text</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">s</span><span class="s1">.</span><span class="s2">text</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inlineQueue</span><span class="s1">.</span><span class="s2">pop</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inlineQueue</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">).</span><span class="s2">src</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">text</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">n</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">length</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">text</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">?.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;text&quot;</span><span class="s1">){</span><span class="s2">n</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">;</span><span class="s2">n</span><span class="s1">.</span><span class="s2">text</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">s</span><span class="s1">.</span><span class="s2">text</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inlineQueue</span><span class="s1">.</span><span class="s2">pop</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inlineQueue</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">).</span><span class="s2">src</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">text</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s0">&quot;Infinite loop on byte: &quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">charCodeAt</span><span class="s1">(</span><span class="s3">0</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">silent</span><span class="s1">){</span><span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">throw new </span><span class="s2">Error</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}}}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s4">true</span><span class="s1">;</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s2">inline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">=[]){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inlineQueue</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({</span><span class="s2">src</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:</span><span class="s2">t</span><span class="s1">});</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s2">inlineTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">=[]){</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">links</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">links</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">while</span><span class="s1">((</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">reflinkSearch</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">n</span><span class="s1">))!=</span><span class="s4">null</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">includes</span><span class="s1">(</span><span class="s2">s</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">s</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">lastIndexOf</span><span class="s1">(</span><span class="s0">&quot;[&quot;</span><span class="s1">)+</span><span class="s3">1</span><span class="s1">,-</span><span class="s3">1</span><span class="s1">))){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">s</span><span class="s1">.</span><span class="s2">index</span><span class="s1">)+</span><span class="s0">&quot;[&quot;</span><span class="s1">+</span><span class="s0">&quot;a&quot;</span><span class="s1">.</span><span class="s2">repeat</span><span class="s1">(</span><span class="s2">s</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">length</span><span class="s1">-</span><span class="s3">2</span><span class="s1">)+</span><span class="s0">&quot;]&quot;</span><span class="s1">+</span><span class="s2">n</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">reflinkSearch</span><span class="s1">.</span><span class="s2">lastIndex</span><span class="s1">)}}}}</span><span class="s4">while</span><span class="s1">((</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">blockSkip</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">n</span><span class="s1">))!=</span><span class="s4">null</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">s</span><span class="s1">.</span><span class="s2">index</span><span class="s1">)+</span><span class="s0">&quot;[&quot;</span><span class="s1">+</span><span class="s0">&quot;a&quot;</span><span class="s1">.</span><span class="s2">repeat</span><span class="s1">(</span><span class="s2">s</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">length</span><span class="s1">-</span><span class="s3">2</span><span class="s1">)+</span><span class="s0">&quot;]&quot;</span><span class="s1">+</span><span class="s2">n</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">blockSkip</span><span class="s1">.</span><span class="s2">lastIndex</span><span class="s1">)}</span><span class="s4">while</span><span class="s1">((</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">anyPunctuation</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">n</span><span class="s1">))!=</span><span class="s4">null</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">s</span><span class="s1">.</span><span class="s2">index</span><span class="s1">)+</span><span class="s0">&quot;++&quot;</span><span class="s1">+</span><span class="s2">n</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">rules</span><span class="s1">.</span><span class="s2">inline</span><span class="s1">.</span><span class="s2">anyPunctuation</span><span class="s1">.</span><span class="s2">lastIndex</span><span class="s1">)}</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">while</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">r</span><span class="s1">){</span><span class="s2">i</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s2">r</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">?.</span><span class="s2">inline</span><span class="s1">?.</span><span class="s2">some</span><span class="s1">((</span><span class="s2">n</span><span class="s1">=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">call</span><span class="s1">({</span><span class="s2">lexer</span><span class="s1">:</span><span class="s4">this</span><span class="s1">},</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">return true</span><span class="s1">}</span><span class="s4">return false</span><span class="s1">}))){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">escape</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">link</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">reflink</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">links</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;text&quot;</span><span class="s1">&amp;&amp;</span><span class="s2">n</span><span class="s1">?.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;text&quot;</span><span class="s1">){</span><span class="s2">n</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">+=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">;</span><span class="s2">n</span><span class="s1">.</span><span class="s2">text</span><span class="s1">+=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">text</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">emStrong</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">codespan</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">br</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">del</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">autolink</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">state</span><span class="s1">.</span><span class="s2">inLink</span><span class="s1">&amp;&amp;(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">url</span><span class="s1">(</span><span class="s2">e</span><span class="s1">))){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">?.</span><span class="s2">startInline</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">.</span><span class="s2">startInline</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">call</span><span class="s1">({</span><span class="s2">lexer</span><span class="s1">:</span><span class="s4">this</span><span class="s1">},</span><span class="s2">n</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s4">typeof </span><span class="s2">s</span><span class="s1">===</span><span class="s0">&quot;number&quot;</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}}));</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s2">Infinity</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">t</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">.</span><span class="s2">inlineText</span><span class="s1">(</span><span class="s2">l</span><span class="s1">)){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">)!==</span><span class="s0">&quot;_&quot;</span><span class="s1">){</span><span class="s2">i</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">)}</span><span class="s2">r</span><span class="s1">=</span><span class="s4">true</span><span class="s1">;</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">at</span><span class="s1">(-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">?.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;text&quot;</span><span class="s1">){</span><span class="s2">n</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">+=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">raw</span><span class="s1">;</span><span class="s2">n</span><span class="s1">.</span><span class="s2">text</span><span class="s1">+=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">text</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s0">&quot;Infinite loop on byte: &quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">charCodeAt</span><span class="s1">(</span><span class="s3">0</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">silent</span><span class="s1">){</span><span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">throw new </span><span class="s2">Error</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}}}</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}}</span><span class="s4">class </span><span class="s2">Re</span><span class="s1">{</span><span class="s2">options</span><span class="s1">;</span><span class="s2">parser</span><span class="s1">;</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">=</span><span class="s2">e</span><span class="s1">||</span><span class="s2">r</span><span class="s1">}</span><span class="s2">space</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s2">code</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">lang</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">escaped</span><span class="s1">:</span><span class="s2">n</span><span class="s1">}){</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=(</span><span class="s2">t</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">).</span><span class="s2">match</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">notSpaceStart</span><span class="s1">)?.[</span><span class="s3">0</span><span class="s1">];</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">endingNewline</span><span class="s1">,</span><span class="s0">&quot;&quot;</span><span class="s1">)+</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;&lt;pre&gt;&lt;code&gt;&quot;</span><span class="s1">+(</span><span class="s2">n</span><span class="s1">?</span><span class="s2">r</span><span class="s1">:</span><span class="s2">ge</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s4">true</span><span class="s1">))+</span><span class="s0">&quot;&lt;/code&gt;&lt;/pre&gt;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">}</span><span class="s4">return</span><span class="s0">'&lt;pre&gt;&lt;code class=&quot;language-'</span><span class="s1">+</span><span class="s2">ge</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)+</span><span class="s0">'&quot;&gt;'</span><span class="s1">+(</span><span class="s2">n</span><span class="s1">?</span><span class="s2">r</span><span class="s1">:</span><span class="s2">ge</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s4">true</span><span class="s1">))+</span><span class="s0">&quot;&lt;/code&gt;&lt;/pre&gt;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">}</span><span class="s2">blockquote</span><span class="s1">({</span><span class="s2">tokens</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">parser</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">return</span><span class="s0">`&lt;blockquote&gt;</span><span class="s4">\n</span><span class="s2">$</span><span class="s1">{</span><span class="s2">t</span><span class="s1">}</span><span class="s0">&lt;/blockquote&gt;</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">}</span><span class="s2">html</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s2">heading</span><span class="s1">({</span><span class="s2">tokens</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">depth</span><span class="s1">:</span><span class="s2">t</span><span class="s1">}){</span><span class="s4">return</span><span class="s0">`&lt;h</span><span class="s2">$</span><span class="s1">{</span><span class="s2">t</span><span class="s1">}</span><span class="s0">&gt;</span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">parser</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s0">&lt;/h</span><span class="s2">$</span><span class="s1">{</span><span class="s2">t</span><span class="s1">}</span><span class="s0">&gt;</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">}</span><span class="s2">hr</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;&lt;hr&gt;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">}</span><span class="s2">list</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">ordered</span><span class="s1">;</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">start</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">l</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">items</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">l</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">items</span><span class="s1">[</span><span class="s2">l</span><span class="s1">];</span><span class="s2">s</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">listitem</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">?</span><span class="s0">&quot;ol&quot;</span><span class="s1">:</span><span class="s0">&quot;ul&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">&amp;&amp;</span><span class="s2">n</span><span class="s1">!==</span><span class="s3">1</span><span class="s1">?</span><span class="s0">' start=&quot;'</span><span class="s1">+</span><span class="s2">n</span><span class="s1">+</span><span class="s0">'&quot;'</span><span class="s1">:</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">return</span><span class="s0">&quot;&lt;&quot;</span><span class="s1">+</span><span class="s2">r</span><span class="s1">+</span><span class="s2">i</span><span class="s1">+</span><span class="s0">&quot;&gt;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">s</span><span class="s1">+</span><span class="s0">&quot;&lt;/&quot;</span><span class="s1">+</span><span class="s2">r</span><span class="s1">+</span><span class="s0">&quot;&gt;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">}</span><span class="s2">listitem</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">task</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">checkbox</span><span class="s1">({</span><span class="s2">checked</span><span class="s1">:!!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">checked</span><span class="s1">});</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">loose</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]?.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;paragraph&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">text</span><span class="s1">=</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot; &quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">text</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">tokens</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;text&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">text</span><span class="s1">=</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot; &quot;</span><span class="s1">+</span><span class="s2">ge</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">text</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">tokens</span><span class="s1">[</span><span class="s3">0</span><span class="s1">].</span><span class="s2">escaped</span><span class="s1">=</span><span class="s4">true</span><span class="s1">}}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">unshift</span><span class="s1">({</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;text&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot; &quot;</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot; &quot;</span><span class="s1">,</span><span class="s2">escaped</span><span class="s1">:</span><span class="s4">true</span><span class="s1">})}}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">+=</span><span class="s2">n</span><span class="s1">+</span><span class="s0">&quot; &quot;</span><span class="s1">}}</span><span class="s2">t</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">parser</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">,!!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">loose</span><span class="s1">);</span><span class="s4">return</span><span class="s0">`&lt;li&gt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">t</span><span class="s1">}</span><span class="s0">&lt;/li&gt;</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">}</span><span class="s2">checkbox</span><span class="s1">({</span><span class="s2">checked</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return</span><span class="s0">&quot;&lt;input &quot;</span><span class="s1">+(</span><span class="s2">e</span><span class="s1">?</span><span class="s0">'checked=&quot;&quot; '</span><span class="s1">:</span><span class="s0">&quot;&quot;</span><span class="s1">)+</span><span class="s0">'disabled=&quot;&quot; type=&quot;checkbox&quot;&gt;'</span><span class="s1">}</span><span class="s2">paragraph</span><span class="s1">({</span><span class="s2">tokens</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return</span><span class="s0">`&lt;p&gt;</span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">parser</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s0">&lt;/p&gt;</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">}</span><span class="s2">table</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">header</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">r</span><span class="s1">++){</span><span class="s2">n</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tablecell</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">header</span><span class="s1">[</span><span class="s2">r</span><span class="s1">])}</span><span class="s2">t</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tablerow</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">n</span><span class="s1">});</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rows</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">r</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rows</span><span class="s1">[</span><span class="s2">r</span><span class="s1">];</span><span class="s2">n</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">e</span><span class="s1">++){</span><span class="s2">n</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tablecell</span><span class="s1">(</span><span class="s2">t</span><span class="s1">[</span><span class="s2">e</span><span class="s1">])}</span><span class="s2">s</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">tablerow</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">n</span><span class="s1">})}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)</span><span class="s2">s</span><span class="s1">=</span><span class="s0">`&lt;tbody&gt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">s</span><span class="s1">}</span><span class="s0">&lt;/tbody&gt;`</span><span class="s1">;</span><span class="s4">return</span><span class="s0">&quot;&lt;table&gt;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s0">&quot;&lt;thead&gt;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">t</span><span class="s1">+</span><span class="s0">&quot;&lt;/thead&gt;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s2">s</span><span class="s1">+</span><span class="s0">&quot;&lt;/table&gt;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">}</span><span class="s2">tablerow</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return</span><span class="s0">`&lt;tr&gt;</span><span class="s4">\n</span><span class="s2">$</span><span class="s1">{</span><span class="s2">e</span><span class="s1">}</span><span class="s0">&lt;/tr&gt;</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">}</span><span class="s2">tablecell</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">parser</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">header</span><span class="s1">?</span><span class="s0">&quot;th&quot;</span><span class="s1">:</span><span class="s0">&quot;td&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">align</span><span class="s1">?</span><span class="s0">`&lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">n</span><span class="s1">} </span><span class="s0">align=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">e</span><span class="s1">.</span><span class="s2">align</span><span class="s1">}</span><span class="s0">&quot;&gt;`</span><span class="s1">:</span><span class="s0">`&lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">n</span><span class="s1">}</span><span class="s0">&gt;`</span><span class="s1">;</span><span class="s4">return </span><span class="s2">s</span><span class="s1">+</span><span class="s2">t</span><span class="s1">+</span><span class="s0">`&lt;/</span><span class="s2">$</span><span class="s1">{</span><span class="s2">n</span><span class="s1">}</span><span class="s0">&gt;</span><span class="s4">\n</span><span class="s0">`</span><span class="s1">}</span><span class="s2">strong</span><span class="s1">({</span><span class="s2">tokens</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return</span><span class="s0">`&lt;strong&gt;</span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">parser</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s0">&lt;/strong&gt;`</span><span class="s1">}</span><span class="s2">em</span><span class="s1">({</span><span class="s2">tokens</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return</span><span class="s0">`&lt;em&gt;</span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">parser</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s0">&lt;/em&gt;`</span><span class="s1">}</span><span class="s2">codespan</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return</span><span class="s0">`&lt;code&gt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">ge</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s4">true</span><span class="s1">)}</span><span class="s0">&lt;/code&gt;`</span><span class="s1">}</span><span class="s2">br</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;&lt;br&gt;&quot;</span><span class="s1">}</span><span class="s2">del</span><span class="s1">({</span><span class="s2">tokens</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return</span><span class="s0">`&lt;del&gt;</span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">parser</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s0">&lt;/del&gt;`</span><span class="s1">}</span><span class="s2">link</span><span class="s1">({</span><span class="s2">href</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">title</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:</span><span class="s2">n</span><span class="s1">}){</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">parser</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">ke</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">===</span><span class="s4">null</span><span class="s1">){</span><span class="s4">return </span><span class="s2">s</span><span class="s1">}</span><span class="s2">e</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s0">'&lt;a href=&quot;'</span><span class="s1">+</span><span class="s2">e</span><span class="s1">+</span><span class="s0">'&quot;'</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">i</span><span class="s1">+=</span><span class="s0">' title=&quot;'</span><span class="s1">+</span><span class="s2">ge</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)+</span><span class="s0">'&quot;'</span><span class="s1">}</span><span class="s2">i</span><span class="s1">+=</span><span class="s0">&quot;&gt;&quot;</span><span class="s1">+</span><span class="s2">s</span><span class="s1">+</span><span class="s0">&quot;&lt;/a&gt;&quot;</span><span class="s1">;</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s2">image</span><span class="s1">({</span><span class="s2">href</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">title</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">n</span><span class="s1">}){</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">ke</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">===</span><span class="s4">null</span><span class="s1">){</span><span class="s4">return </span><span class="s2">ge</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)}</span><span class="s2">e</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s0">`&lt;img src=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">e</span><span class="s1">}</span><span class="s0">&quot; alt=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">n</span><span class="s1">}</span><span class="s0">&quot;`</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">r</span><span class="s1">+=</span><span class="s0">` title=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">ge</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s0">&quot;`</span><span class="s1">}</span><span class="s2">r</span><span class="s1">+=</span><span class="s0">&quot;&gt;&quot;</span><span class="s1">;</span><span class="s4">return </span><span class="s2">r</span><span class="s1">}</span><span class="s2">text</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;tokens&quot;</span><span class="s4">in </span><span class="s2">e</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">?</span><span class="s4">this</span><span class="s1">.</span><span class="s2">parser</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">):</span><span class="s0">&quot;escaped&quot;</span><span class="s4">in </span><span class="s2">e</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">escaped</span><span class="s1">?</span><span class="s2">e</span><span class="s1">.</span><span class="s2">text</span><span class="s1">:</span><span class="s2">ge</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">text</span><span class="s1">)}}</span><span class="s4">class </span><span class="s2">Se</span><span class="s1">{</span><span class="s2">strong</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s2">em</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s2">codespan</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s2">del</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s2">html</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s2">text</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s2">link</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return</span><span class="s0">&quot;&quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">}</span><span class="s2">image</span><span class="s1">({</span><span class="s2">text</span><span class="s1">:</span><span class="s2">e</span><span class="s1">}){</span><span class="s4">return</span><span class="s0">&quot;&quot;</span><span class="s1">+</span><span class="s2">e</span><span class="s1">}</span><span class="s2">br</span><span class="s1">(){</span><span class="s4">return</span><span class="s0">&quot;&quot;</span><span class="s1">}}</span><span class="s4">class </span><span class="s2">Te</span><span class="s1">{</span><span class="s2">options</span><span class="s1">;</span><span class="s2">renderer</span><span class="s1">;</span><span class="s2">textRenderer</span><span class="s1">;</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">=</span><span class="s2">e</span><span class="s1">||</span><span class="s2">r</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">||</span><span class="s4">new </span><span class="s2">Re</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">options</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">parser</span><span class="s1">=</span><span class="s4">this</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">textRenderer</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Se</span><span class="s1">}</span><span class="s4">static </span><span class="s2">parse</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Te</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">return </span><span class="s2">n</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">static </span><span class="s2">parseInline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Te</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">return </span><span class="s2">n</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">parse</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">=</span><span class="s4">true</span><span class="s1">){</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">s</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">[</span><span class="s2">s</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">?.</span><span class="s2">renderers</span><span class="s1">?.[</span><span class="s2">r</span><span class="s1">.</span><span class="s2">type</span><span class="s1">]){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">.</span><span class="s2">renderers</span><span class="s1">[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">].</span><span class="s2">call</span><span class="s1">({</span><span class="s2">parser</span><span class="s1">:</span><span class="s4">this</span><span class="s1">},</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">!==</span><span class="s4">false</span><span class="s1">||![</span><span class="s0">&quot;space&quot;</span><span class="s1">,</span><span class="s0">&quot;hr&quot;</span><span class="s1">,</span><span class="s0">&quot;heading&quot;</span><span class="s1">,</span><span class="s0">&quot;code&quot;</span><span class="s1">,</span><span class="s0">&quot;table&quot;</span><span class="s1">,</span><span class="s0">&quot;blockquote&quot;</span><span class="s1">,</span><span class="s0">&quot;list&quot;</span><span class="s1">,</span><span class="s0">&quot;html&quot;</span><span class="s1">,</span><span class="s0">&quot;paragraph&quot;</span><span class="s1">,</span><span class="s0">&quot;text&quot;</span><span class="s1">].</span><span class="s2">includes</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">)){</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">continue</span><span class="s1">}}</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">type</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;space&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">space</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;hr&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">hr</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;heading&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">heading</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;code&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">code</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;table&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">table</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;blockquote&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">blockquote</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;list&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">list</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;html&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">html</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;paragraph&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">paragraph</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;text&quot;</span><span class="s1">:{</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">text</span><span class="s1">(</span><span class="s2">r</span><span class="s1">);</span><span class="s4">while</span><span class="s1">(</span><span class="s2">s</span><span class="s1">+</span><span class="s3">1</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">[</span><span class="s2">s</span><span class="s1">+</span><span class="s3">1</span><span class="s1">].</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;text&quot;</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">[++</span><span class="s2">s</span><span class="s1">];</span><span class="s2">l</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">text</span><span class="s1">(</span><span class="s2">r</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">n</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">paragraph</span><span class="s1">({</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;paragraph&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">tokens</span><span class="s1">:[{</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;text&quot;</span><span class="s1">,</span><span class="s2">raw</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">text</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">escaped</span><span class="s1">:</span><span class="s4">true</span><span class="s1">}]})}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">l</span><span class="s1">}</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">default</span><span class="s1">:{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s0">'Token with &quot;'</span><span class="s1">+</span><span class="s2">i</span><span class="s1">.</span><span class="s2">type</span><span class="s1">+</span><span class="s0">'&quot; type was not found.'</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">silent</span><span class="s1">){</span><span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">return</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">throw new </span><span class="s2">Error</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}}}}</span><span class="s4">return </span><span class="s2">n</span><span class="s1">}</span><span class="s2">parseInline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">){</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">s</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">[</span><span class="s2">s</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">?.</span><span class="s2">renderers</span><span class="s1">?.[</span><span class="s2">r</span><span class="s1">.</span><span class="s2">type</span><span class="s1">]){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">.</span><span class="s2">renderers</span><span class="s1">[</span><span class="s2">r</span><span class="s1">.</span><span class="s2">type</span><span class="s1">].</span><span class="s2">call</span><span class="s1">({</span><span class="s2">parser</span><span class="s1">:</span><span class="s4">this</span><span class="s1">},</span><span class="s2">r</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">!==</span><span class="s4">false</span><span class="s1">||![</span><span class="s0">&quot;escape&quot;</span><span class="s1">,</span><span class="s0">&quot;html&quot;</span><span class="s1">,</span><span class="s0">&quot;link&quot;</span><span class="s1">,</span><span class="s0">&quot;image&quot;</span><span class="s1">,</span><span class="s0">&quot;strong&quot;</span><span class="s1">,</span><span class="s0">&quot;em&quot;</span><span class="s1">,</span><span class="s0">&quot;codespan&quot;</span><span class="s1">,</span><span class="s0">&quot;br&quot;</span><span class="s1">,</span><span class="s0">&quot;del&quot;</span><span class="s1">,</span><span class="s0">&quot;text&quot;</span><span class="s1">].</span><span class="s2">includes</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">type</span><span class="s1">)){</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">continue</span><span class="s1">}}</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">type</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;escape&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">text</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;html&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">html</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;link&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">link</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;image&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">image</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;strong&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">strong</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;em&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">em</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;codespan&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">codespan</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;br&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">br</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;del&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">del</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;text&quot;</span><span class="s1">:{</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">text</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s4">default</span><span class="s1">:{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s0">'Token with &quot;'</span><span class="s1">+</span><span class="s2">i</span><span class="s1">.</span><span class="s2">type</span><span class="s1">+</span><span class="s0">'&quot; type was not found.'</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">silent</span><span class="s1">){</span><span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">return</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">throw new </span><span class="s2">Error</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}}}}</span><span class="s4">return </span><span class="s2">n</span><span class="s1">}}</span><span class="s4">class </span><span class="s2">ze</span><span class="s1">{</span><span class="s2">options</span><span class="s1">;</span><span class="s2">block</span><span class="s1">;</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">=</span><span class="s2">e</span><span class="s1">||</span><span class="s2">r</span><span class="s1">}</span><span class="s4">static </span><span class="s2">passThroughHooks</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Set</span><span class="s1">([</span><span class="s0">&quot;preprocess&quot;</span><span class="s1">,</span><span class="s0">&quot;postprocess&quot;</span><span class="s1">,</span><span class="s0">&quot;processAllTokens&quot;</span><span class="s1">]);</span><span class="s2">preprocess</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s2">postprocess</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s2">processAllTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s2">provideLexer</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">block</span><span class="s1">?</span><span class="s2">$e</span><span class="s1">.</span><span class="s2">lex</span><span class="s1">:</span><span class="s2">$e</span><span class="s1">.</span><span class="s2">lexInline</span><span class="s1">}</span><span class="s2">provideParser</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">block</span><span class="s1">?</span><span class="s2">Te</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">:</span><span class="s2">Te</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">}}</span><span class="s4">class </span><span class="s2">Ae</span><span class="s1">{</span><span class="s2">defaults</span><span class="s1">=</span><span class="s2">s</span><span class="s1">();</span><span class="s2">options</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">setOptions</span><span class="s1">;</span><span class="s2">parse</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">parseMarkdown</span><span class="s1">(</span><span class="s4">true</span><span class="s1">);</span><span class="s2">parseInline</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">parseMarkdown</span><span class="s1">(</span><span class="s4">false</span><span class="s1">);</span><span class="s2">Parser</span><span class="s1">=</span><span class="s2">Te</span><span class="s1">;</span><span class="s2">Renderer</span><span class="s1">=</span><span class="s2">Re</span><span class="s1">;</span><span class="s2">TextRenderer</span><span class="s1">=</span><span class="s2">Se</span><span class="s1">;</span><span class="s2">Lexer</span><span class="s1">=</span><span class="s2">$e</span><span class="s1">;</span><span class="s2">Tokenizer</span><span class="s1">=</span><span class="s2">ye</span><span class="s1">;</span><span class="s2">Hooks</span><span class="s1">=</span><span class="s2">ze</span><span class="s1">;</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">...e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">use</span><span class="s1">(</span><span class="s2">...e</span><span class="s1">)}</span><span class="s2">walkTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=[];</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">s of e</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">s</span><span class="s1">));</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">type</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;table&quot;</span><span class="s1">:{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">s of e</span><span class="s1">.</span><span class="s2">header</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">,</span><span class="s2">t</span><span class="s1">))}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">s of e</span><span class="s1">.</span><span class="s2">rows</span><span class="s1">){</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">e of s</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">,</span><span class="s2">t</span><span class="s1">))}}</span><span class="s4">break</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;list&quot;</span><span class="s1">:{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">items</span><span class="s1">,</span><span class="s2">t</span><span class="s1">));</span><span class="s4">break</span><span class="s1">}</span><span class="s4">default</span><span class="s1">:{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">?.</span><span class="s2">childTokens</span><span class="s1">?.[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">]){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">.</span><span class="s2">childTokens</span><span class="s1">[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">].</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">s</span><span class="s1">=&gt;{</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">[</span><span class="s2">s</span><span class="s1">].</span><span class="s2">flat</span><span class="s1">(</span><span class="s2">Infinity</span><span class="s1">);</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s2">t</span><span class="s1">))}))}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">,</span><span class="s2">t</span><span class="s1">))}}}}</span><span class="s4">return </span><span class="s2">n</span><span class="s1">}</span><span class="s2">use</span><span class="s1">(</span><span class="s2">...e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">||{</span><span class="s2">renderers</span><span class="s1">:{},</span><span class="s2">childTokens</span><span class="s1">:{}};</span><span class="s2">e</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s4">const </span><span class="s2">n</span><span class="s1">={</span><span class="s2">...e</span><span class="s1">};</span><span class="s2">n</span><span class="s1">.</span><span class="s2">async</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">.</span><span class="s2">async</span><span class="s1">||</span><span class="s2">n</span><span class="s1">.</span><span class="s2">async</span><span class="s1">||</span><span class="s4">false</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">name</span><span class="s1">){</span><span class="s4">throw new </span><span class="s2">Error</span><span class="s1">(</span><span class="s0">&quot;extension name required&quot;</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s0">&quot;renderer&quot;</span><span class="s4">in </span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">renderers</span><span class="s1">[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">name</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">renderers</span><span class="s1">[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">name</span><span class="s1">]=</span><span class="s4">function</span><span class="s1">(</span><span class="s2">...t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">===</span><span class="s4">false</span><span class="s1">){</span><span class="s2">s</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">s</span><span class="s1">}}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">renderers</span><span class="s1">[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">name</span><span class="s1">]=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(</span><span class="s0">&quot;tokenizer&quot;</span><span class="s4">in </span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">level</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">level</span><span class="s1">!==</span><span class="s0">&quot;block&quot;</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">level</span><span class="s1">!==</span><span class="s0">&quot;inline&quot;</span><span class="s1">){</span><span class="s4">throw new </span><span class="s2">Error</span><span class="s1">(</span><span class="s0">&quot;extension level must be 'block' or 'inline'&quot;</span><span class="s1">)}</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">level</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">){</span><span class="s2">n</span><span class="s1">.</span><span class="s2">unshift</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">level</span><span class="s1">]=[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">]}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">start</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">level</span><span class="s1">===</span><span class="s0">&quot;block&quot;</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">startBlock</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">startBlock</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">start</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">startBlock</span><span class="s1">=[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">start</span><span class="s1">]}}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">level</span><span class="s1">===</span><span class="s0">&quot;inline&quot;</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">startInline</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">startInline</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">start</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">startInline</span><span class="s1">=[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">start</span><span class="s1">]}}}}</span><span class="s4">if</span><span class="s1">(</span><span class="s0">&quot;childTokens&quot;</span><span class="s4">in </span><span class="s2">e</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">childTokens</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">childTokens</span><span class="s1">[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">name</span><span class="s1">]=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">childTokens</span><span class="s1">}}));</span><span class="s2">n</span><span class="s1">.</span><span class="s2">extensions</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">||</span><span class="s4">new </span><span class="s2">Re</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">n </span><span class="s4">in </span><span class="s2">e</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!(</span><span class="s2">n </span><span class="s4">in </span><span class="s2">t</span><span class="s1">)){</span><span class="s4">throw new </span><span class="s2">Error</span><span class="s1">(</span><span class="s0">`renderer '</span><span class="s2">$</span><span class="s1">{</span><span class="s2">n</span><span class="s1">}</span><span class="s0">' does not exist`</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">([</span><span class="s0">&quot;options&quot;</span><span class="s1">,</span><span class="s0">&quot;parser&quot;</span><span class="s1">].</span><span class="s2">includes</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">[</span><span class="s2">s</span><span class="s1">];</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s2">s</span><span class="s1">];</span><span class="s2">t</span><span class="s1">[</span><span class="s2">s</span><span class="s1">]=(</span><span class="s2">...e</span><span class="s1">)=&gt;{</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s4">false</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">n</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">}}</span><span class="s2">n</span><span class="s1">.</span><span class="s2">renderer</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">||</span><span class="s4">new </span><span class="s2">ye</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">n </span><span class="s4">in </span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!(</span><span class="s2">n </span><span class="s4">in </span><span class="s2">t</span><span class="s1">)){</span><span class="s4">throw new </span><span class="s2">Error</span><span class="s1">(</span><span class="s0">`tokenizer '</span><span class="s2">$</span><span class="s1">{</span><span class="s2">n</span><span class="s1">}</span><span class="s0">' does not exist`</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">([</span><span class="s0">&quot;options&quot;</span><span class="s1">,</span><span class="s0">&quot;rules&quot;</span><span class="s1">,</span><span class="s0">&quot;lexer&quot;</span><span class="s1">].</span><span class="s2">includes</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">[</span><span class="s2">s</span><span class="s1">];</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s2">s</span><span class="s1">];</span><span class="s2">t</span><span class="s1">[</span><span class="s2">s</span><span class="s1">]=(</span><span class="s2">...e</span><span class="s1">)=&gt;{</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s4">false</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">n</span><span class="s1">}}</span><span class="s2">n</span><span class="s1">.</span><span class="s2">tokenizer</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">||</span><span class="s4">new </span><span class="s2">ze</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">n </span><span class="s4">in </span><span class="s2">e</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!(</span><span class="s2">n </span><span class="s4">in </span><span class="s2">t</span><span class="s1">)){</span><span class="s4">throw new </span><span class="s2">Error</span><span class="s1">(</span><span class="s0">`hook '</span><span class="s2">$</span><span class="s1">{</span><span class="s2">n</span><span class="s1">}</span><span class="s0">' does not exist`</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">([</span><span class="s0">&quot;options&quot;</span><span class="s1">,</span><span class="s0">&quot;block&quot;</span><span class="s1">].</span><span class="s2">includes</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">[</span><span class="s2">s</span><span class="s1">];</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s2">s</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">ze</span><span class="s1">.</span><span class="s2">passThroughHooks</span><span class="s1">.</span><span class="s2">has</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)){</span><span class="s2">t</span><span class="s1">[</span><span class="s2">s</span><span class="s1">]=</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">.</span><span class="s2">async</span><span class="s1">){</span><span class="s4">return </span><span class="s2">Promise</span><span class="s1">.</span><span class="s2">resolve</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)).</span><span class="s2">then</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)))}</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">return </span><span class="s2">i</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)}}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">[</span><span class="s2">s</span><span class="s1">]=(</span><span class="s2">...e</span><span class="s1">)=&gt;{</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s4">false</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">n</span><span class="s1">}}}</span><span class="s2">n</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">;</span><span class="s2">n</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">=</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=[];</span><span class="s2">n</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">e</span><span class="s1">));</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">e</span><span class="s1">))}</span><span class="s4">return </span><span class="s2">n</span><span class="s1">}}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">={</span><span class="s2">...</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">,</span><span class="s2">...n</span><span class="s1">}}));</span><span class="s4">return this</span><span class="s1">}</span><span class="s2">setOptions</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">={</span><span class="s2">...</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">,</span><span class="s2">...e</span><span class="s1">};</span><span class="s4">return this</span><span class="s1">}</span><span class="s2">lexer</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return </span><span class="s2">$e</span><span class="s1">.</span><span class="s2">lex</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">??</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">)}</span><span class="s2">parser</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return </span><span class="s2">Te</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">??</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">)}</span><span class="s2">parseMarkdown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)=&gt;{</span><span class="s4">const </span><span class="s2">s</span><span class="s1">={</span><span class="s2">...n</span><span class="s1">};</span><span class="s4">const </span><span class="s2">r</span><span class="s1">={</span><span class="s2">...</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">,</span><span class="s2">...s</span><span class="s1">};</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onError</span><span class="s1">(!!</span><span class="s2">r</span><span class="s1">.</span><span class="s2">silent</span><span class="s1">,!!</span><span class="s2">r</span><span class="s1">.</span><span class="s2">async</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">.</span><span class="s2">async</span><span class="s1">===</span><span class="s4">true</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">async</span><span class="s1">===</span><span class="s4">false</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">(</span><span class="s4">new </span><span class="s2">Error</span><span class="s1">(</span><span class="s0">&quot;marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise.&quot;</span><span class="s1">))}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">typeof </span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;undefined&quot;</span><span class="s1">||</span><span class="s2">t</span><span class="s1">===</span><span class="s4">null</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">(</span><span class="s4">new </span><span class="s2">Error</span><span class="s1">(</span><span class="s0">&quot;marked(): input parameter is undefined or null&quot;</span><span class="s1">))}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">typeof </span><span class="s2">t</span><span class="s1">!==</span><span class="s0">&quot;string&quot;</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">(</span><span class="s4">new </span><span class="s2">Error</span><span class="s1">(</span><span class="s0">&quot;marked(): input parameter is of type &quot;</span><span class="s1">+</span><span class="s2">Object</span><span class="s1">.</span><span class="s2">prototype</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)+</span><span class="s0">&quot;, string expected&quot;</span><span class="s1">))}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">){</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">.</span><span class="s2">options</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">.</span><span class="s2">block</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">?</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">.</span><span class="s2">provideLexer</span><span class="s1">():</span><span class="s2">e</span><span class="s1">?</span><span class="s2">$e</span><span class="s1">.</span><span class="s2">lex</span><span class="s1">:</span><span class="s2">$e</span><span class="s1">.</span><span class="s2">lexInline</span><span class="s1">;</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">?</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">.</span><span class="s2">provideParser</span><span class="s1">():</span><span class="s2">e</span><span class="s1">?</span><span class="s2">Te</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">:</span><span class="s2">Te</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">async</span><span class="s1">){</span><span class="s4">return </span><span class="s2">Promise</span><span class="s1">.</span><span class="s2">resolve</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">?</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">.</span><span class="s2">preprocess</span><span class="s1">(</span><span class="s2">t</span><span class="s1">):</span><span class="s2">t</span><span class="s1">).</span><span class="s2">then</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">l</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">))).</span><span class="s2">then</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">?</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">.</span><span class="s2">processAllTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">):</span><span class="s2">e</span><span class="s1">)).</span><span class="s2">then</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">r</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">?</span><span class="s2">Promise</span><span class="s1">.</span><span class="s2">all</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">)).</span><span class="s2">then</span><span class="s1">((()=&gt;</span><span class="s2">e</span><span class="s1">)):</span><span class="s2">e</span><span class="s1">)).</span><span class="s2">then</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">o</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">))).</span><span class="s2">then</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">?</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">.</span><span class="s2">postprocess</span><span class="s1">(</span><span class="s2">e</span><span class="s1">):</span><span class="s2">e</span><span class="s1">)).</span><span class="s2">catch</span><span class="s1">(</span><span class="s2">i</span><span class="s1">)}</span><span class="s4">try</span><span class="s1">{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">){</span><span class="s2">t</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">.</span><span class="s2">preprocess</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">l</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">.</span><span class="s2">processAllTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">)}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">o</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">hooks</span><span class="s1">.</span><span class="s2">postprocess</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">n</span><span class="s1">}</span><span class="s4">catch</span><span class="s1">(</span><span class="s2">a</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">(</span><span class="s2">a</span><span class="s1">)}};</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s2">onError</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return </span><span class="s2">n</span><span class="s1">=&gt;{</span><span class="s2">n</span><span class="s1">.</span><span class="s2">message</span><span class="s1">+=</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">Please report this to https://github.com/markedjs/marked.&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s0">&quot;&lt;p&gt;An error occurred:&lt;/p&gt;&lt;pre&gt;&quot;</span><span class="s1">+</span><span class="s2">ge</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">message</span><span class="s1">+</span><span class="s0">&quot;&quot;</span><span class="s1">,</span><span class="s4">true</span><span class="s1">)+</span><span class="s0">&quot;&lt;/pre&gt;&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return </span><span class="s2">Promise</span><span class="s1">.</span><span class="s2">resolve</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return </span><span class="s2">Promise</span><span class="s1">.</span><span class="s2">reject</span><span class="s1">(</span><span class="s2">n</span><span class="s1">)}</span><span class="s4">throw </span><span class="s2">n</span><span class="s1">}}}</span><span class="s4">const </span><span class="s2">_e</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Ae</span><span class="s1">;</span><span class="s4">function </span><span class="s2">Ie</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return </span><span class="s2">_e</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">options</span><span class="s1">=</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">setOptions</span><span class="s1">=</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">_e</span><span class="s1">.</span><span class="s2">setOptions</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">=</span><span class="s2">_e</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">;</span><span class="s2">i</span><span class="s1">(</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">);</span><span class="s4">return </span><span class="s2">Ie</span><span class="s1">};</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">getDefaults</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">use</span><span class="s1">=</span><span class="s4">function</span><span class="s1">(</span><span class="s2">...e</span><span class="s1">){</span><span class="s2">_e</span><span class="s1">.</span><span class="s2">use</span><span class="s1">(</span><span class="s2">...e</span><span class="s1">);</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">=</span><span class="s2">_e</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">;</span><span class="s2">i</span><span class="s1">(</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">defaults</span><span class="s1">);</span><span class="s4">return </span><span class="s2">Ie</span><span class="s1">};</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">=</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return </span><span class="s2">_e</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)};</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">=</span><span class="s2">_e</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">;</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">Parser</span><span class="s1">=</span><span class="s2">Te</span><span class="s1">;</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">parser</span><span class="s1">=</span><span class="s2">Te</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">;</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">Renderer</span><span class="s1">=</span><span class="s2">Re</span><span class="s1">;</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">TextRenderer</span><span class="s1">=</span><span class="s2">Se</span><span class="s1">;</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">Lexer</span><span class="s1">=</span><span class="s2">$e</span><span class="s1">;</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">lexer</span><span class="s1">=</span><span class="s2">$e</span><span class="s1">.</span><span class="s2">lex</span><span class="s1">;</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">Tokenizer</span><span class="s1">=</span><span class="s2">ye</span><span class="s1">;</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">Hooks</span><span class="s1">=</span><span class="s2">ze</span><span class="s1">;</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">=</span><span class="s2">Ie</span><span class="s1">;</span><span class="s4">const </span><span class="s2">Pe</span><span class="s1">=</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">options</span><span class="s1">;</span><span class="s4">const </span><span class="s2">Le</span><span class="s1">=</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">setOptions</span><span class="s1">;</span><span class="s4">const </span><span class="s2">Ce</span><span class="s1">=</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">use</span><span class="s1">;</span><span class="s4">const </span><span class="s2">Be</span><span class="s1">=</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">walkTokens</span><span class="s1">;</span><span class="s4">const </span><span class="s2">qe</span><span class="s1">=</span><span class="s2">Ie</span><span class="s1">.</span><span class="s2">parseInline</span><span class="s1">;</span><span class="s4">const </span><span class="s2">Ee</span><span class="s1">=</span><span class="s2">Ie</span><span class="s1">;</span><span class="s4">const </span><span class="s2">Ze</span><span class="s1">=</span><span class="s2">Te</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">;</span><span class="s4">const </span><span class="s2">ve</span><span class="s1">=</span><span class="s2">$e</span><span class="s1">.</span><span class="s2">lex</span><span class="s1">}}]);</span></pre>
</body>
</html>