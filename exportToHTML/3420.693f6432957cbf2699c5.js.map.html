<html>
<head>
<title>3420.693f6432957cbf2699c5.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #6aab73;}
.s2 { color: #2aacb8;}
.s3 { color: #cf8e6d;}
.ln { color: #4b5059; font-weight: normal; font-style: normal; }
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
3420.693f6432957cbf2699c5.js.map</font>
</center></td></tr></table>
<pre><a name="l1"><span class="ln">1    </span></a><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;file&quot;</span><span class="s0">:</span><span class="s1">&quot;3420.693f6432957cbf2699c5.js?v=693f6432957cbf2699c5&quot;</span><span class="s0">,</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,0CAA0C,EAAE;AAC5C,4DAA4D,EAAE;AAC9D;AACA,oCAAoC,EAAE;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,YAAY,KAAK;;AAEjC;AACA;AACA;AACA;;AAEA;AACA,gDAAgD;AAChD;AACA;;AAEA,iDAAiD;AACjD,8BAA8B,KAAK;AACnC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,QAAQ;AACR;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,mDAAmD,EAAE,iBAAiB,EAAE,GAAG,YAAY,IAAI,EAAE;AAC7F;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iCAAiC;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;;AAEA,6BAA6B;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;;AAEA,4BAA4B;AAC5B,2CAA2C,KAAK;AAChD;AACA;;AAEA,qCAAqC;AACrC,2CAA2C,KAAK;AAChD;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;;AAEA,4BAA4B;AAC5B,2CAA2C,KAAK;AAChD;AACA;;AAEA,qCAAqC;AACrC,2CAA2C,KAAK;AAChD;AACA;;AAEA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA,4CAA4C,gBAAgB;;AAE5D;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA,oBAAoB;AACpB;AACA&quot;</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@codemirror/legacy-modes/mode/crystal.js&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;function wordRegExp(words, end) {</span><span class="s3">\n  </span><span class="s1">return new RegExp((end ? </span><span class="s3">\&quot;\&quot; </span><span class="s1">: </span><span class="s3">\&quot;</span><span class="s1">^</span><span class="s3">\&quot;</span><span class="s1">) + </span><span class="s3">\&quot;</span><span class="s1">(?:</span><span class="s3">\&quot; </span><span class="s1">+ words.join(</span><span class="s3">\&quot;</span><span class="s1">|</span><span class="s3">\&quot;</span><span class="s1">) + </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\&quot; </span><span class="s1">+ (end ? </span><span class="s3">\&quot;</span><span class="s1">$</span><span class="s3">\&quot; </span><span class="s1">: </span><span class="s3">\&quot;\\\\</span><span class="s1">b</span><span class="s3">\&quot;</span><span class="s1">));</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function chain(tokenize, stream, state) {</span><span class="s3">\n  </span><span class="s1">state.tokenize.push(tokenize);</span><span class="s3">\n  </span><span class="s1">return tokenize(stream, state);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">var operators = /^(?:[-+/%|&amp;^]|</span><span class="s3">\\</span><span class="s1">*</span><span class="s3">\\</span><span class="s1">*?|[&lt;&gt;]{2})/;</span><span class="s3">\n</span><span class="s1">var conditionalOperators = /^(?:[=!]~|===|&lt;=&gt;|[&lt;&gt;=!]=?|[|&amp;]{2}|~)/;</span><span class="s3">\n</span><span class="s1">var indexingOperators = /^(?:</span><span class="s3">\\</span><span class="s1">[</span><span class="s3">\\</span><span class="s1">][?=]?)/;</span><span class="s3">\n</span><span class="s1">var anotherOperators = /^(?:</span><span class="s3">\\</span><span class="s1">.(?:</span><span class="s3">\\</span><span class="s1">.{2})?|-&gt;|[?:])/;</span><span class="s3">\n</span><span class="s1">var idents = /^[a-z_</span><span class="s3">\\</span><span class="s1">u009F-</span><span class="s3">\\</span><span class="s1">uFFFF][a-zA-Z0-9_</span><span class="s3">\\</span><span class="s1">u009F-</span><span class="s3">\\</span><span class="s1">uFFFF]*/;</span><span class="s3">\n</span><span class="s1">var types = /^[A-Z_</span><span class="s3">\\</span><span class="s1">u009F-</span><span class="s3">\\</span><span class="s1">uFFFF][a-zA-Z0-9_</span><span class="s3">\\</span><span class="s1">u009F-</span><span class="s3">\\</span><span class="s1">uFFFF]*/;</span><span class="s3">\n</span><span class="s1">var keywords = wordRegExp([</span><span class="s3">\n  \&quot;</span><span class="s1">abstract</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">alias</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">as</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">asm</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">begin</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">break</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">case</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">def</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">do</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n  \&quot;</span><span class="s1">else</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">elsif</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">end</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">ensure</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">enum</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">extend</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">for</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">fun</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">if</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n  \&quot;</span><span class="s1">include</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">instance_sizeof</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">lib</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">macro</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">module</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">next</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">of</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">out</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">pointerof</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n  \&quot;</span><span class="s1">private</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">protected</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">rescue</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">return</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">require</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">select</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">sizeof</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">struct</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n  \&quot;</span><span class="s1">super</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">then</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">type</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">typeof</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">uninitialized</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">union</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">unless</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">until</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">when</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">while</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">with</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n  \&quot;</span><span class="s1">yield</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">__DIR__</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">__END_LINE__</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">__FILE__</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">__LINE__</span><span class="s3">\&quot;\n</span><span class="s1">]);</span><span class="s3">\n</span><span class="s1">var atomWords = wordRegExp([</span><span class="s3">\&quot;</span><span class="s1">true</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">false</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">nil</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">self</span><span class="s3">\&quot;</span><span class="s1">]);</span><span class="s3">\n</span><span class="s1">var indentKeywordsArray = [</span><span class="s3">\n  \&quot;</span><span class="s1">def</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">fun</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">macro</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n  \&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">module</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">struct</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">lib</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">enum</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">union</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n  \&quot;</span><span class="s1">do</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">for</span><span class="s3">\&quot;\n</span><span class="s1">];</span><span class="s3">\n</span><span class="s1">var indentKeywords = wordRegExp(indentKeywordsArray);</span><span class="s3">\n</span><span class="s1">var indentExpressionKeywordsArray = [</span><span class="s3">\&quot;</span><span class="s1">if</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">unless</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">case</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">while</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">until</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">begin</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">then</span><span class="s3">\&quot;</span><span class="s1">];</span><span class="s3">\n</span><span class="s1">var indentExpressionKeywords = wordRegExp(indentExpressionKeywordsArray);</span><span class="s3">\n</span><span class="s1">var dedentKeywordsArray = [</span><span class="s3">\&quot;</span><span class="s1">end</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">else</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">elsif</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">rescue</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">ensure</span><span class="s3">\&quot;</span><span class="s1">];</span><span class="s3">\n</span><span class="s1">var dedentKeywords = wordRegExp(dedentKeywordsArray);</span><span class="s3">\n</span><span class="s1">var dedentPunctualsArray = [</span><span class="s3">\&quot;\\\\</span><span class="s1">)</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;\\\\</span><span class="s1">}</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;\\\\</span><span class="s1">]</span><span class="s3">\&quot;</span><span class="s1">];</span><span class="s3">\n</span><span class="s1">var dedentPunctuals = new RegExp(</span><span class="s3">\&quot;</span><span class="s1">^(?:</span><span class="s3">\&quot; </span><span class="s1">+ dedentPunctualsArray.join(</span><span class="s3">\&quot;</span><span class="s1">|</span><span class="s3">\&quot;</span><span class="s1">) + </span><span class="s3">\&quot;</span><span class="s1">)$</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var nextTokenizer = {</span><span class="s3">\n  \&quot;</span><span class="s1">def</span><span class="s3">\&quot;</span><span class="s1">: tokenFollowIdent, </span><span class="s3">\&quot;</span><span class="s1">fun</span><span class="s3">\&quot;</span><span class="s1">: tokenFollowIdent, </span><span class="s3">\&quot;</span><span class="s1">macro</span><span class="s3">\&quot;</span><span class="s1">: tokenMacroDef,</span><span class="s3">\n  \&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">: tokenFollowType, </span><span class="s3">\&quot;</span><span class="s1">module</span><span class="s3">\&quot;</span><span class="s1">: tokenFollowType, </span><span class="s3">\&quot;</span><span class="s1">struct</span><span class="s3">\&quot;</span><span class="s1">: tokenFollowType,</span><span class="s3">\n  \&quot;</span><span class="s1">lib</span><span class="s3">\&quot;</span><span class="s1">: tokenFollowType, </span><span class="s3">\&quot;</span><span class="s1">enum</span><span class="s3">\&quot;</span><span class="s1">: tokenFollowType, </span><span class="s3">\&quot;</span><span class="s1">union</span><span class="s3">\&quot;</span><span class="s1">: tokenFollowType</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">var matching = {</span><span class="s3">\&quot;</span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">: </span><span class="s3">\&quot;</span><span class="s1">]</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">{</span><span class="s3">\&quot;</span><span class="s1">: </span><span class="s3">\&quot;</span><span class="s1">}</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">(</span><span class="s3">\&quot;</span><span class="s1">: </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">&lt;</span><span class="s3">\&quot;</span><span class="s1">: </span><span class="s3">\&quot;</span><span class="s1">&gt;</span><span class="s3">\&quot;</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">function tokenBase(stream, state) {</span><span class="s3">\n  </span><span class="s1">if (stream.eatSpace()) {</span><span class="s3">\n    </span><span class="s1">return null;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Macros</span><span class="s3">\n  </span><span class="s1">if (state.lastToken != </span><span class="s3">\&quot;\\\\\&quot; </span><span class="s1">&amp;&amp; stream.match(</span><span class="s3">\&quot;</span><span class="s1">{%</span><span class="s3">\&quot;</span><span class="s1">, false)) {</span><span class="s3">\n    </span><span class="s1">return chain(tokenMacro(</span><span class="s3">\&quot;</span><span class="s1">%</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">%</span><span class="s3">\&quot;</span><span class="s1">), stream, state);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (state.lastToken != </span><span class="s3">\&quot;\\\\\&quot; </span><span class="s1">&amp;&amp; stream.match(</span><span class="s3">\&quot;</span><span class="s1">{{</span><span class="s3">\&quot;</span><span class="s1">, false)) {</span><span class="s3">\n    </span><span class="s1">return chain(tokenMacro(</span><span class="s3">\&quot;</span><span class="s1">{</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">}</span><span class="s3">\&quot;</span><span class="s1">), stream, state);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Comments</span><span class="s3">\n  </span><span class="s1">if (stream.peek() == </span><span class="s3">\&quot;</span><span class="s1">#</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">stream.skipToEnd();</span><span class="s3">\n    </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">comment</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Variables and keywords</span><span class="s3">\n  </span><span class="s1">var matched;</span><span class="s3">\n  </span><span class="s1">if (stream.match(idents)) {</span><span class="s3">\n    </span><span class="s1">stream.eat(/[?!]/);</span><span class="s3">\n\n    </span><span class="s1">matched = stream.current();</span><span class="s3">\n    </span><span class="s1">if (stream.eat(</span><span class="s3">\&quot;</span><span class="s1">:</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">atom</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">} else if (state.lastToken == </span><span class="s3">\&quot;</span><span class="s1">.</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">property</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">} else if (keywords.test(matched)) {</span><span class="s3">\n      </span><span class="s1">if (indentKeywords.test(matched)) {</span><span class="s3">\n        </span><span class="s1">if (!(matched == </span><span class="s3">\&quot;</span><span class="s1">fun</span><span class="s3">\&quot; </span><span class="s1">&amp;&amp; state.blocks.indexOf(</span><span class="s3">\&quot;</span><span class="s1">lib</span><span class="s3">\&quot;</span><span class="s1">) &gt;= 0) &amp;&amp; !(matched == </span><span class="s3">\&quot;</span><span class="s1">def</span><span class="s3">\&quot; </span><span class="s1">&amp;&amp; state.lastToken == </span><span class="s3">\&quot;</span><span class="s1">abstract</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n          </span><span class="s1">state.blocks.push(matched);</span><span class="s3">\n          </span><span class="s1">state.currentIndent += 1;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} else if ((state.lastStyle == </span><span class="s3">\&quot;</span><span class="s1">operator</span><span class="s3">\&quot; </span><span class="s1">|| !state.lastStyle) &amp;&amp; indentExpressionKeywords.test(matched)) {</span><span class="s3">\n        </span><span class="s1">state.blocks.push(matched);</span><span class="s3">\n        </span><span class="s1">state.currentIndent += 1;</span><span class="s3">\n      </span><span class="s1">} else if (matched == </span><span class="s3">\&quot;</span><span class="s1">end</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">state.blocks.pop();</span><span class="s3">\n        </span><span class="s1">state.currentIndent -= 1;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (nextTokenizer.hasOwnProperty(matched)) {</span><span class="s3">\n        </span><span class="s1">state.tokenize.push(nextTokenizer[matched]);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">keyword</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">} else if (atomWords.test(matched)) {</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">atom</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">variable</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Class variables and instance variables</span><span class="s3">\n  </span><span class="s1">// or attributes</span><span class="s3">\n  </span><span class="s1">if (stream.eat(</span><span class="s3">\&quot;</span><span class="s1">@</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n    </span><span class="s1">if (stream.peek() == </span><span class="s3">\&quot;</span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return chain(tokenNest(</span><span class="s3">\&quot;</span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">]</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">meta</span><span class="s3">\&quot;</span><span class="s1">), stream, state);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">stream.eat(</span><span class="s3">\&quot;</span><span class="s1">@</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">stream.match(idents) || stream.match(types);</span><span class="s3">\n    </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">propertyName</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Constants and types</span><span class="s3">\n  </span><span class="s1">if (stream.match(types)) {</span><span class="s3">\n    </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">tag</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Symbols or ':' operator</span><span class="s3">\n  </span><span class="s1">if (stream.eat(</span><span class="s3">\&quot;</span><span class="s1">:</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n    </span><span class="s1">if (stream.eat(</span><span class="s3">\&quot;\\\&quot;\&quot;</span><span class="s1">)) {</span><span class="s3">\n      </span><span class="s1">return chain(tokenQuote(</span><span class="s3">\&quot;\\\&quot;\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">atom</span><span class="s3">\&quot;</span><span class="s1">, false), stream, state);</span><span class="s3">\n    </span><span class="s1">} else if (stream.match(idents) || stream.match(types) ||</span><span class="s3">\n               </span><span class="s1">stream.match(operators) || stream.match(conditionalOperators) || stream.match(indexingOperators)) {</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">atom</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">stream.eat(</span><span class="s3">\&quot;</span><span class="s1">:</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">operator</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Strings</span><span class="s3">\n  </span><span class="s1">if (stream.eat(</span><span class="s3">\&quot;\\\&quot;\&quot;</span><span class="s1">)) {</span><span class="s3">\n    </span><span class="s1">return chain(tokenQuote(</span><span class="s3">\&quot;\\\&quot;\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">, true), stream, state);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Strings or regexps or macro variables or '%' operator</span><span class="s3">\n  </span><span class="s1">if (stream.peek() == </span><span class="s3">\&quot;</span><span class="s1">%</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">var style = </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">var embed = true;</span><span class="s3">\n    </span><span class="s1">var delim;</span><span class="s3">\n\n    </span><span class="s1">if (stream.match(</span><span class="s3">\&quot;</span><span class="s1">%r</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n      </span><span class="s1">// Regexps</span><span class="s3">\n      </span><span class="s1">style = </span><span class="s3">\&quot;</span><span class="s1">string.special</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">delim = stream.next();</span><span class="s3">\n    </span><span class="s1">} else if (stream.match(</span><span class="s3">\&quot;</span><span class="s1">%w</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n      </span><span class="s1">embed = false;</span><span class="s3">\n      </span><span class="s1">delim = stream.next();</span><span class="s3">\n    </span><span class="s1">} else if (stream.match(</span><span class="s3">\&quot;</span><span class="s1">%q</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n      </span><span class="s1">embed = false;</span><span class="s3">\n      </span><span class="s1">delim = stream.next();</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">if(delim = stream.match(/^%([^</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">s=])/)) {</span><span class="s3">\n        </span><span class="s1">delim = delim[1];</span><span class="s3">\n      </span><span class="s1">} else if (stream.match(/^%[a-zA-Z_</span><span class="s3">\\</span><span class="s1">u009F-</span><span class="s3">\\</span><span class="s1">uFFFF][</span><span class="s3">\\</span><span class="s1">w</span><span class="s3">\\</span><span class="s1">u009F-</span><span class="s3">\\</span><span class="s1">uFFFF]*/)) {</span><span class="s3">\n        </span><span class="s1">// Macro variables</span><span class="s3">\n        </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">meta</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">} else if (stream.eat('%')) {</span><span class="s3">\n        </span><span class="s1">// '%' operator</span><span class="s3">\n        </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">operator</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (matching.hasOwnProperty(delim)) {</span><span class="s3">\n      </span><span class="s1">delim = matching[delim];</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return chain(tokenQuote(delim, style, embed), stream, state);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Here Docs</span><span class="s3">\n  </span><span class="s1">if (matched = stream.match(/^&lt;&lt;-('?)([A-Z]</span><span class="s3">\\</span><span class="s1">w*)</span><span class="s3">\\</span><span class="s1">1/)) {</span><span class="s3">\n    </span><span class="s1">return chain(tokenHereDoc(matched[2], !matched[1]), stream, state)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Characters</span><span class="s3">\n  </span><span class="s1">if (stream.eat(</span><span class="s3">\&quot;</span><span class="s1">'</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n    </span><span class="s1">stream.match(/^(?:[^']|</span><span class="s3">\\\\</span><span class="s1">(?:[befnrtv0'</span><span class="s3">\&quot;</span><span class="s1">]|[0-7]{3}|u(?:[0-9a-fA-F]{4}|</span><span class="s3">\\</span><span class="s1">{[0-9a-fA-F]{1,6}</span><span class="s3">\\</span><span class="s1">})))/);</span><span class="s3">\n    </span><span class="s1">stream.eat(</span><span class="s3">\&quot;</span><span class="s1">'</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">atom</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Numbers</span><span class="s3">\n  </span><span class="s1">if (stream.eat(</span><span class="s3">\&quot;</span><span class="s1">0</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n    </span><span class="s1">if (stream.eat(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n      </span><span class="s1">stream.match(/^[0-9a-fA-F_]+/);</span><span class="s3">\n    </span><span class="s1">} else if (stream.eat(</span><span class="s3">\&quot;</span><span class="s1">o</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n      </span><span class="s1">stream.match(/^[0-7_]+/);</span><span class="s3">\n    </span><span class="s1">} else if (stream.eat(</span><span class="s3">\&quot;</span><span class="s1">b</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n      </span><span class="s1">stream.match(/^[01_]+/);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">number</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (stream.eat(/^</span><span class="s3">\\</span><span class="s1">d/)) {</span><span class="s3">\n    </span><span class="s1">stream.match(/^[</span><span class="s3">\\</span><span class="s1">d_]*(?:</span><span class="s3">\\</span><span class="s1">.[</span><span class="s3">\\</span><span class="s1">d_]+)?(?:[eE][+-]?</span><span class="s3">\\</span><span class="s1">d+)?/);</span><span class="s3">\n    </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">number</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Operators</span><span class="s3">\n  </span><span class="s1">if (stream.match(operators)) {</span><span class="s3">\n    </span><span class="s1">stream.eat(</span><span class="s3">\&quot;</span><span class="s1">=</span><span class="s3">\&quot;</span><span class="s1">); // Operators can follow assign symbol.</span><span class="s3">\n    </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">operator</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (stream.match(conditionalOperators) || stream.match(anotherOperators)) {</span><span class="s3">\n    </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">operator</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Parens and braces</span><span class="s3">\n  </span><span class="s1">if (matched = stream.match(/[({[]/, false)) {</span><span class="s3">\n    </span><span class="s1">matched = matched[0];</span><span class="s3">\n    </span><span class="s1">return chain(tokenNest(matched, matching[matched], null), stream, state);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Escapes</span><span class="s3">\n  </span><span class="s1">if (stream.eat(</span><span class="s3">\&quot;\\\\\&quot;</span><span class="s1">)) {</span><span class="s3">\n    </span><span class="s1">stream.next();</span><span class="s3">\n    </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">meta</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">stream.next();</span><span class="s3">\n  </span><span class="s1">return null;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function tokenNest(begin, end, style, started) {</span><span class="s3">\n  </span><span class="s1">return function (stream, state) {</span><span class="s3">\n    </span><span class="s1">if (!started &amp;&amp; stream.match(begin)) {</span><span class="s3">\n      </span><span class="s1">state.tokenize[state.tokenize.length - 1] = tokenNest(begin, end, style, true);</span><span class="s3">\n      </span><span class="s1">state.currentIndent += 1;</span><span class="s3">\n      </span><span class="s1">return style;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">var nextStyle = tokenBase(stream, state);</span><span class="s3">\n    </span><span class="s1">if (stream.current() === end) {</span><span class="s3">\n      </span><span class="s1">state.tokenize.pop();</span><span class="s3">\n      </span><span class="s1">state.currentIndent -= 1;</span><span class="s3">\n      </span><span class="s1">nextStyle = style;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return nextStyle;</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function tokenMacro(begin, end, started) {</span><span class="s3">\n  </span><span class="s1">return function (stream, state) {</span><span class="s3">\n    </span><span class="s1">if (!started &amp;&amp; stream.match(</span><span class="s3">\&quot;</span><span class="s1">{</span><span class="s3">\&quot; </span><span class="s1">+ begin)) {</span><span class="s3">\n      </span><span class="s1">state.currentIndent += 1;</span><span class="s3">\n      </span><span class="s1">state.tokenize[state.tokenize.length - 1] = tokenMacro(begin, end, true);</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">meta</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (stream.match(end + </span><span class="s3">\&quot;</span><span class="s1">}</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n      </span><span class="s1">state.currentIndent -= 1;</span><span class="s3">\n      </span><span class="s1">state.tokenize.pop();</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">meta</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return tokenBase(stream, state);</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function tokenMacroDef(stream, state) {</span><span class="s3">\n  </span><span class="s1">if (stream.eatSpace()) {</span><span class="s3">\n    </span><span class="s1">return null;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">var matched;</span><span class="s3">\n  </span><span class="s1">if (matched = stream.match(idents)) {</span><span class="s3">\n    </span><span class="s1">if (matched == </span><span class="s3">\&quot;</span><span class="s1">def</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">keyword</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">stream.eat(/[?!]/);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">state.tokenize.pop();</span><span class="s3">\n  </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">def</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function tokenFollowIdent(stream, state) {</span><span class="s3">\n  </span><span class="s1">if (stream.eatSpace()) {</span><span class="s3">\n    </span><span class="s1">return null;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (stream.match(idents)) {</span><span class="s3">\n    </span><span class="s1">stream.eat(/[!?]/);</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">stream.match(operators) || stream.match(conditionalOperators) || stream.match(indexingOperators);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">state.tokenize.pop();</span><span class="s3">\n  </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">def</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function tokenFollowType(stream, state) {</span><span class="s3">\n  </span><span class="s1">if (stream.eatSpace()) {</span><span class="s3">\n    </span><span class="s1">return null;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">stream.match(types);</span><span class="s3">\n  </span><span class="s1">state.tokenize.pop();</span><span class="s3">\n  </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">def</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function tokenQuote(end, style, embed) {</span><span class="s3">\n  </span><span class="s1">return function (stream, state) {</span><span class="s3">\n    </span><span class="s1">var escaped = false;</span><span class="s3">\n\n    </span><span class="s1">while (stream.peek()) {</span><span class="s3">\n      </span><span class="s1">if (!escaped) {</span><span class="s3">\n        </span><span class="s1">if (stream.match(</span><span class="s3">\&quot;</span><span class="s1">{%</span><span class="s3">\&quot;</span><span class="s1">, false)) {</span><span class="s3">\n          </span><span class="s1">state.tokenize.push(tokenMacro(</span><span class="s3">\&quot;</span><span class="s1">%</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">%</span><span class="s3">\&quot;</span><span class="s1">));</span><span class="s3">\n          </span><span class="s1">return style;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (stream.match(</span><span class="s3">\&quot;</span><span class="s1">{{</span><span class="s3">\&quot;</span><span class="s1">, false)) {</span><span class="s3">\n          </span><span class="s1">state.tokenize.push(tokenMacro(</span><span class="s3">\&quot;</span><span class="s1">{</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">}</span><span class="s3">\&quot;</span><span class="s1">));</span><span class="s3">\n          </span><span class="s1">return style;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (embed &amp;&amp; stream.match(</span><span class="s3">\&quot;</span><span class="s1">#{</span><span class="s3">\&quot;</span><span class="s1">, false)) {</span><span class="s3">\n          </span><span class="s1">state.tokenize.push(tokenNest(</span><span class="s3">\&quot;</span><span class="s1">#{</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">}</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">meta</span><span class="s3">\&quot;</span><span class="s1">));</span><span class="s3">\n          </span><span class="s1">return style;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">var ch = stream.next();</span><span class="s3">\n\n        </span><span class="s1">if (ch == end) {</span><span class="s3">\n          </span><span class="s1">state.tokenize.pop();</span><span class="s3">\n          </span><span class="s1">return style;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">escaped = embed &amp;&amp; ch == </span><span class="s3">\&quot;\\\\\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">stream.next();</span><span class="s3">\n        </span><span class="s1">escaped = false;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return style;</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function tokenHereDoc(phrase, embed) {</span><span class="s3">\n  </span><span class="s1">return function (stream, state) {</span><span class="s3">\n    </span><span class="s1">if (stream.sol()) {</span><span class="s3">\n      </span><span class="s1">stream.eatSpace()</span><span class="s3">\n      </span><span class="s1">if (stream.match(phrase)) {</span><span class="s3">\n        </span><span class="s1">state.tokenize.pop();</span><span class="s3">\n        </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">var escaped = false;</span><span class="s3">\n    </span><span class="s1">while (stream.peek()) {</span><span class="s3">\n      </span><span class="s1">if (!escaped) {</span><span class="s3">\n        </span><span class="s1">if (stream.match(</span><span class="s3">\&quot;</span><span class="s1">{%</span><span class="s3">\&quot;</span><span class="s1">, false)) {</span><span class="s3">\n          </span><span class="s1">state.tokenize.push(tokenMacro(</span><span class="s3">\&quot;</span><span class="s1">%</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">%</span><span class="s3">\&quot;</span><span class="s1">));</span><span class="s3">\n          </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (stream.match(</span><span class="s3">\&quot;</span><span class="s1">{{</span><span class="s3">\&quot;</span><span class="s1">, false)) {</span><span class="s3">\n          </span><span class="s1">state.tokenize.push(tokenMacro(</span><span class="s3">\&quot;</span><span class="s1">{</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">}</span><span class="s3">\&quot;</span><span class="s1">));</span><span class="s3">\n          </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (embed &amp;&amp; stream.match(</span><span class="s3">\&quot;</span><span class="s1">#{</span><span class="s3">\&quot;</span><span class="s1">, false)) {</span><span class="s3">\n          </span><span class="s1">state.tokenize.push(tokenNest(</span><span class="s3">\&quot;</span><span class="s1">#{</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">}</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">meta</span><span class="s3">\&quot;</span><span class="s1">));</span><span class="s3">\n          </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">escaped = stream.next() == </span><span class="s3">\&quot;\\\\\&quot; </span><span class="s1">&amp;&amp; embed;</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">stream.next();</span><span class="s3">\n        </span><span class="s1">escaped = false;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const crystal = {</span><span class="s3">\n  </span><span class="s1">name: </span><span class="s3">\&quot;</span><span class="s1">crystal</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n  </span><span class="s1">startState: function () {</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">tokenize: [tokenBase],</span><span class="s3">\n      </span><span class="s1">currentIndent: 0,</span><span class="s3">\n      </span><span class="s1">lastToken: null,</span><span class="s3">\n      </span><span class="s1">lastStyle: null,</span><span class="s3">\n      </span><span class="s1">blocks: []</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n\n  </span><span class="s1">token: function (stream, state) {</span><span class="s3">\n    </span><span class="s1">var style = state.tokenize[state.tokenize.length - 1](stream, state);</span><span class="s3">\n    </span><span class="s1">var token = stream.current();</span><span class="s3">\n\n    </span><span class="s1">if (style &amp;&amp; style != </span><span class="s3">\&quot;</span><span class="s1">comment</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">state.lastToken = token;</span><span class="s3">\n      </span><span class="s1">state.lastStyle = style;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return style;</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n\n  </span><span class="s1">indent: function (state, textAfter, cx) {</span><span class="s3">\n    </span><span class="s1">textAfter = textAfter.replace(/^</span><span class="s3">\\</span><span class="s1">s*(?:</span><span class="s3">\\</span><span class="s1">{%)?</span><span class="s3">\\</span><span class="s1">s*|</span><span class="s3">\\</span><span class="s1">s*(?:%</span><span class="s3">\\</span><span class="s1">})?</span><span class="s3">\\</span><span class="s1">s*$/g, </span><span class="s3">\&quot;\&quot;</span><span class="s1">);</span><span class="s3">\n\n    </span><span class="s1">if (dedentKeywords.test(textAfter) || dedentPunctuals.test(textAfter)) {</span><span class="s3">\n      </span><span class="s1">return cx.unit * (state.currentIndent - 1);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return cx.unit * state.currentIndent;</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n\n  </span><span class="s1">languageData: {</span><span class="s3">\n    </span><span class="s1">indentOnInput: wordRegExp(dedentPunctualsArray.concat(dedentKeywordsArray), true),</span><span class="s3">\n    </span><span class="s1">commentTokens: {line: </span><span class="s3">\&quot;</span><span class="s1">#</span><span class="s3">\&quot;</span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[],</span><span class="s1">&quot;sourceRoot&quot;</span><span class="s0">:</span><span class="s1">&quot;&quot;</span><span class="s0">}</span></pre>
</body>
</html>