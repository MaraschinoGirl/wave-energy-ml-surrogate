<html>
<head>
<title>5748.5dca396b965fb74427ff.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #6aab73;}
.s2 { color: #2aacb8;}
.s3 { color: #cf8e6d;}
.ln { color: #4b5059; font-weight: normal; font-style: normal; }
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
5748.5dca396b965fb74427ff.js.map</font>
</center></td></tr></table>
<pre><a name="l1"><span class="ln">1    </span></a><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;file&quot;</span><span class="s0">:</span><span class="s1">&quot;5748.5dca396b965fb74427ff.js?v=5dca396b965fb74427ff&quot;</span><span class="s0">,</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;AAE8B;;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAM;;AAIJ;;;;;;;;;;;;AClB4B;;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,qEAAM;AACV;AACA;AACA;AACA;AACA;;AAIE;;;;;;;;;;;;;;;;;ACrB4B;AAGA;AAKA;AAgBA;;AAE9B;AAC2C;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8BAA8B,gFAAqB;AACnD,iCAAiC,qEAAM;AACvC,iBAAiB,4EAAa;AAC9B;AACA,OAAO,wEAAS;AAChB,GAAG;AACH;AACA,CAAC;AACD,gBAAgB,yEAAe;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,8CAA8C;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,SAAS,qEAAM,GAAG,WAAW;AAC7B;AACA,qEAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,qEAAM;AACN,mCAAmC,qEAAM;AACzC;AACA,CAAC;AACD,iCAAiC,qEAAM;AACvC,EAAE,8DAAG;AACL;AACA,oCAAoC;AACpC;AACA;AACA,IAAI;AACJ,IAAI,8DAAG;AACP;AACA,CAAC;AACD,iCAAiC,qEAAM;AACvC;AACA,CAAC;AACD,6BAA6B,qEAAM;AACnC;AACA;AACA;AACA;AACA,EAAE,8DAAG;AACL,EAAE,8DAAG;AACL;AACA,OAAO,yEAAc;AACrB,QAAQ,yEAAc;AACtB,4BAA4B,yEAAc;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,8DAAG;AACL;AACA;AACA,EAAE,8DAAG;AACL,CAAC;AACD,6BAA6B,qEAAM;AACnC;AACA;AACA,SAAS,yEAAc;AACvB;AACA;AACA,kIAAkI,KAAK;AACvI;AACA;AACA;AACA,yCAAyC,aAAa;AACtD;AACA,EAAE,8DAAG;AACL,CAAC;AACD,4BAA4B,qEAAM;AAClC;AACA;AACA;AACA;AACA;AACA,gBAAgB,yEAAc;AAC9B;AACA,eAAe,yEAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,YAAY;AACxD;AACA;AACA;AACA;AACA,qBAAqB,YAAY;AACjC,sBAAsB,YAAY;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,yBAAyB;AAC9E;AACA;AACA,qBAAqB,YAAY;AACjC,sBAAsB,YAAY;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,YAAY;AACjC,sBAAsB,YAAY;AAClC,2BAA2B,YAAY;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,YAAY;AACjC,sBAAsB,YAAY;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,YAAY;AACjC,sBAAsB,YAAY;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,aAAa,EAAE,UAAU,EAAE,cAAc,EAAE,sBAAsB;AACtF,sBAAsB,aAAa,EAAE,UAAU,EAAE,cAAc,EAAE,sBAAsB;AACvF;AACA,iBAAiB,aAAa,EAAE,SAAS,UAAU,cAAc,EAAE,sBAAsB;AACzF;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB,GAAG,QAAQ;AACpD,8BAA8B,aAAa,OAAO,yBAAyB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,8DAAG;AACL,EAAE,8DAAG;AACL,CAAC;AACD,iCAAiC,qEAAM;AACvC;AACA;AACA;AACA;AACA,EAAE,8DAAG;AACL;AACA,aAAa,yEAAc;AAC3B,aAAa,yEAAc;AAC3B,4BAA4B,yEAAc;AAC1C,mBAAmB,yEAAc;AACjC;AACA;AACA;AACA;AACA;AACA,0BAA0B,UAAU,EAAE,SAAS;AAC/C,2BAA2B,UAAU,EAAE,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,UAAU,EAAE,SAAS;AACjD,6BAA6B,UAAU,EAAE,SAAS;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,yBAAyB;AACtF;AACA;AACA,4BAA4B,UAAU,EAAE,SAAS;AACjD,6BAA6B,UAAU,EAAE,SAAS;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,yBAAyB;AACtF;AACA;AACA,4BAA4B,UAAU,EAAE,SAAS;AACjD,6BAA6B,UAAU,EAAE,SAAS;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,uBAAuB,OAAO,yBAAyB;AACvF;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB,EAAE,oDAAoD,eAAe,OAAO;AACnH;AACA;AACA;AACA;AACA;AACA,IAAI,8DAAG;AACP,IAAI,8DAAG;AACP;AACA,CAAC;AACD,+BAA+B,qEAAM;AACrC,YAAY,yEAAc;AAC1B;AACA;AACA,qFAAqF,QAAQ;AAC7F;AACA;AACA,wBAAwB,QAAQ;AAChC,yBAAyB,QAAQ;AACjC,2BAA2B,QAAQ;AACnC;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,qEAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,8DAAG;AACL;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAM;AACN,kCAAkC,qEAAM;AACxC,EAAE,8DAAG;AACL;AACA;AACA,CAAC;AACD,6BAA6B,qEAAM;AACnC;AACA,EAAE,oEAAK;AACP,CAAC;AACD,4CAA4C,qEAAM;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,EAAE;AAC/B;AACA,GAAG,yDAAyD,MAAM,QAAQ,MAAM;AAChF;AACA,CAAC;AACD,kCAAkC,qEAAM;AACxC;AACA,CAAC;AACD,iCAAiC,qEAAM;AACvC;AACA,CAAC;AACD,sCAAsC,qEAAM;AAC5C;AACA;AACA,IAAI,8DAAG;AACP,GAAG;AACH;AACA;AACA,CAAC;AACD,uCAAuC,qEAAM;AAC7C;AACA,CAAC;AACD,mCAAmC,qEAAM;AACzC;AACA,CAAC;AACD,8BAA8B,qEAAM;AACpC;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,aAAa;AACb,mBAAmB;AACnB,mBAAmB;AACnB,iBAAiB;AACjB,iBAAiB;AACjB;;AAEA;AACA,+BAA+B,qEAAM;AACrC,EAAE,8EAAgB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,qCAAqC,qEAAM;AAC3C;AACA,4BAA4B,qEAAM;AAClC,4BAA4B,qEAAM;AAClC,2BAA2B,qEAAM;AACjC,8BAA8B,qEAAM;AACpC,mCAAmC,qEAAM;AACzC;AACA;AACA;AACA;AACA,IAAI;AACJ,IAAI,8DAAG,kCAAkC,gBAAgB;AACzD;AACA,CAAC;AACD,kCAAkC,qEAAM;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,kCAAkC,qEAAM;AACxC;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,iCAAiC,qEAAM;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,oCAAoC,qEAAM;AAC1C;AACA;AACA,CAAC;AACD,yCAAyC,qEAAM;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,yBAAyB,qEAAM;AAC/B,sBAAsB,mEAAK;AAC3B,IAAI,8DAAG;AACP;AACA,GAAG;AACH;AACA;AACA,UAAU,uBAAuB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,6BAA6B;AAChF,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,mDAAmD,6BAA6B;AAChF;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AAC4B;AAC5B,qBAAqB,yEAAU;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,qEAAM;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,+BAA+B,qEAAM;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,CAAC;AACD,wCAAwC,qEAAM;AAC9C;AACA;AACA;AACA;AACA,qCAAqC,qEAAM;AAC3C;AACA,IAAI;AACJ,qCAAqC,qEAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,CAAC;AACD,0CAA0C,qEAAM;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,CAAC;AACD,uCAAuC,qEAAM;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,IAAI;AACtD;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,MAAM;AACxC;AACA,GAAG;AACH,CAAC;AACD,2CAA2C,qEAAM;AACjD;AACA;AACA,2DAA2D,WAAW;AACtE;AACA;AACA;AACA,oEAAoE,WAAW;AAC/E;AACA;AACA,CAAC;AACD,8CAA8C,qEAAM;AACpD;AACA;AACA,CAAC;AACD,wCAAwC,qEAAM;AAC9C;AACA;AACA,mDAAmD,WAAW;AAC9D;AACA;AACA;AACA,8BAA8B,MAAM;AACpC,WAAW;AACX,CAAC;AACD,sCAAsC,qEAAM;AAC5C;AACA;AACA,mDAAmD,WAAW;AAC9D;AACA;AACA;AACA,8BAA8B,MAAM;AACpC,CAAC;AACD,uCAAuC,qEAAM;AAC7C;AACA;AACA;AACA,gBAAgB,YAAY,kBAAkB,iCAAiC,EAAE,UAAU;AAC3F;AACA;AACA;AACA,gBAAgB,YAAY,QAAQ,iCAAiC,EAAE,UAAU;AACjF;AACA,IAAI;AACJ,8HAA8H,YAAY,EAAE,UAAU;AACtJ,6JAA6J,YAAY,EAAE,UAAU;AACrL,6JAA6J,YAAY,EAAE,UAAU;AACrL,2MAA2M,YAAY,EAAE,UAAU;AACnO,2MAA2M,YAAY,EAAE,UAAU;AACnO,IAAI;AACJ;AACA;AACA;AACA;AACA,mCAAmC,YAAY,QAAQ,gCAAgC;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,WAAW,EAAE,YAAY,QAAQ,gCAAgC;AACnF;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,qBAAqB,GAAG,qBAAqB,GAAG,qBAAqB,GAAG,qBAAqB,GAAG,qBAAqB,GAAG,qBAAqB,GAAG,qBAAqB,GAAG,qBAAqB;AAC1M,gCAAgC,WAAW,EAAE,YAAY,QAAQ,gCAAgC;AACjG;AACA;AACA,CAAC;AACD,sCAAsC,qEAAM;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,qCAAqC,qEAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,iBAAiB,qCAAqC;AACtD;AACA;AACA;AACA;AACA;AACA,QAAQ,mCAAmC,GAAG;AAC9C,QAAQ,mCAAmC,GAAG;AAC9C,QAAQ,wDAAwD,GAAG;AACnE,QAAQ,wDAAwD,GAAG;AACnE,QAAQ,wDAAwD,GAAG;AACnE,QAAQ,wDAAwD,GAAG,aAAa;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,iBAAiB,GAAG;AAC9B,UAAU,iBAAiB,GAAG;AAC9B,UAAU,iCAAiC,GAAG;AAC9C,UAAU,uDAAuD,GAAG;AACpE,UAAU,uDAAuD,GAAG;AACpE,UAAU,iCAAiC,GAAG,iBAAiB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,yCAAyC,qEAAM;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,wCAAwC,qEAAM;AAC9C,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,CAAC;AACD,wCAAwC,qEAAM;AAC9C;AACA;AACA;AACA;AACA,0DAA0D,WAAW;AACrE;AACA,WAAW;AACX,CAAC;AACD,kCAAkC,qEAAM;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,qEAAM;AACzC;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,IAAI;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,sDAAsD;AACxF,MAAM;AACN,kCAAkC,sDAAsD;AACxF;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC;AACD,yCAAyC,qEAAM;AAC/C;AACA;AACA,+CAA+C,qEAAM;AACrD,2CAA2C,qEAAM;AACjD;AACA;AACA,GAAG;AACH,CAAC;AACD,+BAA+B,qEAAM;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,gCAAgC,qEAAM;AACtC;AACA;AACA;AACA,8DAA8D,YAAY,MAAM,WAAW;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,MAAM,EAAE,MAAM,IAAI,gBAAgB,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,eAAe,IAAI,OAAO,EAAE,eAAe,EAAE,KAAK,EAAE,gBAAgB,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACjL,QAAQ;AACR;AACA,uBAAuB,MAAM,EAAE,MAAM,IAAI,gBAAgB,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,eAAe,IAAI,OAAO,EAAE,eAAe,EAAE,MAAM,EAAE,gBAAgB,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACjL;AACA,MAAM;AACN;AACA,uBAAuB,MAAM,EAAE,MAAM,IAAI,gBAAgB,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,eAAe,IAAI,OAAO,EAAE,eAAe,EAAE,MAAM,EAAE,gBAAgB,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACjL,QAAQ;AACR;AACA,uBAAuB,MAAM,EAAE,MAAM,IAAI,gBAAgB,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,eAAe,IAAI,OAAO,EAAE,eAAe,EAAE,KAAK,EAAE,gBAAgB,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACjL;AACA,MAAM;AACN;AACA,uBAAuB,MAAM,EAAE,MAAM,IAAI,MAAM,EAAE,gBAAgB,EAAE,KAAK,EAAE,eAAe,EAAE,OAAO,IAAI,eAAe,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,gBAAgB,IAAI,MAAM,EAAE,KAAK;AACjL,QAAQ;AACR;AACA,uBAAuB,MAAM,EAAE,MAAM,IAAI,MAAM,EAAE,gBAAgB,EAAE,MAAM,EAAE,eAAe,EAAE,OAAO,IAAI,eAAe,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE,gBAAgB,IAAI,MAAM,EAAE,KAAK;AACjL;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,MAAM,EAAE,MAAM,IAAI,MAAM,EAAE,eAAe,EAAE,KAAK,EAAE,eAAe,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACnH,UAAU;AACV,yBAAyB,MAAM,EAAE,MAAM,IAAI,eAAe,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,eAAe,IAAI,MAAM,EAAE,KAAK;AACpH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,MAAM,EAAE,MAAM,IAAI,MAAM,EAAE,eAAe,EAAE,MAAM,EAAE,eAAe,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACpH,UAAU;AACV,yBAAyB,MAAM,EAAE,MAAM,IAAI,eAAe,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,eAAe,IAAI,MAAM,EAAE,KAAK;AACnH;AACA;AACA;AACA,uBAAuB,MAAM,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACtD;AACA,MAAM;AACN;AACA;AACA,yBAAyB,MAAM,EAAE,MAAM,IAAI,MAAM,EAAE,eAAe,EAAE,MAAM,EAAE,eAAe,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACpH,UAAU;AACV,yBAAyB,MAAM,EAAE,MAAM,IAAI,eAAe,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,eAAe,IAAI,MAAM,EAAE,KAAK;AACnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,MAAM,EAAE,MAAM,IAAI,MAAM,EAAE,eAAe,EAAE,KAAK,EAAE,eAAe,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACnH,UAAU;AACV,yBAAyB,MAAM,EAAE,MAAM,IAAI,eAAe,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,eAAe,IAAI,MAAM,EAAE,KAAK;AACnH;AACA;AACA;AACA,uBAAuB,MAAM,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACtD;AACA,MAAM;AACN;AACA;AACA,yBAAyB,MAAM,EAAE,MAAM,IAAI,eAAe,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,eAAe,IAAI,MAAM,EAAE,KAAK;AACpH,UAAU;AACV,yBAAyB,MAAM,EAAE,MAAM,IAAI,MAAM,EAAE,eAAe,EAAE,KAAK,EAAE,eAAe,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACnH;AACA;AACA;AACA;AACA,yBAAyB,MAAM,EAAE,MAAM,IAAI,eAAe,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,eAAe,IAAI,MAAM,EAAE,KAAK;AACnH,UAAU;AACV,yBAAyB,MAAM,EAAE,MAAM,IAAI,MAAM,EAAE,eAAe,EAAE,MAAM,EAAE,eAAe,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACpH;AACA;AACA;AACA,uBAAuB,MAAM,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,iCAAiC,qEAAM;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH,CAAC;AACD,mCAAmC,qEAAM;AACzC;AACA;AACA;AACA;AACA;AACA,uDAAuD,aAAa;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,GAAG;AACH,CAAC;AACD,wCAAwC,qEAAM;AAC9C,wBAAwB,YAAY;AACpC;AACA;AACA,CAAC;AACD,2BAA2B,qEAAM;AACjC;AACA,EAAE,8DAAG;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,oDAAM,SAAS,GAAG;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,wEAAa;AACf;AACA;AACA;AACA;AACA;AACA,EAAE,iFAAiB;AACnB;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,UAAU,uBAAuB;AACjC;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,qEAAM;AACpC;AACA;AACA;AACA;AACA;AACA,8CAA8C,kBAAkB;AAChE;AACA;AACA,iDAAiD,eAAe;AAChE,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,8CAA8C,kBAAkB;AAChE;AACA;AACA;AACA,iDAAiD,eAAe;AAChE,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,kBAAkB;AAC9C,+BAA+B,6BAA6B;AAC5D,+BAA+B,6BAA6B;AAC5D;AACA;AACA;AACA;AACA,yBAAyB,gCAAgC;AACzD,sBAAsB,2CAA2C;AACjE,sBAAsB,6CAA6C;AACnE,sBAAsB,kCAAkC;AACxD,sBAAsB,6CAA6C;AACnE,8BAA8B,6CAA6C;AAC3E,sBAAsB,6CAA6C;AACnE,8BAA8B,6CAA6C;AAC3E;AACA;AACA,0DAA0D,IAAI;AAC9D;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA,yBAAyB,gCAAgC;AACzD,sBAAsB,2CAA2C;AACjE,sBAAsB,6CAA6C;AACnE,sBAAsB,kCAAkC;AACxD,sBAAsB,6CAA6C;AACnE,8BAA8B,6CAA6C;AAC3E,sBAAsB,6CAA6C;AACnE,8BAA8B,6CAA6C;AAC3E;AACA;AACA,0DAA0D,IAAI;AAC9D;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,IAAI;AAChE;AACA;AACA,SAAS;AACT,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,aAAa;AACnC,sBAAsB,aAAa;AACnC,sBAAsB,yBAAyB;AAC/C,sBAAsB,yBAAyB;AAC/C,sBAAsB,yBAAyB;AAC/C,sBAAsB,yBAAyB;AAC/C,sBAAsB,cAAc;AACpC,sBAAsB,cAAc;AACpC;AACA;AACA,sBAAsB,cAAc;AACpC,sBAAsB,cAAc;AACpC,sBAAsB,yBAAyB;AAC/C,sBAAsB,wBAAwB;AAC9C,sBAAsB,yBAAyB;AAC/C,sBAAsB,wBAAwB;AAC9C,sBAAsB,cAAc;AACpC,sBAAsB,aAAa;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,kBAAkB;AAChD,iCAAiC,6BAA6B;AAC9D,iCAAiC,6BAA6B;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,kBAAkB;AAChD,iCAAiC,6BAA6B;AAC9D,iCAAiC,6BAA6B;AAC9D;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA;AACA,+BAA+B,YAAY;AAC3C,+BAA+B,YAAY;AAC3C,+BAA+B,YAAY;AAC3C;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA,gCAAgC,qEAAM;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,uBAAuB,KAAK,QAAQ;AACpC,iBAAiB,KAAK,UAAU,qBAAqB,QAAQ;AAC7D,2BAA2B,KAAK,UAAU,wBAAwB,QAAQ;AAC1E,gBAAgB,MAAM,QAAQ;AAC9B,gBAAgB,KAAK,UAAU;AAC/B;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA,kBAAkB,aAAa,8BAA8B,QAAQ;AACrE,sBAAsB,aAAa,8BAA8B,QAAQ,gCAAgC;AACzG,eAAe,aAAa,2BAA2B,QAAQ;AAC/D,mBAAmB,QAAQ,6BAA6B,UAAU;AAClE,cAAc,QAAQ;;AAEtB;AACA,cAAc;AACd,YAAY;AACZ;AACA;AACA,cAAc;AACd,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,YAAY;AACZ;;AAEA,WAAW,iBAAiB,uBAAuB;AACnD;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGE&quot;</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/mermaid/dist/chunks/mermaid.core/chunk-4BMEZGHF.mjs&quot;</span><span class="s0">,</span><span class="s1">&quot;webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/mermaid/dist/chunks/mermaid.core/chunk-XZIHB7SX.mjs&quot;</span><span class="s0">,</span><span class="s1">&quot;webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/mermaid/dist/chunks/mermaid.core/gitGraphDiagram-7IBYFJ6S.mjs&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">__name</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./chunk-YTJNT7DU.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/common/populateCommonDb.ts</span><span class="s3">\n</span><span class="s1">function populateCommonDb(ast, db) {</span><span class="s3">\n  </span><span class="s1">if (ast.accDescr) {</span><span class="s3">\n    </span><span class="s1">db.setAccDescription?.(ast.accDescr);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (ast.accTitle) {</span><span class="s3">\n    </span><span class="s1">db.setAccTitle?.(ast.accTitle);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (ast.title) {</span><span class="s3">\n    </span><span class="s1">db.setDiagramTitle?.(ast.title);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">__name(populateCommonDb, </span><span class="s3">\&quot;</span><span class="s1">populateCommonDb</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">export {</span><span class="s3">\n  </span><span class="s1">populateCommonDb</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">,</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">__name</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./chunk-YTJNT7DU.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">// src/utils/imperativeState.ts</span><span class="s3">\n</span><span class="s1">var ImperativeState = class {</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param init - Function that creates the default state.</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">constructor(init) {</span><span class="s3">\n    </span><span class="s1">this.init = init;</span><span class="s3">\n    </span><span class="s1">this.records = this.init();</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">static {</span><span class="s3">\n    </span><span class="s1">__name(this, </span><span class="s3">\&quot;</span><span class="s1">ImperativeState</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">reset() {</span><span class="s3">\n    </span><span class="s1">this.records = this.init();</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">export {</span><span class="s3">\n  </span><span class="s1">ImperativeState</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">,</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">populateCommonDb</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./chunk-4BMEZGHF.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">ImperativeState</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./chunk-XZIHB7SX.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">cleanAndMerge,</span><span class="s3">\n  </span><span class="s1">random,</span><span class="s3">\n  </span><span class="s1">utils_default</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./chunk-O4NI6UNU.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">__name,</span><span class="s3">\n  </span><span class="s1">clear,</span><span class="s3">\n  </span><span class="s1">common_default,</span><span class="s3">\n  </span><span class="s1">defaultConfig_default,</span><span class="s3">\n  </span><span class="s1">getAccDescription,</span><span class="s3">\n  </span><span class="s1">getAccTitle,</span><span class="s3">\n  </span><span class="s1">getConfig,</span><span class="s3">\n  </span><span class="s1">getConfig2,</span><span class="s3">\n  </span><span class="s1">getDiagramTitle,</span><span class="s3">\n  </span><span class="s1">log,</span><span class="s3">\n  </span><span class="s1">setAccDescription,</span><span class="s3">\n  </span><span class="s1">setAccTitle,</span><span class="s3">\n  </span><span class="s1">setDiagramTitle,</span><span class="s3">\n  </span><span class="s1">setupGraphViewbox2 as setupGraphViewbox</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./chunk-YTJNT7DU.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/git/gitGraphParser.ts</span><span class="s3">\n</span><span class="s1">import { parse } from </span><span class="s3">\&quot;</span><span class="s1">@mermaid-js/parser</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/git/gitGraphTypes.ts</span><span class="s3">\n</span><span class="s1">var commitType = {</span><span class="s3">\n  </span><span class="s1">NORMAL: 0,</span><span class="s3">\n  </span><span class="s1">REVERSE: 1,</span><span class="s3">\n  </span><span class="s1">HIGHLIGHT: 2,</span><span class="s3">\n  </span><span class="s1">MERGE: 3,</span><span class="s3">\n  </span><span class="s1">CHERRY_PICK: 4</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/git/gitGraphAst.ts</span><span class="s3">\n</span><span class="s1">var DEFAULT_GITGRAPH_CONFIG = defaultConfig_default.gitGraph;</span><span class="s3">\n</span><span class="s1">var getConfig3 = /* @__PURE__ */ __name(() =&gt; {</span><span class="s3">\n  </span><span class="s1">const config = cleanAndMerge({</span><span class="s3">\n    </span><span class="s1">...DEFAULT_GITGRAPH_CONFIG,</span><span class="s3">\n    </span><span class="s1">...getConfig().gitGraph</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">return config;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getConfig</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var state = new ImperativeState(() =&gt; {</span><span class="s3">\n  </span><span class="s1">const config = getConfig3();</span><span class="s3">\n  </span><span class="s1">const mainBranchName = config.mainBranchName;</span><span class="s3">\n  </span><span class="s1">const mainBranchOrder = config.mainBranchOrder;</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">mainBranchName,</span><span class="s3">\n    </span><span class="s1">commits: /* @__PURE__ */ new Map(),</span><span class="s3">\n    </span><span class="s1">head: null,</span><span class="s3">\n    </span><span class="s1">branchConfig: /* @__PURE__ */ new Map([[mainBranchName, { name: mainBranchName, order: mainBranchOrder }]]),</span><span class="s3">\n    </span><span class="s1">branches: /* @__PURE__ */ new Map([[mainBranchName, null]]),</span><span class="s3">\n    </span><span class="s1">currBranch: mainBranchName,</span><span class="s3">\n    </span><span class="s1">direction: </span><span class="s3">\&quot;</span><span class="s1">LR</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">seq: 0,</span><span class="s3">\n    </span><span class="s1">options: {}</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n</span><span class="s1">});</span><span class="s3">\n</span><span class="s1">function getID() {</span><span class="s3">\n  </span><span class="s1">return random({ length: 7 });</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">__name(getID, </span><span class="s3">\&quot;</span><span class="s1">getID</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">function uniqBy(list, fn) {</span><span class="s3">\n  </span><span class="s1">const recordMap = /* @__PURE__ */ Object.create(null);</span><span class="s3">\n  </span><span class="s1">return list.reduce((out, item) =&gt; {</span><span class="s3">\n    </span><span class="s1">const key = fn(item);</span><span class="s3">\n    </span><span class="s1">if (!recordMap[key]) {</span><span class="s3">\n      </span><span class="s1">recordMap[key] = true;</span><span class="s3">\n      </span><span class="s1">out.push(item);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return out;</span><span class="s3">\n  </span><span class="s1">}, []);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">__name(uniqBy, </span><span class="s3">\&quot;</span><span class="s1">uniqBy</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var setDirection = /* @__PURE__ */ __name(function(dir2) {</span><span class="s3">\n  </span><span class="s1">state.records.direction = dir2;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">setDirection</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var setOptions = /* @__PURE__ */ __name(function(rawOptString) {</span><span class="s3">\n  </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">options str</span><span class="s3">\&quot;</span><span class="s1">, rawOptString);</span><span class="s3">\n  </span><span class="s1">rawOptString = rawOptString?.trim();</span><span class="s3">\n  </span><span class="s1">rawOptString = rawOptString || </span><span class="s3">\&quot;</span><span class="s1">{}</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">state.records.options = JSON.parse(rawOptString);</span><span class="s3">\n  </span><span class="s1">} catch (e) {</span><span class="s3">\n    </span><span class="s1">log.error(</span><span class="s3">\&quot;</span><span class="s1">error while parsing gitGraph options</span><span class="s3">\&quot;</span><span class="s1">, e.message);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">setOptions</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var getOptions = /* @__PURE__ */ __name(function() {</span><span class="s3">\n  </span><span class="s1">return state.records.options;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getOptions</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var commit = /* @__PURE__ */ __name(function(commitDB) {</span><span class="s3">\n  </span><span class="s1">let msg = commitDB.msg;</span><span class="s3">\n  </span><span class="s1">let id = commitDB.id;</span><span class="s3">\n  </span><span class="s1">const type = commitDB.type;</span><span class="s3">\n  </span><span class="s1">let tags = commitDB.tags;</span><span class="s3">\n  </span><span class="s1">log.info(</span><span class="s3">\&quot;</span><span class="s1">commit</span><span class="s3">\&quot;</span><span class="s1">, msg, id, type, tags);</span><span class="s3">\n  </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">Entering commit:</span><span class="s3">\&quot;</span><span class="s1">, msg, id, type, tags);</span><span class="s3">\n  </span><span class="s1">const config = getConfig3();</span><span class="s3">\n  </span><span class="s1">id = common_default.sanitizeText(id, config);</span><span class="s3">\n  </span><span class="s1">msg = common_default.sanitizeText(msg, config);</span><span class="s3">\n  </span><span class="s1">tags = tags?.map((tag) =&gt; common_default.sanitizeText(tag, config));</span><span class="s3">\n  </span><span class="s1">const newCommit = {</span><span class="s3">\n    </span><span class="s1">id: id ? id : state.records.seq + </span><span class="s3">\&quot;</span><span class="s1">-</span><span class="s3">\&quot; </span><span class="s1">+ getID(),</span><span class="s3">\n    </span><span class="s1">message: msg,</span><span class="s3">\n    </span><span class="s1">seq: state.records.seq++,</span><span class="s3">\n    </span><span class="s1">type: type ?? commitType.NORMAL,</span><span class="s3">\n    </span><span class="s1">tags: tags ?? [],</span><span class="s3">\n    </span><span class="s1">parents: state.records.head == null ? [] : [state.records.head.id],</span><span class="s3">\n    </span><span class="s1">branch: state.records.currBranch</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">state.records.head = newCommit;</span><span class="s3">\n  </span><span class="s1">log.info(</span><span class="s3">\&quot;</span><span class="s1">main branch</span><span class="s3">\&quot;</span><span class="s1">, config.mainBranchName);</span><span class="s3">\n  </span><span class="s1">state.records.commits.set(newCommit.id, newCommit);</span><span class="s3">\n  </span><span class="s1">state.records.branches.set(state.records.currBranch, newCommit.id);</span><span class="s3">\n  </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">in pushCommit </span><span class="s3">\&quot; </span><span class="s1">+ newCommit.id);</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">commit</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var branch = /* @__PURE__ */ __name(function(branchDB) {</span><span class="s3">\n  </span><span class="s1">let name = branchDB.name;</span><span class="s3">\n  </span><span class="s1">const order = branchDB.order;</span><span class="s3">\n  </span><span class="s1">name = common_default.sanitizeText(name, getConfig3());</span><span class="s3">\n  </span><span class="s1">if (state.records.branches.has(name)) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`Trying to create an existing branch. (Help: Either use a new name if you want create a new branch or try using </span><span class="s3">\&quot;</span><span class="s1">checkout ${name}</span><span class="s3">\&quot;</span><span class="s1">)`</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">state.records.branches.set(name, state.records.head != null ? state.records.head.id : null);</span><span class="s3">\n  </span><span class="s1">state.records.branchConfig.set(name, { name, order });</span><span class="s3">\n  </span><span class="s1">checkout(name);</span><span class="s3">\n  </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">in createBranch</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">branch</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var merge = /* @__PURE__ */ __name((mergeDB) =&gt; {</span><span class="s3">\n  </span><span class="s1">let otherBranch = mergeDB.branch;</span><span class="s3">\n  </span><span class="s1">let customId = mergeDB.id;</span><span class="s3">\n  </span><span class="s1">const overrideType = mergeDB.type;</span><span class="s3">\n  </span><span class="s1">const customTags = mergeDB.tags;</span><span class="s3">\n  </span><span class="s1">const config = getConfig3();</span><span class="s3">\n  </span><span class="s1">otherBranch = common_default.sanitizeText(otherBranch, config);</span><span class="s3">\n  </span><span class="s1">if (customId) {</span><span class="s3">\n    </span><span class="s1">customId = common_default.sanitizeText(customId, config);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const currentBranchCheck = state.records.branches.get(state.records.currBranch);</span><span class="s3">\n  </span><span class="s1">const otherBranchCheck = state.records.branches.get(otherBranch);</span><span class="s3">\n  </span><span class="s1">const currentCommit = currentBranchCheck ? state.records.commits.get(currentBranchCheck) : void 0;</span><span class="s3">\n  </span><span class="s1">const otherCommit = otherBranchCheck ? state.records.commits.get(otherBranchCheck) : void 0;</span><span class="s3">\n  </span><span class="s1">if (currentCommit &amp;&amp; otherCommit &amp;&amp; currentCommit.branch === otherBranch) {</span><span class="s3">\n    </span><span class="s1">throw new Error(`Cannot merge branch '${otherBranch}' into itself.`);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (state.records.currBranch === otherBranch) {</span><span class="s3">\n    </span><span class="s1">const error = new Error('Incorrect usage of </span><span class="s3">\&quot;</span><span class="s1">merge</span><span class="s3">\&quot;</span><span class="s1">. Cannot merge a branch to itself');</span><span class="s3">\n    </span><span class="s1">error.hash = {</span><span class="s3">\n      </span><span class="s1">text: `merge ${otherBranch}`,</span><span class="s3">\n      </span><span class="s1">token: `merge ${otherBranch}`,</span><span class="s3">\n      </span><span class="s1">expected: [</span><span class="s3">\&quot;</span><span class="s1">branch abc</span><span class="s3">\&quot;</span><span class="s1">]</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n    </span><span class="s1">throw error;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (currentCommit === void 0 || !currentCommit) {</span><span class="s3">\n    </span><span class="s1">const error = new Error(</span><span class="s3">\n      </span><span class="s1">`Incorrect usage of </span><span class="s3">\&quot;</span><span class="s1">merge</span><span class="s3">\&quot;</span><span class="s1">. Current branch (${state.records.currBranch})has no commits`</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">error.hash = {</span><span class="s3">\n      </span><span class="s1">text: `merge ${otherBranch}`,</span><span class="s3">\n      </span><span class="s1">token: `merge ${otherBranch}`,</span><span class="s3">\n      </span><span class="s1">expected: [</span><span class="s3">\&quot;</span><span class="s1">commit</span><span class="s3">\&quot;</span><span class="s1">]</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n    </span><span class="s1">throw error;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (!state.records.branches.has(otherBranch)) {</span><span class="s3">\n    </span><span class="s1">const error = new Error(</span><span class="s3">\n      </span><span class="s1">'Incorrect usage of </span><span class="s3">\&quot;</span><span class="s1">merge</span><span class="s3">\&quot;</span><span class="s1">. Branch to be merged (' + otherBranch + </span><span class="s3">\&quot;</span><span class="s1">) does not exist</span><span class="s3">\&quot;\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">error.hash = {</span><span class="s3">\n      </span><span class="s1">text: `merge ${otherBranch}`,</span><span class="s3">\n      </span><span class="s1">token: `merge ${otherBranch}`,</span><span class="s3">\n      </span><span class="s1">expected: [`branch ${otherBranch}`]</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n    </span><span class="s1">throw error;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (otherCommit === void 0 || !otherCommit) {</span><span class="s3">\n    </span><span class="s1">const error = new Error(</span><span class="s3">\n      </span><span class="s1">'Incorrect usage of </span><span class="s3">\&quot;</span><span class="s1">merge</span><span class="s3">\&quot;</span><span class="s1">. Branch to be merged (' + otherBranch + </span><span class="s3">\&quot;</span><span class="s1">) has no commits</span><span class="s3">\&quot;\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">error.hash = {</span><span class="s3">\n      </span><span class="s1">text: `merge ${otherBranch}`,</span><span class="s3">\n      </span><span class="s1">token: `merge ${otherBranch}`,</span><span class="s3">\n      </span><span class="s1">expected: ['</span><span class="s3">\&quot;</span><span class="s1">commit</span><span class="s3">\&quot;</span><span class="s1">']</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n    </span><span class="s1">throw error;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (currentCommit === otherCommit) {</span><span class="s3">\n    </span><span class="s1">const error = new Error('Incorrect usage of </span><span class="s3">\&quot;</span><span class="s1">merge</span><span class="s3">\&quot;</span><span class="s1">. Both branches have same head');</span><span class="s3">\n    </span><span class="s1">error.hash = {</span><span class="s3">\n      </span><span class="s1">text: `merge ${otherBranch}`,</span><span class="s3">\n      </span><span class="s1">token: `merge ${otherBranch}`,</span><span class="s3">\n      </span><span class="s1">expected: [</span><span class="s3">\&quot;</span><span class="s1">branch abc</span><span class="s3">\&quot;</span><span class="s1">]</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n    </span><span class="s1">throw error;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (customId &amp;&amp; state.records.commits.has(customId)) {</span><span class="s3">\n    </span><span class="s1">const error = new Error(</span><span class="s3">\n      </span><span class="s1">'Incorrect usage of </span><span class="s3">\&quot;</span><span class="s1">merge</span><span class="s3">\&quot;</span><span class="s1">. Commit with id:' + customId + </span><span class="s3">\&quot; </span><span class="s1">already exists, use different custom Id</span><span class="s3">\&quot;\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">error.hash = {</span><span class="s3">\n      </span><span class="s1">text: `merge ${otherBranch} ${customId} ${overrideType} ${customTags?.join(</span><span class="s3">\&quot; \&quot;</span><span class="s1">)}`,</span><span class="s3">\n      </span><span class="s1">token: `merge ${otherBranch} ${customId} ${overrideType} ${customTags?.join(</span><span class="s3">\&quot; \&quot;</span><span class="s1">)}`,</span><span class="s3">\n      </span><span class="s1">expected: [</span><span class="s3">\n        </span><span class="s1">`merge ${otherBranch} ${customId}_UNIQUE ${overrideType} ${customTags?.join(</span><span class="s3">\&quot; \&quot;</span><span class="s1">)}`</span><span class="s3">\n      </span><span class="s1">]</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n    </span><span class="s1">throw error;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const verifiedBranch = otherBranchCheck ? otherBranchCheck : </span><span class="s3">\&quot;\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">const commit2 = {</span><span class="s3">\n    </span><span class="s1">id: customId || `${state.records.seq}-${getID()}`,</span><span class="s3">\n    </span><span class="s1">message: `merged branch ${otherBranch} into ${state.records.currBranch}`,</span><span class="s3">\n    </span><span class="s1">seq: state.records.seq++,</span><span class="s3">\n    </span><span class="s1">parents: state.records.head == null ? [] : [state.records.head.id, verifiedBranch],</span><span class="s3">\n    </span><span class="s1">branch: state.records.currBranch,</span><span class="s3">\n    </span><span class="s1">type: commitType.MERGE,</span><span class="s3">\n    </span><span class="s1">customType: overrideType,</span><span class="s3">\n    </span><span class="s1">customId: customId ? true : false,</span><span class="s3">\n    </span><span class="s1">tags: customTags ?? []</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">state.records.head = commit2;</span><span class="s3">\n  </span><span class="s1">state.records.commits.set(commit2.id, commit2);</span><span class="s3">\n  </span><span class="s1">state.records.branches.set(state.records.currBranch, commit2.id);</span><span class="s3">\n  </span><span class="s1">log.debug(state.records.branches);</span><span class="s3">\n  </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">in mergeBranch</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">merge</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var cherryPick = /* @__PURE__ */ __name(function(cherryPickDB) {</span><span class="s3">\n  </span><span class="s1">let sourceId = cherryPickDB.id;</span><span class="s3">\n  </span><span class="s1">let targetId = cherryPickDB.targetId;</span><span class="s3">\n  </span><span class="s1">let tags = cherryPickDB.tags;</span><span class="s3">\n  </span><span class="s1">let parentCommitId = cherryPickDB.parent;</span><span class="s3">\n  </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">Entering cherryPick:</span><span class="s3">\&quot;</span><span class="s1">, sourceId, targetId, tags);</span><span class="s3">\n  </span><span class="s1">const config = getConfig3();</span><span class="s3">\n  </span><span class="s1">sourceId = common_default.sanitizeText(sourceId, config);</span><span class="s3">\n  </span><span class="s1">targetId = common_default.sanitizeText(targetId, config);</span><span class="s3">\n  </span><span class="s1">tags = tags?.map((tag) =&gt; common_default.sanitizeText(tag, config));</span><span class="s3">\n  </span><span class="s1">parentCommitId = common_default.sanitizeText(parentCommitId, config);</span><span class="s3">\n  </span><span class="s1">if (!sourceId || !state.records.commits.has(sourceId)) {</span><span class="s3">\n    </span><span class="s1">const error = new Error(</span><span class="s3">\n      </span><span class="s1">'Incorrect usage of </span><span class="s3">\&quot;</span><span class="s1">cherryPick</span><span class="s3">\&quot;</span><span class="s1">. Source commit id should exist and provided'</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">error.hash = {</span><span class="s3">\n      </span><span class="s1">text: `cherryPick ${sourceId} ${targetId}`,</span><span class="s3">\n      </span><span class="s1">token: `cherryPick ${sourceId} ${targetId}`,</span><span class="s3">\n      </span><span class="s1">expected: [</span><span class="s3">\&quot;</span><span class="s1">cherry-pick abc</span><span class="s3">\&quot;</span><span class="s1">]</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n    </span><span class="s1">throw error;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const sourceCommit = state.records.commits.get(sourceId);</span><span class="s3">\n  </span><span class="s1">if (sourceCommit === void 0 || !sourceCommit) {</span><span class="s3">\n    </span><span class="s1">throw new Error('Incorrect usage of </span><span class="s3">\&quot;</span><span class="s1">cherryPick</span><span class="s3">\&quot;</span><span class="s1">. Source commit id should exist and provided');</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (parentCommitId &amp;&amp; !(Array.isArray(sourceCommit.parents) &amp;&amp; sourceCommit.parents.includes(parentCommitId))) {</span><span class="s3">\n    </span><span class="s1">const error = new Error(</span><span class="s3">\n      \&quot;</span><span class="s1">Invalid operation: The specified parent commit is not an immediate parent of the cherry-picked commit.</span><span class="s3">\&quot;\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">throw error;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const sourceCommitBranch = sourceCommit.branch;</span><span class="s3">\n  </span><span class="s1">if (sourceCommit.type === commitType.MERGE &amp;&amp; !parentCommitId) {</span><span class="s3">\n    </span><span class="s1">const error = new Error(</span><span class="s3">\n      \&quot;</span><span class="s1">Incorrect usage of cherry-pick: If the source commit is a merge commit, an immediate parent commit must be specified.</span><span class="s3">\&quot;\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">throw error;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (!targetId || !state.records.commits.has(targetId)) {</span><span class="s3">\n    </span><span class="s1">if (sourceCommitBranch === state.records.currBranch) {</span><span class="s3">\n      </span><span class="s1">const error = new Error(</span><span class="s3">\n        </span><span class="s1">'Incorrect usage of </span><span class="s3">\&quot;</span><span class="s1">cherryPick</span><span class="s3">\&quot;</span><span class="s1">. Source commit is already on current branch'</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">error.hash = {</span><span class="s3">\n        </span><span class="s1">text: `cherryPick ${sourceId} ${targetId}`,</span><span class="s3">\n        </span><span class="s1">token: `cherryPick ${sourceId} ${targetId}`,</span><span class="s3">\n        </span><span class="s1">expected: [</span><span class="s3">\&quot;</span><span class="s1">cherry-pick abc</span><span class="s3">\&quot;</span><span class="s1">]</span><span class="s3">\n      </span><span class="s1">};</span><span class="s3">\n      </span><span class="s1">throw error;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const currentCommitId = state.records.branches.get(state.records.currBranch);</span><span class="s3">\n    </span><span class="s1">if (currentCommitId === void 0 || !currentCommitId) {</span><span class="s3">\n      </span><span class="s1">const error = new Error(</span><span class="s3">\n        </span><span class="s1">`Incorrect usage of </span><span class="s3">\&quot;</span><span class="s1">cherry-pick</span><span class="s3">\&quot;</span><span class="s1">. Current branch (${state.records.currBranch})has no commits`</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">error.hash = {</span><span class="s3">\n        </span><span class="s1">text: `cherryPick ${sourceId} ${targetId}`,</span><span class="s3">\n        </span><span class="s1">token: `cherryPick ${sourceId} ${targetId}`,</span><span class="s3">\n        </span><span class="s1">expected: [</span><span class="s3">\&quot;</span><span class="s1">cherry-pick abc</span><span class="s3">\&quot;</span><span class="s1">]</span><span class="s3">\n      </span><span class="s1">};</span><span class="s3">\n      </span><span class="s1">throw error;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const currentCommit = state.records.commits.get(currentCommitId);</span><span class="s3">\n    </span><span class="s1">if (currentCommit === void 0 || !currentCommit) {</span><span class="s3">\n      </span><span class="s1">const error = new Error(</span><span class="s3">\n        </span><span class="s1">`Incorrect usage of </span><span class="s3">\&quot;</span><span class="s1">cherry-pick</span><span class="s3">\&quot;</span><span class="s1">. Current branch (${state.records.currBranch})has no commits`</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">error.hash = {</span><span class="s3">\n        </span><span class="s1">text: `cherryPick ${sourceId} ${targetId}`,</span><span class="s3">\n        </span><span class="s1">token: `cherryPick ${sourceId} ${targetId}`,</span><span class="s3">\n        </span><span class="s1">expected: [</span><span class="s3">\&quot;</span><span class="s1">cherry-pick abc</span><span class="s3">\&quot;</span><span class="s1">]</span><span class="s3">\n      </span><span class="s1">};</span><span class="s3">\n      </span><span class="s1">throw error;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const commit2 = {</span><span class="s3">\n      </span><span class="s1">id: state.records.seq + </span><span class="s3">\&quot;</span><span class="s1">-</span><span class="s3">\&quot; </span><span class="s1">+ getID(),</span><span class="s3">\n      </span><span class="s1">message: `cherry-picked ${sourceCommit?.message} into ${state.records.currBranch}`,</span><span class="s3">\n      </span><span class="s1">seq: state.records.seq++,</span><span class="s3">\n      </span><span class="s1">parents: state.records.head == null ? [] : [state.records.head.id, sourceCommit.id],</span><span class="s3">\n      </span><span class="s1">branch: state.records.currBranch,</span><span class="s3">\n      </span><span class="s1">type: commitType.CHERRY_PICK,</span><span class="s3">\n      </span><span class="s1">tags: tags ? tags.filter(Boolean) : [</span><span class="s3">\n        </span><span class="s1">`cherry-pick:${sourceCommit.id}${sourceCommit.type === commitType.MERGE ? `|parent:${parentCommitId}` : </span><span class="s3">\&quot;\&quot;</span><span class="s1">}`</span><span class="s3">\n      </span><span class="s1">]</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n    </span><span class="s1">state.records.head = commit2;</span><span class="s3">\n    </span><span class="s1">state.records.commits.set(commit2.id, commit2);</span><span class="s3">\n    </span><span class="s1">state.records.branches.set(state.records.currBranch, commit2.id);</span><span class="s3">\n    </span><span class="s1">log.debug(state.records.branches);</span><span class="s3">\n    </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">in cherryPick</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">cherryPick</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var checkout = /* @__PURE__ */ __name(function(branch2) {</span><span class="s3">\n  </span><span class="s1">branch2 = common_default.sanitizeText(branch2, getConfig3());</span><span class="s3">\n  </span><span class="s1">if (!state.records.branches.has(branch2)) {</span><span class="s3">\n    </span><span class="s1">const error = new Error(</span><span class="s3">\n      </span><span class="s1">`Trying to checkout branch which is not yet created. (Help try using </span><span class="s3">\&quot;</span><span class="s1">branch ${branch2}</span><span class="s3">\&quot;</span><span class="s1">)`</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">error.hash = {</span><span class="s3">\n      </span><span class="s1">text: `checkout ${branch2}`,</span><span class="s3">\n      </span><span class="s1">token: `checkout ${branch2}`,</span><span class="s3">\n      </span><span class="s1">expected: [`branch ${branch2}`]</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n    </span><span class="s1">throw error;</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">state.records.currBranch = branch2;</span><span class="s3">\n    </span><span class="s1">const id = state.records.branches.get(state.records.currBranch);</span><span class="s3">\n    </span><span class="s1">if (id === void 0 || !id) {</span><span class="s3">\n      </span><span class="s1">state.records.head = null;</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">state.records.head = state.records.commits.get(id) ?? null;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">checkout</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">function upsert(arr, key, newVal) {</span><span class="s3">\n  </span><span class="s1">const index = arr.indexOf(key);</span><span class="s3">\n  </span><span class="s1">if (index === -1) {</span><span class="s3">\n    </span><span class="s1">arr.push(newVal);</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">arr.splice(index, 1, newVal);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">__name(upsert, </span><span class="s3">\&quot;</span><span class="s1">upsert</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">function prettyPrintCommitHistory(commitArr) {</span><span class="s3">\n  </span><span class="s1">const commit2 = commitArr.reduce((out, commit3) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (out.seq &gt; commit3.seq) {</span><span class="s3">\n      </span><span class="s1">return out;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return commit3;</span><span class="s3">\n  </span><span class="s1">}, commitArr[0]);</span><span class="s3">\n  </span><span class="s1">let line = </span><span class="s3">\&quot;\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">commitArr.forEach(function(c) {</span><span class="s3">\n    </span><span class="s1">if (c === commit2) {</span><span class="s3">\n      </span><span class="s1">line += </span><span class="s3">\&quot;\t</span><span class="s1">*</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">line += </span><span class="s3">\&quot;\t</span><span class="s1">|</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">const label = [line, commit2.id, commit2.seq];</span><span class="s3">\n  </span><span class="s1">for (const branch2 in state.records.branches) {</span><span class="s3">\n    </span><span class="s1">if (state.records.branches.get(branch2) === commit2.id) {</span><span class="s3">\n      </span><span class="s1">label.push(branch2);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">log.debug(label.join(</span><span class="s3">\&quot; \&quot;</span><span class="s1">));</span><span class="s3">\n  </span><span class="s1">if (commit2.parents &amp;&amp; commit2.parents.length == 2 &amp;&amp; commit2.parents[0] &amp;&amp; commit2.parents[1]) {</span><span class="s3">\n    </span><span class="s1">const newCommit = state.records.commits.get(commit2.parents[0]);</span><span class="s3">\n    </span><span class="s1">upsert(commitArr, commit2, newCommit);</span><span class="s3">\n    </span><span class="s1">if (commit2.parents[1]) {</span><span class="s3">\n      </span><span class="s1">commitArr.push(state.records.commits.get(commit2.parents[1]));</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else if (commit2.parents.length == 0) {</span><span class="s3">\n    </span><span class="s1">return;</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">if (commit2.parents[0]) {</span><span class="s3">\n      </span><span class="s1">const newCommit = state.records.commits.get(commit2.parents[0]);</span><span class="s3">\n      </span><span class="s1">upsert(commitArr, commit2, newCommit);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">commitArr = uniqBy(commitArr, (c) =&gt; c.id);</span><span class="s3">\n  </span><span class="s1">prettyPrintCommitHistory(commitArr);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">__name(prettyPrintCommitHistory, </span><span class="s3">\&quot;</span><span class="s1">prettyPrintCommitHistory</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var prettyPrint = /* @__PURE__ */ __name(function() {</span><span class="s3">\n  </span><span class="s1">log.debug(state.records.commits);</span><span class="s3">\n  </span><span class="s1">const node = getCommitsArray()[0];</span><span class="s3">\n  </span><span class="s1">prettyPrintCommitHistory([node]);</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">prettyPrint</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var clear2 = /* @__PURE__ */ __name(function() {</span><span class="s3">\n  </span><span class="s1">state.reset();</span><span class="s3">\n  </span><span class="s1">clear();</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">clear</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var getBranchesAsObjArray = /* @__PURE__ */ __name(function() {</span><span class="s3">\n  </span><span class="s1">const branchesArray = [...state.records.branchConfig.values()].map((branchConfig, i) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (branchConfig.order !== null &amp;&amp; branchConfig.order !== void 0) {</span><span class="s3">\n      </span><span class="s1">return branchConfig;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return {</span><span class="s3">\n      </span><span class="s1">...branchConfig,</span><span class="s3">\n      </span><span class="s1">order: parseFloat(`0.${i}`)</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">}).sort((a, b) =&gt; (a.order ?? 0) - (b.order ?? 0)).map(({ name }) =&gt; ({ name }));</span><span class="s3">\n  </span><span class="s1">return branchesArray;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getBranchesAsObjArray</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var getBranches = /* @__PURE__ */ __name(function() {</span><span class="s3">\n  </span><span class="s1">return state.records.branches;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getBranches</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var getCommits = /* @__PURE__ */ __name(function() {</span><span class="s3">\n  </span><span class="s1">return state.records.commits;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getCommits</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var getCommitsArray = /* @__PURE__ */ __name(function() {</span><span class="s3">\n  </span><span class="s1">const commitArr = [...state.records.commits.values()];</span><span class="s3">\n  </span><span class="s1">commitArr.forEach(function(o) {</span><span class="s3">\n    </span><span class="s1">log.debug(o.id);</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">commitArr.sort((a, b) =&gt; a.seq - b.seq);</span><span class="s3">\n  </span><span class="s1">return commitArr;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getCommitsArray</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var getCurrentBranch = /* @__PURE__ */ __name(function() {</span><span class="s3">\n  </span><span class="s1">return state.records.currBranch;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getCurrentBranch</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var getDirection = /* @__PURE__ */ __name(function() {</span><span class="s3">\n  </span><span class="s1">return state.records.direction;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getDirection</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var getHead = /* @__PURE__ */ __name(function() {</span><span class="s3">\n  </span><span class="s1">return state.records.head;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getHead</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var db = {</span><span class="s3">\n  </span><span class="s1">commitType,</span><span class="s3">\n  </span><span class="s1">getConfig: getConfig3,</span><span class="s3">\n  </span><span class="s1">setDirection,</span><span class="s3">\n  </span><span class="s1">setOptions,</span><span class="s3">\n  </span><span class="s1">getOptions,</span><span class="s3">\n  </span><span class="s1">commit,</span><span class="s3">\n  </span><span class="s1">branch,</span><span class="s3">\n  </span><span class="s1">merge,</span><span class="s3">\n  </span><span class="s1">cherryPick,</span><span class="s3">\n  </span><span class="s1">checkout,</span><span class="s3">\n  </span><span class="s1">//reset,</span><span class="s3">\n  </span><span class="s1">prettyPrint,</span><span class="s3">\n  </span><span class="s1">clear: clear2,</span><span class="s3">\n  </span><span class="s1">getBranchesAsObjArray,</span><span class="s3">\n  </span><span class="s1">getBranches,</span><span class="s3">\n  </span><span class="s1">getCommits,</span><span class="s3">\n  </span><span class="s1">getCommitsArray,</span><span class="s3">\n  </span><span class="s1">getCurrentBranch,</span><span class="s3">\n  </span><span class="s1">getDirection,</span><span class="s3">\n  </span><span class="s1">getHead,</span><span class="s3">\n  </span><span class="s1">setAccTitle,</span><span class="s3">\n  </span><span class="s1">getAccTitle,</span><span class="s3">\n  </span><span class="s1">getAccDescription,</span><span class="s3">\n  </span><span class="s1">setAccDescription,</span><span class="s3">\n  </span><span class="s1">setDiagramTitle,</span><span class="s3">\n  </span><span class="s1">getDiagramTitle</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/git/gitGraphParser.ts</span><span class="s3">\n</span><span class="s1">var populate = /* @__PURE__ */ __name((ast, db2) =&gt; {</span><span class="s3">\n  </span><span class="s1">populateCommonDb(ast, db2);</span><span class="s3">\n  </span><span class="s1">if (ast.dir) {</span><span class="s3">\n    </span><span class="s1">db2.setDirection(ast.dir);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">for (const statement of ast.statements) {</span><span class="s3">\n    </span><span class="s1">parseStatement(statement, db2);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">populate</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var parseStatement = /* @__PURE__ */ __name((statement, db2) =&gt; {</span><span class="s3">\n  </span><span class="s1">const parsers = {</span><span class="s3">\n    </span><span class="s1">Commit: /* @__PURE__ */ __name((stmt) =&gt; db2.commit(parseCommit(stmt)), </span><span class="s3">\&quot;</span><span class="s1">Commit</span><span class="s3">\&quot;</span><span class="s1">),</span><span class="s3">\n    </span><span class="s1">Branch: /* @__PURE__ */ __name((stmt) =&gt; db2.branch(parseBranch(stmt)), </span><span class="s3">\&quot;</span><span class="s1">Branch</span><span class="s3">\&quot;</span><span class="s1">),</span><span class="s3">\n    </span><span class="s1">Merge: /* @__PURE__ */ __name((stmt) =&gt; db2.merge(parseMerge(stmt)), </span><span class="s3">\&quot;</span><span class="s1">Merge</span><span class="s3">\&quot;</span><span class="s1">),</span><span class="s3">\n    </span><span class="s1">Checkout: /* @__PURE__ */ __name((stmt) =&gt; db2.checkout(parseCheckout(stmt)), </span><span class="s3">\&quot;</span><span class="s1">Checkout</span><span class="s3">\&quot;</span><span class="s1">),</span><span class="s3">\n    </span><span class="s1">CherryPicking: /* @__PURE__ */ __name((stmt) =&gt; db2.cherryPick(parseCherryPicking(stmt)), </span><span class="s3">\&quot;</span><span class="s1">CherryPicking</span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">const parser2 = parsers[statement.$type];</span><span class="s3">\n  </span><span class="s1">if (parser2) {</span><span class="s3">\n    </span><span class="s1">parser2(statement);</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">log.error(`Unknown statement type: ${statement.$type}`);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">parseStatement</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var parseCommit = /* @__PURE__ */ __name((commit2) =&gt; {</span><span class="s3">\n  </span><span class="s1">const commitDB = {</span><span class="s3">\n    </span><span class="s1">id: commit2.id,</span><span class="s3">\n    </span><span class="s1">msg: commit2.message ?? </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">type: commit2.type !== void 0 ? commitType[commit2.type] : commitType.NORMAL,</span><span class="s3">\n    </span><span class="s1">tags: commit2.tags ?? void 0</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">return commitDB;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">parseCommit</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var parseBranch = /* @__PURE__ */ __name((branch2) =&gt; {</span><span class="s3">\n  </span><span class="s1">const branchDB = {</span><span class="s3">\n    </span><span class="s1">name: branch2.name,</span><span class="s3">\n    </span><span class="s1">order: branch2.order ?? 0</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">return branchDB;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">parseBranch</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var parseMerge = /* @__PURE__ */ __name((merge2) =&gt; {</span><span class="s3">\n  </span><span class="s1">const mergeDB = {</span><span class="s3">\n    </span><span class="s1">branch: merge2.branch,</span><span class="s3">\n    </span><span class="s1">id: merge2.id ?? </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">type: merge2.type !== void 0 ? commitType[merge2.type] : void 0,</span><span class="s3">\n    </span><span class="s1">tags: merge2.tags ?? void 0</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">return mergeDB;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">parseMerge</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var parseCheckout = /* @__PURE__ */ __name((checkout2) =&gt; {</span><span class="s3">\n  </span><span class="s1">const branch2 = checkout2.branch;</span><span class="s3">\n  </span><span class="s1">return branch2;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">parseCheckout</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var parseCherryPicking = /* @__PURE__ */ __name((cherryPicking) =&gt; {</span><span class="s3">\n  </span><span class="s1">const cherryPickDB = {</span><span class="s3">\n    </span><span class="s1">id: cherryPicking.id,</span><span class="s3">\n    </span><span class="s1">targetId: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">tags: cherryPicking.tags?.length === 0 ? void 0 : cherryPicking.tags,</span><span class="s3">\n    </span><span class="s1">parent: cherryPicking.parent</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">return cherryPickDB;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">parseCherryPicking</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var parser = {</span><span class="s3">\n  </span><span class="s1">parse: /* @__PURE__ */ __name(async (input) =&gt; {</span><span class="s3">\n    </span><span class="s1">const ast = await parse(</span><span class="s3">\&quot;</span><span class="s1">gitGraph</span><span class="s3">\&quot;</span><span class="s1">, input);</span><span class="s3">\n    </span><span class="s1">log.debug(ast);</span><span class="s3">\n    </span><span class="s1">populate(ast, db);</span><span class="s3">\n  </span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">parse</span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">if (void 0) {</span><span class="s3">\n  </span><span class="s1">const { it, expect, describe } = void 0;</span><span class="s3">\n  </span><span class="s1">const mockDB = {</span><span class="s3">\n    </span><span class="s1">commitType,</span><span class="s3">\n    </span><span class="s1">setDirection: vi.fn(),</span><span class="s3">\n    </span><span class="s1">commit: vi.fn(),</span><span class="s3">\n    </span><span class="s1">branch: vi.fn(),</span><span class="s3">\n    </span><span class="s1">merge: vi.fn(),</span><span class="s3">\n    </span><span class="s1">cherryPick: vi.fn(),</span><span class="s3">\n    </span><span class="s1">checkout: vi.fn()</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">describe(</span><span class="s3">\&quot;</span><span class="s1">GitGraph Parser</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n    </span><span class="s1">it(</span><span class="s3">\&quot;</span><span class="s1">should parse a commit statement</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">const commit2 = {</span><span class="s3">\n        </span><span class="s1">$type: </span><span class="s3">\&quot;</span><span class="s1">Commit</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">1</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">message: </span><span class="s3">\&quot;</span><span class="s1">test</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">tags: [</span><span class="s3">\&quot;</span><span class="s1">tag1</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag2</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">type: </span><span class="s3">\&quot;</span><span class="s1">NORMAL</span><span class="s3">\&quot;\n      </span><span class="s1">};</span><span class="s3">\n      </span><span class="s1">parseStatement(commit2, mockDB);</span><span class="s3">\n      </span><span class="s1">expect(mockDB.commit).toHaveBeenCalledWith({</span><span class="s3">\n        </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">1</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">msg: </span><span class="s3">\&quot;</span><span class="s1">test</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">tags: [</span><span class="s3">\&quot;</span><span class="s1">tag1</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag2</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">type: 0</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">it(</span><span class="s3">\&quot;</span><span class="s1">should parse a branch statement</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">const branch2 = {</span><span class="s3">\n        </span><span class="s1">$type: </span><span class="s3">\&quot;</span><span class="s1">Branch</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">name: </span><span class="s3">\&quot;</span><span class="s1">newBranch</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">order: 1</span><span class="s3">\n      </span><span class="s1">};</span><span class="s3">\n      </span><span class="s1">parseStatement(branch2, mockDB);</span><span class="s3">\n      </span><span class="s1">expect(mockDB.branch).toHaveBeenCalledWith({ name: </span><span class="s3">\&quot;</span><span class="s1">newBranch</span><span class="s3">\&quot;</span><span class="s1">, order: 1 });</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">it(</span><span class="s3">\&quot;</span><span class="s1">should parse a checkout statement</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">const checkout2 = {</span><span class="s3">\n        </span><span class="s1">$type: </span><span class="s3">\&quot;</span><span class="s1">Checkout</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">newBranch</span><span class="s3">\&quot;\n      </span><span class="s1">};</span><span class="s3">\n      </span><span class="s1">parseStatement(checkout2, mockDB);</span><span class="s3">\n      </span><span class="s1">expect(mockDB.checkout).toHaveBeenCalledWith(</span><span class="s3">\&quot;</span><span class="s1">newBranch</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">it(</span><span class="s3">\&quot;</span><span class="s1">should parse a merge statement</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">const merge2 = {</span><span class="s3">\n        </span><span class="s1">$type: </span><span class="s3">\&quot;</span><span class="s1">Merge</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">newBranch</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">1</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">tags: [</span><span class="s3">\&quot;</span><span class="s1">tag1</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag2</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">type: </span><span class="s3">\&quot;</span><span class="s1">NORMAL</span><span class="s3">\&quot;\n      </span><span class="s1">};</span><span class="s3">\n      </span><span class="s1">parseStatement(merge2, mockDB);</span><span class="s3">\n      </span><span class="s1">expect(mockDB.merge).toHaveBeenCalledWith({</span><span class="s3">\n        </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">newBranch</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">1</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">tags: [</span><span class="s3">\&quot;</span><span class="s1">tag1</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag2</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">type: 0</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">it(</span><span class="s3">\&quot;</span><span class="s1">should parse a cherry picking statement</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">const cherryPick2 = {</span><span class="s3">\n        </span><span class="s1">$type: </span><span class="s3">\&quot;</span><span class="s1">CherryPicking</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">1</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">tags: [</span><span class="s3">\&quot;</span><span class="s1">tag1</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag2</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">parent: </span><span class="s3">\&quot;</span><span class="s1">2</span><span class="s3">\&quot;\n      </span><span class="s1">};</span><span class="s3">\n      </span><span class="s1">parseStatement(cherryPick2, mockDB);</span><span class="s3">\n      </span><span class="s1">expect(mockDB.cherryPick).toHaveBeenCalledWith({</span><span class="s3">\n        </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">1</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">targetId: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">parent: </span><span class="s3">\&quot;</span><span class="s1">2</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">tags: [</span><span class="s3">\&quot;</span><span class="s1">tag1</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag2</span><span class="s3">\&quot;</span><span class="s1">]</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">it(</span><span class="s3">\&quot;</span><span class="s1">should parse a langium generated gitGraph ast</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">const dummy = {</span><span class="s3">\n        </span><span class="s1">$type: </span><span class="s3">\&quot;</span><span class="s1">GitGraph</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">statements: []</span><span class="s3">\n      </span><span class="s1">};</span><span class="s3">\n      </span><span class="s1">const gitGraphAst = {</span><span class="s3">\n        </span><span class="s1">$type: </span><span class="s3">\&quot;</span><span class="s1">GitGraph</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">statements: [</span><span class="s3">\n          </span><span class="s1">{</span><span class="s3">\n            </span><span class="s1">$container: dummy,</span><span class="s3">\n            </span><span class="s1">$type: </span><span class="s3">\&quot;</span><span class="s1">Commit</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">1</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            </span><span class="s1">message: </span><span class="s3">\&quot;</span><span class="s1">test</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            </span><span class="s1">tags: [</span><span class="s3">\&quot;</span><span class="s1">tag1</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag2</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n            </span><span class="s1">type: </span><span class="s3">\&quot;</span><span class="s1">NORMAL</span><span class="s3">\&quot;\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">{</span><span class="s3">\n            </span><span class="s1">$container: dummy,</span><span class="s3">\n            </span><span class="s1">$type: </span><span class="s3">\&quot;</span><span class="s1">Branch</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            </span><span class="s1">name: </span><span class="s3">\&quot;</span><span class="s1">newBranch</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            </span><span class="s1">order: 1</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">{</span><span class="s3">\n            </span><span class="s1">$container: dummy,</span><span class="s3">\n            </span><span class="s1">$type: </span><span class="s3">\&quot;</span><span class="s1">Merge</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">newBranch</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">1</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            </span><span class="s1">tags: [</span><span class="s3">\&quot;</span><span class="s1">tag1</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag2</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n            </span><span class="s1">type: </span><span class="s3">\&quot;</span><span class="s1">NORMAL</span><span class="s3">\&quot;\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">{</span><span class="s3">\n            </span><span class="s1">$container: dummy,</span><span class="s3">\n            </span><span class="s1">$type: </span><span class="s3">\&quot;</span><span class="s1">Checkout</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">newBranch</span><span class="s3">\&quot;\n          </span><span class="s1">},</span><span class="s3">\n          </span><span class="s1">{</span><span class="s3">\n            </span><span class="s1">$container: dummy,</span><span class="s3">\n            </span><span class="s1">$type: </span><span class="s3">\&quot;</span><span class="s1">CherryPicking</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">1</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            </span><span class="s1">tags: [</span><span class="s3">\&quot;</span><span class="s1">tag1</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag2</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n            </span><span class="s1">parent: </span><span class="s3">\&quot;</span><span class="s1">2</span><span class="s3">\&quot;\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">]</span><span class="s3">\n      </span><span class="s1">};</span><span class="s3">\n      </span><span class="s1">populate(gitGraphAst, mockDB);</span><span class="s3">\n      </span><span class="s1">expect(mockDB.commit).toHaveBeenCalledWith({</span><span class="s3">\n        </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">1</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">msg: </span><span class="s3">\&quot;</span><span class="s1">test</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">tags: [</span><span class="s3">\&quot;</span><span class="s1">tag1</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag2</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">type: 0</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n      </span><span class="s1">expect(mockDB.branch).toHaveBeenCalledWith({ name: </span><span class="s3">\&quot;</span><span class="s1">newBranch</span><span class="s3">\&quot;</span><span class="s1">, order: 1 });</span><span class="s3">\n      </span><span class="s1">expect(mockDB.merge).toHaveBeenCalledWith({</span><span class="s3">\n        </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">newBranch</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">1</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">tags: [</span><span class="s3">\&quot;</span><span class="s1">tag1</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag2</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">type: 0</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n      </span><span class="s1">expect(mockDB.checkout).toHaveBeenCalledWith(</span><span class="s3">\&quot;</span><span class="s1">newBranch</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/git/gitGraphRenderer.ts</span><span class="s3">\n</span><span class="s1">import { select } from </span><span class="s3">\&quot;</span><span class="s1">d3</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">var DEFAULT_CONFIG = getConfig2();</span><span class="s3">\n</span><span class="s1">var DEFAULT_GITGRAPH_CONFIG2 = DEFAULT_CONFIG?.gitGraph;</span><span class="s3">\n</span><span class="s1">var LAYOUT_OFFSET = 10;</span><span class="s3">\n</span><span class="s1">var COMMIT_STEP = 40;</span><span class="s3">\n</span><span class="s1">var PX = 4;</span><span class="s3">\n</span><span class="s1">var PY = 2;</span><span class="s3">\n</span><span class="s1">var THEME_COLOR_LIMIT = 8;</span><span class="s3">\n</span><span class="s1">var branchPos = /* @__PURE__ */ new Map();</span><span class="s3">\n</span><span class="s1">var commitPos = /* @__PURE__ */ new Map();</span><span class="s3">\n</span><span class="s1">var defaultPos = 30;</span><span class="s3">\n</span><span class="s1">var allCommitsDict = /* @__PURE__ */ new Map();</span><span class="s3">\n</span><span class="s1">var lanes = [];</span><span class="s3">\n</span><span class="s1">var maxPos = 0;</span><span class="s3">\n</span><span class="s1">var dir = </span><span class="s3">\&quot;</span><span class="s1">LR</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">var clear3 = /* @__PURE__ */ __name(() =&gt; {</span><span class="s3">\n  </span><span class="s1">branchPos.clear();</span><span class="s3">\n  </span><span class="s1">commitPos.clear();</span><span class="s3">\n  </span><span class="s1">allCommitsDict.clear();</span><span class="s3">\n  </span><span class="s1">maxPos = 0;</span><span class="s3">\n  </span><span class="s1">lanes = [];</span><span class="s3">\n  </span><span class="s1">dir = </span><span class="s3">\&quot;</span><span class="s1">LR</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">clear</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawText = /* @__PURE__ */ __name((txt) =&gt; {</span><span class="s3">\n  </span><span class="s1">const svgLabel = document.createElementNS(</span><span class="s3">\&quot;</span><span class="s1">http://www.w3.org/2000/svg</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">text</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">const rows = typeof txt === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot; </span><span class="s1">? txt.split(/</span><span class="s3">\\\\</span><span class="s1">n|</span><span class="s3">\\</span><span class="s1">n|&lt;br</span><span class="s3">\\</span><span class="s1">s*</span><span class="s3">\\</span><span class="s1">/?&gt;/gi) : txt;</span><span class="s3">\n  </span><span class="s1">rows.forEach((row) =&gt; {</span><span class="s3">\n    </span><span class="s1">const tspan = document.createElementNS(</span><span class="s3">\&quot;</span><span class="s1">http://www.w3.org/2000/svg</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tspan</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">tspan.setAttributeNS(</span><span class="s3">\&quot;</span><span class="s1">http://www.w3.org/XML/1998/namespace</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">xml:space</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">preserve</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">tspan.setAttribute(</span><span class="s3">\&quot;</span><span class="s1">dy</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">1em</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">tspan.setAttribute(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">0</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">tspan.setAttribute(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">row</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">tspan.textContent = row.trim();</span><span class="s3">\n    </span><span class="s1">svgLabel.appendChild(tspan);</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">return svgLabel;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawText</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var findClosestParent = /* @__PURE__ */ __name((parents) =&gt; {</span><span class="s3">\n  </span><span class="s1">let closestParent;</span><span class="s3">\n  </span><span class="s1">let comparisonFunc;</span><span class="s3">\n  </span><span class="s1">let targetPosition;</span><span class="s3">\n  </span><span class="s1">if (dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">comparisonFunc = /* @__PURE__ */ __name((a, b) =&gt; a &lt;= b, </span><span class="s3">\&quot;</span><span class="s1">comparisonFunc</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">targetPosition = Infinity;</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">comparisonFunc = /* @__PURE__ */ __name((a, b) =&gt; a &gt;= b, </span><span class="s3">\&quot;</span><span class="s1">comparisonFunc</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">targetPosition = 0;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">parents.forEach((parent) =&gt; {</span><span class="s3">\n    </span><span class="s1">const parentPosition = dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot; </span><span class="s1">|| dir == </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot; </span><span class="s1">? commitPos.get(parent)?.y : commitPos.get(parent)?.x;</span><span class="s3">\n    </span><span class="s1">if (parentPosition !== void 0 &amp;&amp; comparisonFunc(parentPosition, targetPosition)) {</span><span class="s3">\n      </span><span class="s1">closestParent = parent;</span><span class="s3">\n      </span><span class="s1">targetPosition = parentPosition;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">return closestParent;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">findClosestParent</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var findClosestParentBT = /* @__PURE__ */ __name((parents) =&gt; {</span><span class="s3">\n  </span><span class="s1">let closestParent = </span><span class="s3">\&quot;\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">let maxPosition = Infinity;</span><span class="s3">\n  </span><span class="s1">parents.forEach((parent) =&gt; {</span><span class="s3">\n    </span><span class="s1">const parentPosition = commitPos.get(parent).y;</span><span class="s3">\n    </span><span class="s1">if (parentPosition &lt;= maxPosition) {</span><span class="s3">\n      </span><span class="s1">closestParent = parent;</span><span class="s3">\n      </span><span class="s1">maxPosition = parentPosition;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">return closestParent || void 0;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">findClosestParentBT</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var setParallelBTPos = /* @__PURE__ */ __name((sortedKeys, commits, defaultPos2) =&gt; {</span><span class="s3">\n  </span><span class="s1">let curPos = defaultPos2;</span><span class="s3">\n  </span><span class="s1">let maxPosition = defaultPos2;</span><span class="s3">\n  </span><span class="s1">const roots = [];</span><span class="s3">\n  </span><span class="s1">sortedKeys.forEach((key) =&gt; {</span><span class="s3">\n    </span><span class="s1">const commit2 = commits.get(key);</span><span class="s3">\n    </span><span class="s1">if (!commit2) {</span><span class="s3">\n      </span><span class="s1">throw new Error(`Commit not found for key ${key}`);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">if (commit2.parents.length) {</span><span class="s3">\n      </span><span class="s1">curPos = calculateCommitPosition(commit2);</span><span class="s3">\n      </span><span class="s1">maxPosition = Math.max(curPos, maxPosition);</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">roots.push(commit2);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">setCommitPosition(commit2, curPos);</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">curPos = maxPosition;</span><span class="s3">\n  </span><span class="s1">roots.forEach((commit2) =&gt; {</span><span class="s3">\n    </span><span class="s1">setRootPosition(commit2, curPos, defaultPos2);</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">sortedKeys.forEach((key) =&gt; {</span><span class="s3">\n    </span><span class="s1">const commit2 = commits.get(key);</span><span class="s3">\n    </span><span class="s1">if (commit2?.parents.length) {</span><span class="s3">\n      </span><span class="s1">const closestParent = findClosestParentBT(commit2.parents);</span><span class="s3">\n      </span><span class="s1">curPos = commitPos.get(closestParent).y - COMMIT_STEP;</span><span class="s3">\n      </span><span class="s1">if (curPos &lt;= maxPosition) {</span><span class="s3">\n        </span><span class="s1">maxPosition = curPos;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">const x = branchPos.get(commit2.branch).pos;</span><span class="s3">\n      </span><span class="s1">const y = curPos - LAYOUT_OFFSET;</span><span class="s3">\n      </span><span class="s1">commitPos.set(commit2.id, { x, y });</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">setParallelBTPos</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var findClosestParentPos = /* @__PURE__ */ __name((commit2) =&gt; {</span><span class="s3">\n  </span><span class="s1">const closestParent = findClosestParent(commit2.parents.filter((p) =&gt; p !== null));</span><span class="s3">\n  </span><span class="s1">if (!closestParent) {</span><span class="s3">\n    </span><span class="s1">throw new Error(`Closest parent not found for commit ${commit2.id}`);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const closestParentPos = commitPos.get(closestParent)?.y;</span><span class="s3">\n  </span><span class="s1">if (closestParentPos === void 0) {</span><span class="s3">\n    </span><span class="s1">throw new Error(`Closest parent position not found for commit ${commit2.id}`);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return closestParentPos;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">findClosestParentPos</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var calculateCommitPosition = /* @__PURE__ */ __name((commit2) =&gt; {</span><span class="s3">\n  </span><span class="s1">const closestParentPos = findClosestParentPos(commit2);</span><span class="s3">\n  </span><span class="s1">return closestParentPos + COMMIT_STEP;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">calculateCommitPosition</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var setCommitPosition = /* @__PURE__ */ __name((commit2, curPos) =&gt; {</span><span class="s3">\n  </span><span class="s1">const branch2 = branchPos.get(commit2.branch);</span><span class="s3">\n  </span><span class="s1">if (!branch2) {</span><span class="s3">\n    </span><span class="s1">throw new Error(`Branch not found for commit ${commit2.id}`);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const x = branch2.pos;</span><span class="s3">\n  </span><span class="s1">const y = curPos + LAYOUT_OFFSET;</span><span class="s3">\n  </span><span class="s1">commitPos.set(commit2.id, { x, y });</span><span class="s3">\n  </span><span class="s1">return { x, y };</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">setCommitPosition</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var setRootPosition = /* @__PURE__ */ __name((commit2, curPos, defaultPos2) =&gt; {</span><span class="s3">\n  </span><span class="s1">const branch2 = branchPos.get(commit2.branch);</span><span class="s3">\n  </span><span class="s1">if (!branch2) {</span><span class="s3">\n    </span><span class="s1">throw new Error(`Branch not found for commit ${commit2.id}`);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const y = curPos + defaultPos2;</span><span class="s3">\n  </span><span class="s1">const x = branch2.pos;</span><span class="s3">\n  </span><span class="s1">commitPos.set(commit2.id, { x, y });</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">setRootPosition</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawCommitBullet = /* @__PURE__ */ __name((gBullets, commit2, commitPosition, typeClass, branchIndex, commitSymbolType) =&gt; {</span><span class="s3">\n  </span><span class="s1">if (commitSymbolType === commitType.HIGHLIGHT) {</span><span class="s3">\n    </span><span class="s1">gBullets.append(</span><span class="s3">\&quot;</span><span class="s1">rect</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x - 10).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y - 10).attr(</span><span class="s3">\&quot;</span><span class="s1">width</span><span class="s3">\&quot;</span><span class="s1">, 20).attr(</span><span class="s3">\&quot;</span><span class="s1">height</span><span class="s3">\&quot;</span><span class="s1">, 20).attr(</span><span class="s3">\n      \&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n      </span><span class="s1">`commit ${commit2.id} commit-highlight${branchIndex % THEME_COLOR_LIMIT} ${typeClass}-outer`</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">gBullets.append(</span><span class="s3">\&quot;</span><span class="s1">rect</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x - 6).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y - 6).attr(</span><span class="s3">\&quot;</span><span class="s1">width</span><span class="s3">\&quot;</span><span class="s1">, 12).attr(</span><span class="s3">\&quot;</span><span class="s1">height</span><span class="s3">\&quot;</span><span class="s1">, 12).attr(</span><span class="s3">\n      \&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n      </span><span class="s1">`commit ${commit2.id} commit${branchIndex % THEME_COLOR_LIMIT} ${typeClass}-inner`</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">} else if (commitSymbolType === commitType.CHERRY_PICK) {</span><span class="s3">\n    </span><span class="s1">gBullets.append(</span><span class="s3">\&quot;</span><span class="s1">circle</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">cx</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x).attr(</span><span class="s3">\&quot;</span><span class="s1">cy</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y).attr(</span><span class="s3">\&quot;</span><span class="s1">r</span><span class="s3">\&quot;</span><span class="s1">, 10).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, `commit ${commit2.id} ${typeClass}`);</span><span class="s3">\n    </span><span class="s1">gBullets.append(</span><span class="s3">\&quot;</span><span class="s1">circle</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">cx</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x - 3).attr(</span><span class="s3">\&quot;</span><span class="s1">cy</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y + 2).attr(</span><span class="s3">\&quot;</span><span class="s1">r</span><span class="s3">\&quot;</span><span class="s1">, 2.75).attr(</span><span class="s3">\&quot;</span><span class="s1">fill</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">#fff</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, `commit ${commit2.id} ${typeClass}`);</span><span class="s3">\n    </span><span class="s1">gBullets.append(</span><span class="s3">\&quot;</span><span class="s1">circle</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">cx</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x + 3).attr(</span><span class="s3">\&quot;</span><span class="s1">cy</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y + 2).attr(</span><span class="s3">\&quot;</span><span class="s1">r</span><span class="s3">\&quot;</span><span class="s1">, 2.75).attr(</span><span class="s3">\&quot;</span><span class="s1">fill</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">#fff</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, `commit ${commit2.id} ${typeClass}`);</span><span class="s3">\n    </span><span class="s1">gBullets.append(</span><span class="s3">\&quot;</span><span class="s1">line</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x1</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x + 3).attr(</span><span class="s3">\&quot;</span><span class="s1">y1</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y + 1).attr(</span><span class="s3">\&quot;</span><span class="s1">x2</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x).attr(</span><span class="s3">\&quot;</span><span class="s1">y2</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y - 5).attr(</span><span class="s3">\&quot;</span><span class="s1">stroke</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">#fff</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, `commit ${commit2.id} ${typeClass}`);</span><span class="s3">\n    </span><span class="s1">gBullets.append(</span><span class="s3">\&quot;</span><span class="s1">line</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x1</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x - 3).attr(</span><span class="s3">\&quot;</span><span class="s1">y1</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y + 1).attr(</span><span class="s3">\&quot;</span><span class="s1">x2</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x).attr(</span><span class="s3">\&quot;</span><span class="s1">y2</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y - 5).attr(</span><span class="s3">\&quot;</span><span class="s1">stroke</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">#fff</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, `commit ${commit2.id} ${typeClass}`);</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">const circle = gBullets.append(</span><span class="s3">\&quot;</span><span class="s1">circle</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">circle.attr(</span><span class="s3">\&quot;</span><span class="s1">cx</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x);</span><span class="s3">\n    </span><span class="s1">circle.attr(</span><span class="s3">\&quot;</span><span class="s1">cy</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y);</span><span class="s3">\n    </span><span class="s1">circle.attr(</span><span class="s3">\&quot;</span><span class="s1">r</span><span class="s3">\&quot;</span><span class="s1">, commit2.type === commitType.MERGE ? 9 : 10);</span><span class="s3">\n    </span><span class="s1">circle.attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, `commit ${commit2.id} commit${branchIndex % THEME_COLOR_LIMIT}`);</span><span class="s3">\n    </span><span class="s1">if (commitSymbolType === commitType.MERGE) {</span><span class="s3">\n      </span><span class="s1">const circle2 = gBullets.append(</span><span class="s3">\&quot;</span><span class="s1">circle</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">circle2.attr(</span><span class="s3">\&quot;</span><span class="s1">cx</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x);</span><span class="s3">\n      </span><span class="s1">circle2.attr(</span><span class="s3">\&quot;</span><span class="s1">cy</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y);</span><span class="s3">\n      </span><span class="s1">circle2.attr(</span><span class="s3">\&quot;</span><span class="s1">r</span><span class="s3">\&quot;</span><span class="s1">, 6);</span><span class="s3">\n      </span><span class="s1">circle2.attr(</span><span class="s3">\n        \&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">`commit ${typeClass} ${commit2.id} commit${branchIndex % THEME_COLOR_LIMIT}`</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">if (commitSymbolType === commitType.REVERSE) {</span><span class="s3">\n      </span><span class="s1">const cross = gBullets.append(</span><span class="s3">\&quot;</span><span class="s1">path</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">cross.attr(</span><span class="s3">\n        \&quot;</span><span class="s1">d</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">`M ${commitPosition.x - 5},${commitPosition.y - 5}L${commitPosition.x + 5},${commitPosition.y + 5}M${commitPosition.x - 5},${commitPosition.y + 5}L${commitPosition.x + 5},${commitPosition.y - 5}`</span><span class="s3">\n      </span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, `commit ${typeClass} ${commit2.id} commit${branchIndex % THEME_COLOR_LIMIT}`);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawCommitBullet</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawCommitLabel = /* @__PURE__ */ __name((gLabels, commit2, commitPosition, pos) =&gt; {</span><span class="s3">\n  </span><span class="s1">if (commit2.type !== commitType.CHERRY_PICK &amp;&amp; (commit2.customId &amp;&amp; commit2.type === commitType.MERGE || commit2.type !== commitType.MERGE) &amp;&amp; DEFAULT_GITGRAPH_CONFIG2?.showCommitLabel) {</span><span class="s3">\n    </span><span class="s1">const wrapper = gLabels.append(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">const labelBkg = wrapper.insert(</span><span class="s3">\&quot;</span><span class="s1">rect</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-label-bkg</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">const text = wrapper.append(</span><span class="s3">\&quot;</span><span class="s1">text</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, pos).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y + 25).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-label</span><span class="s3">\&quot;</span><span class="s1">).text(commit2.id);</span><span class="s3">\n    </span><span class="s1">const bbox = text.node()?.getBBox();</span><span class="s3">\n    </span><span class="s1">if (bbox) {</span><span class="s3">\n      </span><span class="s1">labelBkg.attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.posWithOffset - bbox.width / 2 - PY).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y + 13.5).attr(</span><span class="s3">\&quot;</span><span class="s1">width</span><span class="s3">\&quot;</span><span class="s1">, bbox.width + 2 * PY).attr(</span><span class="s3">\&quot;</span><span class="s1">height</span><span class="s3">\&quot;</span><span class="s1">, bbox.height + 2 * PY);</span><span class="s3">\n      </span><span class="s1">if (dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot; </span><span class="s1">|| dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">labelBkg.attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x - (bbox.width + 4 * PX + 5)).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y - 12);</span><span class="s3">\n        </span><span class="s1">text.attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x - (bbox.width + 4 * PX)).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y + bbox.height - 12);</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">text.attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.posWithOffset - bbox.width / 2);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">if (DEFAULT_GITGRAPH_CONFIG2.rotateCommitLabel) {</span><span class="s3">\n        </span><span class="s1">if (dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot; </span><span class="s1">|| dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">text.attr(</span><span class="s3">\n            \&quot;</span><span class="s1">transform</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            \&quot;</span><span class="s1">rotate(-45, </span><span class="s3">\&quot; </span><span class="s1">+ commitPosition.x + </span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot; </span><span class="s1">+ commitPosition.y + </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\&quot;\n          </span><span class="s1">);</span><span class="s3">\n          </span><span class="s1">labelBkg.attr(</span><span class="s3">\n            \&quot;</span><span class="s1">transform</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            \&quot;</span><span class="s1">rotate(-45, </span><span class="s3">\&quot; </span><span class="s1">+ commitPosition.x + </span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot; </span><span class="s1">+ commitPosition.y + </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\&quot;\n          </span><span class="s1">);</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">const r_x = -7.5 - (bbox.width + 10) / 25 * 9.5;</span><span class="s3">\n          </span><span class="s1">const r_y = 10 + bbox.width / 25 * 8.5;</span><span class="s3">\n          </span><span class="s1">wrapper.attr(</span><span class="s3">\n            \&quot;</span><span class="s1">transform</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n            \&quot;</span><span class="s1">translate(</span><span class="s3">\&quot; </span><span class="s1">+ r_x + </span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot; </span><span class="s1">+ r_y + </span><span class="s3">\&quot;</span><span class="s1">) rotate(-45, </span><span class="s3">\&quot; </span><span class="s1">+ pos + </span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot; </span><span class="s1">+ commitPosition.y + </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\&quot;\n          </span><span class="s1">);</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawCommitLabel</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawCommitTags = /* @__PURE__ */ __name((gLabels, commit2, commitPosition, pos) =&gt; {</span><span class="s3">\n  </span><span class="s1">if (commit2.tags.length &gt; 0) {</span><span class="s3">\n    </span><span class="s1">let yOffset = 0;</span><span class="s3">\n    </span><span class="s1">let maxTagBboxWidth = 0;</span><span class="s3">\n    </span><span class="s1">let maxTagBboxHeight = 0;</span><span class="s3">\n    </span><span class="s1">const tagElements = [];</span><span class="s3">\n    </span><span class="s1">for (const tagValue of commit2.tags.reverse()) {</span><span class="s3">\n      </span><span class="s1">const rect = gLabels.insert(</span><span class="s3">\&quot;</span><span class="s1">polygon</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">const hole = gLabels.append(</span><span class="s3">\&quot;</span><span class="s1">circle</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">const tag = gLabels.append(</span><span class="s3">\&quot;</span><span class="s1">text</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.y - 16 - yOffset).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag-label</span><span class="s3">\&quot;</span><span class="s1">).text(tagValue);</span><span class="s3">\n      </span><span class="s1">const tagBbox = tag.node()?.getBBox();</span><span class="s3">\n      </span><span class="s1">if (!tagBbox) {</span><span class="s3">\n        </span><span class="s1">throw new Error(</span><span class="s3">\&quot;</span><span class="s1">Tag bbox not found</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">maxTagBboxWidth = Math.max(maxTagBboxWidth, tagBbox.width);</span><span class="s3">\n      </span><span class="s1">maxTagBboxHeight = Math.max(maxTagBboxHeight, tagBbox.height);</span><span class="s3">\n      </span><span class="s1">tag.attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.posWithOffset - tagBbox.width / 2);</span><span class="s3">\n      </span><span class="s1">tagElements.push({</span><span class="s3">\n        </span><span class="s1">tag,</span><span class="s3">\n        </span><span class="s1">hole,</span><span class="s3">\n        </span><span class="s1">rect,</span><span class="s3">\n        </span><span class="s1">yOffset</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n      </span><span class="s1">yOffset += 20;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">for (const { tag, hole, rect, yOffset: yOffset2 } of tagElements) {</span><span class="s3">\n      </span><span class="s1">const h2 = maxTagBboxHeight / 2;</span><span class="s3">\n      </span><span class="s1">const ly = commitPosition.y - 19.2 - yOffset2;</span><span class="s3">\n      </span><span class="s1">rect.attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag-label-bkg</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\n        \&quot;</span><span class="s1">points</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">`</span><span class="s3">\n      </span><span class="s1">${pos - maxTagBboxWidth / 2 - PX / 2},${ly + PY}  </span><span class="s3">\n      </span><span class="s1">${pos - maxTagBboxWidth / 2 - PX / 2},${ly - PY}</span><span class="s3">\n      </span><span class="s1">${commitPosition.posWithOffset - maxTagBboxWidth / 2 - PX},${ly - h2 - PY}</span><span class="s3">\n      </span><span class="s1">${commitPosition.posWithOffset + maxTagBboxWidth / 2 + PX},${ly - h2 - PY}</span><span class="s3">\n      </span><span class="s1">${commitPosition.posWithOffset + maxTagBboxWidth / 2 + PX},${ly + h2 + PY}</span><span class="s3">\n      </span><span class="s1">${commitPosition.posWithOffset - maxTagBboxWidth / 2 - PX},${ly + h2 + PY}`</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">hole.attr(</span><span class="s3">\&quot;</span><span class="s1">cy</span><span class="s3">\&quot;</span><span class="s1">, ly).attr(</span><span class="s3">\&quot;</span><span class="s1">cx</span><span class="s3">\&quot;</span><span class="s1">, pos - maxTagBboxWidth / 2 + PX / 2).attr(</span><span class="s3">\&quot;</span><span class="s1">r</span><span class="s3">\&quot;</span><span class="s1">, 1.5).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag-hole</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">if (dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot; </span><span class="s1">|| dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">const yOrigin = pos + yOffset2;</span><span class="s3">\n        </span><span class="s1">rect.attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">tag-label-bkg</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\n          \&quot;</span><span class="s1">points</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">`</span><span class="s3">\n        </span><span class="s1">${commitPosition.x},${yOrigin + 2}</span><span class="s3">\n        </span><span class="s1">${commitPosition.x},${yOrigin - 2}</span><span class="s3">\n        </span><span class="s1">${commitPosition.x + LAYOUT_OFFSET},${yOrigin - h2 - 2}</span><span class="s3">\n        </span><span class="s1">${commitPosition.x + LAYOUT_OFFSET + maxTagBboxWidth + 4},${yOrigin - h2 - 2}</span><span class="s3">\n        </span><span class="s1">${commitPosition.x + LAYOUT_OFFSET + maxTagBboxWidth + 4},${yOrigin + h2 + 2}</span><span class="s3">\n        </span><span class="s1">${commitPosition.x + LAYOUT_OFFSET},${yOrigin + h2 + 2}`</span><span class="s3">\n        </span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">transform</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">translate(12,12) rotate(45, </span><span class="s3">\&quot; </span><span class="s1">+ commitPosition.x + </span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot; </span><span class="s1">+ pos + </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n        </span><span class="s1">hole.attr(</span><span class="s3">\&quot;</span><span class="s1">cx</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x + PX / 2).attr(</span><span class="s3">\&quot;</span><span class="s1">cy</span><span class="s3">\&quot;</span><span class="s1">, yOrigin).attr(</span><span class="s3">\&quot;</span><span class="s1">transform</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">translate(12,12) rotate(45, </span><span class="s3">\&quot; </span><span class="s1">+ commitPosition.x + </span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot; </span><span class="s1">+ pos + </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n        </span><span class="s1">tag.attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, commitPosition.x + 5).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, yOrigin + 3).attr(</span><span class="s3">\&quot;</span><span class="s1">transform</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">translate(14,14) rotate(45, </span><span class="s3">\&quot; </span><span class="s1">+ commitPosition.x + </span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot; </span><span class="s1">+ pos + </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawCommitTags</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var getCommitClassType = /* @__PURE__ */ __name((commit2) =&gt; {</span><span class="s3">\n  </span><span class="s1">const commitSymbolType = commit2.customType ?? commit2.type;</span><span class="s3">\n  </span><span class="s1">switch (commitSymbolType) {</span><span class="s3">\n    </span><span class="s1">case commitType.NORMAL:</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">commit-normal</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">case commitType.REVERSE:</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">commit-reverse</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">case commitType.HIGHLIGHT:</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">commit-highlight</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">case commitType.MERGE:</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">commit-merge</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">case commitType.CHERRY_PICK:</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">commit-cherry-pick</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">default:</span><span class="s3">\n      </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">commit-normal</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getCommitClassType</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var calculatePosition = /* @__PURE__ */ __name((commit2, dir2, pos, commitPos2) =&gt; {</span><span class="s3">\n  </span><span class="s1">const defaultCommitPosition = { x: 0, y: 0 };</span><span class="s3">\n  </span><span class="s1">if (commit2.parents.length &gt; 0) {</span><span class="s3">\n    </span><span class="s1">const closestParent = findClosestParent(commit2.parents);</span><span class="s3">\n    </span><span class="s1">if (closestParent) {</span><span class="s3">\n      </span><span class="s1">const parentPosition = commitPos2.get(closestParent) ?? defaultCommitPosition;</span><span class="s3">\n      </span><span class="s1">if (dir2 === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">return parentPosition.y + COMMIT_STEP;</span><span class="s3">\n      </span><span class="s1">} else if (dir2 === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">const currentPosition = commitPos2.get(commit2.id) ?? defaultCommitPosition;</span><span class="s3">\n        </span><span class="s1">return currentPosition.y - COMMIT_STEP;</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">return parentPosition.x + COMMIT_STEP;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">if (dir2 === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return defaultPos;</span><span class="s3">\n    </span><span class="s1">} else if (dir2 === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">const currentPosition = commitPos2.get(commit2.id) ?? defaultCommitPosition;</span><span class="s3">\n      </span><span class="s1">return currentPosition.y - COMMIT_STEP;</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">return 0;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return 0;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">calculatePosition</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var getCommitPosition = /* @__PURE__ */ __name((commit2, pos, isParallelCommits) =&gt; {</span><span class="s3">\n  </span><span class="s1">const posWithOffset = dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot; </span><span class="s1">&amp;&amp; isParallelCommits ? pos : pos + LAYOUT_OFFSET;</span><span class="s3">\n  </span><span class="s1">const y = dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot; </span><span class="s1">|| dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot; </span><span class="s1">? posWithOffset : branchPos.get(commit2.branch)?.pos;</span><span class="s3">\n  </span><span class="s1">const x = dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot; </span><span class="s1">|| dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot; </span><span class="s1">? branchPos.get(commit2.branch)?.pos : posWithOffset;</span><span class="s3">\n  </span><span class="s1">if (x === void 0 || y === void 0) {</span><span class="s3">\n    </span><span class="s1">throw new Error(`Position were undefined for commit ${commit2.id}`);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return { x, y, posWithOffset };</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getCommitPosition</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawCommits = /* @__PURE__ */ __name((svg, commits, modifyGraph) =&gt; {</span><span class="s3">\n  </span><span class="s1">if (!DEFAULT_GITGRAPH_CONFIG2) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\&quot;</span><span class="s1">GitGraph config not found</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const gBullets = svg.append(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-bullets</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">const gLabels = svg.append(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-labels</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">let pos = dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot; </span><span class="s1">|| dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot; </span><span class="s1">? defaultPos : 0;</span><span class="s3">\n  </span><span class="s1">const keys = [...commits.keys()];</span><span class="s3">\n  </span><span class="s1">const isParallelCommits = DEFAULT_GITGRAPH_CONFIG2?.parallelCommits ?? false;</span><span class="s3">\n  </span><span class="s1">const sortKeys = /* @__PURE__ */ __name((a, b) =&gt; {</span><span class="s3">\n    </span><span class="s1">const seqA = commits.get(a)?.seq;</span><span class="s3">\n    </span><span class="s1">const seqB = commits.get(b)?.seq;</span><span class="s3">\n    </span><span class="s1">return seqA !== void 0 &amp;&amp; seqB !== void 0 ? seqA - seqB : 0;</span><span class="s3">\n  </span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">sortKeys</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">let sortedKeys = keys.sort(sortKeys);</span><span class="s3">\n  </span><span class="s1">if (dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">if (isParallelCommits) {</span><span class="s3">\n      </span><span class="s1">setParallelBTPos(sortedKeys, commits, pos);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">sortedKeys = sortedKeys.reverse();</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">sortedKeys.forEach((key) =&gt; {</span><span class="s3">\n    </span><span class="s1">const commit2 = commits.get(key);</span><span class="s3">\n    </span><span class="s1">if (!commit2) {</span><span class="s3">\n      </span><span class="s1">throw new Error(`Commit not found for key ${key}`);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">if (isParallelCommits) {</span><span class="s3">\n      </span><span class="s1">pos = calculatePosition(commit2, dir, pos, commitPos);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const commitPosition = getCommitPosition(commit2, pos, isParallelCommits);</span><span class="s3">\n    </span><span class="s1">if (modifyGraph) {</span><span class="s3">\n      </span><span class="s1">const typeClass = getCommitClassType(commit2);</span><span class="s3">\n      </span><span class="s1">const commitSymbolType = commit2.customType ?? commit2.type;</span><span class="s3">\n      </span><span class="s1">const branchIndex = branchPos.get(commit2.branch)?.index ?? 0;</span><span class="s3">\n      </span><span class="s1">drawCommitBullet(gBullets, commit2, commitPosition, typeClass, branchIndex, commitSymbolType);</span><span class="s3">\n      </span><span class="s1">drawCommitLabel(gLabels, commit2, commitPosition, pos);</span><span class="s3">\n      </span><span class="s1">drawCommitTags(gLabels, commit2, commitPosition, pos);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">if (dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot; </span><span class="s1">|| dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">commitPos.set(commit2.id, { x: commitPosition.x, y: commitPosition.posWithOffset });</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">commitPos.set(commit2.id, { x: commitPosition.posWithOffset, y: commitPosition.y });</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">pos = dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot; </span><span class="s1">&amp;&amp; isParallelCommits ? pos + COMMIT_STEP : pos + COMMIT_STEP + LAYOUT_OFFSET;</span><span class="s3">\n    </span><span class="s1">if (pos &gt; maxPos) {</span><span class="s3">\n      </span><span class="s1">maxPos = pos;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawCommits</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var shouldRerouteArrow = /* @__PURE__ */ __name((commitA, commitB, p1, p2, allCommits) =&gt; {</span><span class="s3">\n  </span><span class="s1">const commitBIsFurthest = dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot; </span><span class="s1">|| dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot; </span><span class="s1">? p1.x &lt; p2.x : p1.y &lt; p2.y;</span><span class="s3">\n  </span><span class="s1">const branchToGetCurve = commitBIsFurthest ? commitB.branch : commitA.branch;</span><span class="s3">\n  </span><span class="s1">const isOnBranchToGetCurve = /* @__PURE__ */ __name((x) =&gt; x.branch === branchToGetCurve, </span><span class="s3">\&quot;</span><span class="s1">isOnBranchToGetCurve</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">const isBetweenCommits = /* @__PURE__ */ __name((x) =&gt; x.seq &gt; commitA.seq &amp;&amp; x.seq &lt; commitB.seq, </span><span class="s3">\&quot;</span><span class="s1">isBetweenCommits</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">return [...allCommits.values()].some((commitX) =&gt; {</span><span class="s3">\n    </span><span class="s1">return isBetweenCommits(commitX) &amp;&amp; isOnBranchToGetCurve(commitX);</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">shouldRerouteArrow</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var findLane = /* @__PURE__ */ __name((y1, y2, depth = 0) =&gt; {</span><span class="s3">\n  </span><span class="s1">const candidate = y1 + Math.abs(y1 - y2) / 2;</span><span class="s3">\n  </span><span class="s1">if (depth &gt; 5) {</span><span class="s3">\n    </span><span class="s1">return candidate;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const ok = lanes.every((lane) =&gt; Math.abs(lane - candidate) &gt;= 10);</span><span class="s3">\n  </span><span class="s1">if (ok) {</span><span class="s3">\n    </span><span class="s1">lanes.push(candidate);</span><span class="s3">\n    </span><span class="s1">return candidate;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const diff = Math.abs(y1 - y2);</span><span class="s3">\n  </span><span class="s1">return findLane(y1, y2 - diff / 5, depth + 1);</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">findLane</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawArrow = /* @__PURE__ */ __name((svg, commitA, commitB, allCommits) =&gt; {</span><span class="s3">\n  </span><span class="s1">const p1 = commitPos.get(commitA.id);</span><span class="s3">\n  </span><span class="s1">const p2 = commitPos.get(commitB.id);</span><span class="s3">\n  </span><span class="s1">if (p1 === void 0 || p2 === void 0) {</span><span class="s3">\n    </span><span class="s1">throw new Error(`Commit positions not found for commits ${commitA.id} and ${commitB.id}`);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const arrowNeedsRerouting = shouldRerouteArrow(commitA, commitB, p1, p2, allCommits);</span><span class="s3">\n  </span><span class="s1">let arc = </span><span class="s3">\&quot;\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">let arc2 = </span><span class="s3">\&quot;\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">let radius = 0;</span><span class="s3">\n  </span><span class="s1">let offset = 0;</span><span class="s3">\n  </span><span class="s1">let colorClassNum = branchPos.get(commitB.branch)?.index;</span><span class="s3">\n  </span><span class="s1">if (commitB.type === commitType.MERGE &amp;&amp; commitA.id !== commitB.parents[0]) {</span><span class="s3">\n    </span><span class="s1">colorClassNum = branchPos.get(commitA.branch)?.index;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">let lineDef;</span><span class="s3">\n  </span><span class="s1">if (arrowNeedsRerouting) {</span><span class="s3">\n    </span><span class="s1">arc = </span><span class="s3">\&quot;</span><span class="s1">A 10 10, 0, 0, 0,</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">arc2 = </span><span class="s3">\&quot;</span><span class="s1">A 10 10, 0, 0, 1,</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">radius = 10;</span><span class="s3">\n    </span><span class="s1">offset = 10;</span><span class="s3">\n    </span><span class="s1">const lineY = p1.y &lt; p2.y ? findLane(p1.y, p2.y) : findLane(p2.y, p1.y);</span><span class="s3">\n    </span><span class="s1">const lineX = p1.x &lt; p2.x ? findLane(p1.x, p2.x) : findLane(p2.x, p1.x);</span><span class="s3">\n    </span><span class="s1">if (dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">if (p1.x &lt; p2.x) {</span><span class="s3">\n        </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${lineX - radius} ${p1.y} ${arc2} ${lineX} ${p1.y + offset} L ${lineX} ${p2.y - radius} ${arc} ${lineX + offset} ${p2.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">colorClassNum = branchPos.get(commitA.branch)?.index;</span><span class="s3">\n        </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${lineX + radius} ${p1.y} ${arc} ${lineX} ${p1.y + offset} L ${lineX} ${p2.y - radius} ${arc2} ${lineX - offset} ${p2.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else if (dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">if (p1.x &lt; p2.x) {</span><span class="s3">\n        </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${lineX - radius} ${p1.y} ${arc} ${lineX} ${p1.y - offset} L ${lineX} ${p2.y + radius} ${arc2} ${lineX + offset} ${p2.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">colorClassNum = branchPos.get(commitA.branch)?.index;</span><span class="s3">\n        </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${lineX + radius} ${p1.y} ${arc2} ${lineX} ${p1.y - offset} L ${lineX} ${p2.y + radius} ${arc} ${lineX - offset} ${p2.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">if (p1.y &lt; p2.y) {</span><span class="s3">\n        </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p1.x} ${lineY - radius} ${arc} ${p1.x + offset} ${lineY} L ${p2.x - radius} ${lineY} ${arc2} ${p2.x} ${lineY + offset} L ${p2.x} ${p2.y}`;</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">colorClassNum = branchPos.get(commitA.branch)?.index;</span><span class="s3">\n        </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p1.x} ${lineY + radius} ${arc2} ${p1.x + offset} ${lineY} L ${p2.x - radius} ${lineY} ${arc} ${p2.x} ${lineY - offset} L ${p2.x} ${p2.y}`;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">arc = </span><span class="s3">\&quot;</span><span class="s1">A 20 20, 0, 0, 0,</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">arc2 = </span><span class="s3">\&quot;</span><span class="s1">A 20 20, 0, 0, 1,</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">radius = 20;</span><span class="s3">\n    </span><span class="s1">offset = 20;</span><span class="s3">\n    </span><span class="s1">if (dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">if (p1.x &lt; p2.x) {</span><span class="s3">\n        </span><span class="s1">if (commitB.type === commitType.MERGE &amp;&amp; commitA.id !== commitB.parents[0]) {</span><span class="s3">\n          </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p1.x} ${p2.y - radius} ${arc} ${p1.x + offset} ${p2.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p2.x - radius} ${p1.y} ${arc2} ${p2.x} ${p1.y + offset} L ${p2.x} ${p2.y}`;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">if (p1.x &gt; p2.x) {</span><span class="s3">\n        </span><span class="s1">arc = </span><span class="s3">\&quot;</span><span class="s1">A 20 20, 0, 0, 0,</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n        </span><span class="s1">arc2 = </span><span class="s3">\&quot;</span><span class="s1">A 20 20, 0, 0, 1,</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n        </span><span class="s1">radius = 20;</span><span class="s3">\n        </span><span class="s1">offset = 20;</span><span class="s3">\n        </span><span class="s1">if (commitB.type === commitType.MERGE &amp;&amp; commitA.id !== commitB.parents[0]) {</span><span class="s3">\n          </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p1.x} ${p2.y - radius} ${arc2} ${p1.x - offset} ${p2.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p2.x + radius} ${p1.y} ${arc} ${p2.x} ${p1.y + offset} L ${p2.x} ${p2.y}`;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">if (p1.x === p2.x) {</span><span class="s3">\n        </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else if (dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">if (p1.x &lt; p2.x) {</span><span class="s3">\n        </span><span class="s1">if (commitB.type === commitType.MERGE &amp;&amp; commitA.id !== commitB.parents[0]) {</span><span class="s3">\n          </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p1.x} ${p2.y + radius} ${arc2} ${p1.x + offset} ${p2.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p2.x - radius} ${p1.y} ${arc} ${p2.x} ${p1.y - offset} L ${p2.x} ${p2.y}`;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">if (p1.x &gt; p2.x) {</span><span class="s3">\n        </span><span class="s1">arc = </span><span class="s3">\&quot;</span><span class="s1">A 20 20, 0, 0, 0,</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n        </span><span class="s1">arc2 = </span><span class="s3">\&quot;</span><span class="s1">A 20 20, 0, 0, 1,</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n        </span><span class="s1">radius = 20;</span><span class="s3">\n        </span><span class="s1">offset = 20;</span><span class="s3">\n        </span><span class="s1">if (commitB.type === commitType.MERGE &amp;&amp; commitA.id !== commitB.parents[0]) {</span><span class="s3">\n          </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p1.x} ${p2.y + radius} ${arc} ${p1.x - offset} ${p2.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p2.x - radius} ${p1.y} ${arc} ${p2.x} ${p1.y - offset} L ${p2.x} ${p2.y}`;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">if (p1.x === p2.x) {</span><span class="s3">\n        </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">if (p1.y &lt; p2.y) {</span><span class="s3">\n        </span><span class="s1">if (commitB.type === commitType.MERGE &amp;&amp; commitA.id !== commitB.parents[0]) {</span><span class="s3">\n          </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p2.x - radius} ${p1.y} ${arc2} ${p2.x} ${p1.y + offset} L ${p2.x} ${p2.y}`;</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p1.x} ${p2.y - radius} ${arc} ${p1.x + offset} ${p2.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">if (p1.y &gt; p2.y) {</span><span class="s3">\n        </span><span class="s1">if (commitB.type === commitType.MERGE &amp;&amp; commitA.id !== commitB.parents[0]) {</span><span class="s3">\n          </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p2.x - radius} ${p1.y} ${arc} ${p2.x} ${p1.y - offset} L ${p2.x} ${p2.y}`;</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p1.x} ${p2.y + radius} ${arc2} ${p1.x + offset} ${p2.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">if (p1.y === p2.y) {</span><span class="s3">\n        </span><span class="s1">lineDef = `M ${p1.x} ${p1.y} L ${p2.x} ${p2.y}`;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (lineDef === void 0) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\&quot;</span><span class="s1">Line definition not found</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">svg.append(</span><span class="s3">\&quot;</span><span class="s1">path</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">d</span><span class="s3">\&quot;</span><span class="s1">, lineDef).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">arrow arrow</span><span class="s3">\&quot; </span><span class="s1">+ colorClassNum % THEME_COLOR_LIMIT);</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawArrow</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawArrows = /* @__PURE__ */ __name((svg, commits) =&gt; {</span><span class="s3">\n  </span><span class="s1">const gArrows = svg.append(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-arrows</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">[...commits.keys()].forEach((key) =&gt; {</span><span class="s3">\n    </span><span class="s1">const commit2 = commits.get(key);</span><span class="s3">\n    </span><span class="s1">if (commit2.parents &amp;&amp; commit2.parents.length &gt; 0) {</span><span class="s3">\n      </span><span class="s1">commit2.parents.forEach((parent) =&gt; {</span><span class="s3">\n        </span><span class="s1">drawArrow(gArrows, commits.get(parent), commit2, commits);</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawArrows</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawBranches = /* @__PURE__ */ __name((svg, branches) =&gt; {</span><span class="s3">\n  </span><span class="s1">const g = svg.append(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">branches.forEach((branch2, index) =&gt; {</span><span class="s3">\n    </span><span class="s1">const adjustIndexForTheme = index % THEME_COLOR_LIMIT;</span><span class="s3">\n    </span><span class="s1">const pos = branchPos.get(branch2.name)?.pos;</span><span class="s3">\n    </span><span class="s1">if (pos === void 0) {</span><span class="s3">\n      </span><span class="s1">throw new Error(`Position not found for branch ${branch2.name}`);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const line = g.append(</span><span class="s3">\&quot;</span><span class="s1">line</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">x1</span><span class="s3">\&quot;</span><span class="s1">, 0);</span><span class="s3">\n    </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">y1</span><span class="s3">\&quot;</span><span class="s1">, pos);</span><span class="s3">\n    </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">x2</span><span class="s3">\&quot;</span><span class="s1">, maxPos);</span><span class="s3">\n    </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">y2</span><span class="s3">\&quot;</span><span class="s1">, pos);</span><span class="s3">\n    </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">branch branch</span><span class="s3">\&quot; </span><span class="s1">+ adjustIndexForTheme);</span><span class="s3">\n    </span><span class="s1">if (dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">y1</span><span class="s3">\&quot;</span><span class="s1">, defaultPos);</span><span class="s3">\n      </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">x1</span><span class="s3">\&quot;</span><span class="s1">, pos);</span><span class="s3">\n      </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">y2</span><span class="s3">\&quot;</span><span class="s1">, maxPos);</span><span class="s3">\n      </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">x2</span><span class="s3">\&quot;</span><span class="s1">, pos);</span><span class="s3">\n    </span><span class="s1">} else if (dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">y1</span><span class="s3">\&quot;</span><span class="s1">, maxPos);</span><span class="s3">\n      </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">x1</span><span class="s3">\&quot;</span><span class="s1">, pos);</span><span class="s3">\n      </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">y2</span><span class="s3">\&quot;</span><span class="s1">, defaultPos);</span><span class="s3">\n      </span><span class="s1">line.attr(</span><span class="s3">\&quot;</span><span class="s1">x2</span><span class="s3">\&quot;</span><span class="s1">, pos);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">lanes.push(pos);</span><span class="s3">\n    </span><span class="s1">const name = branch2.name;</span><span class="s3">\n    </span><span class="s1">const labelElement = drawText(name);</span><span class="s3">\n    </span><span class="s1">const bkg = g.insert(</span><span class="s3">\&quot;</span><span class="s1">rect</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">const branchLabel = g.insert(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">branchLabel</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">const label = branchLabel.insert(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">label branch-label</span><span class="s3">\&quot; </span><span class="s1">+ adjustIndexForTheme);</span><span class="s3">\n    </span><span class="s1">label.node().appendChild(labelElement);</span><span class="s3">\n    </span><span class="s1">const bbox = labelElement.getBBox();</span><span class="s3">\n    </span><span class="s1">bkg.attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">branchLabelBkg label</span><span class="s3">\&quot; </span><span class="s1">+ adjustIndexForTheme).attr(</span><span class="s3">\&quot;</span><span class="s1">rx</span><span class="s3">\&quot;</span><span class="s1">, 4).attr(</span><span class="s3">\&quot;</span><span class="s1">ry</span><span class="s3">\&quot;</span><span class="s1">, 4).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, -bbox.width - 4 - (DEFAULT_GITGRAPH_CONFIG2?.rotateCommitLabel === true ? 30 : 0)).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, -bbox.height / 2 + 8).attr(</span><span class="s3">\&quot;</span><span class="s1">width</span><span class="s3">\&quot;</span><span class="s1">, bbox.width + 18).attr(</span><span class="s3">\&quot;</span><span class="s1">height</span><span class="s3">\&quot;</span><span class="s1">, bbox.height + 4);</span><span class="s3">\n    </span><span class="s1">label.attr(</span><span class="s3">\n      \&quot;</span><span class="s1">transform</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n      \&quot;</span><span class="s1">translate(</span><span class="s3">\&quot; </span><span class="s1">+ (-bbox.width - 14 - (DEFAULT_GITGRAPH_CONFIG2?.rotateCommitLabel === true ? 30 : 0)) + </span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot; </span><span class="s1">+ (pos - bbox.height / 2 - 1) + </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\&quot;\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">if (dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">bkg.attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, pos - bbox.width / 2 - 10).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, 0);</span><span class="s3">\n      </span><span class="s1">label.attr(</span><span class="s3">\&quot;</span><span class="s1">transform</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">translate(</span><span class="s3">\&quot; </span><span class="s1">+ (pos - bbox.width / 2 - 5) + </span><span class="s3">\&quot;</span><span class="s1">, 0)</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">} else if (dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">bkg.attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, pos - bbox.width / 2 - 10).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, maxPos);</span><span class="s3">\n      </span><span class="s1">label.attr(</span><span class="s3">\&quot;</span><span class="s1">transform</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">translate(</span><span class="s3">\&quot; </span><span class="s1">+ (pos - bbox.width / 2 - 5) + </span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot; </span><span class="s1">+ maxPos + </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">bkg.attr(</span><span class="s3">\&quot;</span><span class="s1">transform</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">translate(-19, </span><span class="s3">\&quot; </span><span class="s1">+ (pos - bbox.height / 2) + </span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawBranches</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var setBranchPosition = /* @__PURE__ */ __name(function(name, pos, index, bbox, rotateCommitLabel) {</span><span class="s3">\n  </span><span class="s1">branchPos.set(name, { pos, index });</span><span class="s3">\n  </span><span class="s1">pos += 50 + (rotateCommitLabel ? 40 : 0) + (dir === </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot; </span><span class="s1">|| dir === </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot; </span><span class="s1">? bbox.width / 2 : 0);</span><span class="s3">\n  </span><span class="s1">return pos;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">setBranchPosition</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var draw = /* @__PURE__ */ __name(function(txt, id, ver, diagObj) {</span><span class="s3">\n  </span><span class="s1">clear3();</span><span class="s3">\n  </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">in gitgraph renderer</span><span class="s3">\&quot;</span><span class="s1">, txt + </span><span class="s3">\&quot;\\</span><span class="s1">n</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">id:</span><span class="s3">\&quot;</span><span class="s1">, id, ver);</span><span class="s3">\n  </span><span class="s1">if (!DEFAULT_GITGRAPH_CONFIG2) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\&quot;</span><span class="s1">GitGraph config not found</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const rotateCommitLabel = DEFAULT_GITGRAPH_CONFIG2.rotateCommitLabel ?? false;</span><span class="s3">\n  </span><span class="s1">const db2 = diagObj.db;</span><span class="s3">\n  </span><span class="s1">allCommitsDict = db2.getCommits();</span><span class="s3">\n  </span><span class="s1">const branches = db2.getBranchesAsObjArray();</span><span class="s3">\n  </span><span class="s1">dir = db2.getDirection();</span><span class="s3">\n  </span><span class="s1">const diagram2 = select(`[id=</span><span class="s3">\&quot;</span><span class="s1">${id}</span><span class="s3">\&quot;</span><span class="s1">]`);</span><span class="s3">\n  </span><span class="s1">let pos = 0;</span><span class="s3">\n  </span><span class="s1">branches.forEach((branch2, index) =&gt; {</span><span class="s3">\n    </span><span class="s1">const labelElement = drawText(branch2.name);</span><span class="s3">\n    </span><span class="s1">const g = diagram2.append(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">const branchLabel = g.insert(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">branchLabel</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">const label = branchLabel.insert(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">label branch-label</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">label.node()?.appendChild(labelElement);</span><span class="s3">\n    </span><span class="s1">const bbox = labelElement.getBBox();</span><span class="s3">\n    </span><span class="s1">pos = setBranchPosition(branch2.name, pos, index, bbox, rotateCommitLabel);</span><span class="s3">\n    </span><span class="s1">label.remove();</span><span class="s3">\n    </span><span class="s1">branchLabel.remove();</span><span class="s3">\n    </span><span class="s1">g.remove();</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">drawCommits(diagram2, allCommitsDict, false);</span><span class="s3">\n  </span><span class="s1">if (DEFAULT_GITGRAPH_CONFIG2.showBranches) {</span><span class="s3">\n    </span><span class="s1">drawBranches(diagram2, branches);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">drawArrows(diagram2, allCommitsDict);</span><span class="s3">\n  </span><span class="s1">drawCommits(diagram2, allCommitsDict, true);</span><span class="s3">\n  </span><span class="s1">utils_default.insertTitle(</span><span class="s3">\n    </span><span class="s1">diagram2,</span><span class="s3">\n    \&quot;</span><span class="s1">gitTitleText</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">DEFAULT_GITGRAPH_CONFIG2.titleTopMargin ?? 0,</span><span class="s3">\n    </span><span class="s1">db2.getDiagramTitle()</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">setupGraphViewbox(</span><span class="s3">\n    </span><span class="s1">void 0,</span><span class="s3">\n    </span><span class="s1">diagram2,</span><span class="s3">\n    </span><span class="s1">DEFAULT_GITGRAPH_CONFIG2.diagramPadding,</span><span class="s3">\n    </span><span class="s1">DEFAULT_GITGRAPH_CONFIG2.useMaxWidth</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">draw</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var gitGraphRenderer_default = {</span><span class="s3">\n  </span><span class="s1">draw</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">if (void 0) {</span><span class="s3">\n  </span><span class="s1">const { it, expect, describe } = void 0;</span><span class="s3">\n  </span><span class="s1">describe(</span><span class="s3">\&quot;</span><span class="s1">drawText</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n    </span><span class="s1">it(</span><span class="s3">\&quot;</span><span class="s1">should drawText</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">const svgLabel = drawText(</span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">expect(svgLabel).toBeDefined();</span><span class="s3">\n      </span><span class="s1">expect(svgLabel.children[0].innerHTML).toBe(</span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">describe(</span><span class="s3">\&quot;</span><span class="s1">branchPosition</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n    </span><span class="s1">const bbox = {</span><span class="s3">\n      </span><span class="s1">x: 0,</span><span class="s3">\n      </span><span class="s1">y: 0,</span><span class="s3">\n      </span><span class="s1">width: 10,</span><span class="s3">\n      </span><span class="s1">height: 10,</span><span class="s3">\n      </span><span class="s1">top: 0,</span><span class="s3">\n      </span><span class="s1">right: 0,</span><span class="s3">\n      </span><span class="s1">bottom: 0,</span><span class="s3">\n      </span><span class="s1">left: 0,</span><span class="s3">\n      </span><span class="s1">toJSON: /* @__PURE__ */ __name(() =&gt; </span><span class="s3">\&quot;\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">toJSON</span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n    </span><span class="s1">it(</span><span class="s3">\&quot;</span><span class="s1">should setBranchPositions LR with two branches</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">dir = </span><span class="s3">\&quot;</span><span class="s1">LR</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">const pos = setBranchPosition(</span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;</span><span class="s1">, 0, 0, bbox, true);</span><span class="s3">\n      </span><span class="s1">expect(pos).toBe(90);</span><span class="s3">\n      </span><span class="s1">expect(branchPos.get(</span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;</span><span class="s1">)).toEqual({ pos: 0, index: 0 });</span><span class="s3">\n      </span><span class="s1">const posNext = setBranchPosition(</span><span class="s3">\&quot;</span><span class="s1">develop</span><span class="s3">\&quot;</span><span class="s1">, pos, 1, bbox, true);</span><span class="s3">\n      </span><span class="s1">expect(posNext).toBe(180);</span><span class="s3">\n      </span><span class="s1">expect(branchPos.get(</span><span class="s3">\&quot;</span><span class="s1">develop</span><span class="s3">\&quot;</span><span class="s1">)).toEqual({ pos, index: 1 });</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">it(</span><span class="s3">\&quot;</span><span class="s1">should setBranchPositions TB with two branches</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">dir = </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">bbox.width = 34.9921875;</span><span class="s3">\n      </span><span class="s1">const pos = setBranchPosition(</span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;</span><span class="s1">, 0, 0, bbox, true);</span><span class="s3">\n      </span><span class="s1">expect(pos).toBe(107.49609375);</span><span class="s3">\n      </span><span class="s1">expect(branchPos.get(</span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;</span><span class="s1">)).toEqual({ pos: 0, index: 0 });</span><span class="s3">\n      </span><span class="s1">bbox.width = 56.421875;</span><span class="s3">\n      </span><span class="s1">const posNext = setBranchPosition(</span><span class="s3">\&quot;</span><span class="s1">develop</span><span class="s3">\&quot;</span><span class="s1">, pos, 1, bbox, true);</span><span class="s3">\n      </span><span class="s1">expect(posNext).toBe(225.70703125);</span><span class="s3">\n      </span><span class="s1">expect(branchPos.get(</span><span class="s3">\&quot;</span><span class="s1">develop</span><span class="s3">\&quot;</span><span class="s1">)).toEqual({ pos, index: 1 });</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">describe(</span><span class="s3">\&quot;</span><span class="s1">commitPosition</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n    </span><span class="s1">const commits = /* @__PURE__ */ new Map([</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">commitZero</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">ZERO</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 0,</span><span class="s3">\n          </span><span class="s1">type: commitType.NORMAL,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">commitA</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">A</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 1,</span><span class="s3">\n          </span><span class="s1">type: commitType.NORMAL,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">ZERO</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">feature</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">commitB</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">B</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 2,</span><span class="s3">\n          </span><span class="s1">type: commitType.NORMAL,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">A</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">feature</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">commitM</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">M</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;</span><span class="s1">merged branch feature into main</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 3,</span><span class="s3">\n          </span><span class="s1">type: commitType.MERGE,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">ZERO</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">B</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">customId: true</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">commitC</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">C</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 4,</span><span class="s3">\n          </span><span class="s1">type: commitType.NORMAL,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">ZERO</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">release</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">commit5_8928ea0</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">5-8928ea0</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;</span><span class="s1">cherry-picked [object Object] into release</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 5,</span><span class="s3">\n          </span><span class="s1">type: commitType.CHERRY_PICK,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">C</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">M</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">release</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">commitD</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">D</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 6,</span><span class="s3">\n          </span><span class="s1">type: commitType.NORMAL,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">5-8928ea0</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">release</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">commit7_ed848ba</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">7-ed848ba</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;</span><span class="s1">cherry-picked [object Object] into release</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 7,</span><span class="s3">\n          </span><span class="s1">type: commitType.CHERRY_PICK,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">D</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">M</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">release</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">]</span><span class="s3">\n    </span><span class="s1">]);</span><span class="s3">\n    </span><span class="s1">let pos = 0;</span><span class="s3">\n    </span><span class="s1">branchPos.set(</span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;</span><span class="s1">, { pos: 0, index: 0 });</span><span class="s3">\n    </span><span class="s1">branchPos.set(</span><span class="s3">\&quot;</span><span class="s1">feature</span><span class="s3">\&quot;</span><span class="s1">, { pos: 107.49609375, index: 1 });</span><span class="s3">\n    </span><span class="s1">branchPos.set(</span><span class="s3">\&quot;</span><span class="s1">release</span><span class="s3">\&quot;</span><span class="s1">, { pos: 224.03515625, index: 2 });</span><span class="s3">\n    </span><span class="s1">describe(</span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">pos = 30;</span><span class="s3">\n      </span><span class="s1">dir = </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">const expectedCommitPositionTB = /* @__PURE__ */ new Map([</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitZero</span><span class="s3">\&quot;</span><span class="s1">, { x: 0, y: 40, posWithOffset: 40 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitA</span><span class="s3">\&quot;</span><span class="s1">, { x: 107.49609375, y: 90, posWithOffset: 90 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitB</span><span class="s3">\&quot;</span><span class="s1">, { x: 107.49609375, y: 140, posWithOffset: 140 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitM</span><span class="s3">\&quot;</span><span class="s1">, { x: 0, y: 190, posWithOffset: 190 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitC</span><span class="s3">\&quot;</span><span class="s1">, { x: 224.03515625, y: 240, posWithOffset: 240 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commit5_8928ea0</span><span class="s3">\&quot;</span><span class="s1">, { x: 224.03515625, y: 290, posWithOffset: 290 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitD</span><span class="s3">\&quot;</span><span class="s1">, { x: 224.03515625, y: 340, posWithOffset: 340 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commit7_ed848ba</span><span class="s3">\&quot;</span><span class="s1">, { x: 224.03515625, y: 390, posWithOffset: 390 }]</span><span class="s3">\n      </span><span class="s1">]);</span><span class="s3">\n      </span><span class="s1">commits.forEach((commit2, key) =&gt; {</span><span class="s3">\n        </span><span class="s1">it(`should give the correct position for commit ${key}`, () =&gt; {</span><span class="s3">\n          </span><span class="s1">const position = getCommitPosition(commit2, pos, false);</span><span class="s3">\n          </span><span class="s1">expect(position).toEqual(expectedCommitPositionTB.get(key));</span><span class="s3">\n          </span><span class="s1">pos += 50;</span><span class="s3">\n        </span><span class="s1">});</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">describe(</span><span class="s3">\&quot;</span><span class="s1">LR</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">let pos2 = 30;</span><span class="s3">\n      </span><span class="s1">dir = </span><span class="s3">\&quot;</span><span class="s1">LR</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">const expectedCommitPositionLR = /* @__PURE__ */ new Map([</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitZero</span><span class="s3">\&quot;</span><span class="s1">, { x: 0, y: 40, posWithOffset: 40 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitA</span><span class="s3">\&quot;</span><span class="s1">, { x: 107.49609375, y: 90, posWithOffset: 90 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitB</span><span class="s3">\&quot;</span><span class="s1">, { x: 107.49609375, y: 140, posWithOffset: 140 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitM</span><span class="s3">\&quot;</span><span class="s1">, { x: 0, y: 190, posWithOffset: 190 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitC</span><span class="s3">\&quot;</span><span class="s1">, { x: 224.03515625, y: 240, posWithOffset: 240 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commit5_8928ea0</span><span class="s3">\&quot;</span><span class="s1">, { x: 224.03515625, y: 290, posWithOffset: 290 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitD</span><span class="s3">\&quot;</span><span class="s1">, { x: 224.03515625, y: 340, posWithOffset: 340 }],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commit7_ed848ba</span><span class="s3">\&quot;</span><span class="s1">, { x: 224.03515625, y: 390, posWithOffset: 390 }]</span><span class="s3">\n      </span><span class="s1">]);</span><span class="s3">\n      </span><span class="s1">commits.forEach((commit2, key) =&gt; {</span><span class="s3">\n        </span><span class="s1">it(`should give the correct position for commit ${key}`, () =&gt; {</span><span class="s3">\n          </span><span class="s1">const position = getCommitPosition(commit2, pos2, false);</span><span class="s3">\n          </span><span class="s1">expect(position).toEqual(expectedCommitPositionLR.get(key));</span><span class="s3">\n          </span><span class="s1">pos2 += 50;</span><span class="s3">\n        </span><span class="s1">});</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">describe(</span><span class="s3">\&quot;</span><span class="s1">getCommitClassType</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">const expectedCommitClassType = /* @__PURE__ */ new Map([</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitZero</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-normal</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitA</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-normal</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitB</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-normal</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitM</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-merge</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitC</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-normal</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commit5_8928ea0</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-cherry-pick</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commitD</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-normal</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n        </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">commit7_ed848ba</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">commit-cherry-pick</span><span class="s3">\&quot;</span><span class="s1">]</span><span class="s3">\n      </span><span class="s1">]);</span><span class="s3">\n      </span><span class="s1">commits.forEach((commit2, key) =&gt; {</span><span class="s3">\n        </span><span class="s1">it(`should give the correct class type for commit ${key}`, () =&gt; {</span><span class="s3">\n          </span><span class="s1">const classType = getCommitClassType(commit2);</span><span class="s3">\n          </span><span class="s1">expect(classType).toBe(expectedCommitClassType.get(key));</span><span class="s3">\n        </span><span class="s1">});</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">describe(</span><span class="s3">\&quot;</span><span class="s1">building BT parallel commit diagram</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n    </span><span class="s1">const commits = /* @__PURE__ */ new Map([</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">1-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">1-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 0,</span><span class="s3">\n          </span><span class="s1">type: 0,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">2-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">2-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 1,</span><span class="s3">\n          </span><span class="s1">type: 0,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">1-abcdefg</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">3-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">3-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 2,</span><span class="s3">\n          </span><span class="s1">type: 0,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">2-abcdefg</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">develop</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">4-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">4-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 3,</span><span class="s3">\n          </span><span class="s1">type: 0,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">3-abcdefg</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">develop</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">5-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">5-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 4,</span><span class="s3">\n          </span><span class="s1">type: 0,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">2-abcdefg</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">feature</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">6-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">6-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 5,</span><span class="s3">\n          </span><span class="s1">type: 0,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">5-abcdefg</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">feature</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">7-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">7-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 6,</span><span class="s3">\n          </span><span class="s1">type: 0,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">2-abcdefg</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\n        \&quot;</span><span class="s1">8-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">{</span><span class="s3">\n          </span><span class="s1">id: </span><span class="s3">\&quot;</span><span class="s1">8-abcdefg</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">message: </span><span class="s3">\&quot;\&quot;</span><span class="s1">,</span><span class="s3">\n          </span><span class="s1">seq: 7,</span><span class="s3">\n          </span><span class="s1">type: 0,</span><span class="s3">\n          </span><span class="s1">tags: [],</span><span class="s3">\n          </span><span class="s1">parents: [</span><span class="s3">\&quot;</span><span class="s1">7-abcdefg</span><span class="s3">\&quot;</span><span class="s1">],</span><span class="s3">\n          </span><span class="s1">branch: </span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">]</span><span class="s3">\n    </span><span class="s1">]);</span><span class="s3">\n    </span><span class="s1">const expectedCommitPosition = /* @__PURE__ */ new Map([</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">1-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 0, y: 40 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">2-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 0, y: 90 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">3-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 107.49609375, y: 140 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">4-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 107.49609375, y: 190 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">5-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 225.70703125, y: 140 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">6-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 225.70703125, y: 190 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">7-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 0, y: 140 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">8-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 0, y: 190 }]</span><span class="s3">\n    </span><span class="s1">]);</span><span class="s3">\n    </span><span class="s1">const expectedCommitPositionAfterParallel = /* @__PURE__ */ new Map([</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">1-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 0, y: 210 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">2-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 0, y: 160 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">3-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 107.49609375, y: 110 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">4-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 107.49609375, y: 60 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">5-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 225.70703125, y: 110 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">6-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 225.70703125, y: 60 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">7-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 0, y: 110 }],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">8-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, { x: 0, y: 60 }]</span><span class="s3">\n    </span><span class="s1">]);</span><span class="s3">\n    </span><span class="s1">const expectedCommitCurrentPosition = /* @__PURE__ */ new Map([</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">1-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, 30],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">2-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, 80],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">3-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, 130],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">4-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, 180],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">5-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, 130],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">6-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, 180],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">7-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, 130],</span><span class="s3">\n      </span><span class="s1">[</span><span class="s3">\&quot;</span><span class="s1">8-abcdefg</span><span class="s3">\&quot;</span><span class="s1">, 180]</span><span class="s3">\n    </span><span class="s1">]);</span><span class="s3">\n    </span><span class="s1">const sortedKeys = [...expectedCommitPosition.keys()];</span><span class="s3">\n    </span><span class="s1">it(</span><span class="s3">\&quot;</span><span class="s1">should get the correct commit position and current position</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">dir = </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">let curPos = 30;</span><span class="s3">\n      </span><span class="s1">commitPos.clear();</span><span class="s3">\n      </span><span class="s1">branchPos.clear();</span><span class="s3">\n      </span><span class="s1">branchPos.set(</span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;</span><span class="s1">, { pos: 0, index: 0 });</span><span class="s3">\n      </span><span class="s1">branchPos.set(</span><span class="s3">\&quot;</span><span class="s1">develop</span><span class="s3">\&quot;</span><span class="s1">, { pos: 107.49609375, index: 1 });</span><span class="s3">\n      </span><span class="s1">branchPos.set(</span><span class="s3">\&quot;</span><span class="s1">feature</span><span class="s3">\&quot;</span><span class="s1">, { pos: 225.70703125, index: 2 });</span><span class="s3">\n      </span><span class="s1">DEFAULT_GITGRAPH_CONFIG2.parallelCommits = true;</span><span class="s3">\n      </span><span class="s1">commits.forEach((commit2, key) =&gt; {</span><span class="s3">\n        </span><span class="s1">if (commit2.parents.length &gt; 0) {</span><span class="s3">\n          </span><span class="s1">curPos = calculateCommitPosition(commit2);</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">const position = setCommitPosition(commit2, curPos);</span><span class="s3">\n        </span><span class="s1">expect(position).toEqual(expectedCommitPosition.get(key));</span><span class="s3">\n        </span><span class="s1">expect(curPos).toEqual(expectedCommitCurrentPosition.get(key));</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">it(</span><span class="s3">\&quot;</span><span class="s1">should get the correct commit position after parallel commits</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n      </span><span class="s1">commitPos.clear();</span><span class="s3">\n      </span><span class="s1">branchPos.clear();</span><span class="s3">\n      </span><span class="s1">dir = </span><span class="s3">\&quot;</span><span class="s1">BT</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">const curPos = 30;</span><span class="s3">\n      </span><span class="s1">commitPos.clear();</span><span class="s3">\n      </span><span class="s1">branchPos.clear();</span><span class="s3">\n      </span><span class="s1">branchPos.set(</span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot;</span><span class="s1">, { pos: 0, index: 0 });</span><span class="s3">\n      </span><span class="s1">branchPos.set(</span><span class="s3">\&quot;</span><span class="s1">develop</span><span class="s3">\&quot;</span><span class="s1">, { pos: 107.49609375, index: 1 });</span><span class="s3">\n      </span><span class="s1">branchPos.set(</span><span class="s3">\&quot;</span><span class="s1">feature</span><span class="s3">\&quot;</span><span class="s1">, { pos: 225.70703125, index: 2 });</span><span class="s3">\n      </span><span class="s1">setParallelBTPos(sortedKeys, commits, curPos);</span><span class="s3">\n      </span><span class="s1">sortedKeys.forEach((commit2) =&gt; {</span><span class="s3">\n        </span><span class="s1">const position = commitPos.get(commit2);</span><span class="s3">\n        </span><span class="s1">expect(position).toEqual(expectedCommitPositionAfterParallel.get(commit2));</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">DEFAULT_GITGRAPH_CONFIG2.parallelCommits = false;</span><span class="s3">\n  </span><span class="s1">it(</span><span class="s3">\&quot;</span><span class="s1">add</span><span class="s3">\&quot;</span><span class="s1">, () =&gt; {</span><span class="s3">\n    </span><span class="s1">commitPos.set(</span><span class="s3">\&quot;</span><span class="s1">parent1</span><span class="s3">\&quot;</span><span class="s1">, { x: 1, y: 1 });</span><span class="s3">\n    </span><span class="s1">commitPos.set(</span><span class="s3">\&quot;</span><span class="s1">parent2</span><span class="s3">\&quot;</span><span class="s1">, { x: 2, y: 2 });</span><span class="s3">\n    </span><span class="s1">commitPos.set(</span><span class="s3">\&quot;</span><span class="s1">parent3</span><span class="s3">\&quot;</span><span class="s1">, { x: 3, y: 3 });</span><span class="s3">\n    </span><span class="s1">dir = </span><span class="s3">\&quot;</span><span class="s1">LR</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">const parents = [</span><span class="s3">\&quot;</span><span class="s1">parent1</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">parent2</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">parent3</span><span class="s3">\&quot;</span><span class="s1">];</span><span class="s3">\n    </span><span class="s1">const closestParent = findClosestParent(parents);</span><span class="s3">\n    </span><span class="s1">expect(closestParent).toBe(</span><span class="s3">\&quot;</span><span class="s1">parent3</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">commitPos.clear();</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/git/styles.js</span><span class="s3">\n</span><span class="s1">var getStyles = /* @__PURE__ */ __name((options) =&gt; `</span><span class="s3">\n  </span><span class="s1">.commit-id,</span><span class="s3">\n  </span><span class="s1">.commit-msg,</span><span class="s3">\n  </span><span class="s1">.branch-label {</span><span class="s3">\n    </span><span class="s1">fill: lightgrey;</span><span class="s3">\n    </span><span class="s1">color: lightgrey;</span><span class="s3">\n    </span><span class="s1">font-family: 'trebuchet ms', verdana, arial, sans-serif;</span><span class="s3">\n    </span><span class="s1">font-family: var(--mermaid-font-family);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">${[0, 1, 2, 3, 4, 5, 6, 7].map(</span><span class="s3">\n  </span><span class="s1">(i) =&gt; `</span><span class="s3">\n        </span><span class="s1">.branch-label${i} { fill: ${options[</span><span class="s3">\&quot;</span><span class="s1">gitBranchLabel</span><span class="s3">\&quot; </span><span class="s1">+ i]}; }</span><span class="s3">\n        </span><span class="s1">.commit${i} { stroke: ${options[</span><span class="s3">\&quot;</span><span class="s1">git</span><span class="s3">\&quot; </span><span class="s1">+ i]}; fill: ${options[</span><span class="s3">\&quot;</span><span class="s1">git</span><span class="s3">\&quot; </span><span class="s1">+ i]}; }</span><span class="s3">\n        </span><span class="s1">.commit-highlight${i} { stroke: ${options[</span><span class="s3">\&quot;</span><span class="s1">gitInv</span><span class="s3">\&quot; </span><span class="s1">+ i]}; fill: ${options[</span><span class="s3">\&quot;</span><span class="s1">gitInv</span><span class="s3">\&quot; </span><span class="s1">+ i]}; }</span><span class="s3">\n        </span><span class="s1">.label${i}  { fill: ${options[</span><span class="s3">\&quot;</span><span class="s1">git</span><span class="s3">\&quot; </span><span class="s1">+ i]}; }</span><span class="s3">\n        </span><span class="s1">.arrow${i} { stroke: ${options[</span><span class="s3">\&quot;</span><span class="s1">git</span><span class="s3">\&quot; </span><span class="s1">+ i]}; }</span><span class="s3">\n        </span><span class="s1">`</span><span class="s3">\n</span><span class="s1">).join(</span><span class="s3">\&quot;\\</span><span class="s1">n</span><span class="s3">\&quot;</span><span class="s1">)}</span><span class="s3">\n\n  </span><span class="s1">.branch {</span><span class="s3">\n    </span><span class="s1">stroke-width: 1;</span><span class="s3">\n    </span><span class="s1">stroke: ${options.lineColor};</span><span class="s3">\n    </span><span class="s1">stroke-dasharray: 2;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">.commit-label { font-size: ${options.commitLabelFontSize}; fill: ${options.commitLabelColor};}</span><span class="s3">\n  </span><span class="s1">.commit-label-bkg { font-size: ${options.commitLabelFontSize}; fill: ${options.commitLabelBackground}; opacity: 0.5; }</span><span class="s3">\n  </span><span class="s1">.tag-label { font-size: ${options.tagLabelFontSize}; fill: ${options.tagLabelColor};}</span><span class="s3">\n  </span><span class="s1">.tag-label-bkg { fill: ${options.tagLabelBackground}; stroke: ${options.tagLabelBorder}; }</span><span class="s3">\n  </span><span class="s1">.tag-hole { fill: ${options.textColor}; }</span><span class="s3">\n\n  </span><span class="s1">.commit-merge {</span><span class="s3">\n    </span><span class="s1">stroke: ${options.primaryColor};</span><span class="s3">\n    </span><span class="s1">fill: ${options.primaryColor};</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">.commit-reverse {</span><span class="s3">\n    </span><span class="s1">stroke: ${options.primaryColor};</span><span class="s3">\n    </span><span class="s1">fill: ${options.primaryColor};</span><span class="s3">\n    </span><span class="s1">stroke-width: 3;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">.commit-highlight-outer {</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">.commit-highlight-inner {</span><span class="s3">\n    </span><span class="s1">stroke: ${options.primaryColor};</span><span class="s3">\n    </span><span class="s1">fill: ${options.primaryColor};</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">.arrow { stroke-width: 8; stroke-linecap: round; fill: none}</span><span class="s3">\n  </span><span class="s1">.gitTitleText {</span><span class="s3">\n    </span><span class="s1">text-anchor: middle;</span><span class="s3">\n    </span><span class="s1">font-size: 18px;</span><span class="s3">\n    </span><span class="s1">fill: ${options.textColor};</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">`, </span><span class="s3">\&quot;</span><span class="s1">getStyles</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var styles_default = getStyles;</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/git/gitGraphDiagram.ts</span><span class="s3">\n</span><span class="s1">var diagram = {</span><span class="s3">\n  </span><span class="s1">parser,</span><span class="s3">\n  </span><span class="s1">db,</span><span class="s3">\n  </span><span class="s1">renderer: gitGraphRenderer_default,</span><span class="s3">\n  </span><span class="s1">styles: styles_default</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">export {</span><span class="s3">\n  </span><span class="s1">diagram</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[],</span><span class="s1">&quot;sourceRoot&quot;</span><span class="s0">:</span><span class="s1">&quot;&quot;</span><span class="s0">}</span></pre>
</body>
</html>