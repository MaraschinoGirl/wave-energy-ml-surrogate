<html>
<head>
<title>1491.010c623dd546db976e95.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #6aab73;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #2aacb8;}
.s4 { color: #cf8e6d;}
.s5 { color: #42c3d4;}
.ln { color: #4b5059; font-weight: normal; font-style: normal; }
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
1491.010c623dd546db976e95.js</font>
</center></td></tr></table>
<pre><a name="l1"><span class="ln">1    </span></a><span class="s0">&quot;use strict&quot;</span><span class="s1">;(</span><span class="s2">self</span><span class="s1">[</span><span class="s0">&quot;webpackChunk_jupyterlab_application_top&quot;</span><span class="s1">]=</span><span class="s2">self</span><span class="s1">[</span><span class="s0">&quot;webpackChunk_jupyterlab_application_top&quot;</span><span class="s1">]||[]).</span><span class="s2">push</span><span class="s1">([[</span><span class="s3">1491</span><span class="s1">],{</span><span class="s3">21491</span><span class="s1">:(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)=&gt;{</span><span class="s2">i</span><span class="s1">.</span><span class="s2">r</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s2">i</span><span class="s1">.</span><span class="s2">d</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,{</span><span class="s2">AsyncCellRenderer</span><span class="s1">:()=&gt;</span><span class="s2">k</span><span class="s1">,</span><span class="s2">BasicKeyHandler</span><span class="s1">:()=&gt;</span><span class="s2">y</span><span class="s1">,</span><span class="s2">BasicMouseHandler</span><span class="s1">:()=&gt;</span><span class="s2">b</span><span class="s1">,</span><span class="s2">BasicSelectionModel</span><span class="s1">:()=&gt;</span><span class="s2">O</span><span class="s1">,</span><span class="s2">BooleanCellEditor</span><span class="s1">:()=&gt;</span><span class="s2">V</span><span class="s1">,</span><span class="s2">CellEditor</span><span class="s1">:()=&gt;</span><span class="s2">D</span><span class="s1">,</span><span class="s2">CellEditorController</span><span class="s1">:()=&gt;</span><span class="s2">K</span><span class="s1">,</span><span class="s2">CellGroup</span><span class="s1">:()=&gt;</span><span class="s2">S</span><span class="s1">,</span><span class="s2">CellRenderer</span><span class="s1">:()=&gt;</span><span class="s2">x</span><span class="s1">,</span><span class="s2">DataGrid</span><span class="s1">:()=&gt;</span><span class="s2">ee</span><span class="s1">,</span><span class="s2">DataModel</span><span class="s1">:()=&gt;</span><span class="s2">q</span><span class="s1">,</span><span class="s2">DateCellEditor</span><span class="s1">:()=&gt;</span><span class="s2">X</span><span class="s1">,</span><span class="s2">DynamicOptionCellEditor</span><span class="s1">:()=&gt;</span><span class="s2">Y</span><span class="s1">,</span><span class="s2">GraphicsContext</span><span class="s1">:()=&gt;</span><span class="s2">$</span><span class="s1">,</span><span class="s2">HyperlinkRenderer</span><span class="s1">:()=&gt;</span><span class="s2">M</span><span class="s1">,</span><span class="s2">ImageRenderer</span><span class="s1">:()=&gt;</span><span class="s2">ne</span><span class="s1">,</span><span class="s2">InputCellEditor</span><span class="s1">:()=&gt;</span><span class="s2">G</span><span class="s1">,</span><span class="s2">IntegerCellEditor</span><span class="s1">:()=&gt;</span><span class="s2">P</span><span class="s1">,</span><span class="s2">IntegerInputValidator</span><span class="s1">:()=&gt;</span><span class="s2">T</span><span class="s1">,</span><span class="s2">JSONModel</span><span class="s1">:()=&gt;</span><span class="s2">ie</span><span class="s1">,</span><span class="s2">MutableDataModel</span><span class="s1">:()=&gt;</span><span class="s2">j</span><span class="s1">,</span><span class="s2">NumberCellEditor</span><span class="s1">:()=&gt;</span><span class="s2">A</span><span class="s1">,</span><span class="s2">NumberInputValidator</span><span class="s1">:()=&gt;</span><span class="s2">B</span><span class="s1">,</span><span class="s2">OptionCellEditor</span><span class="s1">:()=&gt;</span><span class="s2">N</span><span class="s1">,</span><span class="s2">PassInputValidator</span><span class="s1">:()=&gt;</span><span class="s2">L</span><span class="s1">,</span><span class="s2">RendererMap</span><span class="s1">:()=&gt;</span><span class="s2">J</span><span class="s1">,</span><span class="s2">SectionList</span><span class="s1">:()=&gt;</span><span class="s2">Z</span><span class="s1">,</span><span class="s2">SelectionModel</span><span class="s1">:()=&gt;</span><span class="s2">R</span><span class="s1">,</span><span class="s2">TextCellEditor</span><span class="s1">:()=&gt;</span><span class="s2">I</span><span class="s1">,</span><span class="s2">TextInputValidator</span><span class="s1">:()=&gt;</span><span class="s2">W</span><span class="s1">,</span><span class="s2">TextRenderer</span><span class="s1">:()=&gt;</span><span class="s2">v</span><span class="s1">,</span><span class="s2">resolveOption</span><span class="s1">:()=&gt;</span><span class="s2">F</span><span class="s1">});</span><span class="s4">var </span><span class="s2">s</span><span class="s1">=</span><span class="s2">i</span><span class="s1">(</span><span class="s3">76326</span><span class="s1">);</span><span class="s4">var </span><span class="s2">o</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">n</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">var </span><span class="s2">r</span><span class="s1">=</span><span class="s2">i</span><span class="s1">(</span><span class="s3">77162</span><span class="s1">);</span><span class="s4">var </span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">n</span><span class="s1">(</span><span class="s2">r</span><span class="s1">);</span><span class="s4">var </span><span class="s2">l</span><span class="s1">=</span><span class="s2">i</span><span class="s1">(</span><span class="s3">10970</span><span class="s1">);</span><span class="s4">var </span><span class="s2">a</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">n</span><span class="s1">(</span><span class="s2">l</span><span class="s1">);</span><span class="s4">var </span><span class="s2">h</span><span class="s1">=</span><span class="s2">i</span><span class="s1">(</span><span class="s3">34236</span><span class="s1">);</span><span class="s4">var </span><span class="s2">c</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">n</span><span class="s1">(</span><span class="s2">h</span><span class="s1">);</span><span class="s4">var </span><span class="s2">d</span><span class="s1">=</span><span class="s2">i</span><span class="s1">(</span><span class="s3">2336</span><span class="s1">);</span><span class="s4">var </span><span class="s2">u</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">n</span><span class="s1">(</span><span class="s2">d</span><span class="s1">);</span><span class="s4">var </span><span class="s2">f</span><span class="s1">=</span><span class="s2">i</span><span class="s1">(</span><span class="s3">1143</span><span class="s1">);</span><span class="s4">var </span><span class="s2">_</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">n</span><span class="s1">(</span><span class="s2">f</span><span class="s1">);</span><span class="s4">var </span><span class="s2">m</span><span class="s1">=</span><span class="s2">i</span><span class="s1">(</span><span class="s3">42856</span><span class="s1">);</span><span class="s4">var </span><span class="s2">g</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">n</span><span class="s1">(</span><span class="s2">m</span><span class="s1">);</span><span class="s4">var </span><span class="s2">p</span><span class="s1">=</span><span class="s2">i</span><span class="s1">(</span><span class="s3">5592</span><span class="s1">);</span><span class="s4">var </span><span class="s2">w</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">n</span><span class="s1">(</span><span class="s2">p</span><span class="s1">);</span><span class="s4">class </span><span class="s2">y</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">=</span><span class="s4">false</span><span class="s1">}</span><span class="s2">get isDisposed</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">}</span><span class="s2">dispose</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">=</span><span class="s4">true</span><span class="s1">}</span><span class="s2">onKeyDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">editable</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">!==-</span><span class="s3">1</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">!==-</span><span class="s3">1</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">String</span><span class="s1">.</span><span class="s2">fromCharCode</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">keyCode</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s5">/[a-zA-Z0-9-_ ]/</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">i</span><span class="s1">)){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s4">const </span><span class="s2">o</span><span class="s1">={</span><span class="s2">grid</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">s</span><span class="s1">};</span><span class="s2">e</span><span class="s1">.</span><span class="s2">editorController</span><span class="s1">.</span><span class="s2">edit</span><span class="s1">(</span><span class="s2">o</span><span class="s1">);</span><span class="s4">if</span><span class="s1">((</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">getKeyboardLayout</span><span class="s1">)().</span><span class="s2">keyForKeydownEvent</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)===</span><span class="s0">&quot;Space&quot;</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s2">t</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">()}</span><span class="s4">return</span><span class="s1">}}</span><span class="s4">switch</span><span class="s1">((</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">getKeyboardLayout</span><span class="s1">)().</span><span class="s2">keyForKeydownEvent</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s4">case</span><span class="s0">&quot;ArrowLeft&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onArrowLeft</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;ArrowRight&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onArrowRight</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;ArrowUp&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onArrowUp</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;ArrowDown&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onArrowDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;PageUp&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onPageUp</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;PageDown&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onPageDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Escape&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onEscape</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Delete&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onDelete</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;C&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onKeyC</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Enter&quot;</span><span class="s1">:</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">moveCursor</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">?</span><span class="s0">&quot;up&quot;</span><span class="s1">:</span><span class="s0">&quot;down&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToCursor</span><span class="s1">()}</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Tab&quot;</span><span class="s1">:</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">moveCursor</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">?</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s0">&quot;right&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToCursor</span><span class="s1">();</span><span class="s2">t</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s2">t</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">()}</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">onArrowLeft</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">t</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">Platform</span><span class="s1">.</span><span class="s2">accelKey</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollTo</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollByStep</span><span class="s1">(</span><span class="s0">&quot;left&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollTo</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollByStep</span><span class="s1">(</span><span class="s0">&quot;left&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">let </span><span class="s2">c</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">;</span><span class="s4">let </span><span class="s2">g</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">-</span><span class="s3">1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">c</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">a</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s2">i</span><span class="s1">.</span><span class="s2">select</span><span class="s1">({</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">_</span><span class="s1">,</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">m</span><span class="s1">,</span><span class="s2">clear</span><span class="s1">:</span><span class="s2">g</span><span class="s1">});</span><span class="s2">h</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">h</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">||</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToColumn</span><span class="s1">(</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToCursor</span><span class="s1">()}}</span><span class="s2">onArrowRight</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">t</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">Platform</span><span class="s1">.</span><span class="s2">accelKey</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollByStep</span><span class="s1">(</span><span class="s0">&quot;right&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollByStep</span><span class="s1">(</span><span class="s0">&quot;right&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">let </span><span class="s2">c</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">;</span><span class="s4">let </span><span class="s2">g</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">+</span><span class="s3">1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">c</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">+</span><span class="s3">1</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">a</span><span class="s1">+</span><span class="s3">1</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s2">i</span><span class="s1">.</span><span class="s2">select</span><span class="s1">({</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">_</span><span class="s1">,</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">m</span><span class="s1">,</span><span class="s2">clear</span><span class="s1">:</span><span class="s2">g</span><span class="s1">});</span><span class="s2">h</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">h</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">||</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToColumn</span><span class="s1">(</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToCursor</span><span class="s1">()}}</span><span class="s2">onArrowUp</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">t</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">Platform</span><span class="s1">.</span><span class="s2">accelKey</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollByStep</span><span class="s1">(</span><span class="s0">&quot;up&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollByStep</span><span class="s1">(</span><span class="s0">&quot;up&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">let </span><span class="s2">c</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">;</span><span class="s4">let </span><span class="s2">g</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">-</span><span class="s3">1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">c</span><span class="s1">=</span><span class="s2">l</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">l</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s2">i</span><span class="s1">.</span><span class="s2">select</span><span class="s1">({</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">_</span><span class="s1">,</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">m</span><span class="s1">,</span><span class="s2">clear</span><span class="s1">:</span><span class="s2">g</span><span class="s1">});</span><span class="s2">h</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">h</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">||</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToRow</span><span class="s1">(</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToCursor</span><span class="s1">()}}</span><span class="s2">onArrowDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">t</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">Platform</span><span class="s1">.</span><span class="s2">accelKey</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollByStep</span><span class="s1">(</span><span class="s0">&quot;down&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollByStep</span><span class="s1">(</span><span class="s0">&quot;down&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">let </span><span class="s2">c</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">;</span><span class="s4">let </span><span class="s2">g</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">+</span><span class="s3">1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">h</span><span class="s1">?</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">c</span><span class="s1">=</span><span class="s2">l</span><span class="s1">+</span><span class="s3">1</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">l</span><span class="s1">+</span><span class="s3">1</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s2">i</span><span class="s1">.</span><span class="s2">select</span><span class="s1">({</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">_</span><span class="s1">,</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">m</span><span class="s1">,</span><span class="s2">clear</span><span class="s1">:</span><span class="s2">g</span><span class="s1">});</span><span class="s2">h</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">h</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">||</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToRow</span><span class="s1">(</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToCursor</span><span class="s1">()}}</span><span class="s2">onPageUp</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">Platform</span><span class="s1">.</span><span class="s2">accelKey</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">t</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">t</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">||</span><span class="s2">i</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollByPage</span><span class="s1">(</span><span class="s0">&quot;up&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">/</span><span class="s2">e</span><span class="s1">.</span><span class="s2">defaultSizes</span><span class="s1">.</span><span class="s2">rowHeight</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">let </span><span class="s2">a</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">){</span><span class="s2">a</span><span class="s1">=</span><span class="s2">l</span><span class="s1">?</span><span class="s2">l</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">h</span><span class="s1">=</span><span class="s2">l</span><span class="s1">?</span><span class="s2">l</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">-</span><span class="s2">o</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">c</span><span class="s1">=</span><span class="s2">l</span><span class="s1">?</span><span class="s2">l</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">l</span><span class="s1">?</span><span class="s2">l</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">a</span><span class="s1">=</span><span class="s2">l</span><span class="s1">?</span><span class="s2">l</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">-</span><span class="s2">o</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">h</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">c</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s2">i</span><span class="s1">.</span><span class="s2">select</span><span class="s1">({</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">h</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">clear</span><span class="s1">:</span><span class="s2">_</span><span class="s1">});</span><span class="s2">l</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">l</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToRow</span><span class="s1">(</span><span class="s2">l</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">)}</span><span class="s2">onPageDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">Platform</span><span class="s1">.</span><span class="s2">accelKey</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">t</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">t</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">||</span><span class="s2">i</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollByPage</span><span class="s1">(</span><span class="s0">&quot;down&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">/</span><span class="s2">e</span><span class="s1">.</span><span class="s2">defaultSizes</span><span class="s1">.</span><span class="s2">rowHeight</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">let </span><span class="s2">a</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">){</span><span class="s2">a</span><span class="s1">=</span><span class="s2">l</span><span class="s1">?</span><span class="s2">l</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">h</span><span class="s1">=</span><span class="s2">l</span><span class="s1">?</span><span class="s2">l</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">+</span><span class="s2">o</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">c</span><span class="s1">=</span><span class="s2">l</span><span class="s1">?</span><span class="s2">l</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">l</span><span class="s1">?</span><span class="s2">l</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">a</span><span class="s1">=</span><span class="s2">l</span><span class="s1">?</span><span class="s2">l</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">+</span><span class="s2">o</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">h</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">c</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s2">i</span><span class="s1">.</span><span class="s2">select</span><span class="s1">({</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">h</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">clear</span><span class="s1">:</span><span class="s2">_</span><span class="s1">});</span><span class="s2">l</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">l</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToRow</span><span class="s1">(</span><span class="s2">l</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">)}</span><span class="s2">onEscape</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">()}}</span><span class="s2">onDelete</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">editable</span><span class="s1">&amp;&amp;!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">.</span><span class="s2">isEmpty</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">)-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">)-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">o of e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">.</span><span class="s2">selections</span><span class="s1">()){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">o</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">,</span><span class="s2">i</span><span class="s1">));</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">o</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">,</span><span class="s2">s</span><span class="s1">));</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">o</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">,</span><span class="s2">i</span><span class="s1">));</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">o</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">,</span><span class="s2">s</span><span class="s1">));</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s2">n</span><span class="s1">;++</span><span class="s2">i</span><span class="s1">){</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s2">e</span><span class="s1">&lt;=</span><span class="s2">l</span><span class="s1">;++</span><span class="s2">e</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">setData</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s4">null</span><span class="s1">)}}}}}</span><span class="s2">onKeyC</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">||!</span><span class="s2">s</span><span class="s1">.</span><span class="s2">Platform</span><span class="s1">.</span><span class="s2">accelKey</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">t</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">t</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">copyToClipboard</span><span class="s1">()}}</span><span class="s4">class </span><span class="s2">x</span><span class="s1">{}(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">function </span><span class="s2">t</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return typeof </span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;function&quot;</span><span class="s1">?</span><span class="s2">e</span><span class="s1">(</span><span class="s2">t</span><span class="s1">):</span><span class="s2">e</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">=</span><span class="s2">t</span><span class="s1">})(</span><span class="s2">x</span><span class="s1">||(</span><span class="s2">x</span><span class="s1">={}));</span><span class="s4">class </span><span class="s2">v </span><span class="s4">extends </span><span class="s2">x</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">super</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">font</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">font</span><span class="s1">||</span><span class="s0">&quot;12px sans-serif&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">textColor</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textColor</span><span class="s1">||</span><span class="s0">&quot;#000000&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">backgroundColor</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">backgroundColor</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">verticalAlignment</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">verticalAlignment</span><span class="s1">||</span><span class="s0">&quot;center&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">horizontalAlignment</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">horizontalAlignment</span><span class="s1">||</span><span class="s0">&quot;left&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">horizontalPadding</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">horizontalPadding</span><span class="s1">||</span><span class="s3">8</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">format</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">format</span><span class="s1">||</span><span class="s2">v</span><span class="s1">.</span><span class="s2">formatGeneric</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">elideDirection</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">elideDirection</span><span class="s1">||</span><span class="s0">&quot;none&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">wrapText</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">wrapText</span><span class="s1">||</span><span class="s4">false</span><span class="s1">}</span><span class="s2">paint</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">drawBackground</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">drawText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">drawBackground</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">backgroundColor</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">)}</span><span class="s2">getText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">format</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">drawText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">font</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">textColor</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">getText</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">verticalAlignment</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">horizontalAlignment</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">elideDirection</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">wrapText</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">-(</span><span class="s2">r</span><span class="s1">===</span><span class="s0">&quot;center&quot;</span><span class="s1">?</span><span class="s3">1</span><span class="s1">:</span><span class="s3">2</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">v</span><span class="s1">.</span><span class="s2">measureFontHeight</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">let </span><span class="s2">d</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">r</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;top&quot;</span><span class="s1">:</span><span class="s2">u</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+</span><span class="s3">2</span><span class="s1">+</span><span class="s2">c</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;center&quot;</span><span class="s1">:</span><span class="s2">u</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">/</span><span class="s3">2</span><span class="s1">+</span><span class="s2">c</span><span class="s1">/</span><span class="s3">2</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;bottom&quot;</span><span class="s1">:</span><span class="s2">u</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">-</span><span class="s3">2</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">n</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s2">d</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">horizontalPadding</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">-</span><span class="s3">14</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;center&quot;</span><span class="s1">:</span><span class="s2">d</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">/</span><span class="s3">2</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;right&quot;</span><span class="s1">:</span><span class="s2">d</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">horizontalPadding</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">-</span><span class="s3">14</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">c</span><span class="s1">&gt;</span><span class="s2">h</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rect</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">clip</span><span class="s1">()}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">font</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textAlign</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textBaseline</span><span class="s1">=</span><span class="s0">&quot;bottom&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">===</span><span class="s0">&quot;none&quot;</span><span class="s1">&amp;&amp;!</span><span class="s2">a</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">u</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">).</span><span class="s2">width</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">&amp;&amp;</span><span class="s2">_</span><span class="s1">&gt;</span><span class="s2">f</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rect</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">clip</span><span class="s1">();</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">split</span><span class="s1">(</span><span class="s5">/\s(?=\b)/</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">shift</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">r</span><span class="s1">).</span><span class="s2">width</span><span class="s1">;</span><span class="s4">while</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;</span><span class="s2">f</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">!==</span><span class="s0">&quot;&quot;</span><span class="s1">){</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">i</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">;</span><span class="s2">i</span><span class="s1">--){</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">).</span><span class="s2">width</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s2">f</span><span class="s1">||</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">1</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">r</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">r</span><span class="s1">).</span><span class="s2">width</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s2">s</span><span class="s1">+=</span><span class="s2">c</span><span class="s1">;</span><span class="s4">break</span><span class="s1">}}}}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">while</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">length</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">shift</span><span class="s1">();</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=[</span><span class="s2">r</span><span class="s1">,</span><span class="s2">t</span><span class="s1">].</span><span class="s2">join</span><span class="s1">(</span><span class="s0">&quot; &quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">).</span><span class="s2">width</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&gt;</span><span class="s2">f</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s2">s</span><span class="s1">+=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">r</span><span class="s1">=</span><span class="s2">o</span><span class="s1">}}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">m</span><span class="s1">=</span><span class="s0">&quot;…&quot;</span><span class="s1">;</span><span class="s4">while</span><span class="s1">(</span><span class="s2">_</span><span class="s1">&gt;</span><span class="s2">f</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">1</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=[</span><span class="s2">...o</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">===</span><span class="s0">&quot;right&quot;</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">4</span><span class="s1">&amp;&amp;</span><span class="s2">_</span><span class="s1">&gt;=</span><span class="s3">2</span><span class="s1">*</span><span class="s2">f</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">length</span><span class="s1">/</span><span class="s3">2</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)).</span><span class="s2">join</span><span class="s1">(</span><span class="s0">&quot;&quot;</span><span class="s1">)+</span><span class="s2">m</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s3">2</span><span class="s1">).</span><span class="s2">join</span><span class="s1">(</span><span class="s0">&quot;&quot;</span><span class="s1">)+</span><span class="s2">m</span><span class="s1">}}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">4</span><span class="s1">&amp;&amp;</span><span class="s2">_</span><span class="s1">&gt;=</span><span class="s3">2</span><span class="s1">*</span><span class="s2">f</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s2">m</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">length</span><span class="s1">/</span><span class="s3">2</span><span class="s1">)).</span><span class="s2">join</span><span class="s1">(</span><span class="s0">&quot;&quot;</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">=</span><span class="s2">m</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s3">2</span><span class="s1">).</span><span class="s2">join</span><span class="s1">(</span><span class="s0">&quot;&quot;</span><span class="s1">)}}</span><span class="s2">_</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">).</span><span class="s2">width</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">u</span><span class="s1">)}}(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">function </span><span class="s2">t</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">missing</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">return</span><span class="s1">({</span><span class="s2">value</span><span class="s1">:</span><span class="s2">e</span><span class="s1">})=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s4">return </span><span class="s2">String</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">formatGeneric</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">function </span><span class="s2">i</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">digits</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">missing</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">return</span><span class="s1">({</span><span class="s2">value</span><span class="s1">:</span><span class="s2">e</span><span class="s1">})=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">return </span><span class="s2">Number</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">toFixed</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">formatFixed</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">function </span><span class="s2">s</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">digits</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">missing</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">return</span><span class="s1">({</span><span class="s2">value</span><span class="s1">:</span><span class="s2">e</span><span class="s1">})=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">return </span><span class="s2">Number</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">toPrecision</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">formatPrecision</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">function </span><span class="s2">o</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">digits</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">missing</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">return</span><span class="s1">({</span><span class="s2">value</span><span class="s1">:</span><span class="s2">e</span><span class="s1">})=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">return </span><span class="s2">Number</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">toExponential</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">formatExponential</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s4">function </span><span class="s2">r</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">missing</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Intl</span><span class="s1">.</span><span class="s2">NumberFormat</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">locales</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">options</span><span class="s1">);</span><span class="s4">return</span><span class="s1">({</span><span class="s2">value</span><span class="s1">:</span><span class="s2">e</span><span class="s1">})=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s4">return </span><span class="s2">i</span><span class="s1">.</span><span class="s2">format</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">formatIntlNumber</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">function </span><span class="s2">n</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">missing</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">return</span><span class="s1">({</span><span class="s2">value</span><span class="s1">:</span><span class="s2">e</span><span class="s1">})=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e </span><span class="s4">instanceof </span><span class="s2">Date</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">toDateString</span><span class="s1">()}</span><span class="s4">return new </span><span class="s2">Date</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">toDateString</span><span class="s1">()}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">formatDate</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s4">function </span><span class="s2">l</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">missing</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">return</span><span class="s1">({</span><span class="s2">value</span><span class="s1">:</span><span class="s2">e</span><span class="s1">})=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e </span><span class="s4">instanceof </span><span class="s2">Date</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">toTimeString</span><span class="s1">()}</span><span class="s4">return new </span><span class="s2">Date</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">toTimeString</span><span class="s1">()}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">formatTime</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s4">function </span><span class="s2">a</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">missing</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">return</span><span class="s1">({</span><span class="s2">value</span><span class="s1">:</span><span class="s2">e</span><span class="s1">})=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e </span><span class="s4">instanceof </span><span class="s2">Date</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">toISOString</span><span class="s1">()}</span><span class="s4">return new </span><span class="s2">Date</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">toISOString</span><span class="s1">()}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">formatISODateTime</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s4">function </span><span class="s2">h</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">missing</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">return</span><span class="s1">({</span><span class="s2">value</span><span class="s1">:</span><span class="s2">e</span><span class="s1">})=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e </span><span class="s4">instanceof </span><span class="s2">Date</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">toUTCString</span><span class="s1">()}</span><span class="s4">return new </span><span class="s2">Date</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">toUTCString</span><span class="s1">()}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">formatUTCDateTime</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s4">function </span><span class="s2">c</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">missing</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Intl</span><span class="s1">.</span><span class="s2">DateTimeFormat</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">locales</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">options</span><span class="s1">);</span><span class="s4">return</span><span class="s1">({</span><span class="s2">value</span><span class="s1">:</span><span class="s2">e</span><span class="s1">})=&gt;{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s4">return </span><span class="s2">i</span><span class="s1">.</span><span class="s2">format</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">formatIntlDateTime</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s4">function </span><span class="s2">d</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">C</span><span class="s1">.</span><span class="s2">fontHeightCache</span><span class="s1">[</span><span class="s2">e</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">!==</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s2">C</span><span class="s1">.</span><span class="s2">fontMeasurementGC</span><span class="s1">.</span><span class="s2">font</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">C</span><span class="s1">.</span><span class="s2">fontMeasurementGC</span><span class="s1">.</span><span class="s2">font</span><span class="s1">;</span><span class="s2">C</span><span class="s1">.</span><span class="s2">fontMeasurementNode</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">font</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">document</span><span class="s1">.</span><span class="s2">body</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s2">C</span><span class="s1">.</span><span class="s2">fontMeasurementNode</span><span class="s1">);</span><span class="s2">t</span><span class="s1">=</span><span class="s2">C</span><span class="s1">.</span><span class="s2">fontMeasurementNode</span><span class="s1">.</span><span class="s2">offsetHeight</span><span class="s1">;</span><span class="s2">document</span><span class="s1">.</span><span class="s2">body</span><span class="s1">.</span><span class="s2">removeChild</span><span class="s1">(</span><span class="s2">C</span><span class="s1">.</span><span class="s2">fontMeasurementNode</span><span class="s1">);</span><span class="s2">C</span><span class="s1">.</span><span class="s2">fontHeightCache</span><span class="s1">[</span><span class="s2">e</span><span class="s1">]=</span><span class="s2">t</span><span class="s1">;</span><span class="s2">C</span><span class="s1">.</span><span class="s2">fontHeightCache</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureFontHeight</span><span class="s1">=</span><span class="s2">d</span><span class="s1">})(</span><span class="s2">v</span><span class="s1">||(</span><span class="s2">v</span><span class="s1">={}));</span><span class="s4">var </span><span class="s2">C</span><span class="s1">;(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fontHeightCache</span><span class="s1">=</span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s4">null</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fontMeasurementNode</span><span class="s1">=(()=&gt;{</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;div&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">position</span><span class="s1">=</span><span class="s0">&quot;absolute&quot;</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s0">&quot;-99999px&quot;</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">left</span><span class="s1">=</span><span class="s0">&quot;-99999px&quot;</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">visibility</span><span class="s1">=</span><span class="s0">&quot;hidden&quot;</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textContent</span><span class="s1">=</span><span class="s0">&quot;M&quot;</span><span class="s1">;</span><span class="s4">return </span><span class="s2">e</span><span class="s1">})();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fontMeasurementGC</span><span class="s1">=(()=&gt;{</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;canvas&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">getContext</span><span class="s1">(</span><span class="s0">&quot;2d&quot;</span><span class="s1">)})()})(</span><span class="s2">C</span><span class="s1">||(</span><span class="s2">C</span><span class="s1">={}));</span><span class="s4">class </span><span class="s2">M </span><span class="s4">extends </span><span class="s2">v</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textColor</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textColor</span><span class="s1">||</span><span class="s0">&quot;navy&quot;</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">font</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">font</span><span class="s1">||</span><span class="s0">&quot;bold 12px sans-serif&quot;</span><span class="s1">;</span><span class="s4">super</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">url</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">url</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">urlName</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">urlName</span><span class="s1">}</span><span class="s2">getText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">urlName</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">format</span><span class="s1">({</span><span class="s2">...e</span><span class="s1">,</span><span class="s2">value</span><span class="s1">:</span><span class="s2">t</span><span class="s1">})}</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">format</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">drawText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">font</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">textColor</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">getText</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">verticalAlignment</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">horizontalAlignment</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">elideDirection</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">wrapText</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">-(</span><span class="s2">r</span><span class="s1">===</span><span class="s0">&quot;center&quot;</span><span class="s1">?</span><span class="s3">1</span><span class="s1">:</span><span class="s3">2</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">M</span><span class="s1">.</span><span class="s2">measureFontHeight</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">let </span><span class="s2">d</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">r</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;top&quot;</span><span class="s1">:</span><span class="s2">u</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+</span><span class="s3">2</span><span class="s1">+</span><span class="s2">c</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;center&quot;</span><span class="s1">:</span><span class="s2">u</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">/</span><span class="s3">2</span><span class="s1">+</span><span class="s2">c</span><span class="s1">/</span><span class="s3">2</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;bottom&quot;</span><span class="s1">:</span><span class="s2">u</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">-</span><span class="s3">2</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">n</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s2">d</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">+</span><span class="s3">8</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">-</span><span class="s3">14</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;center&quot;</span><span class="s1">:</span><span class="s2">d</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">/</span><span class="s3">2</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;right&quot;</span><span class="s1">:</span><span class="s2">d</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">-</span><span class="s3">8</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">-</span><span class="s3">14</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">c</span><span class="s1">&gt;</span><span class="s2">h</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rect</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">clip</span><span class="s1">()}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">font</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textAlign</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textBaseline</span><span class="s1">=</span><span class="s0">&quot;bottom&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">===</span><span class="s0">&quot;none&quot;</span><span class="s1">&amp;&amp;!</span><span class="s2">a</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">u</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">).</span><span class="s2">width</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">&amp;&amp;</span><span class="s2">_</span><span class="s1">&gt;</span><span class="s2">f</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rect</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">clip</span><span class="s1">();</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">split</span><span class="s1">(</span><span class="s5">/\s(?=\b)/</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">shift</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">r</span><span class="s1">).</span><span class="s2">width</span><span class="s1">;</span><span class="s4">while</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;</span><span class="s2">f</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">!==</span><span class="s0">&quot;&quot;</span><span class="s1">){</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">i</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">;</span><span class="s2">i</span><span class="s1">--){</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">).</span><span class="s2">width</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s2">f</span><span class="s1">||</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">1</span><span class="s1">){</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s2">r</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">r</span><span class="s1">).</span><span class="s2">width</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s2">s</span><span class="s1">+=</span><span class="s2">c</span><span class="s1">;</span><span class="s4">break</span><span class="s1">}}}}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">while</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">length</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">shift</span><span class="s1">();</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=[</span><span class="s2">r</span><span class="s1">,</span><span class="s2">t</span><span class="s1">].</span><span class="s2">join</span><span class="s1">(</span><span class="s0">&quot; &quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">).</span><span class="s2">width</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&gt;</span><span class="s2">f</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s2">s</span><span class="s1">+=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">r</span><span class="s1">=</span><span class="s2">o</span><span class="s1">}}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s0">&quot;…&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">===</span><span class="s0">&quot;right&quot;</span><span class="s1">){</span><span class="s4">while</span><span class="s1">(</span><span class="s2">_</span><span class="s1">&gt;</span><span class="s2">f</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">1</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">4</span><span class="s1">&amp;&amp;</span><span class="s2">_</span><span class="s1">&gt;=</span><span class="s3">2</span><span class="s1">*</span><span class="s2">f</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">/</span><span class="s3">2</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)+</span><span class="s2">m</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s3">2</span><span class="s1">)+</span><span class="s2">m</span><span class="s1">}</span><span class="s2">_</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">).</span><span class="s2">width</span><span class="s1">}}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">while</span><span class="s1">(</span><span class="s2">_</span><span class="s1">&gt;</span><span class="s2">f</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">1</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">4</span><span class="s1">&amp;&amp;</span><span class="s2">_</span><span class="s1">&gt;=</span><span class="s3">2</span><span class="s1">*</span><span class="s2">f</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s2">m</span><span class="s1">+</span><span class="s2">o</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">/</span><span class="s3">2</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">=</span><span class="s2">m</span><span class="s1">+</span><span class="s2">o</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s3">2</span><span class="s1">)}</span><span class="s2">_</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">).</span><span class="s2">width</span><span class="s1">}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">u</span><span class="s1">)}}</span><span class="s4">var </span><span class="s2">S</span><span class="s1">;(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">function </span><span class="s2">t</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&gt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&lt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&gt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&lt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">||</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&gt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&lt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">||</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&gt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&lt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&gt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&lt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">&gt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">&lt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">||</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&gt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&lt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">||</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">&gt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">&lt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">areCellGroupsIntersectingAtAxis</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">function </span><span class="s2">i</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&gt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&lt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&gt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&lt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">||</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&gt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&lt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">||</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&gt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&lt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">)&amp;&amp;(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&gt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&lt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">&gt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">&lt;=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">||</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&gt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&lt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">||</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">&gt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">&lt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">)}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">areCellGroupsIntersecting</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">function </span><span class="s2">s</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">groupCount</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">;</span><span class="s2">r</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">group</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&amp;&amp;</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&gt;=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">){</span><span class="s4">return </span><span class="s2">r</span><span class="s1">}}</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">getGroupIndex</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">function </span><span class="s2">o</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">o</span><span class="s1">){</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">===-</span><span class="s3">1</span><span class="s1">){</span><span class="s4">return null</span><span class="s1">}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">group</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">getGroup</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s4">function </span><span class="s2">r</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=[];</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">groupCount</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">o</span><span class="s1">&lt;</span><span class="s2">s</span><span class="s1">;</span><span class="s2">o</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">group</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s2">i</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">getCellGroupsAtRegion</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">function </span><span class="s2">n</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">MAX_VALUE</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">MIN_VALUE</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">MAX_VALUE</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">MIN_VALUE</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">r of e</span><span class="s1">){</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">);</span><span class="s2">i</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">);</span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">);</span><span class="s2">o</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">)}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">o</span><span class="s1">}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">joinCellGroups</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s4">function </span><span class="s2">l</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">let </span><span class="s2">o</span><span class="s1">={</span><span class="s2">...t</span><span class="s1">};</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s2">r</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">l</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">r</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">l</span><span class="s1">[</span><span class="s2">r</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)){</span><span class="s2">o</span><span class="s1">=</span><span class="s2">n</span><span class="s1">([</span><span class="s2">o</span><span class="s1">,</span><span class="s2">e</span><span class="s1">])}}</span><span class="s4">return </span><span class="s2">o</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">joinCellGroupWithMergedCellGroups</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s4">function </span><span class="s2">a</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=[];</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">groupCount</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">;</span><span class="s2">r</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">group</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&amp;&amp;</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">){</span><span class="s2">s</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">o</span><span class="s1">)}}</span><span class="s4">return </span><span class="s2">s</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">getCellGroupsAtRow</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s4">function </span><span class="s2">h</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=[];</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">groupCount</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">;</span><span class="s2">r</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">group</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&amp;&amp;</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">){</span><span class="s2">s</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">o</span><span class="s1">)}}</span><span class="s4">return </span><span class="s2">s</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">getCellGroupsAtColumn</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s4">function </span><span class="s2">c</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">){</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=[];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">s of i</span><span class="s1">){</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">;</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">;</span><span class="s2">i</span><span class="s1">++){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">getCellGroupsAtRow</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">i</span><span class="s1">))}}}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">s of i</span><span class="s1">){</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">;</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">;</span><span class="s2">i</span><span class="s1">++){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">getCellGroupsAtColumn</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">i</span><span class="s1">))}}}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">joinCellGroups</span><span class="s1">(</span><span class="s2">r</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=[];</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">s of i</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">getCellGroupsAtRegion</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">))}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">t</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">o</span><span class="s1">[</span><span class="s2">t</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">areCellGroupsIntersectingAtAxis</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">joinCellGroups</span><span class="s1">([</span><span class="s2">i</span><span class="s1">,</span><span class="s2">n</span><span class="s1">]);</span><span class="s2">o</span><span class="s1">.</span><span class="s2">splice</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s3">1</span><span class="s1">);</span><span class="s2">t</span><span class="s1">=</span><span class="s3">0</span><span class="s1">}}}</span><span class="s4">return </span><span class="s2">n</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">joinCellGroupsIntersectingAtAxis</span><span class="s1">=</span><span class="s2">c</span><span class="s1">})(</span><span class="s2">S</span><span class="s1">||(</span><span class="s2">S</span><span class="s1">={}));</span><span class="s4">class </span><span class="s2">b</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">=</span><span class="s4">null</span><span class="s1">}</span><span class="s2">dispose</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">release</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">=</span><span class="s4">true</span><span class="s1">}</span><span class="s2">get isDisposed</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">}</span><span class="s2">release</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;select&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">.</span><span class="s2">timeout</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">.</span><span class="s2">override</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">=</span><span class="s4">null</span><span class="s1">}</span><span class="s2">onMouseHover</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">hitTest</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">clientX</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">clientY</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">resizeHandleForHitTest</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cursorForHandle</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">createCellConfigObject</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">cellRenderers</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">r</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t </span><span class="s4">instanceof </span><span class="s2">M</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cursorForHandle</span><span class="s1">(</span><span class="s0">&quot;hyperlink&quot;</span><span class="s1">)}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">cursor</span><span class="s1">=</span><span class="s2">o</span><span class="s1">}</span><span class="s2">onMouseLeave</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">cursor</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s2">onMouseDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">clientX</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">clientY</span><span class="s1">:</span><span class="s2">o</span><span class="s1">}=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">hitTest</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">const</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">h</span><span class="s1">}=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;void&quot;</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">Platform</span><span class="s1">.</span><span class="s2">accelKey</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">createCellConfigObject</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">cellRenderers</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i </span><span class="s4">instanceof </span><span class="s2">M</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">url</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">s</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">v</span><span class="s1">.</span><span class="s2">formatGeneric</span><span class="s1">();</span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">d</span><span class="s1">){</span><span class="s2">window</span><span class="s1">.</span><span class="s2">open</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cursorForHandle</span><span class="s1">(</span><span class="s0">&quot;none&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">cursor</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">return</span><span class="s1">}}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Drag</span><span class="s1">.</span><span class="s2">overrideCursor</span><span class="s1">(</span><span class="s0">&quot;default&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">={</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;select&quot;</span><span class="s1">,</span><span class="s2">region</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">h</span><span class="s1">,</span><span class="s2">override</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">localX</span><span class="s1">:-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">localY</span><span class="s1">:-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">timeout</span><span class="s1">:-</span><span class="s3">1</span><span class="s1">};</span><span class="s4">let </span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">d</span><span class="s1">){</span><span class="s2">s</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">r</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">o</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">c</span><span class="s1">){</span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s2">r</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">s</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">r</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">o</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s2">u</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s2">t</span><span class="s1">.</span><span class="s2">select</span><span class="s1">({</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">_</span><span class="s1">,</span><span class="s2">clear</span><span class="s1">:</span><span class="s2">m</span><span class="s1">});</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">resizeHandleForHitTest</span><span class="s1">(</span><span class="s2">r</span><span class="s1">);</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cursorForHandle</span><span class="s1">(</span><span class="s2">u</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">u</span><span class="s1">===</span><span class="s0">&quot;left&quot;</span><span class="s1">||</span><span class="s2">u</span><span class="s1">===</span><span class="s0">&quot;right&quot;</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s0">&quot;column-resize&quot;</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;column-header&quot;</span><span class="s1">?</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s0">&quot;row-header&quot;</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">u</span><span class="s1">===</span><span class="s0">&quot;left&quot;</span><span class="s1">?</span><span class="s2">h</span><span class="s1">-</span><span class="s3">1</span><span class="s1">:</span><span class="s2">h</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnSize</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Drag</span><span class="s1">.</span><span class="s2">overrideCursor</span><span class="s1">(</span><span class="s2">f</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">={</span><span class="s2">type</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">region</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">index</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">size</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">clientX</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">override</span><span class="s1">:</span><span class="s2">a</span><span class="s1">};</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">u</span><span class="s1">===</span><span class="s0">&quot;top&quot;</span><span class="s1">||</span><span class="s2">u</span><span class="s1">===</span><span class="s0">&quot;bottom&quot;</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s0">&quot;row-resize&quot;</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;row-header&quot;</span><span class="s1">?</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s0">&quot;column-header&quot;</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">u</span><span class="s1">===</span><span class="s0">&quot;top&quot;</span><span class="s1">?</span><span class="s2">a</span><span class="s1">-</span><span class="s3">1</span><span class="s1">:</span><span class="s2">a</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowSize</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Drag</span><span class="s1">.</span><span class="s2">overrideCursor</span><span class="s1">(</span><span class="s2">f</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">={</span><span class="s2">type</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">region</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">index</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">size</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">clientY</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">override</span><span class="s1">:</span><span class="s2">h</span><span class="s1">};</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">_</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s2">l</span><span class="s1">.</span><span class="s2">Drag</span><span class="s1">.</span><span class="s2">overrideCursor</span><span class="s1">(</span><span class="s0">&quot;default&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">={</span><span class="s2">type</span><span class="s1">:</span><span class="s0">&quot;select&quot;</span><span class="s1">,</span><span class="s2">region</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">h</span><span class="s1">,</span><span class="s2">override</span><span class="s1">:</span><span class="s2">m</span><span class="s1">,</span><span class="s2">localX</span><span class="s1">:-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">localY</span><span class="s1">:-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">timeout</span><span class="s1">:-</span><span class="s3">1</span><span class="s1">};</span><span class="s4">let </span><span class="s2">g</span><span class="s1">;</span><span class="s4">let </span><span class="s2">p</span><span class="s1">;</span><span class="s4">let </span><span class="s2">w</span><span class="s1">;</span><span class="s4">let </span><span class="s2">y</span><span class="s1">;</span><span class="s4">let </span><span class="s2">C</span><span class="s1">;</span><span class="s4">let </span><span class="s2">b</span><span class="s1">;</span><span class="s4">let </span><span class="s2">R</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">){</span><span class="s2">g</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">w</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s2">p</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">y</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s2">C</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s3">0</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s2">_</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">b</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s3">0</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s2">_</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">R</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s0">&quot;none&quot;</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s0">&quot;current&quot;</span><span class="s1">:</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;row-header&quot;</span><span class="s1">){</span><span class="s2">g</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s2">a</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s2">_</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">a</span><span class="s1">;</span><span class="s2">w</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">={</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">g</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">w</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">};</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">joinCellGroupsIntersectingAtAxis</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,[</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s0">&quot;body&quot;</span><span class="s1">],</span><span class="s0">&quot;row&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">!=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">MAX_VALUE</span><span class="s1">){</span><span class="s2">g</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">;</span><span class="s2">w</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">}</span><span class="s2">p</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">y</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s2">C</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s2">a</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s2">_</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">a</span><span class="s1">;</span><span class="s2">b</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s3">0</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s2">_</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">R</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s0">&quot;none&quot;</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s0">&quot;current&quot;</span><span class="s1">:</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s0">&quot;column-header&quot;</span><span class="s1">){</span><span class="s2">g</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">w</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s2">p</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s2">h</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s2">_</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">h</span><span class="s1">;</span><span class="s2">y</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">={</span><span class="s2">r1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">p</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">y</span><span class="s1">};</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">joinCellGroupsIntersectingAtAxis</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,[</span><span class="s0">&quot;column-header&quot;</span><span class="s1">,</span><span class="s0">&quot;body&quot;</span><span class="s1">],</span><span class="s0">&quot;column&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">!=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">MAX_VALUE</span><span class="s1">){</span><span class="s2">p</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">;</span><span class="s2">y</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">}</span><span class="s2">C</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s3">0</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s2">_</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">b</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s2">h</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s2">_</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">h</span><span class="s1">;</span><span class="s2">R</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s0">&quot;none&quot;</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s0">&quot;current&quot;</span><span class="s1">:</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">g</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s2">a</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s2">_</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">a</span><span class="s1">;</span><span class="s2">w</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">p</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s2">h</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s2">_</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">h</span><span class="s1">;</span><span class="s2">y</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s2">C</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s2">a</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s2">_</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">a</span><span class="s1">;</span><span class="s2">b</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s2">h</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s2">_</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">h</span><span class="s1">;</span><span class="s2">R</span><span class="s1">=</span><span class="s2">d</span><span class="s1">?</span><span class="s0">&quot;none&quot;</span><span class="s1">:</span><span class="s2">c</span><span class="s1">?</span><span class="s0">&quot;current&quot;</span><span class="s1">:</span><span class="s0">&quot;all&quot;</span><span class="s1">}</span><span class="s2">_</span><span class="s1">.</span><span class="s2">select</span><span class="s1">({</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">g</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">p</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">w</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">y</span><span class="s1">,</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">C</span><span class="s1">,</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">b</span><span class="s1">,</span><span class="s2">clear</span><span class="s1">:</span><span class="s2">R</span><span class="s1">})}</span><span class="s2">onMouseMove</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;row-resize&quot;</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">clientY</span><span class="s1">-</span><span class="s2">i</span><span class="s1">.</span><span class="s2">clientY</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">resizeRow</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">index</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">size</span><span class="s1">+</span><span class="s2">s</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;column-resize&quot;</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">clientX</span><span class="s1">-</span><span class="s2">i</span><span class="s1">.</span><span class="s2">clientX</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">resizeColumn</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">index</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">size</span><span class="s1">+</span><span class="s2">s</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">region</span><span class="s1">===</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let</span><span class="s1">{</span><span class="s2">lx</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">ly</span><span class="s1">:</span><span class="s2">r</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">mapToLocal</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">clientX</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">clientY</span><span class="s1">);</span><span class="s2">i</span><span class="s1">.</span><span class="s2">localX</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">localY</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">viewportWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">viewportHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">region</span><span class="s1">===</span><span class="s0">&quot;row-header&quot;</span><span class="s1">||</span><span class="s2">_</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">l</span><span class="s1">&amp;&amp;</span><span class="s2">d</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">m</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">computeTimeout</span><span class="s1">(</span><span class="s2">l</span><span class="s1">-</span><span class="s2">r</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&gt;=</span><span class="s2">h</span><span class="s1">&amp;&amp;</span><span class="s2">d</span><span class="s1">&lt;</span><span class="s2">f</span><span class="s1">){</span><span class="s2">m</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">computeTimeout</span><span class="s1">(</span><span class="s2">r</span><span class="s1">-</span><span class="s2">h</span><span class="s1">)}}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">region</span><span class="s1">===</span><span class="s0">&quot;column-header&quot;</span><span class="s1">||</span><span class="s2">_</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;</span><span class="s2">n</span><span class="s1">&amp;&amp;</span><span class="s2">c</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">m</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">computeTimeout</span><span class="s1">(</span><span class="s2">n</span><span class="s1">-</span><span class="s2">o</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;=</span><span class="s2">a</span><span class="s1">&amp;&amp;</span><span class="s2">c</span><span class="s1">&lt;</span><span class="s2">u</span><span class="s1">){</span><span class="s2">m</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">computeTimeout</span><span class="s1">(</span><span class="s2">o</span><span class="s1">-</span><span class="s2">a</span><span class="s1">)}}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;</span><span class="s2">n</span><span class="s1">&amp;&amp;</span><span class="s2">c</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">m</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">computeTimeout</span><span class="s1">(</span><span class="s2">n</span><span class="s1">-</span><span class="s2">o</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;=</span><span class="s2">a</span><span class="s1">&amp;&amp;</span><span class="s2">c</span><span class="s1">&lt;</span><span class="s2">u</span><span class="s1">){</span><span class="s2">m</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">computeTimeout</span><span class="s1">(</span><span class="s2">o</span><span class="s1">-</span><span class="s2">a</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">l</span><span class="s1">&amp;&amp;</span><span class="s2">d</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">m</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">computeTimeout</span><span class="s1">(</span><span class="s2">l</span><span class="s1">-</span><span class="s2">r</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&gt;=</span><span class="s2">h</span><span class="s1">&amp;&amp;</span><span class="s2">d</span><span class="s1">&lt;</span><span class="s2">f</span><span class="s1">){</span><span class="s2">m</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">computeTimeout</span><span class="s1">(</span><span class="s2">r</span><span class="s1">-</span><span class="s2">h</span><span class="s1">)}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">m</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">timeout</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">i</span><span class="s1">.</span><span class="s2">timeout</span><span class="s1">=</span><span class="s2">m</span><span class="s1">;</span><span class="s2">setTimeout</span><span class="s1">((()=&gt;{</span><span class="s2">H</span><span class="s1">.</span><span class="s2">autoselect</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)}),</span><span class="s2">m</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">i</span><span class="s1">.</span><span class="s2">timeout</span><span class="s1">=</span><span class="s2">m</span><span class="s1">}</span><span class="s4">return</span><span class="s1">}</span><span class="s2">i</span><span class="s1">.</span><span class="s2">timeout</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let</span><span class="s1">{</span><span class="s2">vx</span><span class="s1">:</span><span class="s2">g</span><span class="s1">,</span><span class="s2">vy</span><span class="s1">:</span><span class="s2">p</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">mapToVirtual</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">clientX</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">clientY</span><span class="s1">);</span><span class="s2">g</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">g</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s2">p</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">p</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s4">let </span><span class="s2">w</span><span class="s1">;</span><span class="s4">let </span><span class="s2">y</span><span class="s1">;</span><span class="s4">let </span><span class="s2">x</span><span class="s1">;</span><span class="s4">let </span><span class="s2">v</span><span class="s1">;</span><span class="s4">let </span><span class="s2">C</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s4">let </span><span class="s2">M</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s4">let </span><span class="s2">b</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">region</span><span class="s1">===</span><span class="s0">&quot;row-header&quot;</span><span class="s1">||</span><span class="s2">_</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s2">w</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">row</span><span class="s1">;</span><span class="s2">x</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowAt</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">p</span><span class="s1">);</span><span class="s4">const </span><span class="s2">t</span><span class="s1">={</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">w</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">x</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">};</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">joinCellGroupsIntersectingAtAxis</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,[</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s0">&quot;body&quot;</span><span class="s1">],</span><span class="s0">&quot;row&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">!=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">MAX_VALUE</span><span class="s1">){</span><span class="s2">w</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">w</span><span class="s1">,</span><span class="s2">s</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">);</span><span class="s2">x</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">x</span><span class="s1">,</span><span class="s2">s</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">)}</span><span class="s2">y</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">v</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">region</span><span class="s1">===</span><span class="s0">&quot;column-header&quot;</span><span class="s1">||</span><span class="s2">_</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s2">w</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">x</span><span class="s1">=</span><span class="s2">Infinity</span><span class="s1">;</span><span class="s2">y</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">column</span><span class="s1">;</span><span class="s2">v</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnAt</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">g</span><span class="s1">);</span><span class="s4">const </span><span class="s2">t</span><span class="s1">={</span><span class="s2">r1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">y</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">v</span><span class="s1">};</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">joinCellGroupsIntersectingAtAxis</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,[</span><span class="s0">&quot;column-header&quot;</span><span class="s1">,</span><span class="s0">&quot;body&quot;</span><span class="s1">],</span><span class="s0">&quot;column&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">!=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">MAX_VALUE</span><span class="s1">){</span><span class="s2">y</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">;</span><span class="s2">v</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">}}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">w</span><span class="s1">=</span><span class="s2">C</span><span class="s1">;</span><span class="s2">x</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowAt</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">p</span><span class="s1">);</span><span class="s2">y</span><span class="s1">=</span><span class="s2">M</span><span class="s1">;</span><span class="s2">v</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnAt</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">g</span><span class="s1">)}</span><span class="s2">s</span><span class="s1">.</span><span class="s2">select</span><span class="s1">({</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">w</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">y</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">x</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">v</span><span class="s1">,</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">C</span><span class="s1">,</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">M</span><span class="s1">,</span><span class="s2">clear</span><span class="s1">:</span><span class="s2">b</span><span class="s1">})}</span><span class="s2">onMouseUp</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">release</span><span class="s1">()}</span><span class="s2">onMouseDoubleClick</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">var </span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">release</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let</span><span class="s1">{</span><span class="s2">clientX</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">clientY</span><span class="s1">:</span><span class="s2">n</span><span class="s1">}=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">hitTest</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">let</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">h</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">c</span><span class="s1">}=</span><span class="s2">l</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">===</span><span class="s0">&quot;void&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">release</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">===</span><span class="s0">&quot;column-header&quot;</span><span class="s1">||</span><span class="s2">a</span><span class="s1">===</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">H</span><span class="s1">.</span><span class="s2">resizeHandleForHitTest</span><span class="s1">(</span><span class="s2">l</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;left&quot;</span><span class="s1">||</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;right&quot;</span><span class="s1">){</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;left&quot;</span><span class="s1">?</span><span class="s2">c</span><span class="s1">-</span><span class="s3">1</span><span class="s1">:</span><span class="s2">c</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">a</span><span class="s1">===</span><span class="s0">&quot;column-header&quot;</span><span class="s1">?</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s0">&quot;row-header&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">===</span><span class="s0">&quot;column-header&quot;</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">)-</span><span class="s3">1</span><span class="s1">;</span><span class="s2">n</span><span class="s1">=</span><span class="s0">&quot;row-header&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">return</span><span class="s1">}}</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=(</span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">)===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">i</span><span class="s1">===</span><span class="s4">void </span><span class="s3">0</span><span class="s1">?</span><span class="s4">void </span><span class="s3">0</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">const </span><span class="s2">h</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">currentViewport</span><span class="s1">;</span><span class="s4">const </span><span class="s2">d</span><span class="s1">=(</span><span class="s2">o</span><span class="s1">=(</span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">)===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">s</span><span class="s1">===</span><span class="s4">void </span><span class="s3">0</span><span class="s1">?</span><span class="s4">void </span><span class="s3">0</span><span class="s1">:</span><span class="s2">s</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">))!==</span><span class="s4">null</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">!==</span><span class="s4">void </span><span class="s3">0</span><span class="s1">?</span><span class="s2">o</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">==</span><span class="s0">&quot;body&quot;</span><span class="s1">&amp;&amp;</span><span class="s2">l</span><span class="s1">!=</span><span class="s4">null</span><span class="s1">&amp;&amp;</span><span class="s2">h</span><span class="s1">!=</span><span class="s4">null</span><span class="s1">&amp;&amp;</span><span class="s2">l</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">==</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">l</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">==</span><span class="s2">d</span><span class="s1">-</span><span class="s3">1</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">l</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">),</span><span class="s2">h</span><span class="s1">.</span><span class="s2">firstColumn</span><span class="s1">);</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">l</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">,</span><span class="s2">l</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">),</span><span class="s2">h</span><span class="s1">.</span><span class="s2">lastColumn</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;=</span><span class="s2">r</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s2">i</span><span class="s1">){</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">s</span><span class="s1">++){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">resizeColumn</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s4">null</span><span class="s1">)}}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">e</span><span class="s1">.</span><span class="s2">resizeColumn</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s4">null</span><span class="s1">)}}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">e</span><span class="s1">.</span><span class="s2">resizeColumn</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s4">null</span><span class="s1">)}}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">editable</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">={</span><span class="s2">grid</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">h</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">c</span><span class="s1">};</span><span class="s2">e</span><span class="s1">.</span><span class="s2">editorController</span><span class="s1">.</span><span class="s2">edit</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">release</span><span class="s1">()}</span><span class="s2">onContextMenu</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){}</span><span class="s2">onWheel</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">deltaX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">deltaY</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">deltaMode</span><span class="s1">){</span><span class="s4">case </span><span class="s3">0</span><span class="s1">:</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case </span><span class="s3">1</span><span class="s1">:{</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">defaultSizes</span><span class="s1">;</span><span class="s2">i</span><span class="s1">*=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">columnWidth</span><span class="s1">;</span><span class="s2">s</span><span class="s1">*=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">rowHeight</span><span class="s1">;</span><span class="s4">break</span><span class="s1">}</span><span class="s4">case </span><span class="s3">2</span><span class="s1">:</span><span class="s2">i</span><span class="s1">*=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s2">s</span><span class="s1">*=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">||</span><span class="s2">i</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">||</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">||</span><span class="s2">s</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">t</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollBy</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}}</span><span class="s2">cursorForHandle</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return </span><span class="s2">H</span><span class="s1">.</span><span class="s2">cursorMap</span><span class="s1">[</span><span class="s2">e</span><span class="s1">]}</span><span class="s2">get pressData</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_pressData</span><span class="s1">}}</span><span class="s4">var </span><span class="s2">H</span><span class="s1">;(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">function </span><span class="s2">t</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">o</span><span class="s1">}=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">===</span><span class="s0">&quot;void&quot;</span><span class="s1">){</span><span class="s4">return </span><span class="s2">undefined</span><span class="s1">}</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">data</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">const </span><span class="s2">l</span><span class="s1">={</span><span class="s2">...t</span><span class="s1">,</span><span class="s2">value</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">metadata</span><span class="s1">:</span><span class="s2">n</span><span class="s1">};</span><span class="s4">return </span><span class="s2">l</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">createCellConfigObject</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">function </span><span class="s2">i</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">row</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">x</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">y</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">width</span><span class="s1">-</span><span class="s2">e</span><span class="s1">.</span><span class="s2">x</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">height</span><span class="s1">-</span><span class="s2">e</span><span class="s1">.</span><span class="s2">y</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">region</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">:</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s3">5</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;left&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s3">6</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;right&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s3">5</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;top&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&lt;=</span><span class="s3">6</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;bottom&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">}</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;column-header&quot;</span><span class="s1">:</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s3">5</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;left&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s3">6</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;right&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s3">5</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;top&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&lt;=</span><span class="s3">6</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;bottom&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">}</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;row-header&quot;</span><span class="s1">:</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s3">5</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;left&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s3">6</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;right&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s3">5</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;top&quot;</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&lt;=</span><span class="s3">6</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;bottom&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">}</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;void&quot;</span><span class="s1">:</span><span class="s2">l</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">return </span><span class="s2">l</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">resizeHandleForHitTest</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">function </span><span class="s2">s</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">timeout</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">localX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">localY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s0">&quot;current&quot;</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">g</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">viewportWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">p</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">viewportHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">w</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">===</span><span class="s0">&quot;row-header&quot;</span><span class="s1">||</span><span class="s2">w</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s2">h</span><span class="s1">+=</span><span class="s2">n</span><span class="s1">&lt;=</span><span class="s2">m</span><span class="s1">?-</span><span class="s3">1</span><span class="s1">:</span><span class="s2">n</span><span class="s1">&gt;=</span><span class="s2">p</span><span class="s1">?</span><span class="s3">1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">===</span><span class="s0">&quot;column-header&quot;</span><span class="s1">||</span><span class="s2">w</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s2">c</span><span class="s1">+=</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s2">_</span><span class="s1">?-</span><span class="s3">1</span><span class="s1">:</span><span class="s2">r</span><span class="s1">&gt;=</span><span class="s2">g</span><span class="s1">?</span><span class="s3">1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">h</span><span class="s1">+=</span><span class="s2">n</span><span class="s1">&lt;=</span><span class="s2">m</span><span class="s1">?-</span><span class="s3">1</span><span class="s1">:</span><span class="s2">n</span><span class="s1">&gt;=</span><span class="s2">p</span><span class="s1">?</span><span class="s3">1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s2">c</span><span class="s1">+=</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s2">_</span><span class="s1">?-</span><span class="s3">1</span><span class="s1">:</span><span class="s2">r</span><span class="s1">&gt;=</span><span class="s2">g</span><span class="s1">?</span><span class="s3">1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">}</span><span class="s2">i</span><span class="s1">.</span><span class="s2">select</span><span class="s1">({</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">h</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">clear</span><span class="s1">:</span><span class="s2">f</span><span class="s1">});</span><span class="s2">o</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">===</span><span class="s0">&quot;row-header&quot;</span><span class="s1">||</span><span class="s2">w</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToRow</span><span class="s1">(</span><span class="s2">o</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">===</span><span class="s0">&quot;column-header&quot;</span><span class="s1">||</span><span class="s2">w</span><span class="s1">==</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToColumn</span><span class="s1">(</span><span class="s2">o</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">w</span><span class="s1">===</span><span class="s0">&quot;cell&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">scrollToCell</span><span class="s1">(</span><span class="s2">o</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">,</span><span class="s2">o</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">)}</span><span class="s2">setTimeout</span><span class="s1">((()=&gt;{</span><span class="s2">s</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}),</span><span class="s2">t</span><span class="s1">.</span><span class="s2">timeout</span><span class="s1">)}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">autoselect</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">function </span><span class="s2">o</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return </span><span class="s3">5</span><span class="s1">+</span><span class="s3">120</span><span class="s1">*(</span><span class="s3">1</span><span class="s1">-</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s3">128</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">abs</span><span class="s1">(</span><span class="s2">e</span><span class="s1">))/</span><span class="s3">128</span><span class="s1">)}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">computeTimeout</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">cursorMap</span><span class="s1">={</span><span class="s2">top</span><span class="s1">:</span><span class="s0">&quot;ns-resize&quot;</span><span class="s1">,</span><span class="s2">left</span><span class="s1">:</span><span class="s0">&quot;ew-resize&quot;</span><span class="s1">,</span><span class="s2">right</span><span class="s1">:</span><span class="s0">&quot;ew-resize&quot;</span><span class="s1">,</span><span class="s2">bottom</span><span class="s1">:</span><span class="s0">&quot;ns-resize&quot;</span><span class="s1">,</span><span class="s2">hyperlink</span><span class="s1">:</span><span class="s0">&quot;pointer&quot;</span><span class="s1">,</span><span class="s2">none</span><span class="s1">:</span><span class="s0">&quot;default&quot;</span><span class="s1">}})(</span><span class="s2">H</span><span class="s1">||(</span><span class="s2">H</span><span class="s1">={}));</span><span class="s4">class </span><span class="s2">R</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_changed</span><span class="s1">=</span><span class="s4">new </span><span class="s2">d</span><span class="s1">.</span><span class="s2">Signal</span><span class="s1">(</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionMode</span><span class="s1">=</span><span class="s0">&quot;cell&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionMode</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">||</span><span class="s0">&quot;cell&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">changed</span><span class="s1">.</span><span class="s2">connect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onDataModelChanged</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s2">get changed</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_changed</span><span class="s1">}</span><span class="s2">get selectionMode</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_selectionMode</span><span class="s1">}</span><span class="s2">set selectionMode</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionMode</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionMode</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">()}</span><span class="s2">isRowSelected</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">h</span><span class="s1">.</span><span class="s2">some</span><span class="s1">)(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">selections</span><span class="s1">(),(</span><span class="s2">t</span><span class="s1">=&gt;</span><span class="s2">z</span><span class="s1">.</span><span class="s2">containsRow</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)))}</span><span class="s2">isColumnSelected</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">h</span><span class="s1">.</span><span class="s2">some</span><span class="s1">)(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">selections</span><span class="s1">(),(</span><span class="s2">t</span><span class="s1">=&gt;</span><span class="s2">z</span><span class="s1">.</span><span class="s2">containsColumn</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)))}</span><span class="s2">isCellSelected</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">h</span><span class="s1">.</span><span class="s2">some</span><span class="s1">)(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">selections</span><span class="s1">(),(</span><span class="s2">i</span><span class="s1">=&gt;</span><span class="s2">z</span><span class="s1">.</span><span class="s2">containsCell</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)))}</span><span class="s2">onDataModelChanged</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){}</span><span class="s2">emitChanged</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_changed</span><span class="s1">.</span><span class="s2">emit</span><span class="s1">(</span><span class="s2">undefined</span><span class="s1">)}}</span><span class="s4">var </span><span class="s2">z</span><span class="s1">;(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">function </span><span class="s2">t</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">return </span><span class="s2">t</span><span class="s1">&gt;=</span><span class="s2">i</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">&lt;=</span><span class="s2">s</span><span class="s1">||</span><span class="s2">t</span><span class="s1">&gt;=</span><span class="s2">s</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">&lt;=</span><span class="s2">i</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">containsRow</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">function </span><span class="s2">i</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">return </span><span class="s2">t</span><span class="s1">&gt;=</span><span class="s2">i</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">&lt;=</span><span class="s2">s</span><span class="s1">||</span><span class="s2">t</span><span class="s1">&gt;=</span><span class="s2">s</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">&lt;=</span><span class="s2">i</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">containsColumn</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">function </span><span class="s2">s</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return </span><span class="s2">t</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)&amp;&amp;</span><span class="s2">i</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">o</span><span class="s1">)}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">containsCell</span><span class="s1">=</span><span class="s2">s</span><span class="s1">})(</span><span class="s2">z</span><span class="s1">||(</span><span class="s2">z</span><span class="s1">={}));</span><span class="s4">class </span><span class="s2">O </span><span class="s4">extends </span><span class="s2">R</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">super</span><span class="s1">(</span><span class="s2">...arguments</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRow</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorColumn</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">=[]}</span><span class="s2">get isEmpty</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">}</span><span class="s2">get cursorRow</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_cursorRow</span><span class="s1">}</span><span class="s2">get cursorColumn</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_cursorColumn</span><span class="s1">}</span><span class="s2">moveCursorWithinSelections</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">isEmpty</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">===-</span><span class="s3">1</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorColumn</span><span class="s1">===-</span><span class="s3">1</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">[</span><span class="s3">0</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">1</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">===</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">===</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">===-</span><span class="s3">1</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">[</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">];</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;down&quot;</span><span class="s1">?</span><span class="s3">1</span><span class="s1">:</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;up&quot;</span><span class="s1">?-</span><span class="s3">1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;right&quot;</span><span class="s1">?</span><span class="s3">1</span><span class="s1">:</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;left&quot;</span><span class="s1">?-</span><span class="s3">1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRow</span><span class="s1">+</span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorColumn</span><span class="s1">+</span><span class="s2">o</span><span class="s1">;</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">);</span><span class="s4">const </span><span class="s2">a</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">);</span><span class="s4">const </span><span class="s2">h</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">);</span><span class="s4">const </span><span class="s2">c</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">);</span><span class="s4">const </span><span class="s2">d</span><span class="s1">=()=&gt;{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">=(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)%</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">[</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">];</span><span class="s2">r</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">);</span><span class="s2">n</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">)};</span><span class="s4">const </span><span class="s2">u</span><span class="s1">=()=&gt;{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">===</span><span class="s3">0</span><span class="s1">?</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">[</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">];</span><span class="s2">r</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">);</span><span class="s2">n</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">,</span><span class="s2">i</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">)};</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s2">a</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">n</span><span class="s1">+=</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&gt;</span><span class="s2">c</span><span class="s1">){</span><span class="s2">d</span><span class="s1">()}}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">l</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">n</span><span class="s1">-=</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s2">h</span><span class="s1">){</span><span class="s2">u</span><span class="s1">()}}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&gt;</span><span class="s2">c</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s2">r</span><span class="s1">+=</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s2">a</span><span class="s1">){</span><span class="s2">d</span><span class="s1">()}}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s2">h</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">r</span><span class="s1">-=</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">l</span><span class="s1">){</span><span class="s2">u</span><span class="s1">()}}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRow</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorColumn</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">emitChanged</span><span class="s1">()}</span><span class="s2">currentSelection</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">[</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">]||</span><span class="s4">null</span><span class="s1">}*</span><span class="s2">selections</span><span class="s1">(){</span><span class="s4">yield</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">}</span><span class="s2">select</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">);</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">||</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let</span><span class="s1">{</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">clear</span><span class="s1">:</span><span class="s2">h</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">===</span><span class="s0">&quot;all&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">=</span><span class="s3">0</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">===</span><span class="s0">&quot;current&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">pop</span><span class="s1">()}</span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s2">r</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s2">o</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">i</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s2">n</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">i</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">===</span><span class="s2">s</span><span class="s1">)).</span><span class="s2">length</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">=</span><span class="s2">c</span><span class="s1">?</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">!==</span><span class="s2">s</span><span class="s1">)):</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s2">s</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">===</span><span class="s2">o</span><span class="s1">)).</span><span class="s2">length</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">=</span><span class="s2">c</span><span class="s1">?</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">!==</span><span class="s2">o</span><span class="s1">)):</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">}</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">d</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">d</span><span class="s1">&lt;</span><span class="s2">s</span><span class="s1">&amp;&amp;</span><span class="s2">d</span><span class="s1">&lt;</span><span class="s2">r</span><span class="s1">||</span><span class="s2">d</span><span class="s1">&gt;</span><span class="s2">s</span><span class="s1">&amp;&amp;</span><span class="s2">d</span><span class="s1">&gt;</span><span class="s2">r</span><span class="s1">){</span><span class="s2">d</span><span class="s1">=</span><span class="s2">s</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">u</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">u</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">&amp;&amp;</span><span class="s2">u</span><span class="s1">&lt;</span><span class="s2">n</span><span class="s1">||</span><span class="s2">u</span><span class="s1">&gt;</span><span class="s2">o</span><span class="s1">&amp;&amp;</span><span class="s2">u</span><span class="s1">&gt;</span><span class="s2">n</span><span class="s1">){</span><span class="s2">u</span><span class="s1">=</span><span class="s2">o</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRow</span><span class="s1">=</span><span class="s2">d</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorColumn</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">c</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">n</span><span class="s1">})}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">emitChanged</span><span class="s1">()}</span><span class="s2">clear</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRow</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorColumn</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cursorRectIndex</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">emitChanged</span><span class="s1">()}</span><span class="s2">onDataModelChanged</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;cells-changed&quot;</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;rows-moved&quot;</span><span class="s1">||</span><span class="s2">t</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;columns-moved&quot;</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">)-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">)-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">emitChanged</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s2">l</span><span class="s1">;++</span><span class="s2">n</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">a</span><span class="s1">}=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">[</span><span class="s2">n</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">&amp;&amp;</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">l</span><span class="s1">||</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">t</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">a</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">i</span><span class="s1">));</span><span class="s2">l</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">l</span><span class="s1">,</span><span class="s2">i</span><span class="s1">));</span><span class="s2">t</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">a</span><span class="s1">=</span><span class="s2">s</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">l</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">));</span><span class="s2">a</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">s</span><span class="s1">))}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">i</span><span class="s1">));</span><span class="s2">l</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">l</span><span class="s1">,</span><span class="s2">i</span><span class="s1">));</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">));</span><span class="s2">a</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">s</span><span class="s1">))}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">[</span><span class="s2">r</span><span class="s1">++]={</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">a</span><span class="s1">}}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">emitChanged</span><span class="s1">()}}</span><span class="s4">class </span><span class="s2">k </span><span class="s4">extends </span><span class="s2">x</span><span class="s1">{}</span><span class="s4">const </span><span class="s2">E</span><span class="s1">=</span><span class="s0">&quot;Invalid input!&quot;</span><span class="s1">;</span><span class="s4">class </span><span class="s2">L</span><span class="s1">{</span><span class="s2">validate</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">true</span><span class="s1">}}}</span><span class="s4">class </span><span class="s2">W</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">minLength</span><span class="s1">=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">NaN</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxLength</span><span class="s1">=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">NaN</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pattern</span><span class="s1">=</span><span class="s4">null</span><span class="s1">}</span><span class="s2">validate</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s4">null</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">true</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">typeof </span><span class="s2">t</span><span class="s1">!==</span><span class="s0">&quot;string&quot;</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">message</span><span class="s1">:</span><span class="s0">&quot;Input must be valid text&quot;</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">isNaN</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">minLength</span><span class="s1">)&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">minLength</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">message</span><span class="s1">:</span><span class="s0">`Text length must be greater than </span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">minLength</span><span class="s1">}</span><span class="s0">`</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">isNaN</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxLength</span><span class="s1">)&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxLength</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">message</span><span class="s1">:</span><span class="s0">`Text length must be less than </span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxLength</span><span class="s1">}</span><span class="s0">`</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pattern</span><span class="s1">&amp;&amp;!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pattern</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">message</span><span class="s1">:</span><span class="s0">`Text doesn't match the required pattern`</span><span class="s1">}}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">true</span><span class="s1">}}}</span><span class="s4">class </span><span class="s2">T</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">min</span><span class="s1">=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">NaN</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">max</span><span class="s1">=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">NaN</span><span class="s1">}</span><span class="s2">validate</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s4">null</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">true</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">isNaN</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)||</span><span class="s2">t</span><span class="s1">%</span><span class="s3">1</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">message</span><span class="s1">:</span><span class="s0">&quot;Input must be valid integer&quot;</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">isNaN</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">min</span><span class="s1">)&amp;&amp;</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">min</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">message</span><span class="s1">:</span><span class="s0">`Input must be greater than </span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">min</span><span class="s1">}</span><span class="s0">`</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">isNaN</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">max</span><span class="s1">)&amp;&amp;</span><span class="s2">t</span><span class="s1">&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">max</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">message</span><span class="s1">:</span><span class="s0">`Input must be less than </span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">max</span><span class="s1">}</span><span class="s0">`</span><span class="s1">}}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">true</span><span class="s1">}}}</span><span class="s4">class </span><span class="s2">B</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">min</span><span class="s1">=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">NaN</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">max</span><span class="s1">=</span><span class="s2">Number</span><span class="s1">.</span><span class="s2">NaN</span><span class="s1">}</span><span class="s2">validate</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s4">null</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">true</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">isNaN</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">message</span><span class="s1">:</span><span class="s0">&quot;Input must be valid number&quot;</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">isNaN</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">min</span><span class="s1">)&amp;&amp;</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">min</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">message</span><span class="s1">:</span><span class="s0">`Input must be greater than </span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">min</span><span class="s1">}</span><span class="s0">`</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">isNaN</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">max</span><span class="s1">)&amp;&amp;</span><span class="s2">t</span><span class="s1">&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">max</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">false</span><span class="s1">,</span><span class="s2">message</span><span class="s1">:</span><span class="s0">`Input must be less than </span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">max</span><span class="s1">}</span><span class="s0">`</span><span class="s1">}}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">valid</span><span class="s1">:</span><span class="s4">true</span><span class="s1">}}}</span><span class="s4">class </span><span class="s2">D</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inputChanged</span><span class="s1">=</span><span class="s4">new </span><span class="s2">d</span><span class="s1">.</span><span class="s2">Signal</span><span class="s1">(</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">validityNotification</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_validInput</span><span class="s1">=</span><span class="s4">true</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_gridWheelEventHandler</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inputChanged</span><span class="s1">.</span><span class="s2">connect</span><span class="s1">((()=&gt;{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">validate</span><span class="s1">()}))}</span><span class="s2">get isDisposed</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">}</span><span class="s2">dispose</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_gridWheelEventHandler</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;wheel&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_gridWheelEventHandler</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_gridWheelEventHandler</span><span class="s1">=</span><span class="s4">null</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_closeValidityNotification</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">=</span><span class="s4">true</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">removeChild</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportOccluder</span><span class="s1">)}</span><span class="s2">edit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onCommit</span><span class="s1">=</span><span class="s2">t</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">onCommit</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onCancel</span><span class="s1">=</span><span class="s2">t</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">onCancel</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">validator</span><span class="s1">=</span><span class="s2">t</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">validator</span><span class="s1">?</span><span class="s2">t</span><span class="s1">.</span><span class="s2">validator</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">createValidatorBasedOnType</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_gridWheelEventHandler</span><span class="s1">=()=&gt;{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_closeValidityNotification</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">updatePosition</span><span class="s1">()};</span><span class="s2">e</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;wheel&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_gridWheelEventHandler</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_addContainer</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">updatePosition</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">startEditing</span><span class="s1">()}</span><span class="s2">cancel</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onCancel</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onCancel</span><span class="s1">()}}</span><span class="s2">get validInput</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_validInput</span><span class="s1">}</span><span class="s2">validate</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">;</span><span class="s4">try</span><span class="s1">{</span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">getInput</span><span class="s1">()}</span><span class="s4">catch</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">console</span><span class="s1">.</span><span class="s2">log</span><span class="s1">(</span><span class="s0">`Input error: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">t</span><span class="s1">.</span><span class="s2">message</span><span class="s1">}</span><span class="s0">`</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">setValidity</span><span class="s1">(</span><span class="s4">false</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">message</span><span class="s1">||</span><span class="s2">E</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">validator</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">validator</span><span class="s1">.</span><span class="s2">validate</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">valid</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">setValidity</span><span class="s1">(</span><span class="s4">true</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">setValidity</span><span class="s1">(</span><span class="s4">false</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">message</span><span class="s1">||</span><span class="s2">E</span><span class="s1">)}}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">setValidity</span><span class="s1">(</span><span class="s4">true</span><span class="s1">)}}</span><span class="s2">setValidity</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_validInput</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_closeValidityNotification</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">classList</span><span class="s1">.</span><span class="s2">remove</span><span class="s1">(</span><span class="s0">&quot;lm-mod-invalid&quot;</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">classList</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">&quot;lm-mod-invalid&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">!==</span><span class="s0">&quot;&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">validityNotification</span><span class="s1">=</span><span class="s4">new </span><span class="s2">D</span><span class="s1">.</span><span class="s2">Notification</span><span class="s1">({</span><span class="s2">target</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">,</span><span class="s2">message</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">placement</span><span class="s1">:</span><span class="s0">&quot;bottom&quot;</span><span class="s1">,</span><span class="s2">timeout</span><span class="s1">:</span><span class="s3">5e3</span><span class="s1">});</span><span class="s4">this</span><span class="s1">.</span><span class="s2">validityNotification</span><span class="s1">.</span><span class="s2">show</span><span class="s1">()}}}</span><span class="s2">createValidatorBasedOnType</span><span class="s1">(){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">row</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">);</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">type</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;string&quot;</span><span class="s1">:{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">new </span><span class="s2">W</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">typeof </span><span class="s2">t</span><span class="s1">.</span><span class="s2">format</span><span class="s1">===</span><span class="s0">&quot;string&quot;</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">format</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;email&quot;</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">pattern</span><span class="s1">=</span><span class="s4">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">&quot;^([a-z0-9_.-]+)@([da-z.-]+).([a-z.]{2,6})$&quot;</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;uuid&quot;</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">pattern</span><span class="s1">=</span><span class="s4">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">&quot;[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}&quot;</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">minLength</span><span class="s1">!==</span><span class="s2">undefined</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">minLength</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">minLength</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">maxLength</span><span class="s1">!==</span><span class="s2">undefined</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">maxLength</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">maxLength</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">typeof </span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">pattern</span><span class="s1">===</span><span class="s0">&quot;string&quot;</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">pattern</span><span class="s1">=</span><span class="s4">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">pattern</span><span class="s1">)}}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;number&quot;</span><span class="s1">:{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">new </span><span class="s2">B</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">minimum</span><span class="s1">!==</span><span class="s2">undefined</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">min</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">minimum</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">maximum</span><span class="s1">!==</span><span class="s2">undefined</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">max</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">maximum</span><span class="s1">}}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s4">case</span><span class="s0">&quot;integer&quot;</span><span class="s1">:{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">new </span><span class="s2">T</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">minimum</span><span class="s1">!==</span><span class="s2">undefined</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">min</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">minimum</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">maximum</span><span class="s1">!==</span><span class="s2">undefined</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">max</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">maximum</span><span class="s1">}}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}}</span><span class="s4">return </span><span class="s2">undefined</span><span class="s1">}</span><span class="s2">getCellInfo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const</span><span class="s1">{</span><span class="s2">grid</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">l</span><span class="s1">,</span><span class="s2">a</span><span class="s1">;</span><span class="s4">const </span><span class="s2">h</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getGroup</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">-</span><span class="s2">t</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">columnOffset</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">);</span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">-</span><span class="s2">t</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">rowOffset</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">);</span><span class="s2">l</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">a</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">;</span><span class="s2">e</span><span class="s1">&lt;=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">;</span><span class="s2">e</span><span class="s1">++){</span><span class="s2">a</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">rowSize</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">;</span><span class="s2">e</span><span class="s1">&lt;=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">;</span><span class="s2">e</span><span class="s1">++){</span><span class="s2">l</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">columnSize</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">data</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">,</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">-</span><span class="s2">t</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">columnOffset</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">-</span><span class="s2">t</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">rowOffset</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s2">l</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">columnSize</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s2">a</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">rowSize</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">data</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">grid</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">data</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">x</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s2">a</span><span class="s1">}}</span><span class="s2">updatePosition</span><span class="s1">(){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">getCellInfo</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">);</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportOccluder</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s2">i</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportOccluder</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">left</span><span class="s1">=</span><span class="s2">s</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportOccluder</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">viewportWidth</span><span class="s1">-</span><span class="s2">s</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportOccluder</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">viewportHeight</span><span class="s1">-</span><span class="s2">i</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportOccluder</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">position</span><span class="s1">=</span><span class="s0">&quot;absolute&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">left</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">-</span><span class="s3">1</span><span class="s1">-</span><span class="s2">s</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">-</span><span class="s3">1</span><span class="s1">-</span><span class="s2">i</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">+</span><span class="s3">1</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">+</span><span class="s3">1</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">visibility</span><span class="s1">=</span><span class="s0">&quot;visible&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">position</span><span class="s1">=</span><span class="s0">&quot;absolute&quot;</span><span class="s1">}</span><span class="s2">commit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">validate</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_validInput</span><span class="s1">){</span><span class="s4">return false</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">;</span><span class="s4">try</span><span class="s1">{</span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">getInput</span><span class="s1">()}</span><span class="s4">catch</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s2">console</span><span class="s1">.</span><span class="s2">log</span><span class="s1">(</span><span class="s0">`Input error: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">i</span><span class="s1">.</span><span class="s2">message</span><span class="s1">}</span><span class="s0">`</span><span class="s1">);</span><span class="s4">return false</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onCommit</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">onCommit</span><span class="s1">({</span><span class="s2">cell</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">,</span><span class="s2">value</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">cursorMovement</span><span class="s1">:</span><span class="s2">e</span><span class="s1">})}</span><span class="s4">return true</span><span class="s1">}</span><span class="s2">_addContainer</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportOccluder</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;div&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportOccluder</span><span class="s1">.</span><span class="s2">className</span><span class="s1">=</span><span class="s0">&quot;lm-DataGrid-cellEditorOccluder&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportOccluder</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;div&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">className</span><span class="s1">=</span><span class="s0">&quot;lm-DataGrid-cellEditorContainer&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportOccluder</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;mouseleave&quot;</span><span class="s1">,(</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportOccluder</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">pointerEvents</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_validInput</span><span class="s1">?</span><span class="s0">&quot;none&quot;</span><span class="s1">:</span><span class="s0">&quot;auto&quot;</span><span class="s1">}));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;mouseenter&quot;</span><span class="s1">,(</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportOccluder</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">pointerEvents</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">}))}</span><span class="s2">_closeValidityNotification</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">validityNotification</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">validityNotification</span><span class="s1">.</span><span class="s2">close</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">validityNotification</span><span class="s1">=</span><span class="s4">null</span><span class="s1">}}}</span><span class="s4">class </span><span class="s2">G </span><span class="s4">extends </span><span class="s2">D</span><span class="s1">{</span><span class="s2">handleEvent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;keydown&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onKeyDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;blur&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onBlur</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;input&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onInput</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">dispose</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">isDisposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_unbindEvents</span><span class="s1">();</span><span class="s4">super</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">()}</span><span class="s2">startEditing</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">createWidget</span><span class="s1">();</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">getCellInfo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">deserialize</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">data</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">select</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bindEvents</span><span class="s1">()}</span><span class="s2">deserialize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">()}</span><span class="s2">createWidget</span><span class="s1">(){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;input&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">classList</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-cellEditorWidget&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">classList</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-cellEditorInput&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">spellcheck</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inputType</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}</span><span class="s2">bindEvents</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;blur&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;input&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s2">_unbindEvents</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;blur&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;input&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s2">_onKeyDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">((</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">getKeyboardLayout</span><span class="s1">)().</span><span class="s2">keyForKeydownEvent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">case</span><span class="s0">&quot;Enter&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">?</span><span class="s0">&quot;up&quot;</span><span class="s1">:</span><span class="s0">&quot;down&quot;</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Tab&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">?</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s0">&quot;right&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Escape&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cancel</span><span class="s1">();</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">_onBlur</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">isDisposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">()){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">()}}</span><span class="s2">_onInput</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inputChanged</span><span class="s1">.</span><span class="s2">emit</span><span class="s1">(</span><span class="s4">void </span><span class="s3">0</span><span class="s1">)}}</span><span class="s4">class </span><span class="s2">I </span><span class="s4">extends </span><span class="s2">G</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">super</span><span class="s1">(</span><span class="s2">...arguments</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inputType</span><span class="s1">=</span><span class="s0">&quot;text&quot;</span><span class="s1">}</span><span class="s2">getInput</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}}</span><span class="s4">class </span><span class="s2">A </span><span class="s4">extends </span><span class="s2">G</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">super</span><span class="s1">(</span><span class="s2">...arguments</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inputType</span><span class="s1">=</span><span class="s0">&quot;number&quot;</span><span class="s1">}</span><span class="s2">startEditing</span><span class="s1">(){</span><span class="s4">super</span><span class="s1">.</span><span class="s2">startEditing</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">step</span><span class="s1">=</span><span class="s0">&quot;any&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">row</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">);</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">minimum</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">min</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">minimum</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">maximum</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">max</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">maximum</span><span class="s1">}}}</span><span class="s2">getInput</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">value</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()===</span><span class="s0">&quot;&quot;</span><span class="s1">){</span><span class="s4">return null</span><span class="s1">}</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">parseFloat</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">isNaN</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s4">throw new </span><span class="s2">Error</span><span class="s1">(</span><span class="s0">&quot;Invalid input&quot;</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}}</span><span class="s4">class </span><span class="s2">P </span><span class="s4">extends </span><span class="s2">G</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">super</span><span class="s1">(</span><span class="s2">...arguments</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">inputType</span><span class="s1">=</span><span class="s0">&quot;number&quot;</span><span class="s1">}</span><span class="s2">startEditing</span><span class="s1">(){</span><span class="s4">super</span><span class="s1">.</span><span class="s2">startEditing</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">step</span><span class="s1">=</span><span class="s0">&quot;1&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">row</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">);</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">minimum</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">min</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">minimum</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">maximum</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">max</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">maximum</span><span class="s1">}}}</span><span class="s2">getInput</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">input</span><span class="s1">.</span><span class="s2">value</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()===</span><span class="s0">&quot;&quot;</span><span class="s1">){</span><span class="s4">return null</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">parseInt</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">isNaN</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s4">throw new </span><span class="s2">Error</span><span class="s1">(</span><span class="s0">&quot;Invalid input&quot;</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}}</span><span class="s4">class </span><span class="s2">X </span><span class="s4">extends </span><span class="s2">D</span><span class="s1">{</span><span class="s2">handleEvent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;keydown&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onKeyDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;blur&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onBlur</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">dispose</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">isDisposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_unbindEvents</span><span class="s1">();</span><span class="s4">super</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">()}</span><span class="s2">startEditing</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_createWidget</span><span class="s1">();</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">getCellInfo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_deserialize</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">data</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bindEvents</span><span class="s1">()}</span><span class="s2">getInput</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s2">_deserialize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">()}</span><span class="s2">_createWidget</span><span class="s1">(){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;input&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">=</span><span class="s0">&quot;date&quot;</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">pattern</span><span class="s1">=</span><span class="s0">&quot;d{4}-d{2}-d{2}&quot;</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">classList</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-cellEditorWidget&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">classList</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-cellEditorInput&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}</span><span class="s2">_bindEvents</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;blur&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s2">_unbindEvents</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;blur&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s2">_onKeyDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">((</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">getKeyboardLayout</span><span class="s1">)().</span><span class="s2">keyForKeydownEvent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">case</span><span class="s0">&quot;Enter&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">?</span><span class="s0">&quot;up&quot;</span><span class="s1">:</span><span class="s0">&quot;down&quot;</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Tab&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">?</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s0">&quot;right&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Escape&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cancel</span><span class="s1">();</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">_onBlur</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">isDisposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">()){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">()}}}</span><span class="s4">class </span><span class="s2">V </span><span class="s4">extends </span><span class="s2">D</span><span class="s1">{</span><span class="s2">handleEvent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;keydown&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onKeyDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;mousedown&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;blur&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onBlur</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">dispose</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">isDisposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_unbindEvents</span><span class="s1">();</span><span class="s4">super</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">()}</span><span class="s2">startEditing</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_createWidget</span><span class="s1">();</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">getCellInfo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">checked</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_deserialize</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">data</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bindEvents</span><span class="s1">()}</span><span class="s2">getInput</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">checked</span><span class="s1">}</span><span class="s2">_deserialize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return false</span><span class="s1">}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">==</span><span class="s4">true</span><span class="s1">}</span><span class="s2">_createWidget</span><span class="s1">(){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;input&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">classList</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-cellEditorWidget&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">classList</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-cellEditorCheckbox&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">=</span><span class="s0">&quot;checkbox&quot;</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">spellcheck</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}</span><span class="s2">_bindEvents</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;mousedown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;blur&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s2">_unbindEvents</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;mousedown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;blur&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s2">_onKeyDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">((</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">getKeyboardLayout</span><span class="s1">)().</span><span class="s2">keyForKeydownEvent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">case</span><span class="s0">&quot;Enter&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">?</span><span class="s0">&quot;up&quot;</span><span class="s1">:</span><span class="s0">&quot;down&quot;</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Tab&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">?</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s0">&quot;right&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Escape&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cancel</span><span class="s1">();</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">_onBlur</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">isDisposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">()){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">()}}}</span><span class="s4">class </span><span class="s2">N </span><span class="s4">extends </span><span class="s2">D</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">super</span><span class="s1">(</span><span class="s2">...arguments</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_isMultiSelect</span><span class="s1">=</span><span class="s4">false</span><span class="s1">}</span><span class="s2">dispose</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">isDisposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">super</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_isMultiSelect</span><span class="s1">){</span><span class="s2">document</span><span class="s1">.</span><span class="s2">body</span><span class="s1">.</span><span class="s2">removeChild</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">)}}</span><span class="s2">startEditing</span><span class="s1">(){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">getCellInfo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">row</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_isMultiSelect</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;array&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_createWidget</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_isMultiSelect</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">multiple</span><span class="s1">=</span><span class="s4">true</span><span class="s1">;</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_deserialize</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">data</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;++</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">item</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s2">i</span><span class="s1">.</span><span class="s2">selected</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">value</span><span class="s1">)!==-</span><span class="s3">1</span><span class="s1">}</span><span class="s2">document</span><span class="s1">.</span><span class="s2">body</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_deserialize</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">data</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bindEvents</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">updatePosition</span><span class="s1">()}</span><span class="s2">getInput</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_isMultiSelect</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=[];</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">selectedOptions</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;++</span><span class="s2">t</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">selectedOptions</span><span class="s1">.</span><span class="s2">item</span><span class="s1">(</span><span class="s2">t</span><span class="s1">).</span><span class="s2">value</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}}</span><span class="s2">updatePosition</span><span class="s1">(){</span><span class="s4">super</span><span class="s1">.</span><span class="s2">updatePosition</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_isMultiSelect</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">getCellInfo</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">position</span><span class="s1">=</span><span class="s0">&quot;absolute&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">getBoundingClientRect</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">left</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">left</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">top</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">height</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">maxHeight</span><span class="s1">=</span><span class="s0">&quot;60px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">visibility</span><span class="s1">=</span><span class="s0">&quot;hidden&quot;</span><span class="s1">}</span><span class="s2">_deserialize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_isMultiSelect</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=[];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">Array</span><span class="s1">.</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i of e</span><span class="s1">){</span><span class="s2">t</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">())}}</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">()}}</span><span class="s2">_createWidget</span><span class="s1">(){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">row</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">);</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">enum</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;select&quot;</span><span class="s1">);</span><span class="s2">s</span><span class="s1">.</span><span class="s2">classList</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-cellEditorWidget&quot;</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">o of i</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;option&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">text</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">=</span><span class="s2">s</span><span class="s1">}</span><span class="s2">_bindEvents</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onKeyDown</span><span class="s1">.</span><span class="s2">bind</span><span class="s1">(</span><span class="s4">this</span><span class="s1">));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;blur&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onBlur</span><span class="s1">.</span><span class="s2">bind</span><span class="s1">(</span><span class="s4">this</span><span class="s1">))}</span><span class="s2">_onKeyDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">((</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">getKeyboardLayout</span><span class="s1">)().</span><span class="s2">keyForKeydownEvent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">case</span><span class="s0">&quot;Enter&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">?</span><span class="s0">&quot;up&quot;</span><span class="s1">:</span><span class="s0">&quot;down&quot;</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Tab&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">?</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s0">&quot;right&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Escape&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cancel</span><span class="s1">();</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">_onBlur</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">isDisposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">()){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_select</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">()}}}</span><span class="s4">class </span><span class="s2">Y </span><span class="s4">extends </span><span class="s2">D</span><span class="s1">{</span><span class="s2">handleEvent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;keydown&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onKeyDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;blur&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onBlur</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">dispose</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">isDisposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_unbindEvents</span><span class="s1">();</span><span class="s4">super</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">()}</span><span class="s2">startEditing</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_createWidget</span><span class="s1">();</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">getCellInfo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_deserialize</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">data</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">select</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bindEvents</span><span class="s1">()}</span><span class="s2">getInput</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s2">_deserialize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">()}</span><span class="s2">_createWidget</span><span class="s1">(){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cell</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s0">&quot;cell-editor-list&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;datalist&quot;</span><span class="s1">);</span><span class="s2">r</span><span class="s1">.</span><span class="s2">id</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;input&quot;</span><span class="s1">);</span><span class="s2">n</span><span class="s1">.</span><span class="s2">classList</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-cellEditorWidget&quot;</span><span class="s1">);</span><span class="s2">n</span><span class="s1">.</span><span class="s2">classList</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-cellEditorInput&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Set</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">a</span><span class="s1">&lt;</span><span class="s2">s</span><span class="s1">;++</span><span class="s2">a</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">data</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">l</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}}</span><span class="s2">l</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;{</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;option&quot;</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">text</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">r</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">editorContainer</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s2">r</span><span class="s1">);</span><span class="s2">n</span><span class="s1">.</span><span class="s2">setAttribute</span><span class="s1">(</span><span class="s0">&quot;list&quot;</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">=</span><span class="s2">n</span><span class="s1">}</span><span class="s2">_bindEvents</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;blur&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s2">_unbindEvents</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;blur&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s2">_onKeyDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">((</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">getKeyboardLayout</span><span class="s1">)().</span><span class="s2">keyForKeydownEvent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">case</span><span class="s0">&quot;Enter&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">?</span><span class="s0">&quot;up&quot;</span><span class="s1">:</span><span class="s0">&quot;down&quot;</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Tab&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shiftKey</span><span class="s1">?</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s0">&quot;right&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;Escape&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cancel</span><span class="s1">();</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">_onBlur</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">isDisposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">commit</span><span class="s1">()){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_input</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">()}}}(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">class </span><span class="s2">t </span><span class="s4">extends </span><span class="s2">f</span><span class="s1">.</span><span class="s2">Widget</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">super</span><span class="s1">({</span><span class="s2">node</span><span class="s1">:</span><span class="s2">t</span><span class="s1">.</span><span class="s2">createNode</span><span class="s1">()});</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_message</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">addClass</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-notification&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">setFlag</span><span class="s1">(</span><span class="s2">f</span><span class="s1">.</span><span class="s2">Widget</span><span class="s1">.</span><span class="s2">Flag</span><span class="s1">.</span><span class="s2">DisallowLayout</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_target</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">target</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_message</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">message</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_placement</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">placement</span><span class="s1">||</span><span class="s0">&quot;bottom&quot;</span><span class="s1">;</span><span class="s2">f</span><span class="s1">.</span><span class="s2">Widget</span><span class="s1">.</span><span class="s2">attach</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">document</span><span class="s1">.</span><span class="s2">body</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">timeout</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">timeout</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">setTimeout</span><span class="s1">((()=&gt;{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">close</span><span class="s1">()}),</span><span class="s2">e</span><span class="s1">.</span><span class="s2">timeout</span><span class="s1">)}}</span><span class="s2">handleEvent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;mousedown&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_evtMouseDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;contextmenu&quot;</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">get placement</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_placement</span><span class="s1">}</span><span class="s2">set placement</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_placement</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_placement</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">update</span><span class="s1">()}</span><span class="s2">get message</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_message</span><span class="s1">}</span><span class="s2">set message</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_message</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_message</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">update</span><span class="s1">()}</span><span class="s2">get messageNode</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">getElementsByClassName</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-notificationMessage&quot;</span><span class="s1">)[</span><span class="s3">0</span><span class="s1">]}</span><span class="s2">onBeforeAttach</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;mousedown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">update</span><span class="s1">()}</span><span class="s2">onAfterDetach</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;mousedown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s2">onUpdateRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_target</span><span class="s1">.</span><span class="s2">getBoundingClientRect</span><span class="s1">();</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">style</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_placement</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;bottom&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">left</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">left</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">bottom</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;top&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">left</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">left</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">top</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s0">&quot;0&quot;</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">alignItems</span><span class="s1">=</span><span class="s0">&quot;flex-end&quot;</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">justifyContent</span><span class="s1">=</span><span class="s0">&quot;flex-end&quot;</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">left</span><span class="s1">=</span><span class="s0">&quot;0&quot;</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">left</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">top</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">alignItems</span><span class="s1">=</span><span class="s0">&quot;flex-end&quot;</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">justifyContent</span><span class="s1">=</span><span class="s0">&quot;flex-end&quot;</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;right&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">left</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">right</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">top</span><span class="s1">+</span><span class="s0">&quot;px&quot;</span><span class="s1">;</span><span class="s4">break</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">messageNode</span><span class="s1">.</span><span class="s2">innerHTML</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_message</span><span class="s1">}</span><span class="s2">_evtMouseDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">button</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">close</span><span class="s1">()}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">Notification</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">function </span><span class="s2">t</span><span class="s1">(){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;div&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;div&quot;</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">className</span><span class="s1">=</span><span class="s0">&quot;lm-DataGrid-notificationContainer&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;span&quot;</span><span class="s1">);</span><span class="s2">i</span><span class="s1">.</span><span class="s2">className</span><span class="s1">=</span><span class="s0">&quot;lm-DataGrid-notificationMessage&quot;</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">createNode</span><span class="s1">=</span><span class="s2">t</span><span class="s1">})(</span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">Notification</span><span class="s1">||(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">Notification</span><span class="s1">={}))})(</span><span class="s2">D</span><span class="s1">||(</span><span class="s2">D</span><span class="s1">={}));</span><span class="s4">function </span><span class="s2">F</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return typeof </span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;function&quot;</span><span class="s1">?</span><span class="s2">e</span><span class="s1">(</span><span class="s2">t</span><span class="s1">):</span><span class="s2">e</span><span class="s1">}</span><span class="s4">class </span><span class="s2">K</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editor</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cell</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_typeBasedOverrides</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Map</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_metadataBasedOverrides</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Map</span><span class="s1">}</span><span class="s2">setEditor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">typeof </span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;string&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_typeBasedOverrides</span><span class="s1">.</span><span class="s2">set</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_metadataIdentifierToKey</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_metadataBasedOverrides</span><span class="s1">.</span><span class="s2">set</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,[</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">])}}</span><span class="s2">edit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">.</span><span class="s2">editable</span><span class="s1">){</span><span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s0">&quot;Grid cannot be edited!&quot;</span><span class="s1">);</span><span class="s4">return false</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cancel</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cell</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">t</span><span class="s1">=</span><span class="s2">t</span><span class="s1">||{};</span><span class="s2">t</span><span class="s1">.</span><span class="s2">onCommit</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">onCommit</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onCommit</span><span class="s1">.</span><span class="s2">bind</span><span class="s1">(</span><span class="s4">this</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">onCancel</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">onCancel</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onCancel</span><span class="s1">.</span><span class="s2">bind</span><span class="s1">(</span><span class="s4">this</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">editor</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editor</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">editor</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">editor</span><span class="s1">.</span><span class="s2">edit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">return true</span><span class="s1">}</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getEditor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editor</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">edit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">return true</span><span class="s1">}</span><span class="s4">return false</span><span class="s1">}</span><span class="s2">cancel</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editor</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editor</span><span class="s1">.</span><span class="s2">cancel</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editor</span><span class="s1">=</span><span class="s4">null</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cell</span><span class="s1">=</span><span class="s4">null</span><span class="s1">}</span><span class="s2">_onCommit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cell</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">row</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">column</span><span class="s1">;</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getGroup</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">;</span><span class="s2">r</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">}</span><span class="s2">s</span><span class="s1">.</span><span class="s2">setData</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">value</span><span class="s1">);</span><span class="s2">i</span><span class="s1">.</span><span class="s2">viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">cursorMovement</span><span class="s1">!==</span><span class="s0">&quot;none&quot;</span><span class="s1">){</span><span class="s2">i</span><span class="s1">.</span><span class="s2">moveCursor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">cursorMovement</span><span class="s1">);</span><span class="s2">i</span><span class="s1">.</span><span class="s2">scrollToCursor</span><span class="s1">()}}</span><span class="s2">_onCancel</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cell</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cell</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">()}</span><span class="s2">_getDataTypeKey</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">?</span><span class="s2">e</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">row</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">):</span><span class="s4">null</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;default&quot;</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">type</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">enum</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">constraint</span><span class="s1">.</span><span class="s2">enum</span><span class="s1">===</span><span class="s0">&quot;dynamic&quot;</span><span class="s1">){</span><span class="s2">i</span><span class="s1">+=</span><span class="s0">&quot;:dynamic-option&quot;</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">i</span><span class="s1">+=</span><span class="s0">&quot;:option&quot;</span><span class="s1">}}</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s2">_objectToKey</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i </span><span class="s4">in </span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s4">typeof </span><span class="s2">s</span><span class="s1">===</span><span class="s0">&quot;object&quot;</span><span class="s1">){</span><span class="s2">t</span><span class="s1">+=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">i</span><span class="s1">}</span><span class="s0">:</span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_objectToKey</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">+=</span><span class="s0">`[</span><span class="s2">$</span><span class="s1">{</span><span class="s2">i</span><span class="s1">}</span><span class="s0">:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">s</span><span class="s1">}</span><span class="s0">]`</span><span class="s1">}}</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s2">_metadataIdentifierToKey</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_objectToKey</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">_metadataMatchesIdentifier</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i </span><span class="s4">in </span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">hasOwnProperty</span><span class="s1">(</span><span class="s2">i</span><span class="s1">)){</span><span class="s4">return false</span><span class="s1">}</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s4">typeof </span><span class="s2">s</span><span class="s1">===</span><span class="s0">&quot;object&quot;</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_metadataMatchesIdentifier</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)){</span><span class="s4">return false</span><span class="s1">}}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">!==</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return false</span><span class="s1">}}</span><span class="s4">return true</span><span class="s1">}</span><span class="s2">_getMetadataBasedEditor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">row</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_metadataBasedOverrides</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">((</span><span class="s2">s</span><span class="s1">=&gt;{</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let</span><span class="s1">[</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">]=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_metadataMatchesIdentifier</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">o</span><span class="s1">)){</span><span class="s2">t</span><span class="s1">=</span><span class="s2">F</span><span class="s1">(</span><span class="s2">r</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}}}))}</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s2">_getEditor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getDataTypeKey</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_typeBasedOverrides</span><span class="s1">.</span><span class="s2">has</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_typeBasedOverrides</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">return </span><span class="s2">F</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_metadataBasedOverrides</span><span class="s1">.</span><span class="s2">size</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getMetadataBasedEditor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}}</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;string&quot;</span><span class="s1">:</span><span class="s4">return new </span><span class="s2">I</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;number&quot;</span><span class="s1">:</span><span class="s4">return new </span><span class="s2">A</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;integer&quot;</span><span class="s1">:</span><span class="s4">return new </span><span class="s2">P</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;boolean&quot;</span><span class="s1">:</span><span class="s4">return new </span><span class="s2">V</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;date&quot;</span><span class="s1">:</span><span class="s4">return new </span><span class="s2">X</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;string:option&quot;</span><span class="s1">:</span><span class="s4">case</span><span class="s0">&quot;number:option&quot;</span><span class="s1">:</span><span class="s4">case</span><span class="s0">&quot;integer:option&quot;</span><span class="s1">:</span><span class="s4">case</span><span class="s0">&quot;date:option&quot;</span><span class="s1">:</span><span class="s4">case</span><span class="s0">&quot;array:option&quot;</span><span class="s1">:</span><span class="s4">return new </span><span class="s2">N</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;string:dynamic-option&quot;</span><span class="s1">:</span><span class="s4">case</span><span class="s0">&quot;number:dynamic-option&quot;</span><span class="s1">:</span><span class="s4">case</span><span class="s0">&quot;integer:dynamic-option&quot;</span><span class="s1">:</span><span class="s4">case</span><span class="s0">&quot;date:dynamic-option&quot;</span><span class="s1">:</span><span class="s4">return new </span><span class="s2">Y</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_typeBasedOverrides</span><span class="s1">.</span><span class="s2">has</span><span class="s1">(</span><span class="s0">&quot;default&quot;</span><span class="s1">)){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_typeBasedOverrides</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s0">&quot;default&quot;</span><span class="s1">);</span><span class="s4">return </span><span class="s2">F</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">grid</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">data</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">row</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">||</span><span class="s4">typeof </span><span class="s2">i</span><span class="s1">!==</span><span class="s0">&quot;object&quot;</span><span class="s1">){</span><span class="s4">return new </span><span class="s2">I</span><span class="s1">}</span><span class="s4">return </span><span class="s2">undefined</span><span class="s1">}}</span><span class="s4">class </span><span class="s2">q</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_changed</span><span class="s1">=</span><span class="s4">new </span><span class="s2">d</span><span class="s1">.</span><span class="s2">Signal</span><span class="s1">(</span><span class="s4">this</span><span class="s1">)}</span><span class="s2">get changed</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_changed</span><span class="s1">}</span><span class="s2">groupCount</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return </span><span class="s3">0</span><span class="s1">}</span><span class="s2">metadata</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return </span><span class="s2">q</span><span class="s1">.</span><span class="s2">emptyMetadata</span><span class="s1">}</span><span class="s2">group</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return null</span><span class="s1">}</span><span class="s2">emitChanged</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_changed</span><span class="s1">.</span><span class="s2">emit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}}</span><span class="s4">class </span><span class="s2">j </span><span class="s4">extends </span><span class="s2">q</span><span class="s1">{}(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">emptyMetadata</span><span class="s1">=</span><span class="s2">Object</span><span class="s1">.</span><span class="s2">freeze</span><span class="s1">({})})(</span><span class="s2">q</span><span class="s1">||(</span><span class="s2">q</span><span class="s1">={}));</span><span class="s4">class </span><span class="s2">${constructor(e){this._disposed=false;this._context=e;this._state=U.State.create(e)}dispose</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">=</span><span class="s4">true</span><span class="s1">;</span><span class="s4">while</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">next</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">next</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">()}}</span><span class="s2">get isDisposed</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_disposed</span><span class="s1">}</span><span class="s2">get fillStyle</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">}</span><span class="s2">set fillStyle</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get strokeStyle</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">}</span><span class="s2">set strokeStyle</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get font</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">font</span><span class="s1">}</span><span class="s2">set font</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">font</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">font</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">font</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get textAlign</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">textAlign</span><span class="s1">}</span><span class="s2">set textAlign</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">textAlign</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">textAlign</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">textAlign</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get textBaseline</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">textBaseline</span><span class="s1">}</span><span class="s2">set textBaseline</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">textBaseline</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">textBaseline</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">textBaseline</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get lineCap</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">lineCap</span><span class="s1">}</span><span class="s2">set lineCap</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">lineCap</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">lineCap</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">lineCap</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get lineDashOffset</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">lineDashOffset</span><span class="s1">}</span><span class="s2">set lineDashOffset</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">lineDashOffset</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">lineDashOffset</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">lineDashOffset</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get lineJoin</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">lineJoin</span><span class="s1">}</span><span class="s2">set lineJoin</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">lineJoin</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">lineJoin</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">lineJoin</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get lineWidth</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">}</span><span class="s2">set lineWidth</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get miterLimit</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">miterLimit</span><span class="s1">}</span><span class="s2">set miterLimit</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">miterLimit</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">miterLimit</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">miterLimit</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get shadowBlur</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">shadowBlur</span><span class="s1">}</span><span class="s2">set shadowBlur</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">shadowBlur</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">shadowBlur</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">shadowBlur</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get shadowColor</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">shadowColor</span><span class="s1">}</span><span class="s2">set shadowColor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">shadowColor</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">shadowColor</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">shadowColor</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get shadowOffsetX</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">shadowOffsetX</span><span class="s1">}</span><span class="s2">set shadowOffsetX</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">shadowOffsetX</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">shadowOffsetX</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">shadowOffsetX</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get shadowOffsetY</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">shadowOffsetY</span><span class="s1">}</span><span class="s2">set shadowOffsetY</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">shadowOffsetY</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">shadowOffsetY</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">shadowOffsetY</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get imageSmoothingEnabled</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">imageSmoothingEnabled</span><span class="s1">}</span><span class="s2">set imageSmoothingEnabled</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">imageSmoothingEnabled</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">imageSmoothingEnabled</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">imageSmoothingEnabled</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get globalAlpha</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">globalAlpha</span><span class="s1">}</span><span class="s2">set globalAlpha</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">globalAlpha</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">globalAlpha</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">globalAlpha</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get globalCompositeOperation</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">globalCompositeOperation</span><span class="s1">}</span><span class="s2">set globalCompositeOperation</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">globalCompositeOperation</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">globalCompositeOperation</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">globalCompositeOperation</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">getLineDash</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">getLineDash</span><span class="s1">()}</span><span class="s2">setLineDash</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">setLineDash</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">rotate</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">rotate</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">scale</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">scale</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">transform</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">transform</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s2">translate</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">translate</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">setTransform</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">setTransform</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s2">save</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">=</span><span class="s2">U</span><span class="s1">.</span><span class="s2">State</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">save</span><span class="s1">()}</span><span class="s2">restore</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">.</span><span class="s2">next</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">=</span><span class="s2">U</span><span class="s1">.</span><span class="s2">State</span><span class="s1">.</span><span class="s2">pop</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_state</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">()}</span><span class="s2">beginPath</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">()}</span><span class="s2">closePath</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">closePath</span><span class="s1">()}</span><span class="s2">isPointInPath</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">arguments</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">2</span><span class="s1">){</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">isPointInPath</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">isPointInPath</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">s</span><span class="s1">}</span><span class="s2">arc</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">arguments</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">5</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">arc</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">arc</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}}</span><span class="s2">arcTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">arcTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">)}</span><span class="s2">bezierCurveTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">bezierCurveTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s2">ellipse</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">l</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">arguments</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">7</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">ellipse</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">ellipse</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">l</span><span class="s1">)}}</span><span class="s2">lineTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">lineTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">moveTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">moveTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">quadraticCurveTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">quadraticCurveTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">rect</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">rect</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">clip</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">arguments</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">clip</span><span class="s1">()}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">clip</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}}</span><span class="s2">fill</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">arguments</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">fill</span><span class="s1">()}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">fill</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}}</span><span class="s2">stroke</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">stroke</span><span class="s1">()}</span><span class="s2">clearRect</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">clearRect</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">arguments</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">3</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}}</span><span class="s2">strokeRect</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">strokeRect</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">strokeText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">arguments</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">3</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">strokeText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">strokeText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}}</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">createLinearGradient</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">createLinearGradient</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">createRadialGradient</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">createRadialGradient</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s2">createPattern</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">createPattern</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">createImageData</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">createImageData</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">,</span><span class="s2">arguments</span><span class="s1">)}</span><span class="s2">getImageData</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">getImageData</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">putImageData</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">putImageData</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">,</span><span class="s2">arguments</span><span class="s1">)}</span><span class="s2">drawImage</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">drawImage</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">,</span><span class="s2">arguments</span><span class="s1">)}</span><span class="s2">drawFocusIfNeeded</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_context</span><span class="s1">.</span><span class="s2">drawFocusIfNeeded</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}}</span><span class="s4">var </span><span class="s2">U</span><span class="s1">;(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=[];</span><span class="s4">class </span><span class="s2">s</span><span class="s1">{</span><span class="s4">static </span><span class="s2">create</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s4">new </span><span class="s2">s</span><span class="s1">:</span><span class="s2">i</span><span class="s1">[</span><span class="s2">t</span><span class="s1">--];</span><span class="s2">o</span><span class="s1">.</span><span class="s2">next</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">font</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">font</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">globalAlpha</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">globalAlpha</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">globalCompositeOperation</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">globalCompositeOperation</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">imageSmoothingEnabled</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">imageSmoothingEnabled</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">lineCap</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">lineCap</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">lineDashOffset</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">lineDashOffset</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">lineJoin</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">lineJoin</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">miterLimit</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">miterLimit</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">shadowBlur</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shadowBlur</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">shadowColor</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shadowColor</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">shadowOffsetX</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shadowOffsetX</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">shadowOffsetY</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shadowOffsetY</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">textAlign</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textAlign</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">textBaseline</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textBaseline</span><span class="s1">;</span><span class="s4">return </span><span class="s2">o</span><span class="s1">}</span><span class="s4">static </span><span class="s2">push</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s4">new </span><span class="s2">s</span><span class="s1">:</span><span class="s2">i</span><span class="s1">[</span><span class="s2">t</span><span class="s1">--];</span><span class="s2">o</span><span class="s1">.</span><span class="s2">next</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">font</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">font</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">globalAlpha</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">globalAlpha</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">globalCompositeOperation</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">globalCompositeOperation</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">imageSmoothingEnabled</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">imageSmoothingEnabled</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">lineCap</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">lineCap</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">lineDashOffset</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">lineDashOffset</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">lineJoin</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">lineJoin</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">miterLimit</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">miterLimit</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">shadowBlur</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shadowBlur</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">shadowColor</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shadowColor</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">shadowOffsetX</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shadowOffsetX</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">shadowOffsetY</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">shadowOffsetY</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">textAlign</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textAlign</span><span class="s1">;</span><span class="s2">o</span><span class="s1">.</span><span class="s2">textBaseline</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textBaseline</span><span class="s1">;</span><span class="s4">return </span><span class="s2">o</span><span class="s1">}</span><span class="s4">static </span><span class="s2">pop</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">=</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s2">i</span><span class="s1">[++</span><span class="s2">t</span><span class="s1">]=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">next</span><span class="s1">}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">State</span><span class="s1">=</span><span class="s2">s</span><span class="s1">})(</span><span class="s2">U</span><span class="s1">||(</span><span class="s2">U</span><span class="s1">={}));</span><span class="s4">class </span><span class="s2">J</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={},</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_changed</span><span class="s1">=</span><span class="s4">new </span><span class="s2">d</span><span class="s1">.</span><span class="s2">Signal</span><span class="s1">(</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_values</span><span class="s1">={</span><span class="s2">...e</span><span class="s1">};</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_fallback</span><span class="s1">=</span><span class="s2">t</span><span class="s1">||</span><span class="s4">new </span><span class="s2">v</span><span class="s1">}</span><span class="s2">get changed</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_changed</span><span class="s1">}</span><span class="s2">get</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_values</span><span class="s1">[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">region</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s4">typeof </span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;function&quot;</span><span class="s1">){</span><span class="s4">try</span><span class="s1">{</span><span class="s2">t</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">catch</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s2">t</span><span class="s1">=</span><span class="s2">undefined</span><span class="s1">;</span><span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s2">i</span><span class="s1">)}}</span><span class="s4">return </span><span class="s2">t</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_fallback</span><span class="s1">}</span><span class="s2">update</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={},</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_values</span><span class="s1">={</span><span class="s2">...</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_values</span><span class="s1">,</span><span class="s2">...e</span><span class="s1">};</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_fallback</span><span class="s1">=</span><span class="s2">t</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_fallback</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_changed</span><span class="s1">.</span><span class="s2">emit</span><span class="s1">(</span><span class="s2">undefined</span><span class="s1">)}}</span><span class="s4">class </span><span class="s2">Z</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_length</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">=[];</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_minimumSize</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">minimumSize</span><span class="s1">||</span><span class="s3">2</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_minimumSize</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">defaultSize</span><span class="s1">))}</span><span class="s2">get length</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_length</span><span class="s1">}</span><span class="s2">get count</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">}</span><span class="s2">get minimumSize</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_minimumSize</span><span class="s1">}</span><span class="s2">set minimumSize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">2</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">));</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_minimumSize</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_minimumSize</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">defaultSize</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}}</span><span class="s2">get defaultSize</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">}</span><span class="s2">set defaultSize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_minimumSize</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">));</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_length</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">*(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s3">0</span><span class="s1">,</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">s</span><span class="s1">;++</span><span class="s2">i</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">i</span><span class="s1">-</span><span class="s3">1</span><span class="s1">];</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">index</span><span class="s1">-</span><span class="s2">t</span><span class="s1">.</span><span class="s2">index</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">size</span><span class="s1">+</span><span class="s2">i</span><span class="s1">*</span><span class="s2">e</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">s</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">index</span><span class="s1">*</span><span class="s2">e</span><span class="s1">}}}</span><span class="s2">clampSize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return </span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_minimumSize</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">))}</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_length</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return </span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">)}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">lowerBound</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">Q</span><span class="s1">.</span><span class="s2">offsetCmp</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">t</span><span class="s1">].</span><span class="s2">offset</span><span class="s1">&lt;=</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">t</span><span class="s1">].</span><span class="s2">index</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return </span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">)}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">];</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">-(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">+</span><span class="s2">i</span><span class="s1">.</span><span class="s2">size</span><span class="s1">);</span><span class="s4">return </span><span class="s2">i</span><span class="s1">.</span><span class="s2">index</span><span class="s1">+</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">s</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">)+</span><span class="s3">1</span><span class="s1">}</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">lowerBound</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">Q</span><span class="s1">.</span><span class="s2">indexCmp</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">t</span><span class="s1">].</span><span class="s2">index</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">t</span><span class="s1">].</span><span class="s2">offset</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">];</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">-</span><span class="s2">i</span><span class="s1">.</span><span class="s2">index</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">return </span><span class="s2">i</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">+</span><span class="s2">i</span><span class="s1">.</span><span class="s2">size</span><span class="s1">+</span><span class="s2">s</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">}</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">(</span><span class="s2">e</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">lowerBound</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">Q</span><span class="s1">.</span><span class="s2">indexCmp</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">t</span><span class="s1">].</span><span class="s2">index</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">t</span><span class="s1">].</span><span class="s2">offset</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">t</span><span class="s1">].</span><span class="s2">size</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">(</span><span class="s2">e</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">];</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">-</span><span class="s2">i</span><span class="s1">.</span><span class="s2">index</span><span class="s1">;</span><span class="s4">return </span><span class="s2">i</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">+</span><span class="s2">i</span><span class="s1">.</span><span class="s2">size</span><span class="s1">+</span><span class="s2">s</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">lowerBound</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">Q</span><span class="s1">.</span><span class="s2">indexCmp</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">t</span><span class="s1">].</span><span class="s2">index</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">t</span><span class="s1">].</span><span class="s2">size</span><span class="s1">}</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">}</span><span class="s2">resize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_minimumSize</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">t</span><span class="s1">));</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">lowerBound</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">Q</span><span class="s1">.</span><span class="s2">indexCmp</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">index</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">-</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">;</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,{</span><span class="s2">index</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">offset</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">size</span><span class="s1">:</span><span class="s2">t</span><span class="s1">});</span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">i</span><span class="s1">-</span><span class="s3">1</span><span class="s1">];</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">-</span><span class="s2">o</span><span class="s1">.</span><span class="s2">index</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">+</span><span class="s2">o</span><span class="s1">.</span><span class="s2">size</span><span class="s1">+</span><span class="s2">r</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">;</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,{</span><span class="s2">index</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">offset</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">size</span><span class="s1">:</span><span class="s2">t</span><span class="s1">});</span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_length</span><span class="s1">+=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">i</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">o</span><span class="s1">&lt;</span><span class="s2">r</span><span class="s1">;++</span><span class="s2">o</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">o</span><span class="s1">].</span><span class="s2">offset</span><span class="s1">+=</span><span class="s2">s</span><span class="s1">}}</span><span class="s2">insert</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">));</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_length</span><span class="s1">+=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">lowerBound</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">Q</span><span class="s1">.</span><span class="s2">indexCmp</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">;++</span><span class="s2">s</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">s</span><span class="s1">];</span><span class="s2">e</span><span class="s1">.</span><span class="s2">index</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">+=</span><span class="s2">i</span><span class="s1">}}</span><span class="s2">remove</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">||</span><span class="s2">t</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">-</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">-=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_length</span><span class="s1">-=</span><span class="s2">t</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">;</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_length</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">lowerBound</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">Q</span><span class="s1">.</span><span class="s2">indexCmp</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">lowerBound</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">e</span><span class="s1">+</span><span class="s2">t</span><span class="s1">,</span><span class="s2">Q</span><span class="s1">.</span><span class="s2">indexCmp</span><span class="s1">);</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">splice</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">-</span><span class="s2">i</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=(</span><span class="s2">t</span><span class="s1">-</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">)*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s2">l</span><span class="s1">;++</span><span class="s2">n</span><span class="s1">){</span><span class="s2">r</span><span class="s1">+=</span><span class="s2">o</span><span class="s1">[</span><span class="s2">n</span><span class="s1">].</span><span class="s2">size</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">-=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_length</span><span class="s1">-=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">,</span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s2">l</span><span class="s1">;++</span><span class="s2">n</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">n</span><span class="s1">];</span><span class="s2">e</span><span class="s1">.</span><span class="s2">index</span><span class="s1">-=</span><span class="s2">t</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">-=</span><span class="s2">r</span><span class="s1">}}</span><span class="s2">move</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">||</span><span class="s2">t</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">-</span><span class="s2">e</span><span class="s1">);</span><span class="s2">i</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">i</span><span class="s1">),</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">-</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">lowerBound</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">Q</span><span class="s1">.</span><span class="s2">indexCmp</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">+</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">i</span><span class="s1">+</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">upperBound</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">Q</span><span class="s1">.</span><span class="s2">indexCmp</span><span class="s1">)-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">?</span><span class="s2">e</span><span class="s1">:</span><span class="s2">e</span><span class="s1">+</span><span class="s2">t</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">l</span><span class="s1">-</span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">r</span><span class="s1">-</span><span class="s2">l</span><span class="s1">+</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">a</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">c</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s2">h</span><span class="s1">&lt;=</span><span class="s2">n</span><span class="s1">;++</span><span class="s2">h</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">h</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">index</span><span class="s1">&lt;</span><span class="s2">l</span><span class="s1">){</span><span class="s2">d</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">u</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">}}</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">lowerBound</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">l</span><span class="s1">,</span><span class="s2">Q</span><span class="s1">.</span><span class="s2">indexCmp</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s2">f</span><span class="s1">&amp;&amp;</span><span class="s2">f</span><span class="s1">&lt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s2">h</span><span class="s1">.</span><span class="s2">ArrayExt</span><span class="s1">.</span><span class="s2">rotate</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">,</span><span class="s2">f</span><span class="s1">-</span><span class="s2">o</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s2">h</span><span class="s1">&lt;=</span><span class="s2">n</span><span class="s1">;++</span><span class="s2">h</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">[</span><span class="s2">h</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">index</span><span class="s1">&lt;</span><span class="s2">l</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">index</span><span class="s1">+=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">+=</span><span class="s2">u</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">e</span><span class="s1">.</span><span class="s2">index</span><span class="s1">-=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">-=</span><span class="s2">d</span><span class="s1">}}}</span><span class="s2">reset</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_length</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_defaultSize</span><span class="s1">}</span><span class="s2">clear</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_count</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_length</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_sections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">=</span><span class="s3">0</span><span class="s1">}}</span><span class="s4">var </span><span class="s2">Q</span><span class="s1">;(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">function </span><span class="s2">t</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">){</span><span class="s4">return </span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">offset</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">&lt;=</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">return </span><span class="s3">0</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">offsetCmp</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">function </span><span class="s2">i</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">index</span><span class="s1">-</span><span class="s2">t</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">indexCmp</span><span class="s1">=</span><span class="s2">i</span><span class="s1">})(</span><span class="s2">Q</span><span class="s1">||(</span><span class="s2">Q</span><span class="s1">={}));</span><span class="s4">class </span><span class="s2">ee </span><span class="s4">extends </span><span class="s2">f</span><span class="s1">.</span><span class="s2">Widget</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">super</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mousedown</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_keyHandler</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBarMinWidth</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBarMinHeight</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">ceil</span><span class="s1">(</span><span class="s2">window</span><span class="s1">.</span><span class="s2">devicePixelRatio</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editingEnabled</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">addClass</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">style</span><span class="s1">||</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">defaultStyle</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stretchLastRow</span><span class="s1">||</span><span class="s4">false</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stretchLastColumn</span><span class="s1">||</span><span class="s4">false</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_headerVisibility</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">headerVisibility</span><span class="s1">||</span><span class="s0">&quot;all&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cellRenderers</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">cellRenderers</span><span class="s1">||</span><span class="s4">new </span><span class="s2">J</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_copyConfig</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">copyConfig</span><span class="s1">||</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">defaultCopyConfig</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cellRenderers</span><span class="s1">.</span><span class="s2">changed</span><span class="s1">.</span><span class="s2">connect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onRenderersChanged</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">defaultSizes</span><span class="s1">||</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">defaultSizes</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">minimumSizes</span><span class="s1">||</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">minimumSizes</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Z</span><span class="s1">({</span><span class="s2">defaultSize</span><span class="s1">:</span><span class="s2">t</span><span class="s1">.</span><span class="s2">rowHeight</span><span class="s1">,</span><span class="s2">minimumSize</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">rowHeight</span><span class="s1">});</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Z</span><span class="s1">({</span><span class="s2">defaultSize</span><span class="s1">:</span><span class="s2">t</span><span class="s1">.</span><span class="s2">columnWidth</span><span class="s1">,</span><span class="s2">minimumSize</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">columnWidth</span><span class="s1">});</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Z</span><span class="s1">({</span><span class="s2">defaultSize</span><span class="s1">:</span><span class="s2">t</span><span class="s1">.</span><span class="s2">rowHeaderWidth</span><span class="s1">,</span><span class="s2">minimumSize</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">rowHeaderWidth</span><span class="s1">});</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Z</span><span class="s1">({</span><span class="s2">defaultSize</span><span class="s1">:</span><span class="s2">t</span><span class="s1">.</span><span class="s2">columnHeaderHeight</span><span class="s1">,</span><span class="s2">minimumSize</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">columnHeaderHeight</span><span class="s1">});</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">=</span><span class="s2">te</span><span class="s1">.</span><span class="s2">createCanvas</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_buffer</span><span class="s1">=</span><span class="s2">te</span><span class="s1">.</span><span class="s2">createCanvas</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">=</span><span class="s2">te</span><span class="s1">.</span><span class="s2">createCanvas</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">getContext</span><span class="s1">(</span><span class="s0">&quot;2d&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bufferGC</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_buffer</span><span class="s1">.</span><span class="s2">getContext</span><span class="s1">(</span><span class="s0">&quot;2d&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlayGC</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">getContext</span><span class="s1">(</span><span class="s0">&quot;2d&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">position</span><span class="s1">=</span><span class="s0">&quot;absolute&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s0">&quot;0px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">left</span><span class="s1">=</span><span class="s0">&quot;0px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s0">&quot;0px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s0">&quot;0px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">position</span><span class="s1">=</span><span class="s0">&quot;absolute&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">top</span><span class="s1">=</span><span class="s0">&quot;0px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">left</span><span class="s1">=</span><span class="s0">&quot;0px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s0">&quot;0px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s0">&quot;0px&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">=</span><span class="s4">new </span><span class="s2">f</span><span class="s1">.</span><span class="s2">Widget</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">tabIndex</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">outline</span><span class="s1">=</span><span class="s0">&quot;none&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">=</span><span class="s4">new </span><span class="s2">f</span><span class="s1">.</span><span class="s2">ScrollBar</span><span class="s1">({</span><span class="s2">orientation</span><span class="s1">:</span><span class="s0">&quot;vertical&quot;</span><span class="s1">});</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">=</span><span class="s4">new </span><span class="s2">f</span><span class="s1">.</span><span class="s2">ScrollBar</span><span class="s1">({</span><span class="s2">orientation</span><span class="s1">:</span><span class="s0">&quot;horizontal&quot;</span><span class="s1">});</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollCorner</span><span class="s1">=</span><span class="s4">new </span><span class="s2">f</span><span class="s1">.</span><span class="s2">Widget</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editorController</span><span class="s1">=</span><span class="s4">new </span><span class="s2">K</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">addClass</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-viewport&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">addClass</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-scrollBar&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">addClass</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-scrollBar&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollCorner</span><span class="s1">.</span><span class="s2">addClass</span><span class="s1">(</span><span class="s0">&quot;lm-DataGrid-scrollCorner&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">appendChild</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">);</span><span class="s2">m</span><span class="s1">.</span><span class="s2">MessageLoop</span><span class="s1">.</span><span class="s2">installMessageHook</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s2">m</span><span class="s1">.</span><span class="s2">MessageLoop</span><span class="s1">.</span><span class="s2">installMessageHook</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s2">m</span><span class="s1">.</span><span class="s2">MessageLoop</span><span class="s1">.</span><span class="s2">installMessageHook</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">hide</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">hide</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollCorner</span><span class="s1">.</span><span class="s2">hide</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">thumbMoved</span><span class="s1">.</span><span class="s2">connect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onThumbMoved</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">thumbMoved</span><span class="s1">.</span><span class="s2">connect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onThumbMoved</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">pageRequested</span><span class="s1">.</span><span class="s2">connect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onPageRequested</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">pageRequested</span><span class="s1">.</span><span class="s2">connect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onPageRequested</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">stepRequested</span><span class="s1">.</span><span class="s2">connect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onStepRequested</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">stepRequested</span><span class="s1">.</span><span class="s2">connect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onStepRequested</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s2">f</span><span class="s1">.</span><span class="s2">GridLayout</span><span class="s1">.</span><span class="s2">setCellConfig</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">,{</span><span class="s2">row</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s3">0</span><span class="s1">});</span><span class="s2">f</span><span class="s1">.</span><span class="s2">GridLayout</span><span class="s1">.</span><span class="s2">setCellConfig</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">,{</span><span class="s2">row</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s3">1</span><span class="s1">});</span><span class="s2">f</span><span class="s1">.</span><span class="s2">GridLayout</span><span class="s1">.</span><span class="s2">setCellConfig</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">,{</span><span class="s2">row</span><span class="s1">:</span><span class="s3">1</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s3">0</span><span class="s1">});</span><span class="s2">f</span><span class="s1">.</span><span class="s2">GridLayout</span><span class="s1">.</span><span class="s2">setCellConfig</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollCorner</span><span class="s1">,{</span><span class="s2">row</span><span class="s1">:</span><span class="s3">1</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s3">1</span><span class="s1">});</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">new </span><span class="s2">f</span><span class="s1">.</span><span class="s2">GridLayout</span><span class="s1">({</span><span class="s2">rowCount</span><span class="s1">:</span><span class="s3">2</span><span class="s1">,</span><span class="s2">columnCount</span><span class="s1">:</span><span class="s3">2</span><span class="s1">,</span><span class="s2">rowSpacing</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">columnSpacing</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">fitPolicy</span><span class="s1">:</span><span class="s0">&quot;set-no-constraint&quot;</span><span class="s1">});</span><span class="s2">s</span><span class="s1">.</span><span class="s2">setRowStretch</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s3">1</span><span class="s1">);</span><span class="s2">s</span><span class="s1">.</span><span class="s2">setRowStretch</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s2">s</span><span class="s1">.</span><span class="s2">setColumnStretch</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s3">1</span><span class="s1">);</span><span class="s2">s</span><span class="s1">.</span><span class="s2">setColumnStretch</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s2">s</span><span class="s1">.</span><span class="s2">addWidget</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">);</span><span class="s2">s</span><span class="s1">.</span><span class="s2">addWidget</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">);</span><span class="s2">s</span><span class="s1">.</span><span class="s2">addWidget</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">);</span><span class="s2">s</span><span class="s1">.</span><span class="s2">addWidget</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollCorner</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">layout</span><span class="s1">=</span><span class="s2">s</span><span class="s1">}</span><span class="s2">dispose</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_releaseMouse</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_keyHandler</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_keyHandler</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">()}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">()}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_keyHandler</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">();</span><span class="s4">super</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">()}</span><span class="s2">get dataModel</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">}</span><span class="s2">set dataModel</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_releaseMouse</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">selectionModel</span><span class="s1">=</span><span class="s4">null</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">.</span><span class="s2">changed</span><span class="s1">.</span><span class="s2">disconnect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onDataModelChanged</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">changed</span><span class="s1">.</span><span class="s2">connect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onDataModelChanged</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">))}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">get selectionModel</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">}</span><span class="s2">set selectionModel</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_releaseMouse</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">!==</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">){</span><span class="s4">throw new </span><span class="s2">Error</span><span class="s1">(</span><span class="s0">&quot;SelectionModel.dataModel !== DataGrid.dataModel&quot;</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">.</span><span class="s2">changed</span><span class="s1">.</span><span class="s2">disconnect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onSelectionsChanged</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">changed</span><span class="s1">.</span><span class="s2">connect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onSelectionsChanged</span><span class="s1">,</span><span class="s4">this</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintOverlay</span><span class="s1">()}</span><span class="s2">get keyHandler</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_keyHandler</span><span class="s1">}</span><span class="s2">set keyHandler</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_keyHandler</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}</span><span class="s2">get mouseHandler</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">}</span><span class="s2">set mouseHandler</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_releaseMouse</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}</span><span class="s2">get style</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">}</span><span class="s2">set style</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">={</span><span class="s2">...e</span><span class="s1">};</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintContent</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintOverlay</span><span class="s1">()}</span><span class="s2">get cellRenderers</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_cellRenderers</span><span class="s1">}</span><span class="s2">set cellRenderers</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cellRenderers</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cellRenderers</span><span class="s1">.</span><span class="s2">changed</span><span class="s1">.</span><span class="s2">disconnect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onRenderersChanged</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">changed</span><span class="s1">.</span><span class="s2">connect</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onRenderersChanged</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cellRenderers</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintContent</span><span class="s1">()}</span><span class="s2">get headerVisibility</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_headerVisibility</span><span class="s1">}</span><span class="s2">set headerVisibility</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_headerVisibility</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_headerVisibility</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">get defaultSizes</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">defaultSize</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">defaultSize</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">defaultSize</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">defaultSize</span><span class="s1">;</span><span class="s4">return</span><span class="s1">{</span><span class="s2">rowHeight</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">columnWidth</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">rowHeaderWidth</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">columnHeaderHeight</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}}</span><span class="s2">set defaultSizes</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">defaultSize</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowHeight</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">defaultSize</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnWidth</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">defaultSize</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowHeaderWidth</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">defaultSize</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnHeaderHeight</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">get minimumSizes</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">minimumSize</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">minimumSize</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">minimumSize</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">minimumSize</span><span class="s1">;</span><span class="s4">return</span><span class="s1">{</span><span class="s2">rowHeight</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">columnWidth</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">rowHeaderWidth</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">columnHeaderHeight</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}}</span><span class="s2">set minimumSizes</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">minimumSize</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowHeight</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">minimumSize</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnWidth</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">minimumSize</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowHeaderWidth</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">minimumSize</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnHeaderHeight</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">get copyConfig</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_copyConfig</span><span class="s1">}</span><span class="s2">set copyConfig</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_copyConfig</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}</span><span class="s2">get stretchLastRow</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">}</span><span class="s2">set stretchLastRow</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">get stretchLastColumn</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">}</span><span class="s2">set stretchLastColumn</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">get headerWidth</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_headerVisibility</span><span class="s1">===</span><span class="s0">&quot;none&quot;</span><span class="s1">){</span><span class="s4">return </span><span class="s3">0</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_headerVisibility</span><span class="s1">===</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s4">return </span><span class="s3">0</span><span class="s1">}</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">}</span><span class="s2">get headerHeight</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_headerVisibility</span><span class="s1">===</span><span class="s0">&quot;none&quot;</span><span class="s1">){</span><span class="s4">return </span><span class="s3">0</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_headerVisibility</span><span class="s1">===</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s4">return </span><span class="s3">0</span><span class="s1">}</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">}</span><span class="s2">get bodyWidth</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">}</span><span class="s2">get bodyHeight</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">}</span><span class="s2">get totalWidth</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">}</span><span class="s2">get totalHeight</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">}</span><span class="s2">get viewportWidth</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">}</span><span class="s2">get viewportHeight</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">}</span><span class="s2">get pageWidth</span><span class="s1">(){</span><span class="s4">return </span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportWidth</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">)}</span><span class="s2">get pageHeight</span><span class="s1">(){</span><span class="s4">return </span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewportHeight</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">)}</span><span class="s2">get scrollX</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s2">get scrollY</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s2">get maxScrollX</span><span class="s1">(){</span><span class="s4">return </span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">-</span><span class="s3">1</span><span class="s1">)}</span><span class="s2">get maxScrollY</span><span class="s1">(){</span><span class="s4">return </span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">-</span><span class="s3">1</span><span class="s1">)}</span><span class="s2">get viewport</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">}</span><span class="s2">get editorController</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_editorController</span><span class="s1">}</span><span class="s2">set editorController</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editorController</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}</span><span class="s2">get editingEnabled</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_editingEnabled</span><span class="s1">}</span><span class="s2">set editingEnabled</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editingEnabled</span><span class="s1">=</span><span class="s2">e</span><span class="s1">}</span><span class="s2">get editable</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_editingEnabled</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">!==</span><span class="s4">null</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editorController</span><span class="s1">!==</span><span class="s4">null</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel </span><span class="s4">instanceof </span><span class="s2">j</span><span class="s1">}</span><span class="s2">get canvasGC</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">}</span><span class="s2">get rowSections</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">}</span><span class="s2">get columnSections</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">}</span><span class="s2">get rowHeaderSections</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">}</span><span class="s2">get columnHeaderSections</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">}</span><span class="s2">scrollToRow</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">-</span><span class="s2">o</span><span class="s1">-</span><span class="s3">10</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">&gt;</span><span class="s2">r</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">s</span><span class="s1">-</span><span class="s2">r</span><span class="s1">+</span><span class="s3">10</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollBy</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)}</span><span class="s2">scrollToColumn</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">-</span><span class="s2">o</span><span class="s1">-</span><span class="s3">10</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">&gt;</span><span class="s2">r</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">s</span><span class="s1">-</span><span class="s2">r</span><span class="s1">+</span><span class="s3">10</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollBy</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s3">0</span><span class="s1">)}</span><span class="s2">scrollToCell</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s2">s</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">i</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;</span><span class="s2">a</span><span class="s1">){</span><span class="s2">u</span><span class="s1">=</span><span class="s2">o</span><span class="s1">-</span><span class="s2">a</span><span class="s1">-</span><span class="s3">10</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s2">h</span><span class="s1">){</span><span class="s2">u</span><span class="s1">=</span><span class="s2">r</span><span class="s1">-</span><span class="s2">h</span><span class="s1">+</span><span class="s3">10</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s2">c</span><span class="s1">){</span><span class="s2">f</span><span class="s1">=</span><span class="s2">n</span><span class="s1">-</span><span class="s2">c</span><span class="s1">-</span><span class="s3">10</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">&gt;</span><span class="s2">d</span><span class="s1">){</span><span class="s2">f</span><span class="s1">=</span><span class="s2">l</span><span class="s1">-</span><span class="s2">d</span><span class="s1">+</span><span class="s3">10</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">u</span><span class="s1">===</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">f</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollBy</span><span class="s1">(</span><span class="s2">u</span><span class="s1">,</span><span class="s2">f</span><span class="s1">)}</span><span class="s2">moveCursor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">||!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">.</span><span class="s2">isEmpty</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">.</span><span class="s2">selections</span><span class="s1">();</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">next</span><span class="s1">()&amp;&amp;!</span><span class="s2">t</span><span class="s1">.</span><span class="s2">next</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">.</span><span class="s2">currentSelection</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">===</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">===</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;down&quot;</span><span class="s1">?</span><span class="s3">1</span><span class="s1">:</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;up&quot;</span><span class="s1">?-</span><span class="s3">1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;right&quot;</span><span class="s1">?</span><span class="s3">1</span><span class="s1">:</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;left&quot;</span><span class="s1">?-</span><span class="s3">1</span><span class="s1">:</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">+</span><span class="s2">i</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">+</span><span class="s2">s</span><span class="s1">;</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">r</span><span class="s1">+=</span><span class="s3">1</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">===-</span><span class="s3">1</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s2">n</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s2">r</span><span class="s1">-=</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&gt;=</span><span class="s2">l</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">o</span><span class="s1">+=</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s3">0</span><span class="s1">}}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">===-</span><span class="s3">1</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">l</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s2">o</span><span class="s1">-=</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">===-</span><span class="s3">1</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s2">n</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">.</span><span class="s2">select</span><span class="s1">({</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">cursorRow</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">cursorColumn</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">clear</span><span class="s1">:</span><span class="s0">&quot;all&quot;</span><span class="s1">});</span><span class="s4">return</span><span class="s1">}}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">.</span><span class="s2">moveCursorWithinSelections</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">scrollToCursor</span><span class="s1">(){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollToCell</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">scrollBy</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollTo</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">+</span><span class="s2">e</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">+</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">scrollByPage</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;up&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">=-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;down&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s2">t</span><span class="s1">=-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;right&quot;</span><span class="s1">:</span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollTo</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">+</span><span class="s2">t</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">+</span><span class="s2">i</span><span class="s1">)}</span><span class="s2">scrollByStep</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;up&quot;</span><span class="s1">:</span><span class="s2">t</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">o</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">o</span><span class="s1">:</span><span class="s2">r</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;down&quot;</span><span class="s1">:</span><span class="s2">t</span><span class="s1">=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">o</span><span class="s1">);</span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">o</span><span class="s1">:</span><span class="s2">r</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)+</span><span class="s2">r</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">s</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s2">s</span><span class="s1">=</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">s</span><span class="s1">:</span><span class="s2">n</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;right&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s2">s</span><span class="s1">=</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">s</span><span class="s1">:</span><span class="s2">n</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">i</span><span class="s1">)+</span><span class="s2">n</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollTo</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">)}</span><span class="s2">scrollTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">),</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">));</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">t</span><span class="s1">),</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s2">m</span><span class="s1">.</span><span class="s2">MessageLoop</span><span class="s1">.</span><span class="s2">postMessage</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">,</span><span class="s2">te</span><span class="s1">.</span><span class="s2">ScrollRequest</span><span class="s1">)}</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">}</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">}</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s2">rowAt</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;column-header&quot;</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;=</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s2">columnAt</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;row-header&quot;</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;=</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s2">rowOffset</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s2">columnOffset</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s2">rowSize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;column-header&quot;</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">return </span><span class="s2">i</span><span class="s1">+(</span><span class="s2">o</span><span class="s1">-</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">columnSize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;row-header&quot;</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return </span><span class="s2">i</span><span class="s1">}</span><span class="s4">return </span><span class="s2">i</span><span class="s1">+(</span><span class="s2">o</span><span class="s1">-</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">resizeRow</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">new </span><span class="s2">te</span><span class="s1">.</span><span class="s2">RowResizeRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s2">m</span><span class="s1">.</span><span class="s2">MessageLoop</span><span class="s1">.</span><span class="s2">postMessage</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">resizeColumn</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">new </span><span class="s2">te</span><span class="s1">.</span><span class="s2">ColumnResizeRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s2">m</span><span class="s1">.</span><span class="s2">MessageLoop</span><span class="s1">.</span><span class="s2">postMessage</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">resetRows</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;all&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">reset</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">reset</span><span class="s1">();</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">reset</span><span class="s1">();</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;column-header&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">reset</span><span class="s1">();</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintContent</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintOverlay</span><span class="s1">()}</span><span class="s2">resetColumns</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;all&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">reset</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">reset</span><span class="s1">();</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">reset</span><span class="s1">();</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;row-header&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">reset</span><span class="s1">();</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintContent</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintOverlay</span><span class="s1">()}</span><span class="s2">fitColumnNames</span><span class="s1">(</span><span class="s2">e</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">=</span><span class="s3">15</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">i</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">||</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">undefined</span><span class="s1">:</span><span class="s2">i</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;row-header&quot;</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;all&quot;</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">!==</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">-</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_fitRowColumnHeaders</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s2">s</span><span class="s1">=</span><span class="s3">0</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_fitRowColumnHeaders</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s2">s</span><span class="s1">=</span><span class="s2">s</span><span class="s1">-</span><span class="s2">e</span><span class="s1">}}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_fitRowColumnHeaders</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;all&quot;</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">!==</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">-</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_fitBodyColumnHeaders</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_fitBodyColumnHeaders</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">e</span><span class="s1">))}}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_fitBodyColumnHeaders</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}}}}</span><span class="s2">mapToLocal</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">getBoundingClientRect</span><span class="s1">();</span><span class="s4">let</span><span class="s1">{</span><span class="s2">left</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">top</span><span class="s1">:</span><span class="s2">o</span><span class="s1">}=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s2">o</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">-</span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">t</span><span class="s1">-</span><span class="s2">o</span><span class="s1">;</span><span class="s4">return</span><span class="s1">{</span><span class="s2">lx</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">ly</span><span class="s1">:</span><span class="s2">n</span><span class="s1">}}</span><span class="s2">mapToVirtual</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">lx</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">ly</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">mapToLocal</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">i</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">return</span><span class="s1">{</span><span class="s2">vx</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">vy</span><span class="s1">:</span><span class="s2">r</span><span class="s1">}}</span><span class="s2">hitTest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">lx</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">ly</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">mapToLocal</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">&amp;&amp;</span><span class="s2">h</span><span class="s1">&gt;</span><span class="s2">n</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">h</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">&amp;&amp;</span><span class="s2">a</span><span class="s1">&gt;</span><span class="s2">l</span><span class="s1">){</span><span class="s2">l</span><span class="s1">=</span><span class="s2">a</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">r</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rowAt</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">columnAt</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">columnOffset</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rowOffset</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">columnSize</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rowSize</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">e</span><span class="s1">-</span><span class="s2">n</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">t</span><span class="s1">-</span><span class="s2">l</span><span class="s1">;</span><span class="s4">return</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">x</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s2">h</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">r</span><span class="s1">&amp;&amp;</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">+</span><span class="s2">n</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">i</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">-</span><span class="s2">o</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rowAt</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">columnAt</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">columnOffset</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rowOffset</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">columnSize</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rowSize</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">e</span><span class="s1">-</span><span class="s2">l</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">t</span><span class="s1">-</span><span class="s2">a</span><span class="s1">;</span><span class="s4">return</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s0">&quot;column-header&quot;</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">r</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">x</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s2">h</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s2">c</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">r</span><span class="s1">+</span><span class="s2">l</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">s</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">-</span><span class="s2">r</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rowAt</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">columnAt</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">columnOffset</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rowOffset</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">columnSize</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rowSize</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">e</span><span class="s1">-</span><span class="s2">l</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">t</span><span class="s1">-</span><span class="s2">a</span><span class="s1">;</span><span class="s4">return</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">x</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s2">h</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s2">c</span><span class="s1">}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s2">o</span><span class="s1">&amp;&amp;</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">+</span><span class="s2">n</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&gt;=</span><span class="s2">r</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">r</span><span class="s1">+</span><span class="s2">l</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">i</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">-</span><span class="s2">o</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">s</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">-</span><span class="s2">r</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rowAt</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">columnAt</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">columnOffset</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">l</span><span class="s1">);</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rowOffset</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">columnSize</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">l</span><span class="s1">);</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">rowSize</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">e</span><span class="s1">-</span><span class="s2">a</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s2">t</span><span class="s1">-</span><span class="s2">h</span><span class="s1">;</span><span class="s4">return</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">x</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s2">d</span><span class="s1">}}</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">return</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s0">&quot;void&quot;</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">x</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s2">_</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s2">m</span><span class="s1">}}</span><span class="s2">copyToClipboard</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">Array</span><span class="s1">.</span><span class="s2">from</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">selections</span><span class="s1">());</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">1</span><span class="s1">){</span><span class="s2">alert</span><span class="s1">(</span><span class="s0">&quot;Cannot copy multiple grid selections.&quot;</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s2">r</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let</span><span class="s1">{</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">n</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">h</span><span class="s1">}=</span><span class="s2">i</span><span class="s1">[</span><span class="s3">0</span><span class="s1">];</span><span class="s2">n</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">o</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s2">l</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">l</span><span class="s1">,</span><span class="s2">r</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s2">a</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">o</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s2">h</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">h</span><span class="s1">,</span><span class="s2">r</span><span class="s1">-</span><span class="s3">1</span><span class="s1">));</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">&lt;</span><span class="s2">n</span><span class="s1">)[</span><span class="s2">n</span><span class="s1">,</span><span class="s2">a</span><span class="s1">]=[</span><span class="s2">a</span><span class="s1">,</span><span class="s2">n</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">&lt;</span><span class="s2">l</span><span class="s1">)[</span><span class="s2">l</span><span class="s1">,</span><span class="s2">h</span><span class="s1">]=[</span><span class="s2">h</span><span class="s1">,</span><span class="s2">l</span><span class="s1">];</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">);</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">);</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_copyConfig</span><span class="s1">.</span><span class="s2">separator</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_copyConfig</span><span class="s1">.</span><span class="s2">format</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_copyConfig</span><span class="s1">.</span><span class="s2">headers</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_copyConfig</span><span class="s1">.</span><span class="s2">warningThreshold</span><span class="s1">;</span><span class="s4">let </span><span class="s2">g</span><span class="s1">=</span><span class="s2">a</span><span class="s1">-</span><span class="s2">n</span><span class="s1">+</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">p</span><span class="s1">=</span><span class="s2">h</span><span class="s1">-</span><span class="s2">l</span><span class="s1">+</span><span class="s3">1</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">_</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;none&quot;</span><span class="s1">:</span><span class="s2">c</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;row&quot;</span><span class="s1">:</span><span class="s2">d</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">p</span><span class="s1">+=</span><span class="s2">c</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;column&quot;</span><span class="s1">:</span><span class="s2">c</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">g</span><span class="s1">+=</span><span class="s2">d</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;all&quot;</span><span class="s1">:</span><span class="s2">g</span><span class="s1">+=</span><span class="s2">d</span><span class="s1">;</span><span class="s2">p</span><span class="s1">+=</span><span class="s2">c</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">let </span><span class="s2">w</span><span class="s1">=</span><span class="s2">g</span><span class="s1">*</span><span class="s2">p</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">w</span><span class="s1">&gt;</span><span class="s2">m</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s0">`Copying </span><span class="s2">$</span><span class="s1">{</span><span class="s2">w</span><span class="s1">} </span><span class="s0">cells may take a while. Continue?`</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">window</span><span class="s1">.</span><span class="s2">confirm</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">return</span><span class="s1">}}</span><span class="s4">let </span><span class="s2">y</span><span class="s1">={</span><span class="s2">region</span><span class="s1">:</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">value</span><span class="s1">:</span><span class="s4">null</span><span class="s1">,</span><span class="s2">metadata</span><span class="s1">:{}};</span><span class="s4">let </span><span class="s2">x</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">g</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">g</span><span class="s1">;++</span><span class="s2">s</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">p</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">p</span><span class="s1">;++</span><span class="s2">i</span><span class="s1">){</span><span class="s4">let </span><span class="s2">o</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">d</span><span class="s1">&amp;&amp;</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">c</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">;</span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s2">a</span><span class="s1">=</span><span class="s2">i</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s2">d</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s0">&quot;column-header&quot;</span><span class="s1">;</span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s2">a</span><span class="s1">=</span><span class="s2">i</span><span class="s1">-</span><span class="s2">c</span><span class="s1">+</span><span class="s2">l</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">c</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s0">&quot;row-header&quot;</span><span class="s1">;</span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">-</span><span class="s2">d</span><span class="s1">+</span><span class="s2">n</span><span class="s1">;</span><span class="s2">a</span><span class="s1">=</span><span class="s2">i</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">=</span><span class="s0">&quot;body&quot;</span><span class="s1">;</span><span class="s2">r</span><span class="s1">=</span><span class="s2">s</span><span class="s1">-</span><span class="s2">d</span><span class="s1">+</span><span class="s2">n</span><span class="s1">;</span><span class="s2">a</span><span class="s1">=</span><span class="s2">i</span><span class="s1">-</span><span class="s2">c</span><span class="s1">+</span><span class="s2">l</span><span class="s1">}</span><span class="s2">y</span><span class="s1">.</span><span class="s2">region</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s2">y</span><span class="s1">.</span><span class="s2">row</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s2">y</span><span class="s1">.</span><span class="s2">column</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">y</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">data</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">a</span><span class="s1">);</span><span class="s2">y</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">a</span><span class="s1">);</span><span class="s2">t</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]=</span><span class="s2">f</span><span class="s1">(</span><span class="s2">y</span><span class="s1">)}</span><span class="s2">x</span><span class="s1">[</span><span class="s2">s</span><span class="s1">]=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">let </span><span class="s2">v</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">map</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s2">u</span><span class="s1">)));</span><span class="s4">let </span><span class="s2">C</span><span class="s1">=</span><span class="s2">v</span><span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">&quot;</span><span class="s4">\n</span><span class="s0">&quot;</span><span class="s1">);</span><span class="s2">s</span><span class="s1">.</span><span class="s2">ClipboardExt</span><span class="s1">.</span><span class="s2">copyText</span><span class="s1">(</span><span class="s2">C</span><span class="s1">)}</span><span class="s2">processMessage</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;child-shown&quot;</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;child-hidden&quot;</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;fit-request&quot;</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">ElementExt</span><span class="s1">.</span><span class="s2">sizeLimits</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">node</span><span class="s1">);</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">ElementExt</span><span class="s1">.</span><span class="s2">sizeLimits</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">node</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBarMinWidth</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">minWidth</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBarMinHeight</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">minHeight</span><span class="s1">}</span><span class="s4">super</span><span class="s1">.</span><span class="s2">processMessage</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">messageHook</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_processViewportMessage</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">return true</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;activate-request&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">activate</span><span class="s1">();</span><span class="s4">return false</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">type</span><span class="s1">===</span><span class="s0">&quot;activate-request&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">activate</span><span class="s1">();</span><span class="s4">return false</span><span class="s1">}</span><span class="s4">return true</span><span class="s1">}</span><span class="s2">handleEvent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;keydown&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_evtKeyDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;mousedown&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_evtMouseDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;mousemove&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_evtMouseMove</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;mouseup&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_evtMouseUp</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;dblclick&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_evtMouseDoubleClick</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;mouseleave&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_evtMouseLeave</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;contextmenu&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_evtContextMenu</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;wheel&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_evtWheel</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;resize&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_refreshDPI</span><span class="s1">();</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">get currentViewport</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">offsetWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">offsetHeight</span><span class="s1">;</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">round</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">round</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">||</span><span class="s2">t</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">;</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">const </span><span class="s2">a</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">o</span><span class="s1">+</span><span class="s2">i</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">const </span><span class="s2">h</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">r</span><span class="s1">+</span><span class="s2">s</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">const </span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">l</span><span class="s1">-</span><span class="s2">r</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">);</span><span class="s4">const </span><span class="s2">d</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">n</span><span class="s1">-</span><span class="s2">o</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">);</span><span class="s4">const </span><span class="s2">u</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">h</span><span class="s1">-</span><span class="s2">r</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollY</span><span class="s1">);</span><span class="s4">const </span><span class="s2">f</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">a</span><span class="s1">-</span><span class="s2">o</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollX</span><span class="s1">);</span><span class="s4">return</span><span class="s1">{</span><span class="s2">firstRow</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">firstColumn</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">lastRow</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">lastColumn</span><span class="s1">:</span><span class="s2">f</span><span class="s1">}}</span><span class="s2">onActivateRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">focus</span><span class="s1">({</span><span class="s2">preventScroll</span><span class="s1">:</span><span class="s4">true</span><span class="s1">})}</span><span class="s2">onBeforeAttach</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">window</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;resize&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;wheel&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;mousedown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;mousemove&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;dblclick&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;mouseleave&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;contextmenu&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintContent</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintOverlay</span><span class="s1">()}</span><span class="s2">onAfterDetach</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">window</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;resize&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;wheel&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;mousedown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;mousemove&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;mouseleave&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;dblclick&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;contextmenu&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_releaseMouse</span><span class="s1">()}</span><span class="s2">onBeforeShow</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintContent</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintOverlay</span><span class="s1">()}</span><span class="s2">onResize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editorController</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_editorController</span><span class="s1">.</span><span class="s2">cancel</span><span class="s1">()}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">()}</span><span class="s2">repaintContent</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">new </span><span class="s2">te</span><span class="s1">.</span><span class="s2">PaintRequest</span><span class="s1">(</span><span class="s0">&quot;all&quot;</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s2">m</span><span class="s1">.</span><span class="s2">MessageLoop</span><span class="s1">.</span><span class="s2">postMessage</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">repaintRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">){</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">new </span><span class="s2">te</span><span class="s1">.</span><span class="s2">PaintRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s2">m</span><span class="s1">.</span><span class="s2">MessageLoop</span><span class="s1">.</span><span class="s2">postMessage</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s2">repaintOverlay</span><span class="s1">(){</span><span class="s2">m</span><span class="s1">.</span><span class="s2">MessageLoop</span><span class="s1">.</span><span class="s2">postMessage</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">,</span><span class="s2">te</span><span class="s1">.</span><span class="s2">OverlayPaintRequest</span><span class="s1">)}</span><span class="s2">_getMaxWidthInColumn</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return null</span><span class="s1">}</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">==</span><span class="s0">&quot;row-header&quot;</span><span class="s1">?</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">:</span><span class="s0">&quot;column-header&quot;</span><span class="s1">;</span><span class="s4">return </span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getMaxWidthInArea</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s0">&quot;column-header&quot;</span><span class="s1">),</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getMaxWidthInArea</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s0">&quot;body&quot;</span><span class="s1">))}</span><span class="s2">_getMaxWidthInArea</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">Array</span><span class="s1">.</span><span class="s2">from</span><span class="s1">({</span><span class="s2">length</span><span class="s1">:</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s3">1e6</span><span class="s1">)},((</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">)=&gt;</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">_getConfig</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)));</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;</span><span class="s3">1e5</span><span class="s1">){</span><span class="s2">r</span><span class="s1">.</span><span class="s2">sort</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getTextToRender</span><span class="s1">(</span><span class="s2">e</span><span class="s1">).</span><span class="s2">length</span><span class="s1">))}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">l</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">&amp;&amp;</span><span class="s2">l</span><span class="s1">&lt;</span><span class="s3">1e5</span><span class="s1">;++</span><span class="s2">l</span><span class="s1">){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getCellTextWidth</span><span class="s1">(</span><span class="s2">r</span><span class="s1">[</span><span class="s2">l</span><span class="s1">]);</span><span class="s2">n</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">return </span><span class="s2">n</span><span class="s1">}</span><span class="s4">static </span><span class="s2">_getConfig</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return</span><span class="s1">{</span><span class="s2">x</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">region</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">value</span><span class="s1">:</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">_getCellValue</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">),</span><span class="s2">metadata</span><span class="s1">:</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">_getCellMetadata</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)}}</span><span class="s2">_getTextToRender</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cellRenderers</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">return </span><span class="s2">t</span><span class="s1">.</span><span class="s2">getText</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">_getCellTextWidth</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cellRenderers</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">canvasGC</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">font</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">font</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s2">i</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">textColor</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s2">i</span><span class="s1">.</span><span class="s2">textAlign</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">horizontalAlignment</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s2">i</span><span class="s1">.</span><span class="s2">textBaseline</span><span class="s1">=</span><span class="s0">&quot;bottom&quot;</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getTextToRender</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">return </span><span class="s2">i</span><span class="s1">.</span><span class="s2">measureText</span><span class="s1">(</span><span class="s2">s</span><span class="s1">).</span><span class="s2">width</span><span class="s1">+</span><span class="s3">2</span><span class="s1">*</span><span class="s2">t</span><span class="s1">.</span><span class="s2">horizontalPadding</span><span class="s1">}</span><span class="s2">_resizeCanvasIfNeeded</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s2">e</span><span class="s1">=</span><span class="s2">e</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">;</span><span class="s2">t</span><span class="s1">=</span><span class="s2">t</span><span class="s1">*</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">ceil</span><span class="s1">((</span><span class="s2">e</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)/</span><span class="s3">512</span><span class="s1">)+</span><span class="s3">1</span><span class="s1">)*</span><span class="s3">512</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">ceil</span><span class="s1">((</span><span class="s2">t</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)/</span><span class="s3">512</span><span class="s1">)+</span><span class="s3">1</span><span class="s1">)*</span><span class="s3">512</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">width</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">height</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;=</span><span class="s2">e</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">&gt;=</span><span class="s2">t</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s2">i</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s2">s</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">-</span><span class="s3">512</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">s</span><span class="s1">-</span><span class="s3">512</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">setTransform</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">1</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bufferGC</span><span class="s1">.</span><span class="s2">setTransform</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">1</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlayGC</span><span class="s1">.</span><span class="s2">setTransform</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">1</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_buffer</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">n</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;</span><span class="s2">i</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_buffer</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">i</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_buffer</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s2">l</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s2">s</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_buffer</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s2">s</span><span class="s1">}</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">o</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">e</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bufferGC</span><span class="s1">.</span><span class="s2">drawImage</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">n</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">}</span><span class="s0">px`</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;</span><span class="s2">i</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">i</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">}</span><span class="s0">px`</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">l</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">}</span><span class="s0">px`</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s2">s</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">s</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">}</span><span class="s0">px`</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">drawImage</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_buffer</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bufferGC</span><span class="s1">.</span><span class="s2">drawImage</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">n</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">}</span><span class="s0">px`</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;</span><span class="s2">i</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">i</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">}</span><span class="s0">px`</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">l</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">}</span><span class="s0">px`</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s2">s</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">s</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">}</span><span class="s0">px`</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlayGC</span><span class="s1">.</span><span class="s2">drawImage</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_buffer</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">)}}</span><span class="s2">_syncScrollState</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">isHidden</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">isHidden</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBarMinWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBarMinHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">i</span><span class="s1">+(</span><span class="s2">o</span><span class="s1">?</span><span class="s2">n</span><span class="s1">:</span><span class="s3">0</span><span class="s1">);</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">s</span><span class="s1">+(</span><span class="s2">r</span><span class="s1">?</span><span class="s2">l</span><span class="s1">:</span><span class="s3">0</span><span class="s1">);</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">h</span><span class="s1">&lt;</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">a</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">c</span><span class="s1">&amp;&amp;!</span><span class="s2">d</span><span class="s1">){</span><span class="s2">d</span><span class="s1">=</span><span class="s2">a</span><span class="s1">-</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s2">e</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">d</span><span class="s1">&amp;&amp;!</span><span class="s2">c</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">h</span><span class="s1">-</span><span class="s2">l</span><span class="s1">&lt;</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">c</span><span class="s1">!==</span><span class="s2">o</span><span class="s1">||</span><span class="s2">d</span><span class="s1">!==</span><span class="s2">r</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">setHidden</span><span class="s1">(!</span><span class="s2">c</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">setHidden</span><span class="s1">(!</span><span class="s2">d</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollCorner</span><span class="s1">.</span><span class="s2">setHidden</span><span class="s1">(!</span><span class="s2">c</span><span class="s1">||!</span><span class="s2">d</span><span class="s1">);</span><span class="s2">m</span><span class="s1">.</span><span class="s2">MessageLoop</span><span class="s1">.</span><span class="s2">sendMessage</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">f</span><span class="s1">.</span><span class="s2">Widget</span><span class="s1">.</span><span class="s2">Msg</span><span class="s1">.</span><span class="s2">FitRequest</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">maximum</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">page</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">maximum</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">page</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollTo</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">)}</span><span class="s2">_syncViewport</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintContent</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintOverlay</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">()}</span><span class="s2">_processViewportMessage</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">type</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;resize&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onViewportResize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;scroll-request&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onViewportScrollRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;paint-request&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onViewportPaintRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;overlay-paint-request&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onViewportOverlayPaintRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;row-resize-request&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onViewportRowResizeRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;column-resize-request&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onViewportColumnResizeRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}}</span><span class="s2">_onViewportResize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">isVisible</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let</span><span class="s1">{</span><span class="s2">width</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s2">i</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===-</span><span class="s3">1</span><span class="s1">){</span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">offsetWidth</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">===-</span><span class="s3">1</span><span class="s1">){</span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">node</span><span class="s1">.</span><span class="s2">offsetHeight</span><span class="s1">}</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">round</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s2">i</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">round</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_resizeCanvasIfNeeded</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s2">i</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s2">o</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">+</span><span class="s2">e</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">t</span><span class="s1">-</span><span class="s2">o</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;</span><span class="s2">s</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">t</span><span class="s1">-</span><span class="s2">s</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">+</span><span class="s2">e</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">-</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;</span><span class="s2">o</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">-</span><span class="s2">o</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">()}</span><span class="s2">_onViewportScrollRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollTo</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">value</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">value</span><span class="s1">)}</span><span class="s2">_onViewportPaintRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">isVisible</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">;</span><span class="s4">let</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">_</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">m</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">g</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">p</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">let </span><span class="s2">w</span><span class="s1">;</span><span class="s4">let </span><span class="s2">y</span><span class="s1">;</span><span class="s4">let </span><span class="s2">x</span><span class="s1">;</span><span class="s4">let </span><span class="s2">v</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">f</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;all&quot;</span><span class="s1">:</span><span class="s2">w</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s2">y</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">x</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s2">v</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s2">_</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">_</span><span class="s1">,</span><span class="s2">h</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">m</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">m</span><span class="s1">,</span><span class="s2">c</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">g</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">g</span><span class="s1">,</span><span class="s2">h</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">p</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">p</span><span class="s1">,</span><span class="s2">c</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">w</span><span class="s1">=</span><span class="s2">c</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">m</span><span class="s1">)-</span><span class="s2">r</span><span class="s1">+</span><span class="s2">l</span><span class="s1">;</span><span class="s2">y</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">_</span><span class="s1">)-</span><span class="s2">n</span><span class="s1">+</span><span class="s2">a</span><span class="s1">;</span><span class="s2">x</span><span class="s1">=</span><span class="s2">c</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">p</span><span class="s1">)-</span><span class="s2">r</span><span class="s1">+</span><span class="s2">l</span><span class="s1">;</span><span class="s2">v</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">g</span><span class="s1">)-</span><span class="s2">n</span><span class="s1">+</span><span class="s2">a</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;row-header&quot;</span><span class="s1">:</span><span class="s2">_</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">_</span><span class="s1">,</span><span class="s2">h</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">m</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">m</span><span class="s1">,</span><span class="s2">d</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">g</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">g</span><span class="s1">,</span><span class="s2">h</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">p</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">p</span><span class="s1">,</span><span class="s2">d</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">w</span><span class="s1">=</span><span class="s2">d</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">m</span><span class="s1">);</span><span class="s2">y</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">_</span><span class="s1">)-</span><span class="s2">n</span><span class="s1">+</span><span class="s2">a</span><span class="s1">;</span><span class="s2">x</span><span class="s1">=</span><span class="s2">d</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">p</span><span class="s1">);</span><span class="s2">v</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">g</span><span class="s1">)-</span><span class="s2">n</span><span class="s1">+</span><span class="s2">a</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;column-header&quot;</span><span class="s1">:</span><span class="s2">_</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">_</span><span class="s1">,</span><span class="s2">u</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">m</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">m</span><span class="s1">,</span><span class="s2">c</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">g</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">g</span><span class="s1">,</span><span class="s2">u</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">p</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">p</span><span class="s1">,</span><span class="s2">c</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">w</span><span class="s1">=</span><span class="s2">c</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">m</span><span class="s1">)-</span><span class="s2">r</span><span class="s1">+</span><span class="s2">l</span><span class="s1">;</span><span class="s2">y</span><span class="s1">=</span><span class="s2">u</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">_</span><span class="s1">);</span><span class="s2">x</span><span class="s1">=</span><span class="s2">c</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">p</span><span class="s1">)-</span><span class="s2">r</span><span class="s1">+</span><span class="s2">l</span><span class="s1">;</span><span class="s2">v</span><span class="s1">=</span><span class="s2">u</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">g</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">:</span><span class="s2">_</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">_</span><span class="s1">,</span><span class="s2">u</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">m</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">m</span><span class="s1">,</span><span class="s2">d</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">g</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">g</span><span class="s1">,</span><span class="s2">u</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">p</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">p</span><span class="s1">,</span><span class="s2">d</span><span class="s1">.</span><span class="s2">count</span><span class="s1">));</span><span class="s2">w</span><span class="s1">=</span><span class="s2">d</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">m</span><span class="s1">);</span><span class="s2">y</span><span class="s1">=</span><span class="s2">u</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">_</span><span class="s1">);</span><span class="s2">x</span><span class="s1">=</span><span class="s2">d</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">p</span><span class="s1">);</span><span class="s2">v</span><span class="s1">=</span><span class="s2">u</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">g</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">x</span><span class="s1">&lt;</span><span class="s2">t</span><span class="s1">||</span><span class="s2">v</span><span class="s1">&lt;</span><span class="s2">i</span><span class="s1">||</span><span class="s2">w</span><span class="s1">&gt;</span><span class="s2">s</span><span class="s1">||</span><span class="s2">y</span><span class="s1">&gt;</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">w</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">w</span><span class="s1">,</span><span class="s2">s</span><span class="s1">));</span><span class="s2">y</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">y</span><span class="s1">,</span><span class="s2">o</span><span class="s1">));</span><span class="s2">x</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">x</span><span class="s1">,</span><span class="s2">s</span><span class="s1">));</span><span class="s2">v</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">v</span><span class="s1">,</span><span class="s2">o</span><span class="s1">));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">w</span><span class="s1">,</span><span class="s2">y</span><span class="s1">,</span><span class="s2">x</span><span class="s1">-</span><span class="s2">w</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">v</span><span class="s1">-</span><span class="s2">y</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)}</span><span class="s2">_onViewportOverlayPaintRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">isVisible</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">()}</span><span class="s2">_onViewportRowResizeRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">region</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_resizeRow</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">index</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_resizeColumnHeader</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">index</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">)}}</span><span class="s2">_onViewportColumnResizeRequest</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">region</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_resizeColumn</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">index</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_resizeRowHeader</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">index</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">)}}</span><span class="s2">_onThumbMoved</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">m</span><span class="s1">.</span><span class="s2">MessageLoop</span><span class="s1">.</span><span class="s2">postMessage</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">,</span><span class="s2">te</span><span class="s1">.</span><span class="s2">ScrollRequest</span><span class="s1">)}</span><span class="s2">_onPageRequested</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollByPage</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;decrement&quot;</span><span class="s1">?</span><span class="s0">&quot;up&quot;</span><span class="s1">:</span><span class="s0">&quot;down&quot;</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollByPage</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;decrement&quot;</span><span class="s1">?</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s0">&quot;right&quot;</span><span class="s1">)}}</span><span class="s2">_onStepRequested</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollByStep</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;decrement&quot;</span><span class="s1">?</span><span class="s0">&quot;up&quot;</span><span class="s1">:</span><span class="s0">&quot;down&quot;</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">scrollByStep</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;decrement&quot;</span><span class="s1">?</span><span class="s0">&quot;left&quot;</span><span class="s1">:</span><span class="s0">&quot;right&quot;</span><span class="s1">)}}</span><span class="s2">_onDataModelChanged</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">type</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;rows-inserted&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onRowsInserted</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;columns-inserted&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onColumnsInserted</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;rows-removed&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onRowsRemoved</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;columns-removed&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onColumnsRemoved</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;rows-moved&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onRowsMoved</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;columns-moved&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onColumnsMoved</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;cells-changed&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onCellsChanged</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;model-reset&quot;</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_onModelReset</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}}</span><span class="s2">_onSelectionsChanged</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintOverlay</span><span class="s1">()}</span><span class="s2">_onRowsInserted</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">index</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">span</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">o</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">_onColumnsInserted</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">index</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">span</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">o</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">_onRowsRemoved</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">index</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">span</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">count</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">o</span><span class="s1">.</span><span class="s2">remove</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">.</span><span class="s2">remove</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">_onColumnsRemoved</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">index</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">span</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">count</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">o</span><span class="s1">.</span><span class="s2">remove</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">o</span><span class="s1">.</span><span class="s2">remove</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">_onRowsMoved</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">index</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">span</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">destination</span><span class="s1">:</span><span class="s2">o</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">r</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">count</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s2">i</span><span class="s1">);</span><span class="s2">o</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">o</span><span class="s1">),</span><span class="s2">r</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s2">s</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">===</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">i</span><span class="s1">+</span><span class="s2">s</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">o</span><span class="s1">+</span><span class="s2">s</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s2">r</span><span class="s1">.</span><span class="s2">move</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintRegion</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">,</span><span class="s2">Infinity</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintRegion</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">,</span><span class="s2">Infinity</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintRegion</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">,</span><span class="s2">Infinity</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintRegion</span><span class="s1">(</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">,</span><span class="s2">Infinity</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">_onColumnsMoved</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">index</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">span</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">destination</span><span class="s1">:</span><span class="s2">o</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">r</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">i</span><span class="s1">&gt;=</span><span class="s2">r</span><span class="s1">.</span><span class="s2">count</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">r</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s2">i</span><span class="s1">);</span><span class="s2">o</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">o</span><span class="s1">),</span><span class="s2">r</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s2">s</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">===</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">r</span><span class="s1">.</span><span class="s2">move</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">i</span><span class="s1">+</span><span class="s2">s</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">o</span><span class="s1">+</span><span class="s2">s</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintRegion</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">Infinity</span><span class="s1">,</span><span class="s2">l</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintRegion</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">Infinity</span><span class="s1">,</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintRegion</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">Infinity</span><span class="s1">,</span><span class="s2">l</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintRegion</span><span class="s1">(</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">Infinity</span><span class="s1">,</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">_onCellsChanged</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let</span><span class="s1">{</span><span class="s2">region</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">rowSpan</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">columnSpan</span><span class="s1">:</span><span class="s2">r</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">n</span><span class="s1">+</span><span class="s2">o</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">l</span><span class="s1">+</span><span class="s2">r</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintRegion</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">l</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">h</span><span class="s1">)}</span><span class="s2">_onModelReset</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">)-</span><span class="s2">t</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">)-</span><span class="s2">i</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">)-</span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">)-</span><span class="s2">o</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">remove</span><span class="s1">(</span><span class="s2">t</span><span class="s1">+</span><span class="s2">r</span><span class="s1">,-</span><span class="s2">r</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">remove</span><span class="s1">(</span><span class="s2">i</span><span class="s1">+</span><span class="s2">n</span><span class="s1">,-</span><span class="s2">n</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">remove</span><span class="s1">(</span><span class="s2">s</span><span class="s1">+</span><span class="s2">l</span><span class="s1">,-</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">insert</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">a</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">remove</span><span class="s1">(</span><span class="s2">o</span><span class="s1">+</span><span class="s2">a</span><span class="s1">,-</span><span class="s2">a</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncViewport</span><span class="s1">()}</span><span class="s2">_onRenderersChanged</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintContent</span><span class="s1">()}</span><span class="s2">_evtKeyDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mousedown</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">()}</span><span class="s4">else if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_keyHandler</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_keyHandler</span><span class="s1">.</span><span class="s2">onKeyDown</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}}</span><span class="s2">_evtMouseDown</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">button</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">activate</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s2">document</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">,</span><span class="s4">true</span><span class="s1">);</span><span class="s2">document</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;mouseup&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">,</span><span class="s4">true</span><span class="s1">);</span><span class="s2">document</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;mousedown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">,</span><span class="s4">true</span><span class="s1">);</span><span class="s2">document</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;mousemove&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">,</span><span class="s4">true</span><span class="s1">);</span><span class="s2">document</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">&quot;contextmenu&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">,</span><span class="s4">true</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mousedown</span><span class="s1">=</span><span class="s4">true</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">.</span><span class="s2">onMouseDown</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}}</span><span class="s2">_evtMouseMove</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mousedown</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">()}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mousedown</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">.</span><span class="s2">onMouseMove</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">.</span><span class="s2">onMouseHover</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}}</span><span class="s2">_evtMouseUp</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">button</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">.</span><span class="s2">onMouseUp</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_releaseMouse</span><span class="s1">()}</span><span class="s2">_evtMouseDoubleClick</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">button</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">.</span><span class="s2">onMouseDoubleClick</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_releaseMouse</span><span class="s1">()}</span><span class="s2">_evtMouseLeave</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mousedown</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">()}</span><span class="s4">else if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">.</span><span class="s2">onMouseLeave</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}}</span><span class="s2">_evtContextMenu</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mousedown</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">preventDefault</span><span class="s1">();</span><span class="s2">e</span><span class="s1">.</span><span class="s2">stopPropagation</span><span class="s1">()}</span><span class="s4">else if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">.</span><span class="s2">onContextMenu</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}}</span><span class="s2">_evtWheel</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">Platform</span><span class="s1">.</span><span class="s2">accelKey</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">.</span><span class="s2">onWheel</span><span class="s1">(</span><span class="s4">this</span><span class="s1">,</span><span class="s2">e</span><span class="s1">)}</span><span class="s2">_releaseMouse</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mousedown</span><span class="s1">=</span><span class="s4">false</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_mouseHandler</span><span class="s1">.</span><span class="s2">release</span><span class="s1">()}</span><span class="s2">document</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;keydown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">,</span><span class="s4">true</span><span class="s1">);</span><span class="s2">document</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;mouseup&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">,</span><span class="s4">true</span><span class="s1">);</span><span class="s2">document</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;mousedown&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">,</span><span class="s4">true</span><span class="s1">);</span><span class="s2">document</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;mousemove&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">,</span><span class="s4">true</span><span class="s1">);</span><span class="s2">document</span><span class="s1">.</span><span class="s2">removeEventListener</span><span class="s1">(</span><span class="s0">&quot;contextmenu&quot;</span><span class="s1">,</span><span class="s4">this</span><span class="s1">,</span><span class="s4">true</span><span class="s1">)}</span><span class="s2">_refreshDPI</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">ceil</span><span class="s1">(</span><span class="s2">window</span><span class="s1">.</span><span class="s2">devicePixelRatio</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">===</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintContent</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintOverlay</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_resizeCanvasIfNeeded</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">width</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">}</span><span class="s0">px`</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">.</span><span class="s2">height</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">}</span><span class="s0">px`</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">width</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">}</span><span class="s0">px`</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">style</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">height</span><span class="s1">/</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">}</span><span class="s0">px`</span><span class="s1">}</span><span class="s2">_resizeRow</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">count</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">clampSize</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">===</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">i</span><span class="s1">.</span><span class="s2">resize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">isVisible</span><span class="s1">||</span><span class="s2">r</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s2">n</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">o</span><span class="s1">-</span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)+</span><span class="s2">a</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">||</span><span class="s2">h</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">+</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s2">a</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">+=</span><span class="s2">l</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">h</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">+</span><span class="s2">s</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">||</span><span class="s2">h</span><span class="s1">+</span><span class="s2">o</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">c</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">n</span><span class="s1">-</span><span class="s2">c</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">;</span><span class="s4">let </span><span class="s2">g</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">+</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s2">a</span><span class="s1">){</span><span class="s2">_</span><span class="s1">=</span><span class="s2">a</span><span class="s1">-</span><span class="s2">l</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">n</span><span class="s1">-</span><span class="s2">_</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s2">a</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">_</span><span class="s1">=</span><span class="s2">h</span><span class="s1">+</span><span class="s2">s</span><span class="s1">;</span><span class="s2">m</span><span class="s1">=</span><span class="s2">n</span><span class="s1">-</span><span class="s2">_</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s2">_</span><span class="s1">+</span><span class="s2">l</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_blitContent</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">_</span><span class="s1">,</span><span class="s2">u</span><span class="s1">,</span><span class="s2">m</span><span class="s1">,</span><span class="s2">f</span><span class="s1">,</span><span class="s2">g</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">h</span><span class="s1">+</span><span class="s2">o</span><span class="s1">&gt;</span><span class="s2">a</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">c</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">h</span><span class="s1">+</span><span class="s2">o</span><span class="s1">-</span><span class="s2">c</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">a</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">n</span><span class="s1">-</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">+</span><span class="s2">l</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,-</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">p of</span><span class="s1">[</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s0">&quot;row-header&quot;</span><span class="s1">]){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getCellGroupsAtRow</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">p</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">i</span><span class="s1">={</span><span class="s2">region</span><span class="s1">:</span><span class="s2">p</span><span class="s1">,</span><span class="s2">xMin</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">xMax</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">yMin</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">yMax</span><span class="s1">:</span><span class="s3">0</span><span class="s1">};</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">undefined</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">p</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">backgroundColor</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;row-header&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerBackgroundColor</span><span class="s1">;</span><span class="s4">break</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintMergedCells</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">()}</span><span class="s2">_resizeColumn</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">count</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">!==</span><span class="s4">null</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">!==</span><span class="s4">void </span><span class="s3">0</span><span class="s1">?</span><span class="s2">t</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getMaxWidthInColumn</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s0">&quot;body&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">s</span><span class="s1">||</span><span class="s2">s</span><span class="s1">==</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">clampSize</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">===</span><span class="s2">r</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">i</span><span class="s1">.</span><span class="s2">resize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">isVisible</span><span class="s1">||</span><span class="s2">n</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s2">l</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">r</span><span class="s1">-</span><span class="s2">o</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)+</span><span class="s2">h</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">||</span><span class="s2">c</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">c</span><span class="s1">+</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s2">h</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">+=</span><span class="s2">a</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">h</span><span class="s1">,</span><span class="s2">c</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">c</span><span class="s1">+</span><span class="s2">o</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">||</span><span class="s2">c</span><span class="s1">+</span><span class="s2">r</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">d</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">-</span><span class="s2">d</span><span class="s1">,</span><span class="s2">l</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">;</span><span class="s4">let </span><span class="s2">g</span><span class="s1">;</span><span class="s4">let </span><span class="s2">p</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">c</span><span class="s1">+</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s2">h</span><span class="s1">){</span><span class="s2">m</span><span class="s1">=</span><span class="s2">h</span><span class="s1">-</span><span class="s2">a</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s2">n</span><span class="s1">-</span><span class="s2">m</span><span class="s1">;</span><span class="s2">p</span><span class="s1">=</span><span class="s2">h</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">m</span><span class="s1">=</span><span class="s2">c</span><span class="s1">+</span><span class="s2">o</span><span class="s1">;</span><span class="s2">g</span><span class="s1">=</span><span class="s2">n</span><span class="s1">-</span><span class="s2">m</span><span class="s1">;</span><span class="s2">p</span><span class="s1">=</span><span class="s2">m</span><span class="s1">+</span><span class="s2">a</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_blitContent</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">,</span><span class="s2">m</span><span class="s1">,</span><span class="s2">u</span><span class="s1">,</span><span class="s2">g</span><span class="s1">,</span><span class="s2">f</span><span class="s1">,</span><span class="s2">p</span><span class="s1">,</span><span class="s2">_</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">c</span><span class="s1">+</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s2">h</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">d</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">c</span><span class="s1">+</span><span class="s2">r</span><span class="s1">-</span><span class="s2">d</span><span class="s1">,</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">h</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">-</span><span class="s2">t</span><span class="s1">,</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">n</span><span class="s1">+</span><span class="s2">a</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,-</span><span class="s2">a</span><span class="s1">,</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">w of</span><span class="s1">[</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s0">&quot;column-header&quot;</span><span class="s1">]){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getCellGroupsAtColumn</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">w</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">i</span><span class="s1">={</span><span class="s2">region</span><span class="s1">:</span><span class="s2">w</span><span class="s1">,</span><span class="s2">xMin</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">xMax</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">yMin</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">yMax</span><span class="s1">:</span><span class="s3">0</span><span class="s1">};</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">undefined</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">w</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">backgroundColor</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;column-header&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerBackgroundColor</span><span class="s1">;</span><span class="s4">break</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintMergedCells</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">()}</span><span class="s2">_resizeRowHeader</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">count</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">!==</span><span class="s4">null</span><span class="s1">&amp;&amp;</span><span class="s2">t</span><span class="s1">!==</span><span class="s4">void </span><span class="s3">0</span><span class="s1">?</span><span class="s2">t</span><span class="s1">:</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getMaxWidthInColumn</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s0">&quot;row-header&quot;</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">s</span><span class="s1">||</span><span class="s2">s</span><span class="s1">==</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">clampSize</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">===</span><span class="s2">r</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">i</span><span class="s1">.</span><span class="s2">resize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">isVisible</span><span class="s1">||</span><span class="s2">n</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s2">l</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">r</span><span class="s1">-</span><span class="s2">o</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">+</span><span class="s2">o</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">||</span><span class="s2">h</span><span class="s1">+</span><span class="s2">r</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">h</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">-</span><span class="s2">h</span><span class="s1">,</span><span class="s2">l</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">h</span><span class="s1">+</span><span class="s2">o</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">n</span><span class="s1">-</span><span class="s2">c</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s2">c</span><span class="s1">+</span><span class="s2">a</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_blitContent</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">,</span><span class="s2">c</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">u</span><span class="s1">,</span><span class="s2">f</span><span class="s1">,</span><span class="s2">_</span><span class="s1">,</span><span class="s2">m</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">h</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">-</span><span class="s2">t</span><span class="s1">,</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">n</span><span class="s1">+</span><span class="s2">a</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,-</span><span class="s2">a</span><span class="s1">,</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">g of</span><span class="s1">[</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">,</span><span class="s0">&quot;row-header&quot;</span><span class="s1">]){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getCellGroupsAtColumn</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">g</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">i</span><span class="s1">={</span><span class="s2">region</span><span class="s1">:</span><span class="s2">g</span><span class="s1">,</span><span class="s2">xMin</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">xMax</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">yMin</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">yMax</span><span class="s1">:</span><span class="s3">0</span><span class="s1">};</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">g</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;row-header&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s4">break</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintMergedCells</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerBackgroundColor</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">()}</span><span class="s2">_resizeColumnHeader</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">count</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">clampSize</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">===</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">i</span><span class="s1">.</span><span class="s2">resize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">isVisible</span><span class="s1">||</span><span class="s2">r</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s2">n</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">();</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">o</span><span class="s1">-</span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">+</span><span class="s2">s</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">||</span><span class="s2">a</span><span class="s1">+</span><span class="s2">o</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">n</span><span class="s1">-</span><span class="s2">a</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">a</span><span class="s1">+</span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">n</span><span class="s1">-</span><span class="s2">c</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s2">c</span><span class="s1">+</span><span class="s2">l</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_blitContent</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">,</span><span class="s2">h</span><span class="s1">,</span><span class="s2">c</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">u</span><span class="s1">,</span><span class="s2">f</span><span class="s1">,</span><span class="s2">_</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">o</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">n</span><span class="s1">-</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">+</span><span class="s2">l</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,-</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">m of</span><span class="s1">[</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">,</span><span class="s0">&quot;column-header&quot;</span><span class="s1">]){</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getCellGroupsAtRow</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">m</span><span class="s1">,</span><span class="s2">e</span><span class="s1">);</span><span class="s4">let </span><span class="s2">i</span><span class="s1">={</span><span class="s2">region</span><span class="s1">:</span><span class="s2">m</span><span class="s1">,</span><span class="s2">xMin</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">xMax</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">yMin</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">yMax</span><span class="s1">:</span><span class="s3">0</span><span class="s1">};</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">m</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;column-header&quot;</span><span class="s1">:</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">i</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">break</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintMergedCells</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerBackgroundColor</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_syncScrollState</span><span class="s1">()}</span><span class="s2">_scrollTo</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">),</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">));</span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">t</span><span class="s1">),</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_hScrollBar</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_vScrollBar</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">===</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewport</span><span class="s1">.</span><span class="s2">isVisible</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s2">r</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">o</span><span class="s1">-</span><span class="s2">n</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">r</span><span class="s1">-</span><span class="s2">l</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">h</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">a</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">abs</span><span class="s1">(</span><span class="s2">i</span><span class="s1">)&gt;=</span><span class="s2">a</span><span class="s1">){</span><span class="s2">c</span><span class="s1">=</span><span class="s2">a</span><span class="s1">*</span><span class="s2">r</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">c</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">abs</span><span class="s1">(</span><span class="s2">i</span><span class="s1">)*</span><span class="s2">r</span><span class="s1">}}</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">h</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">abs</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)&gt;=</span><span class="s2">h</span><span class="s1">){</span><span class="s2">d</span><span class="s1">=</span><span class="s2">o</span><span class="s1">*</span><span class="s2">h</span><span class="s1">}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">d</span><span class="s1">=</span><span class="s2">o</span><span class="s1">*</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">abs</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)}}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">c</span><span class="s1">+</span><span class="s2">d</span><span class="s1">&gt;=</span><span class="s2">o</span><span class="s1">*</span><span class="s2">r</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">();</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">h</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">abs</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)&gt;=</span><span class="s2">h</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">h</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">l</span><span class="s1">:</span><span class="s2">l</span><span class="s1">+</span><span class="s2">s</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">h</span><span class="s1">-</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">abs</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_blitContent</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">-</span><span class="s2">s</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">l</span><span class="s1">:</span><span class="s2">r</span><span class="s1">-</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">abs</span><span class="s1">(</span><span class="s2">s</span><span class="s1">));</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">s of</span><span class="s1">[</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s0">&quot;row-header&quot;</span><span class="s1">]){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getCellGroupsAtRegion</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">let </span><span class="s2">t</span><span class="s1">={</span><span class="s2">region</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">xMin</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">xMax</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">yMin</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">yMax</span><span class="s1">:</span><span class="s3">0</span><span class="s1">};</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">undefined</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">s</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s2">t</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">backgroundColor</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;row-header&quot;</span><span class="s1">:</span><span class="s2">t</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerBackgroundColor</span><span class="s1">;</span><span class="s4">break</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintMergedCells</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)}}}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">!==</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">a</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">abs</span><span class="s1">(</span><span class="s2">i</span><span class="s1">)&gt;=</span><span class="s2">a</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">n</span><span class="s1">:</span><span class="s2">n</span><span class="s1">+</span><span class="s2">i</span><span class="s1">;</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">a</span><span class="s1">-</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">abs</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_blitContent</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvas</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">l</span><span class="s1">,</span><span class="s2">e</span><span class="s1">-</span><span class="s2">i</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">n</span><span class="s1">:</span><span class="s2">o</span><span class="s1">-</span><span class="s2">i</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">abs</span><span class="s1">(</span><span class="s2">i</span><span class="s1">),</span><span class="s2">r</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">i of</span><span class="s1">[</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s0">&quot;column-header&quot;</span><span class="s1">]){</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getCellGroupsAtRegion</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s4">let </span><span class="s2">t</span><span class="s1">={</span><span class="s2">region</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">xMin</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">xMax</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">yMin</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">yMax</span><span class="s1">:</span><span class="s3">0</span><span class="s1">};</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">undefined</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s2">t</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">backgroundColor</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;column-header&quot;</span><span class="s1">:</span><span class="s2">t</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerBackgroundColor</span><span class="s1">;</span><span class="s4">break</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintMergedCells</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}}}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintOverlay</span><span class="s1">()}</span><span class="s2">_blitContent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">n</span><span class="s1">){</span><span class="s2">t</span><span class="s1">*=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">;</span><span class="s2">i</span><span class="s1">*=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">;</span><span class="s2">s</span><span class="s1">*=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">;</span><span class="s2">o</span><span class="s1">*=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">;</span><span class="s2">r</span><span class="s1">*=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">;</span><span class="s2">n</span><span class="s1">*=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">save</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">setTransform</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">1</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">drawImage</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">()}</span><span class="s2">paintContent</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">setTransform</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bufferGC</span><span class="s1">.</span><span class="s2">setTransform</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">clearRect</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawVoidRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawBodyRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawRowHeaderRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawColumnHeaderRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">drawCornerHeaderRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">_fitBodyColumnHeaders</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">i</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">?</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">):</span><span class="s2">i</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">o</span><span class="s1">&lt;</span><span class="s2">s</span><span class="s1">;</span><span class="s2">o</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s2">i</span><span class="s1">;</span><span class="s2">t</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">_getConfig</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s0">&quot;column-header&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getCellTextWidth</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">resizeColumn</span><span class="s1">(</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">s</span><span class="s1">+</span><span class="s2">t</span><span class="s1">)}}</span><span class="s2">_fitRowColumnHeaders</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">i</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">?</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">):</span><span class="s2">i</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">o</span><span class="s1">&lt;</span><span class="s2">s</span><span class="s1">;</span><span class="s2">o</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s0">&quot;column-header&quot;</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s2">i</span><span class="s1">;</span><span class="s2">t</span><span class="s1">++){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">_getConfig</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">);</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getCellTextWidth</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">resizeColumn</span><span class="s1">(</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">s</span><span class="s1">+</span><span class="s2">t</span><span class="s1">)}}</span><span class="s2">_paintOverlay</span><span class="s1">(){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlayGC</span><span class="s1">.</span><span class="s2">setTransform</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dpiRatio</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlayGC</span><span class="s1">.</span><span class="s2">clearRect</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlay</span><span class="s1">.</span><span class="s2">height</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawBodySelections</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawRowHeaderSelections</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawColumnHeaderSelections</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawCursor</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawShadows</span><span class="s1">()}</span><span class="s2">_drawVoidRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">voidColor</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">_drawBodyRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">||</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">+</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">+</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s2">l</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">+</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;=</span><span class="s2">l</span><span class="s1">+</span><span class="s2">r</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">l</span><span class="s1">);</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">+</span><span class="s2">i</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">n</span><span class="s1">+</span><span class="s2">o</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">+</span><span class="s2">s</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">l</span><span class="s1">+</span><span class="s2">r</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">g</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">f</span><span class="s1">-</span><span class="s2">l</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">);</span><span class="s4">let </span><span class="s2">p</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">u</span><span class="s1">-</span><span class="s2">n</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">);</span><span class="s4">let </span><span class="s2">w</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">m</span><span class="s1">-</span><span class="s2">l</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">);</span><span class="s4">let </span><span class="s2">y</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">_</span><span class="s1">-</span><span class="s2">n</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">);</span><span class="s4">let </span><span class="s2">x</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">v</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">w</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">w</span><span class="s1">=</span><span class="s2">x</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">y</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">y</span><span class="s1">=</span><span class="s2">v</span><span class="s1">}</span><span class="s4">let </span><span class="s2">C</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">p</span><span class="s1">)+</span><span class="s2">n</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">M</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">g</span><span class="s1">)+</span><span class="s2">l</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">b</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">H</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">R</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">w</span><span class="s1">-</span><span class="s2">g</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">z</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">y</span><span class="s1">-</span><span class="s2">p</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">S</span><span class="s1">=</span><span class="s2">g</span><span class="s1">;</span><span class="s2">S</span><span class="s1">&lt;=</span><span class="s2">w</span><span class="s1">;++</span><span class="s2">S</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">S</span><span class="s1">);</span><span class="s2">R</span><span class="s1">[</span><span class="s2">S</span><span class="s1">-</span><span class="s2">g</span><span class="s1">]=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">H</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">S</span><span class="s1">=</span><span class="s2">p</span><span class="s1">;</span><span class="s2">S</span><span class="s1">&lt;=</span><span class="s2">y</span><span class="s1">;++</span><span class="s2">S</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">S</span><span class="s1">);</span><span class="s2">z</span><span class="s1">[</span><span class="s2">S</span><span class="s1">-</span><span class="s2">p</span><span class="s1">]=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">b</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">&amp;&amp;</span><span class="s2">c</span><span class="s1">&gt;</span><span class="s2">a</span><span class="s1">&amp;&amp;</span><span class="s2">w</span><span class="s1">===</span><span class="s2">x</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s2">R</span><span class="s1">[</span><span class="s2">R</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">]+=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">H</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">m</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">&amp;&amp;</span><span class="s2">d</span><span class="s1">&gt;</span><span class="s2">h</span><span class="s1">&amp;&amp;</span><span class="s2">y</span><span class="s1">===</span><span class="s2">v</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s2">z</span><span class="s1">[</span><span class="s2">z</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">]+=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">b</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">_</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">let </span><span class="s2">O</span><span class="s1">={</span><span class="s2">region</span><span class="s1">:</span><span class="s0">&quot;body&quot;</span><span class="s1">,</span><span class="s2">xMin</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">yMin</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">xMax</span><span class="s1">:</span><span class="s2">_</span><span class="s1">,</span><span class="s2">yMax</span><span class="s1">:</span><span class="s2">m</span><span class="s1">,</span><span class="s2">x</span><span class="s1">:</span><span class="s2">C</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s2">M</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s2">b</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s2">H</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">g</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">p</span><span class="s1">,</span><span class="s2">rowSizes</span><span class="s1">:</span><span class="s2">R</span><span class="s1">,</span><span class="s2">columnSizes</span><span class="s1">:</span><span class="s2">z</span><span class="s1">};</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawBackground</span><span class="s1">(</span><span class="s2">O</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">backgroundColor</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawRowBackground</span><span class="s1">(</span><span class="s2">O</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">rowBackgroundColor</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawColumnBackground</span><span class="s1">(</span><span class="s2">O</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">columnBackgroundColor</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawCells</span><span class="s1">(</span><span class="s2">O</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawHorizontalGridLines</span><span class="s1">(</span><span class="s2">O</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">horizontalGridLineColor</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">gridLineColor</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawVerticalGridLines</span><span class="s1">(</span><span class="s2">O</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">verticalGridLineColor</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">gridLineColor</span><span class="s1">);</span><span class="s4">const </span><span class="s2">k</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getCellGroupsAtRegion</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">O</span><span class="s1">.</span><span class="s2">region</span><span class="s1">).</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cellGroupInteresectsRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">O</span><span class="s1">)));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintMergedCells</span><span class="s1">(</span><span class="s2">k</span><span class="s1">,</span><span class="s2">O</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">backgroundColor</span><span class="s1">)}</span><span class="s2">_drawRowHeaderRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">||</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">+</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">+</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s2">l</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">+</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;=</span><span class="s2">l</span><span class="s1">+</span><span class="s2">r</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">l</span><span class="s1">);</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">+</span><span class="s2">i</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">n</span><span class="s1">+</span><span class="s2">o</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">+</span><span class="s2">s</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">l</span><span class="s1">+</span><span class="s2">r</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">d</span><span class="s1">-</span><span class="s2">l</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">);</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">c</span><span class="s1">);</span><span class="s4">let </span><span class="s2">g</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">f</span><span class="s1">-</span><span class="s2">l</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">);</span><span class="s4">let </span><span class="s2">p</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">u</span><span class="s1">);</span><span class="s4">let </span><span class="s2">w</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">y</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">g</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">g</span><span class="s1">=</span><span class="s2">w</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">p</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">p</span><span class="s1">=</span><span class="s2">y</span><span class="s1">}</span><span class="s4">let </span><span class="s2">x</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">m</span><span class="s1">);</span><span class="s4">let </span><span class="s2">v</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">_</span><span class="s1">)+</span><span class="s2">l</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">C</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">M</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">b</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">g</span><span class="s1">-</span><span class="s2">_</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">H</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">p</span><span class="s1">-</span><span class="s2">m</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">S</span><span class="s1">=</span><span class="s2">_</span><span class="s1">;</span><span class="s2">S</span><span class="s1">&lt;=</span><span class="s2">g</span><span class="s1">;++</span><span class="s2">S</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">S</span><span class="s1">);</span><span class="s2">b</span><span class="s1">[</span><span class="s2">S</span><span class="s1">-</span><span class="s2">_</span><span class="s1">]=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">M</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">S</span><span class="s1">=</span><span class="s2">m</span><span class="s1">;</span><span class="s2">S</span><span class="s1">&lt;=</span><span class="s2">p</span><span class="s1">;++</span><span class="s2">S</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">S</span><span class="s1">);</span><span class="s2">H</span><span class="s1">[</span><span class="s2">S</span><span class="s1">-</span><span class="s2">m</span><span class="s1">]=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">C</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">&amp;&amp;</span><span class="s2">h</span><span class="s1">&gt;</span><span class="s2">a</span><span class="s1">&amp;&amp;</span><span class="s2">g</span><span class="s1">===</span><span class="s2">w</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s2">b</span><span class="s1">[</span><span class="s2">b</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">]+=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">M</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">f</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">let </span><span class="s2">R</span><span class="s1">={</span><span class="s2">region</span><span class="s1">:</span><span class="s0">&quot;row-header&quot;</span><span class="s1">,</span><span class="s2">xMin</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">yMin</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">xMax</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">yMax</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">x</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s2">v</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s2">C</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s2">M</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">_</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">m</span><span class="s1">,</span><span class="s2">rowSizes</span><span class="s1">:</span><span class="s2">b</span><span class="s1">,</span><span class="s2">columnSizes</span><span class="s1">:</span><span class="s2">H</span><span class="s1">};</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawBackground</span><span class="s1">(</span><span class="s2">R</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerBackgroundColor</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawCells</span><span class="s1">(</span><span class="s2">R</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawHorizontalGridLines</span><span class="s1">(</span><span class="s2">R</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerHorizontalGridLineColor</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerGridLineColor</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawVerticalGridLines</span><span class="s1">(</span><span class="s2">R</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerVerticalGridLineColor</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerGridLineColor</span><span class="s1">);</span><span class="s4">const </span><span class="s2">z</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getCellGroupsAtRegion</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">R</span><span class="s1">.</span><span class="s2">region</span><span class="s1">).</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cellGroupInteresectsRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">R</span><span class="s1">)));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintMergedCells</span><span class="s1">(</span><span class="s2">z</span><span class="s1">,</span><span class="s2">R</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerBackgroundColor</span><span class="s1">)}</span><span class="s2">_drawColumnHeaderRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">||</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">+</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">+</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s2">l</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">+</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;=</span><span class="s2">l</span><span class="s1">+</span><span class="s2">r</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">+</span><span class="s2">i</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">n</span><span class="s1">+</span><span class="s2">o</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">+</span><span class="s2">s</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">l</span><span class="s1">+</span><span class="s2">r</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">d</span><span class="s1">);</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">c</span><span class="s1">-</span><span class="s2">n</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">);</span><span class="s4">let </span><span class="s2">g</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">f</span><span class="s1">);</span><span class="s4">let </span><span class="s2">p</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">u</span><span class="s1">-</span><span class="s2">n</span><span class="s1">+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">);</span><span class="s4">let </span><span class="s2">w</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">y</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">g</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">g</span><span class="s1">=</span><span class="s2">w</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">p</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">p</span><span class="s1">=</span><span class="s2">y</span><span class="s1">}</span><span class="s4">let </span><span class="s2">x</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">m</span><span class="s1">)+</span><span class="s2">n</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">v</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">_</span><span class="s1">);</span><span class="s4">let </span><span class="s2">C</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">M</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">b</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">g</span><span class="s1">-</span><span class="s2">_</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">H</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">p</span><span class="s1">-</span><span class="s2">m</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">S</span><span class="s1">=</span><span class="s2">_</span><span class="s1">;</span><span class="s2">S</span><span class="s1">&lt;=</span><span class="s2">g</span><span class="s1">;++</span><span class="s2">S</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">S</span><span class="s1">);</span><span class="s2">b</span><span class="s1">[</span><span class="s2">S</span><span class="s1">-</span><span class="s2">_</span><span class="s1">]=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">M</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">S</span><span class="s1">=</span><span class="s2">m</span><span class="s1">;</span><span class="s2">S</span><span class="s1">&lt;=</span><span class="s2">p</span><span class="s1">;++</span><span class="s2">S</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">S</span><span class="s1">);</span><span class="s2">H</span><span class="s1">[</span><span class="s2">S</span><span class="s1">-</span><span class="s2">m</span><span class="s1">]=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">C</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">&amp;&amp;</span><span class="s2">h</span><span class="s1">&gt;</span><span class="s2">a</span><span class="s1">&amp;&amp;</span><span class="s2">p</span><span class="s1">===</span><span class="s2">y</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s2">H</span><span class="s1">[</span><span class="s2">H</span><span class="s1">.</span><span class="s2">length</span><span class="s1">-</span><span class="s3">1</span><span class="s1">]+=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">C</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">u</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">let </span><span class="s2">R</span><span class="s1">={</span><span class="s2">region</span><span class="s1">:</span><span class="s0">&quot;column-header&quot;</span><span class="s1">,</span><span class="s2">xMin</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">yMin</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">xMax</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">yMax</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">x</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s2">v</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s2">C</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s2">M</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">_</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">m</span><span class="s1">,</span><span class="s2">rowSizes</span><span class="s1">:</span><span class="s2">b</span><span class="s1">,</span><span class="s2">columnSizes</span><span class="s1">:</span><span class="s2">H</span><span class="s1">};</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawBackground</span><span class="s1">(</span><span class="s2">R</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerBackgroundColor</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawCells</span><span class="s1">(</span><span class="s2">R</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawHorizontalGridLines</span><span class="s1">(</span><span class="s2">R</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerHorizontalGridLineColor</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerGridLineColor</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawVerticalGridLines</span><span class="s1">(</span><span class="s2">R</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerVerticalGridLineColor</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerGridLineColor</span><span class="s1">);</span><span class="s4">const </span><span class="s2">z</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getCellGroupsAtRegion</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">R</span><span class="s1">.</span><span class="s2">region</span><span class="s1">).</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cellGroupInteresectsRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">R</span><span class="s1">)));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintMergedCells</span><span class="s1">(</span><span class="s2">z</span><span class="s1">,</span><span class="s2">R</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerBackgroundColor</span><span class="s1">)}</span><span class="s2">drawCornerHeaderRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">||</span><span class="s2">r</span><span class="s1">&lt;=</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">+</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s2">n</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">+</span><span class="s2">s</span><span class="s1">&lt;=</span><span class="s2">l</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&gt;=</span><span class="s2">n</span><span class="s1">+</span><span class="s2">o</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;=</span><span class="s2">l</span><span class="s1">+</span><span class="s2">r</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">+</span><span class="s2">i</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">n</span><span class="s1">+</span><span class="s2">o</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">+</span><span class="s2">s</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">l</span><span class="s1">+</span><span class="s2">r</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">h</span><span class="s1">);</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">a</span><span class="s1">);</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">d</span><span class="s1">);</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">c</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">_</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">_</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">m</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s2">m</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">let </span><span class="s2">g</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">f</span><span class="s1">);</span><span class="s4">let </span><span class="s2">p</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">u</span><span class="s1">);</span><span class="s4">let </span><span class="s2">w</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">y</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">x</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">_</span><span class="s1">-</span><span class="s2">u</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">v</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">m</span><span class="s1">-</span><span class="s2">f</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">S</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s2">S</span><span class="s1">&lt;=</span><span class="s2">_</span><span class="s1">;++</span><span class="s2">S</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">S</span><span class="s1">);</span><span class="s2">x</span><span class="s1">[</span><span class="s2">S</span><span class="s1">-</span><span class="s2">u</span><span class="s1">]=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">y</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">S</span><span class="s1">=</span><span class="s2">f</span><span class="s1">;</span><span class="s2">S</span><span class="s1">&lt;=</span><span class="s2">m</span><span class="s1">;++</span><span class="s2">S</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">S</span><span class="s1">);</span><span class="s2">v</span><span class="s1">[</span><span class="s2">S</span><span class="s1">-</span><span class="s2">f</span><span class="s1">]=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">w</span><span class="s1">+=</span><span class="s2">e</span><span class="s1">}</span><span class="s4">let </span><span class="s2">C</span><span class="s1">={</span><span class="s2">region</span><span class="s1">:</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">,</span><span class="s2">xMin</span><span class="s1">:</span><span class="s2">a</span><span class="s1">,</span><span class="s2">yMin</span><span class="s1">:</span><span class="s2">h</span><span class="s1">,</span><span class="s2">xMax</span><span class="s1">:</span><span class="s2">c</span><span class="s1">,</span><span class="s2">yMax</span><span class="s1">:</span><span class="s2">d</span><span class="s1">,</span><span class="s2">x</span><span class="s1">:</span><span class="s2">g</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s2">p</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s2">w</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s2">y</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s2">u</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s2">f</span><span class="s1">,</span><span class="s2">rowSizes</span><span class="s1">:</span><span class="s2">x</span><span class="s1">,</span><span class="s2">columnSizes</span><span class="s1">:</span><span class="s2">v</span><span class="s1">};</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawBackground</span><span class="s1">(</span><span class="s2">C</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerBackgroundColor</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawCells</span><span class="s1">(</span><span class="s2">C</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawHorizontalGridLines</span><span class="s1">(</span><span class="s2">C</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerHorizontalGridLineColor</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerGridLineColor</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_drawVerticalGridLines</span><span class="s1">(</span><span class="s2">C</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerVerticalGridLineColor</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerGridLineColor</span><span class="s1">);</span><span class="s4">const </span><span class="s2">M</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getCellGroupsAtRegion</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">C</span><span class="s1">.</span><span class="s2">region</span><span class="s1">).</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">e</span><span class="s1">=&gt;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">cellGroupInteresectsRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">C</span><span class="s1">)));</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_paintMergedCells</span><span class="s1">(</span><span class="s2">M</span><span class="s1">,</span><span class="s2">C</span><span class="s1">,</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerBackgroundColor</span><span class="s1">)}</span><span class="s2">_drawBackground</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let</span><span class="s1">{</span><span class="s2">xMin</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">yMin</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">xMax</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">yMax</span><span class="s1">:</span><span class="s2">r</span><span class="s1">}=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">-</span><span class="s2">i</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">r</span><span class="s1">-</span><span class="s2">s</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)}</span><span class="s2">_drawRowBackground</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">x</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">x</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">width</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowSizes</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">n</span><span class="s1">;++</span><span class="s2">r</span><span class="s1">){</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowSizes</span><span class="s1">[</span><span class="s2">r</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">row</span><span class="s1">+</span><span class="s2">r</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">o</span><span class="s1">+</span><span class="s2">n</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">-</span><span class="s2">i</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">r</span><span class="s1">-</span><span class="s2">t</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)}</span><span class="s2">o</span><span class="s1">+=</span><span class="s2">n</span><span class="s1">}}</span><span class="s2">_drawColumnBackground</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">y</span><span class="s1">);</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">height</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">,</span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnSizes</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s2">n</span><span class="s1">;++</span><span class="s2">r</span><span class="s1">){</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnSizes</span><span class="s1">[</span><span class="s2">r</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">n</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">t</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">+</span><span class="s2">r</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">o</span><span class="s1">+</span><span class="s2">n</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">r</span><span class="s1">-</span><span class="s2">t</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">s</span><span class="s1">-</span><span class="s2">i</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)}</span><span class="s2">o</span><span class="s1">+=</span><span class="s2">n</span><span class="s1">}}</span><span class="s2">_getColumnSize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_rowHeaderSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">columnSize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">_getRowSize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_columnHeaderSections</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">rowSize</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">_drawCells</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">={</span><span class="s2">x</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">region</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">value</span><span class="s1">:</span><span class="s4">null</span><span class="s1">,</span><span class="s2">metadata</span><span class="s1">:</span><span class="s2">q</span><span class="s1">.</span><span class="s2">emptyMetadata</span><span class="s1">};</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bufferGC</span><span class="s1">.</span><span class="s2">save</span><span class="s1">();</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">new </span><span class="s2">$</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bufferGC</span><span class="s1">);</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">l</span><span class="s1">=</span><span class="s3">0</span><span class="s1">,</span><span class="s2">a</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnSizes</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">l</span><span class="s1">&lt;</span><span class="s2">a</span><span class="s1">;++</span><span class="s2">l</span><span class="s1">){</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnSizes</span><span class="s1">[</span><span class="s2">l</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">+</span><span class="s2">l</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">column</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">c</span><span class="s1">=</span><span class="s3">0</span><span class="s1">,</span><span class="s2">d</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowSizes</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s2">c</span><span class="s1">&lt;</span><span class="s2">d</span><span class="s1">;++</span><span class="s2">c</span><span class="s1">){</span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowSizes</span><span class="s1">[</span><span class="s2">c</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">row</span><span class="s1">+</span><span class="s2">c</span><span class="s1">;</span><span class="s2">i</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getGroupIndex</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">h</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">!==-</span><span class="s3">1</span><span class="s1">){</span><span class="s2">l</span><span class="s1">+=</span><span class="s2">o</span><span class="s1">;</span><span class="s4">continue</span><span class="s1">}</span><span class="s2">s</span><span class="s1">.</span><span class="s2">clearRect</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s2">l</span><span class="s1">,</span><span class="s2">a</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">_getCellValue</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">h</span><span class="s1">);</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">_getCellMetadata</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">h</span><span class="s1">);</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">row</span><span class="s1">=</span><span class="s2">d</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s2">u</span><span class="s1">;</span><span class="s2">t</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">=</span><span class="s2">f</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cellRenderers</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">t</span><span class="s1">);</span><span class="s2">s</span><span class="s1">.</span><span class="s2">save</span><span class="s1">();</span><span class="s4">try</span><span class="s1">{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">_ </span><span class="s4">instanceof </span><span class="s2">k</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">_</span><span class="s1">.</span><span class="s2">isReady</span><span class="s1">(</span><span class="s2">t</span><span class="s1">)){</span><span class="s2">_</span><span class="s1">.</span><span class="s2">paint</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">_</span><span class="s1">.</span><span class="s2">paintPlaceholder</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s2">_</span><span class="s1">.</span><span class="s2">load</span><span class="s1">(</span><span class="s2">t</span><span class="s1">).</span><span class="s2">then</span><span class="s1">((()=&gt;{</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">d</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">d</span><span class="s1">+</span><span class="s3">1</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">h</span><span class="s1">+</span><span class="s3">1</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">o</span><span class="s1">)}))}}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">_</span><span class="s1">.</span><span class="s2">paint</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}}</span><span class="s4">catch</span><span class="s1">(</span><span class="s2">r</span><span class="s1">){</span><span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s2">r</span><span class="s1">)}</span><span class="s2">s</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">();</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">);</span><span class="s4">let </span><span class="s2">g</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">);</span><span class="s4">let </span><span class="s2">p</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">);</span><span class="s4">let </span><span class="s2">w</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_blitContent</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_buffer</span><span class="s1">,</span><span class="s2">m</span><span class="s1">,</span><span class="s2">p</span><span class="s1">,</span><span class="s2">g</span><span class="s1">-</span><span class="s2">m</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">w</span><span class="s1">-</span><span class="s2">p</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">m</span><span class="s1">,</span><span class="s2">p</span><span class="s1">);</span><span class="s2">l</span><span class="s1">+=</span><span class="s2">o</span><span class="s1">}</span><span class="s2">s</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">();</span><span class="s2">n</span><span class="s1">+=</span><span class="s2">a</span><span class="s1">}</span><span class="s2">s</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bufferGC</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">()}</span><span class="s2">cellGroupInteresectsRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">row</span><span class="s1">;</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">row</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">rowSizes</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">column</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">column</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">columnSizes</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s4">const </span><span class="s2">n</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)-</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)-</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">,</span><span class="s2">o</span><span class="s1">);</span><span class="s4">return </span><span class="s2">n</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">&amp;&amp;</span><span class="s2">l</span><span class="s1">&gt;=</span><span class="s3">0</span><span class="s1">}</span><span class="s4">static </span><span class="s2">_getCellValue</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">try</span><span class="s1">{</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">data</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">catch</span><span class="s1">(</span><span class="s2">o</span><span class="s1">){</span><span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s2">o</span><span class="s1">);</span><span class="s4">return null</span><span class="s1">}}</span><span class="s4">static </span><span class="s2">_getCellMetadata</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">){</span><span class="s4">try</span><span class="s1">{</span><span class="s4">return </span><span class="s2">e</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">catch</span><span class="s1">(</span><span class="s2">o</span><span class="s1">){</span><span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s2">o</span><span class="s1">);</span><span class="s4">return </span><span class="s2">q</span><span class="s1">.</span><span class="s2">emptyMetadata</span><span class="s1">}}</span><span class="s2">_paintMergedCells</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_dataModel</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">={</span><span class="s2">x</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">y</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">width</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">height</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">region</span><span class="s1">:</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">row</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">column</span><span class="s1">:</span><span class="s3">0</span><span class="s1">,</span><span class="s2">value</span><span class="s1">:</span><span class="s4">null</span><span class="s1">,</span><span class="s2">metadata</span><span class="s1">:</span><span class="s2">q</span><span class="s1">.</span><span class="s2">emptyMetadata</span><span class="s1">};</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">i</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">=</span><span class="s3">1</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bufferGC</span><span class="s1">.</span><span class="s2">save</span><span class="s1">();</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">new </span><span class="s2">$</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bufferGC</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">const </span><span class="s2">n of e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">;</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">;</span><span class="s2">i</span><span class="s1">++){</span><span class="s2">e</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getColumnSize</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)}</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">;</span><span class="s2">i</span><span class="s1">&lt;=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">;</span><span class="s2">i</span><span class="s1">++){</span><span class="s2">l</span><span class="s1">+=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_getRowSize</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">i</span><span class="s1">)}</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">_getCellValue</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">);</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">ee</span><span class="s1">.</span><span class="s2">_getCellMetadata</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">,</span><span class="s2">n</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">);</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">)+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">)+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;column-header&quot;</span><span class="s1">:</span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">)+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s2">d</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">);</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;row-header&quot;</span><span class="s1">:</span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">);</span><span class="s2">d</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">)+</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">-</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">:</span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">);</span><span class="s2">d</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">);</span><span class="s4">break</span><span class="s1">}</span><span class="s2">s</span><span class="s1">.</span><span class="s2">x</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">y</span><span class="s1">=</span><span class="s2">d</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">region</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">row</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">column</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">value</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">metadata</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s4">const </span><span class="s2">u</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">,</span><span class="s2">c</span><span class="s1">);</span><span class="s4">const </span><span class="s2">f</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">c</span><span class="s1">+</span><span class="s2">e</span><span class="s1">-</span><span class="s3">2</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">);</span><span class="s4">const </span><span class="s2">_</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">,</span><span class="s2">d</span><span class="s1">);</span><span class="s4">const </span><span class="s2">m</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">d</span><span class="s1">+</span><span class="s2">l</span><span class="s1">-</span><span class="s3">2</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">f</span><span class="s1">&lt;=</span><span class="s2">u</span><span class="s1">||</span><span class="s2">m</span><span class="s1">&lt;=</span><span class="s2">_</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">u</span><span class="s1">,</span><span class="s2">_</span><span class="s1">,</span><span class="s2">f</span><span class="s1">-</span><span class="s2">u</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">m</span><span class="s1">-</span><span class="s2">_</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)}</span><span class="s4">let </span><span class="s2">g</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_cellRenderers</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s2">o</span><span class="s1">.</span><span class="s2">clearRect</span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">s</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">l</span><span class="s1">);</span><span class="s2">o</span><span class="s1">.</span><span class="s2">save</span><span class="s1">();</span><span class="s4">try</span><span class="s1">{</span><span class="s4">if</span><span class="s1">(</span><span class="s2">g </span><span class="s4">instanceof </span><span class="s2">k</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">g</span><span class="s1">.</span><span class="s2">isReady</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)){</span><span class="s2">g</span><span class="s1">.</span><span class="s2">paint</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">g</span><span class="s1">.</span><span class="s2">paintPlaceholder</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s4">const </span><span class="s2">e</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">;</span><span class="s4">const </span><span class="s2">l</span><span class="s1">=</span><span class="s2">n</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">;</span><span class="s2">g</span><span class="s1">.</span><span class="s2">load</span><span class="s1">(</span><span class="s2">s</span><span class="s1">).</span><span class="s2">then</span><span class="s1">((()=&gt;{</span><span class="s4">this</span><span class="s1">.</span><span class="s2">repaintRegion</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">region</span><span class="s1">,</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">l</span><span class="s1">)}))}}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">g</span><span class="s1">.</span><span class="s2">paint</span><span class="s1">(</span><span class="s2">o</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}}</span><span class="s4">catch</span><span class="s1">(</span><span class="s2">r</span><span class="s1">){</span><span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s2">r</span><span class="s1">)}</span><span class="s2">o</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_blitContent</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_buffer</span><span class="s1">,</span><span class="s2">u</span><span class="s1">,</span><span class="s2">_</span><span class="s1">,</span><span class="s2">f</span><span class="s1">-</span><span class="s2">u</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">m</span><span class="s1">-</span><span class="s2">_</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">u</span><span class="s1">,</span><span class="s2">_</span><span class="s1">)}</span><span class="s2">o</span><span class="s1">.</span><span class="s2">dispose</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bufferGC</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">()}</span><span class="s2">_drawHorizontalGridLines</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">x</span><span class="s1">);</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">x</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">=</span><span class="s3">1</span><span class="s1">;</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowSizes</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s2">o</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">row</span><span class="s1">+</span><span class="s2">n</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">){</span><span class="s2">n</span><span class="s1">-=</span><span class="s3">1</span><span class="s1">}}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">a</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">a</span><span class="s1">&lt;</span><span class="s2">n</span><span class="s1">;++</span><span class="s2">a</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">rowSizes</span><span class="s1">[</span><span class="s2">a</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">l</span><span class="s1">+</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">moveTo</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">o</span><span class="s1">+</span><span class="s3">.5</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">lineTo</span><span class="s1">(</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">+</span><span class="s3">.5</span><span class="s1">)}</span><span class="s2">l</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">stroke</span><span class="s1">()}</span><span class="s2">_drawVerticalGridLines</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">yMin</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">y</span><span class="s1">);</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">height</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">yMax</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">=</span><span class="s3">1</span><span class="s1">;</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnSizes</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s2">o</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">column</span><span class="s1">+</span><span class="s2">n</span><span class="s1">===</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">){</span><span class="s2">n</span><span class="s1">-=</span><span class="s3">1</span><span class="s1">}}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">a</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">a</span><span class="s1">&lt;</span><span class="s2">n</span><span class="s1">;++</span><span class="s2">a</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">columnSizes</span><span class="s1">[</span><span class="s2">a</span><span class="s1">];</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">l</span><span class="s1">+</span><span class="s2">t</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&gt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">xMin</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">&lt;=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">xMax</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">moveTo</span><span class="s1">(</span><span class="s2">o</span><span class="s1">+</span><span class="s3">.5</span><span class="s1">,</span><span class="s2">i</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">lineTo</span><span class="s1">(</span><span class="s2">o</span><span class="s1">+</span><span class="s3">.5</span><span class="s1">,</span><span class="s2">s</span><span class="s1">)}</span><span class="s2">l</span><span class="s1">+=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_canvasGC</span><span class="s1">.</span><span class="s2">stroke</span><span class="s1">()}</span><span class="s2">_drawBodySelections</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">isEmpty</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">selectionFillColor</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">selectionBorderColor</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">&amp;&amp;!</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">o</span><span class="s1">);</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">r</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">n</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">o</span><span class="s1">+</span><span class="s2">c</span><span class="s1">);</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">s</span><span class="s1">+</span><span class="s2">h</span><span class="s1">);</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">g</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s2">f</span><span class="s1">=</span><span class="s2">f</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">m</span><span class="s1">:</span><span class="s2">f</span><span class="s1">;</span><span class="s2">_</span><span class="s1">=</span><span class="s2">_</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">g</span><span class="s1">:</span><span class="s2">_</span><span class="s1">;</span><span class="s4">let </span><span class="s2">p</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlayGC</span><span class="s1">;</span><span class="s2">p</span><span class="s1">.</span><span class="s2">save</span><span class="s1">();</span><span class="s2">p</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">();</span><span class="s2">p</span><span class="s1">.</span><span class="s2">rect</span><span class="s1">(</span><span class="s2">d</span><span class="s1">,</span><span class="s2">u</span><span class="s1">,</span><span class="s2">h</span><span class="s1">,</span><span class="s2">c</span><span class="s1">);</span><span class="s2">p</span><span class="s1">.</span><span class="s2">clip</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">p</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s2">p</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">p</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">=</span><span class="s3">1</span><span class="s1">}</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">w of e</span><span class="s1">.</span><span class="s2">selections</span><span class="s1">()){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">w</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&lt;</span><span class="s2">r</span><span class="s1">&amp;&amp;</span><span class="s2">w</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&lt;</span><span class="s2">r</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">w</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">&gt;</span><span class="s2">f</span><span class="s1">&amp;&amp;</span><span class="s2">w</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">&gt;</span><span class="s2">f</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">w</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&lt;</span><span class="s2">n</span><span class="s1">&amp;&amp;</span><span class="s2">w</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">&lt;</span><span class="s2">n</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">w</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">&gt;</span><span class="s2">_</span><span class="s1">&amp;&amp;</span><span class="s2">w</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">&gt;</span><span class="s2">_</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">w</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">,</span><span class="s2">m</span><span class="s1">));</span><span class="s4">let </span><span class="s2">y</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">w</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">,</span><span class="s2">g</span><span class="s1">));</span><span class="s4">let </span><span class="s2">x</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">w</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">,</span><span class="s2">m</span><span class="s1">));</span><span class="s4">let </span><span class="s2">v</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">w</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">,</span><span class="s2">g</span><span class="s1">));</span><span class="s4">let </span><span class="s2">C</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">&gt;</span><span class="s2">x</span><span class="s1">){</span><span class="s2">C</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s2">e</span><span class="s1">=</span><span class="s2">x</span><span class="s1">;</span><span class="s2">x</span><span class="s1">=</span><span class="s2">C</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">y</span><span class="s1">&gt;</span><span class="s2">v</span><span class="s1">){</span><span class="s2">C</span><span class="s1">=</span><span class="s2">y</span><span class="s1">;</span><span class="s2">y</span><span class="s1">=</span><span class="s2">v</span><span class="s1">;</span><span class="s2">v</span><span class="s1">=</span><span class="s2">C</span><span class="s1">}</span><span class="s4">const </span><span class="s2">M</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">joinCellGroupWithMergedCellGroups</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,{</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">e</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">x</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">y</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">v</span><span class="s1">},</span><span class="s0">&quot;body&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">=</span><span class="s2">M</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">;</span><span class="s2">x</span><span class="s1">=</span><span class="s2">M</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">;</span><span class="s2">y</span><span class="s1">=</span><span class="s2">M</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">;</span><span class="s2">v</span><span class="s1">=</span><span class="s2">M</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">;</span><span class="s4">let </span><span class="s2">b</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">y</span><span class="s1">)-</span><span class="s2">s</span><span class="s1">+</span><span class="s2">d</span><span class="s1">;</span><span class="s4">let </span><span class="s2">H</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)-</span><span class="s2">o</span><span class="s1">+</span><span class="s2">u</span><span class="s1">;</span><span class="s4">let </span><span class="s2">R</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">v</span><span class="s1">)-</span><span class="s2">s</span><span class="s1">+</span><span class="s2">d</span><span class="s1">;</span><span class="s4">let </span><span class="s2">z</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">x</span><span class="s1">)-</span><span class="s2">o</span><span class="s1">+</span><span class="s2">u</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">&amp;&amp;</span><span class="s2">h</span><span class="s1">&gt;</span><span class="s2">l</span><span class="s1">&amp;&amp;</span><span class="s2">v</span><span class="s1">===</span><span class="s2">g</span><span class="s1">){</span><span class="s2">R</span><span class="s1">=</span><span class="s2">d</span><span class="s1">+</span><span class="s2">h</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">&amp;&amp;</span><span class="s2">c</span><span class="s1">&gt;</span><span class="s2">a</span><span class="s1">&amp;&amp;</span><span class="s2">x</span><span class="s1">===</span><span class="s2">m</span><span class="s1">){</span><span class="s2">z</span><span class="s1">=</span><span class="s2">u</span><span class="s1">+</span><span class="s2">c</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s2">b</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">d</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">b</span><span class="s1">);</span><span class="s2">H</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">u</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">H</span><span class="s1">);</span><span class="s2">R</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">d</span><span class="s1">+</span><span class="s2">h</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">R</span><span class="s1">);</span><span class="s2">z</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">u</span><span class="s1">+</span><span class="s2">c</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">z</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">R</span><span class="s1">&lt;</span><span class="s2">b</span><span class="s1">||</span><span class="s2">z</span><span class="s1">&lt;</span><span class="s2">H</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">p</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">b</span><span class="s1">,</span><span class="s2">H</span><span class="s1">,</span><span class="s2">R</span><span class="s1">-</span><span class="s2">b</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">z</span><span class="s1">-</span><span class="s2">H</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s2">p</span><span class="s1">.</span><span class="s2">strokeRect</span><span class="s1">(</span><span class="s2">b</span><span class="s1">-</span><span class="s3">.5</span><span class="s1">,</span><span class="s2">H</span><span class="s1">-</span><span class="s3">.5</span><span class="s1">,</span><span class="s2">R</span><span class="s1">-</span><span class="s2">b</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">z</span><span class="s1">-</span><span class="s2">H</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)}}</span><span class="s2">p</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">()}</span><span class="s2">_drawRowHeaderSelections</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">isEmpty</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">==</span><span class="s0">&quot;column&quot;</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerSelectionFillColor</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerSelectionBorderColor</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">&amp;&amp;!</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlayGC</span><span class="s1">;</span><span class="s2">h</span><span class="s1">.</span><span class="s2">save</span><span class="s1">();</span><span class="s2">h</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">();</span><span class="s2">h</span><span class="s1">.</span><span class="s2">rect</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">l</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s2">h</span><span class="s1">.</span><span class="s2">clip</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">h</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s2">h</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">h</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">=</span><span class="s3">1</span><span class="s1">}</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">s</span><span class="s1">+</span><span class="s2">r</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s2">u</span><span class="s1">=</span><span class="s2">u</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">c</span><span class="s1">:</span><span class="s2">u</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s2">d</span><span class="s1">;</span><span class="s2">f</span><span class="s1">&lt;=</span><span class="s2">u</span><span class="s1">;++</span><span class="s2">f</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">isRowSelected</span><span class="s1">(</span><span class="s2">f</span><span class="s1">)){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">f</span><span class="s1">)-</span><span class="s2">s</span><span class="s1">+</span><span class="s2">l</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">f</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s2">o</span><span class="s1">&amp;&amp;</span><span class="s2">f</span><span class="s1">===</span><span class="s2">c</span><span class="s1">){</span><span class="s2">u</span><span class="s1">=</span><span class="s2">l</span><span class="s1">+</span><span class="s2">r</span><span class="s1">-</span><span class="s2">d</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">u</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">h</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">n</span><span class="s1">,</span><span class="s2">u</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s2">h</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">();</span><span class="s2">h</span><span class="s1">.</span><span class="s2">moveTo</span><span class="s1">(</span><span class="s2">n</span><span class="s1">-</span><span class="s3">.5</span><span class="s1">,</span><span class="s2">d</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s2">h</span><span class="s1">.</span><span class="s2">lineTo</span><span class="s1">(</span><span class="s2">n</span><span class="s1">-</span><span class="s3">.5</span><span class="s1">,</span><span class="s2">d</span><span class="s1">+</span><span class="s2">u</span><span class="s1">);</span><span class="s2">h</span><span class="s1">.</span><span class="s2">stroke</span><span class="s1">()}}</span><span class="s2">h</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">()}</span><span class="s2">_drawColumnHeaderSelections</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">isEmpty</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">==</span><span class="s0">&quot;row&quot;</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">===</span><span class="s3">0</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerSelectionFillColor</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">headerSelectionBorderColor</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">&amp;&amp;!</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlayGC</span><span class="s1">;</span><span class="s2">h</span><span class="s1">.</span><span class="s2">save</span><span class="s1">();</span><span class="s2">h</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">();</span><span class="s2">h</span><span class="s1">.</span><span class="s2">rect</span><span class="s1">(</span><span class="s2">n</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">l</span><span class="s1">);</span><span class="s2">h</span><span class="s1">.</span><span class="s2">clip</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">h</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">t</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s2">h</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">h</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">=</span><span class="s3">1</span><span class="s1">}</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">s</span><span class="s1">);</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">s</span><span class="s1">+</span><span class="s2">r</span><span class="s1">-</span><span class="s3">1</span><span class="s1">);</span><span class="s2">u</span><span class="s1">=</span><span class="s2">u</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">?</span><span class="s2">c</span><span class="s1">:</span><span class="s2">u</span><span class="s1">;</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s2">d</span><span class="s1">;</span><span class="s2">f</span><span class="s1">&lt;=</span><span class="s2">u</span><span class="s1">;++</span><span class="s2">f</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">isColumnSelected</span><span class="s1">(</span><span class="s2">f</span><span class="s1">)){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">f</span><span class="s1">)-</span><span class="s2">s</span><span class="s1">+</span><span class="s2">n</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">.</span><span class="s2">sizeOf</span><span class="s1">(</span><span class="s2">f</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">&amp;&amp;</span><span class="s2">r</span><span class="s1">&gt;</span><span class="s2">o</span><span class="s1">&amp;&amp;</span><span class="s2">f</span><span class="s1">===</span><span class="s2">c</span><span class="s1">){</span><span class="s2">u</span><span class="s1">=</span><span class="s2">n</span><span class="s1">+</span><span class="s2">r</span><span class="s1">-</span><span class="s2">d</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">u</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">continue</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">h</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">d</span><span class="s1">,</span><span class="s3">0</span><span class="s1">,</span><span class="s2">u</span><span class="s1">,</span><span class="s2">l</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s2">h</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">();</span><span class="s2">h</span><span class="s1">.</span><span class="s2">moveTo</span><span class="s1">(</span><span class="s2">d</span><span class="s1">-</span><span class="s3">1</span><span class="s1">,</span><span class="s2">l</span><span class="s1">-</span><span class="s3">.5</span><span class="s1">);</span><span class="s2">h</span><span class="s1">.</span><span class="s2">lineTo</span><span class="s1">(</span><span class="s2">d</span><span class="s1">+</span><span class="s2">u</span><span class="s1">,</span><span class="s2">l</span><span class="s1">-</span><span class="s3">.5</span><span class="s1">);</span><span class="s2">h</span><span class="s1">.</span><span class="s2">stroke</span><span class="s1">()}}</span><span class="s2">h</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">()}</span><span class="s2">_drawCursor</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_selectionModel</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">isEmpty</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">selectionMode</span><span class="s1">!==</span><span class="s0">&quot;cell&quot;</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">cursorFillColor</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">cursorBorderColor</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">&amp;&amp;!</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">cursorRow</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">cursorColumn</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">count</span><span class="s1">-</span><span class="s3">1</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">s</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">s</span><span class="s1">&gt;</span><span class="s2">r</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">o</span><span class="s1">&lt;</span><span class="s3">0</span><span class="s1">||</span><span class="s2">o</span><span class="s1">&gt;</span><span class="s2">n</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s4">const </span><span class="s2">h</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">joinCellGroupWithMergedCellGroups</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">dataModel</span><span class="s1">,{</span><span class="s2">r1</span><span class="s1">:</span><span class="s2">s</span><span class="s1">,</span><span class="s2">r2</span><span class="s1">:</span><span class="s2">l</span><span class="s1">,</span><span class="s2">c1</span><span class="s1">:</span><span class="s2">o</span><span class="s1">,</span><span class="s2">c2</span><span class="s1">:</span><span class="s2">a</span><span class="s1">},</span><span class="s0">&quot;body&quot;</span><span class="s1">);</span><span class="s2">s</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r1</span><span class="s1">;</span><span class="s2">l</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">r2</span><span class="s1">;</span><span class="s2">o</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c1</span><span class="s1">;</span><span class="s2">a</span><span class="s1">=</span><span class="s2">h</span><span class="s1">.</span><span class="s2">c2</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">g</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">p</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">w</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">y</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">x</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">o</span><span class="s1">)-</span><span class="s2">c</span><span class="s1">+</span><span class="s2">g</span><span class="s1">;</span><span class="s4">let </span><span class="s2">v</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_columnSections</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">a</span><span class="s1">)-</span><span class="s2">c</span><span class="s1">+</span><span class="s2">g</span><span class="s1">;</span><span class="s4">let </span><span class="s2">C</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">offsetOf</span><span class="s1">(</span><span class="s2">s</span><span class="s1">)-</span><span class="s2">d</span><span class="s1">+</span><span class="s2">p</span><span class="s1">;</span><span class="s4">let </span><span class="s2">M</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_rowSections</span><span class="s1">.</span><span class="s2">extentOf</span><span class="s1">(</span><span class="s2">l</span><span class="s1">)-</span><span class="s2">d</span><span class="s1">+</span><span class="s2">p</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">&amp;&amp;</span><span class="s2">_</span><span class="s1">&gt;</span><span class="s2">u</span><span class="s1">&amp;&amp;</span><span class="s2">o</span><span class="s1">===</span><span class="s2">n</span><span class="s1">){</span><span class="s2">v</span><span class="s1">=</span><span class="s2">w</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">&amp;&amp;</span><span class="s2">m</span><span class="s1">&gt;</span><span class="s2">f</span><span class="s1">&amp;&amp;</span><span class="s2">s</span><span class="s1">===</span><span class="s2">r</span><span class="s1">){</span><span class="s2">M</span><span class="s1">=</span><span class="s2">y</span><span class="s1">-</span><span class="s3">1</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">v</span><span class="s1">&lt;</span><span class="s2">x</span><span class="s1">||</span><span class="s2">M</span><span class="s1">&lt;</span><span class="s2">C</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">x</span><span class="s1">-</span><span class="s3">1</span><span class="s1">&gt;=</span><span class="s2">w</span><span class="s1">||</span><span class="s2">C</span><span class="s1">-</span><span class="s3">1</span><span class="s1">&gt;=</span><span class="s2">y</span><span class="s1">||</span><span class="s2">v</span><span class="s1">+</span><span class="s3">1</span><span class="s1">&lt;</span><span class="s2">g</span><span class="s1">||</span><span class="s2">M</span><span class="s1">+</span><span class="s3">1</span><span class="s1">&lt;</span><span class="s2">p</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">b</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlayGC</span><span class="s1">;</span><span class="s2">b</span><span class="s1">.</span><span class="s2">save</span><span class="s1">();</span><span class="s2">b</span><span class="s1">.</span><span class="s2">beginPath</span><span class="s1">();</span><span class="s2">b</span><span class="s1">.</span><span class="s2">rect</span><span class="s1">(</span><span class="s2">g</span><span class="s1">,</span><span class="s2">p</span><span class="s1">,</span><span class="s2">_</span><span class="s1">,</span><span class="s2">m</span><span class="s1">);</span><span class="s2">b</span><span class="s1">.</span><span class="s2">clip</span><span class="s1">();</span><span class="s2">b</span><span class="s1">.</span><span class="s2">clearRect</span><span class="s1">(</span><span class="s2">x</span><span class="s1">,</span><span class="s2">C</span><span class="s1">,</span><span class="s2">v</span><span class="s1">-</span><span class="s2">x</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">M</span><span class="s1">-</span><span class="s2">C</span><span class="s1">+</span><span class="s3">1</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">){</span><span class="s2">b</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s2">b</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">x</span><span class="s1">,</span><span class="s2">C</span><span class="s1">,</span><span class="s2">v</span><span class="s1">-</span><span class="s2">x</span><span class="s1">+</span><span class="s3">1</span><span class="s1">,</span><span class="s2">M</span><span class="s1">-</span><span class="s2">C</span><span class="s1">+</span><span class="s3">1</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">){</span><span class="s2">b</span><span class="s1">.</span><span class="s2">strokeStyle</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">b</span><span class="s1">.</span><span class="s2">lineWidth</span><span class="s1">=</span><span class="s3">2</span><span class="s1">;</span><span class="s2">b</span><span class="s1">.</span><span class="s2">strokeRect</span><span class="s1">(</span><span class="s2">x</span><span class="s1">,</span><span class="s2">C</span><span class="s1">,</span><span class="s2">v</span><span class="s1">-</span><span class="s2">x</span><span class="s1">,</span><span class="s2">M</span><span class="s1">-</span><span class="s2">C</span><span class="s1">)}</span><span class="s2">b</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">()}</span><span class="s2">_drawShadows</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_style</span><span class="s1">.</span><span class="s2">scrollShadow</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_scrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollX</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">maxScrollY</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">headerHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">pageHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_viewportHeight</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyWidth</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">bodyHeight</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastRow</span><span class="s1">&amp;&amp;</span><span class="s2">a</span><span class="s1">&gt;</span><span class="s2">u</span><span class="s1">){</span><span class="s2">u</span><span class="s1">=</span><span class="s2">a</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_stretchLastColumn</span><span class="s1">&amp;&amp;</span><span class="s2">l</span><span class="s1">&gt;</span><span class="s2">d</span><span class="s1">){</span><span class="s2">d</span><span class="s1">=</span><span class="s2">l</span><span class="s1">}</span><span class="s4">let </span><span class="s2">f</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_overlayGC</span><span class="s1">;</span><span class="s2">f</span><span class="s1">.</span><span class="s2">save</span><span class="s1">();</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">s</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">f</span><span class="s1">.</span><span class="s2">createLinearGradient</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">a</span><span class="s1">);</span><span class="s2">h</span><span class="s1">.</span><span class="s2">addColorStop</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">color1</span><span class="s1">);</span><span class="s2">h</span><span class="s1">.</span><span class="s2">addColorStop</span><span class="s1">(</span><span class="s3">.5</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">color2</span><span class="s1">);</span><span class="s2">h</span><span class="s1">.</span><span class="s2">addColorStop</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">color3</span><span class="s1">);</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">n</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s2">r</span><span class="s1">+</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">l</span><span class="s1">,</span><span class="s2">d</span><span class="s1">-</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">;</span><span class="s2">f</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s2">f</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">c</span><span class="s1">,</span><span class="s2">u</span><span class="s1">,</span><span class="s2">_</span><span class="s1">,</span><span class="s2">m</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">+</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s2">f</span><span class="s1">.</span><span class="s2">createLinearGradient</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">l</span><span class="s1">);</span><span class="s2">h</span><span class="s1">.</span><span class="s2">addColorStop</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">color1</span><span class="s1">);</span><span class="s2">h</span><span class="s1">.</span><span class="s2">addColorStop</span><span class="s1">(</span><span class="s3">.5</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">color2</span><span class="s1">);</span><span class="s2">h</span><span class="s1">.</span><span class="s2">addColorStop</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">color3</span><span class="s1">);</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">r</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s2">n</span><span class="s1">+</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">u</span><span class="s1">-</span><span class="s2">i</span><span class="s1">);</span><span class="s2">f</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s2">f</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">c</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">_</span><span class="s1">,</span><span class="s2">m</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">i</span><span class="s1">&lt;</span><span class="s2">o</span><span class="s1">){</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s2">c</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">c</span><span class="s1">-</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">=</span><span class="s2">f</span><span class="s1">.</span><span class="s2">createLinearGradient</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">n</span><span class="s1">);</span><span class="s2">a</span><span class="s1">.</span><span class="s2">addColorStop</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">color1</span><span class="s1">);</span><span class="s2">a</span><span class="s1">.</span><span class="s2">addColorStop</span><span class="s1">(</span><span class="s3">.5</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">color2</span><span class="s1">);</span><span class="s2">a</span><span class="s1">.</span><span class="s2">addColorStop</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">color3</span><span class="s1">);</span><span class="s4">let </span><span class="s2">h</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">u</span><span class="s1">=</span><span class="s2">c</span><span class="s1">-</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s2">r</span><span class="s1">+</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">l</span><span class="s1">,</span><span class="s2">d</span><span class="s1">-</span><span class="s2">t</span><span class="s1">);</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">;</span><span class="s2">f</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">a</span><span class="s1">;</span><span class="s2">f</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">h</span><span class="s1">,</span><span class="s2">u</span><span class="s1">,</span><span class="s2">_</span><span class="s1">,</span><span class="s2">m</span><span class="s1">)}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">&lt;</span><span class="s2">s</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">h</span><span class="s1">;</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">=</span><span class="s2">h</span><span class="s1">-</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">;</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">=</span><span class="s2">f</span><span class="s1">.</span><span class="s2">createLinearGradient</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">addColorStop</span><span class="s1">(</span><span class="s3">0</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">color1</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">addColorStop</span><span class="s1">(</span><span class="s3">.5</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">color2</span><span class="s1">);</span><span class="s2">l</span><span class="s1">.</span><span class="s2">addColorStop</span><span class="s1">(</span><span class="s3">1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">color3</span><span class="s1">);</span><span class="s4">let </span><span class="s2">c</span><span class="s1">=</span><span class="s2">h</span><span class="s1">-</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">;</span><span class="s4">let </span><span class="s2">d</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">let </span><span class="s2">_</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">size</span><span class="s1">;</span><span class="s4">let </span><span class="s2">m</span><span class="s1">=</span><span class="s2">n</span><span class="s1">+</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">a</span><span class="s1">,</span><span class="s2">u</span><span class="s1">-</span><span class="s2">i</span><span class="s1">);</span><span class="s2">f</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">l</span><span class="s1">;</span><span class="s2">f</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">c</span><span class="s1">,</span><span class="s2">d</span><span class="s1">,</span><span class="s2">_</span><span class="s1">,</span><span class="s2">m</span><span class="s1">)}</span><span class="s2">f</span><span class="s1">.</span><span class="s2">restore</span><span class="s1">()}}(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">function </span><span class="s2">t</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">value</span><span class="s1">===</span><span class="s4">null</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">value</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s4">return</span><span class="s0">&quot;&quot;</span><span class="s1">}</span><span class="s4">return </span><span class="s2">String</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">value</span><span class="s1">)}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">copyFormatGeneric</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">defaultStyle</span><span class="s1">={</span><span class="s2">voidColor</span><span class="s1">:</span><span class="s0">&quot;#F3F3F3&quot;</span><span class="s1">,</span><span class="s2">backgroundColor</span><span class="s1">:</span><span class="s0">&quot;#FFFFFF&quot;</span><span class="s1">,</span><span class="s2">gridLineColor</span><span class="s1">:</span><span class="s0">&quot;rgba(20, 20, 20, 0.15)&quot;</span><span class="s1">,</span><span class="s2">headerBackgroundColor</span><span class="s1">:</span><span class="s0">&quot;#F3F3F3&quot;</span><span class="s1">,</span><span class="s2">headerGridLineColor</span><span class="s1">:</span><span class="s0">&quot;rgba(20, 20, 20, 0.25)&quot;</span><span class="s1">,</span><span class="s2">selectionFillColor</span><span class="s1">:</span><span class="s0">&quot;rgba(49, 119, 229, 0.2)&quot;</span><span class="s1">,</span><span class="s2">selectionBorderColor</span><span class="s1">:</span><span class="s0">&quot;rgba(0, 107, 247, 1.0)&quot;</span><span class="s1">,</span><span class="s2">cursorBorderColor</span><span class="s1">:</span><span class="s0">&quot;rgba(0, 107, 247, 1.0)&quot;</span><span class="s1">,</span><span class="s2">headerSelectionFillColor</span><span class="s1">:</span><span class="s0">&quot;rgba(20, 20, 20, 0.1)&quot;</span><span class="s1">,</span><span class="s2">headerSelectionBorderColor</span><span class="s1">:</span><span class="s0">&quot;rgba(0, 107, 247, 1.0)&quot;</span><span class="s1">,</span><span class="s2">scrollShadow</span><span class="s1">:{</span><span class="s2">size</span><span class="s1">:</span><span class="s3">10</span><span class="s1">,</span><span class="s2">color1</span><span class="s1">:</span><span class="s0">&quot;rgba(0, 0, 0, 0.20)&quot;</span><span class="s1">,</span><span class="s2">color2</span><span class="s1">:</span><span class="s0">&quot;rgba(0, 0, 0, 0.05)&quot;</span><span class="s1">,</span><span class="s2">color3</span><span class="s1">:</span><span class="s0">&quot;rgba(0, 0, 0, 0.00)&quot;</span><span class="s1">}};</span><span class="s2">e</span><span class="s1">.</span><span class="s2">defaultSizes</span><span class="s1">={</span><span class="s2">rowHeight</span><span class="s1">:</span><span class="s3">20</span><span class="s1">,</span><span class="s2">columnWidth</span><span class="s1">:</span><span class="s3">64</span><span class="s1">,</span><span class="s2">rowHeaderWidth</span><span class="s1">:</span><span class="s3">64</span><span class="s1">,</span><span class="s2">columnHeaderHeight</span><span class="s1">:</span><span class="s3">20</span><span class="s1">};</span><span class="s2">e</span><span class="s1">.</span><span class="s2">minimumSizes</span><span class="s1">={</span><span class="s2">rowHeight</span><span class="s1">:</span><span class="s3">20</span><span class="s1">,</span><span class="s2">columnWidth</span><span class="s1">:</span><span class="s3">10</span><span class="s1">,</span><span class="s2">rowHeaderWidth</span><span class="s1">:</span><span class="s3">10</span><span class="s1">,</span><span class="s2">columnHeaderHeight</span><span class="s1">:</span><span class="s3">20</span><span class="s1">};</span><span class="s2">e</span><span class="s1">.</span><span class="s2">defaultCopyConfig</span><span class="s1">={</span><span class="s2">separator</span><span class="s1">:</span><span class="s0">&quot;</span><span class="s4">\t</span><span class="s0">&quot;</span><span class="s1">,</span><span class="s2">format</span><span class="s1">:</span><span class="s2">t</span><span class="s1">,</span><span class="s2">headers</span><span class="s1">:</span><span class="s0">&quot;none&quot;</span><span class="s1">,</span><span class="s2">warningThreshold</span><span class="s1">:</span><span class="s3">1e6</span><span class="s1">}})(</span><span class="s2">ee</span><span class="s1">||(</span><span class="s2">ee</span><span class="s1">={}));</span><span class="s4">var </span><span class="s2">te</span><span class="s1">;(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">ScrollRequest</span><span class="s1">=</span><span class="s4">new </span><span class="s2">m</span><span class="s1">.</span><span class="s2">ConflatableMessage</span><span class="s1">(</span><span class="s0">&quot;scroll-request&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">OverlayPaintRequest</span><span class="s1">=</span><span class="s4">new </span><span class="s2">m</span><span class="s1">.</span><span class="s2">ConflatableMessage</span><span class="s1">(</span><span class="s0">&quot;overlay-paint-request&quot;</span><span class="s1">);</span><span class="s4">function </span><span class="s2">t</span><span class="s1">(){</span><span class="s4">let </span><span class="s2">e</span><span class="s1">=</span><span class="s2">document</span><span class="s1">.</span><span class="s2">createElement</span><span class="s1">(</span><span class="s0">&quot;canvas&quot;</span><span class="s1">);</span><span class="s2">e</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s3">0</span><span class="s1">;</span><span class="s4">return </span><span class="s2">e</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">createCanvas</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">function </span><span class="s2">i</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">S</span><span class="s1">.</span><span class="s2">getCellGroupsAtRegion</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">return </span><span class="s2">i</span><span class="s1">.</span><span class="s2">length</span><span class="s1">&gt;</span><span class="s3">0</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">regionHasMergedCells</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">class </span><span class="s2">s </span><span class="s4">extends </span><span class="s2">m</span><span class="s1">.</span><span class="s2">ConflatableMessage</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">,</span><span class="s2">s</span><span class="s1">,</span><span class="s2">o</span><span class="s1">){</span><span class="s4">super</span><span class="s1">(</span><span class="s0">&quot;paint-request&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_r1</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_c1</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_r2</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_c2</span><span class="s1">=</span><span class="s2">o</span><span class="s1">}</span><span class="s2">get region</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">}</span><span class="s2">get r1</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_r1</span><span class="s1">}</span><span class="s2">get c1</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_c1</span><span class="s1">}</span><span class="s2">get r2</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_r2</span><span class="s1">}</span><span class="s2">get c2</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_c2</span><span class="s1">}</span><span class="s2">conflate</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">===</span><span class="s0">&quot;all&quot;</span><span class="s1">){</span><span class="s4">return true</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">===</span><span class="s0">&quot;all&quot;</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">=</span><span class="s0">&quot;all&quot;</span><span class="s1">;</span><span class="s4">return true</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">){</span><span class="s4">return false</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_r1</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_r1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">_r1</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_c1</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_c1</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">_c1</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_r2</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_r2</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">_r2</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_c2</span><span class="s1">=</span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_c2</span><span class="s1">,</span><span class="s2">e</span><span class="s1">.</span><span class="s2">_c2</span><span class="s1">);</span><span class="s4">return true</span><span class="s1">}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">PaintRequest</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s4">class </span><span class="s2">o </span><span class="s4">extends </span><span class="s2">m</span><span class="s1">.</span><span class="s2">ConflatableMessage</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">super</span><span class="s1">(</span><span class="s0">&quot;row-resize-request&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_index</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_size</span><span class="s1">=</span><span class="s2">i</span><span class="s1">}</span><span class="s2">get region</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">}</span><span class="s2">get index</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_index</span><span class="s1">}</span><span class="s2">get size</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_size</span><span class="s1">}</span><span class="s2">conflate</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_index</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">.</span><span class="s2">_index</span><span class="s1">){</span><span class="s4">return false</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_size</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">_size</span><span class="s1">;</span><span class="s4">return true</span><span class="s1">}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">RowResizeRequest</span><span class="s1">=</span><span class="s2">o</span><span class="s1">;</span><span class="s4">class </span><span class="s2">r </span><span class="s4">extends </span><span class="s2">m</span><span class="s1">.</span><span class="s2">ConflatableMessage</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">super</span><span class="s1">(</span><span class="s0">&quot;column-resize-request&quot;</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">=</span><span class="s2">e</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_index</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_size</span><span class="s1">=</span><span class="s2">i</span><span class="s1">}</span><span class="s2">get region</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">}</span><span class="s2">get index</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_index</span><span class="s1">}</span><span class="s2">get size</span><span class="s1">(){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_size</span><span class="s1">}</span><span class="s2">conflate</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">.</span><span class="s2">_region</span><span class="s1">||</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_index</span><span class="s1">!==</span><span class="s2">e</span><span class="s1">.</span><span class="s2">_index</span><span class="s1">){</span><span class="s4">return false</span><span class="s1">}</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_size</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">_size</span><span class="s1">;</span><span class="s4">return true</span><span class="s1">}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">ColumnResizeRequest</span><span class="s1">=</span><span class="s2">r</span><span class="s1">})(</span><span class="s2">te</span><span class="s1">||(</span><span class="s2">te</span><span class="s1">={}));</span><span class="s4">class </span><span class="s2">ie </span><span class="s4">extends </span><span class="s2">q</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">super</span><span class="s1">();</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">se</span><span class="s1">.</span><span class="s2">splitFields</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">schema</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_data</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">data</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bodyFields</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">bodyFields</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_headerFields</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">headerFields</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_missingValues</span><span class="s1">=</span><span class="s2">se</span><span class="s1">.</span><span class="s2">createMissingMap</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">schema</span><span class="s1">)}</span><span class="s2">rowCount</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_data</span><span class="s1">.</span><span class="s2">length</span><span class="s1">}</span><span class="s4">return </span><span class="s3">1</span><span class="s1">}</span><span class="s2">columnCount</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_bodyFields</span><span class="s1">.</span><span class="s2">length</span><span class="s1">}</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_headerFields</span><span class="s1">.</span><span class="s2">length</span><span class="s1">}</span><span class="s2">data</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">let </span><span class="s2">s</span><span class="s1">;</span><span class="s4">let </span><span class="s2">o</span><span class="s1">;</span><span class="s4">switch</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">case</span><span class="s0">&quot;body&quot;</span><span class="s1">:</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bodyFields</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_data</span><span class="s1">[</span><span class="s2">t</span><span class="s1">][</span><span class="s2">s</span><span class="s1">.</span><span class="s2">name</span><span class="s1">];</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;column-header&quot;</span><span class="s1">:</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_bodyFields</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span><span class="s2">o</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">title</span><span class="s1">||</span><span class="s2">s</span><span class="s1">.</span><span class="s2">name</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;row-header&quot;</span><span class="s1">:</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_headerFields</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span><span class="s2">o</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_data</span><span class="s1">[</span><span class="s2">t</span><span class="s1">][</span><span class="s2">s</span><span class="s1">.</span><span class="s2">name</span><span class="s1">];</span><span class="s4">break</span><span class="s1">;</span><span class="s4">case</span><span class="s0">&quot;corner-header&quot;</span><span class="s1">:</span><span class="s2">s</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_headerFields</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span><span class="s2">o</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">title</span><span class="s1">||</span><span class="s2">s</span><span class="s1">.</span><span class="s2">name</span><span class="s1">;</span><span class="s4">break</span><span class="s1">;</span><span class="s4">default</span><span class="s1">:</span><span class="s4">throw</span><span class="s0">&quot;unreachable&quot;</span><span class="s1">}</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_missingValues</span><span class="s1">!==</span><span class="s4">null</span><span class="s1">&amp;&amp;</span><span class="s4">typeof </span><span class="s2">o</span><span class="s1">===</span><span class="s0">&quot;string&quot;</span><span class="s1">&amp;&amp;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">_missingValues</span><span class="s1">[</span><span class="s2">o</span><span class="s1">]===</span><span class="s4">true</span><span class="s1">;</span><span class="s4">return </span><span class="s2">r</span><span class="s1">?</span><span class="s4">null</span><span class="s1">:</span><span class="s2">o</span><span class="s1">}</span><span class="s2">metadata</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">,</span><span class="s2">i</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;body&quot;</span><span class="s1">||</span><span class="s2">e</span><span class="s1">===</span><span class="s0">&quot;column-header&quot;</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_bodyFields</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]}</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">_headerFields</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]}}</span><span class="s4">var </span><span class="s2">se</span><span class="s1">;(</span><span class="s4">function</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">function </span><span class="s2">t</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">let </span><span class="s2">t</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">primaryKey</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">){</span><span class="s2">t</span><span class="s1">=[]}</span><span class="s4">else if</span><span class="s1">(</span><span class="s4">typeof </span><span class="s2">e</span><span class="s1">.</span><span class="s2">primaryKey</span><span class="s1">===</span><span class="s0">&quot;string&quot;</span><span class="s1">){</span><span class="s2">t</span><span class="s1">=[</span><span class="s2">e</span><span class="s1">.</span><span class="s2">primaryKey</span><span class="s1">]}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">primaryKey</span><span class="s1">}</span><span class="s4">let </span><span class="s2">i</span><span class="s1">=[];</span><span class="s4">let </span><span class="s2">s</span><span class="s1">=[];</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">o of e</span><span class="s1">.</span><span class="s2">fields</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">o</span><span class="s1">.</span><span class="s2">name</span><span class="s1">)===-</span><span class="s3">1</span><span class="s1">){</span><span class="s2">i</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">o</span><span class="s1">)}</span><span class="s4">else</span><span class="s1">{</span><span class="s2">s</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">o</span><span class="s1">)}}</span><span class="s4">return</span><span class="s1">{</span><span class="s2">bodyFields</span><span class="s1">:</span><span class="s2">i</span><span class="s1">,</span><span class="s2">headerFields</span><span class="s1">:</span><span class="s2">s</span><span class="s1">}}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">splitFields</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">function </span><span class="s2">i</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">missingValues</span><span class="s1">||</span><span class="s2">e</span><span class="s1">.</span><span class="s2">missingValues</span><span class="s1">.</span><span class="s2">length</span><span class="s1">===</span><span class="s3">0</span><span class="s1">){</span><span class="s4">return null</span><span class="s1">}</span><span class="s4">let </span><span class="s2">t</span><span class="s1">=</span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s4">null</span><span class="s1">);</span><span class="s4">for</span><span class="s1">(</span><span class="s4">let </span><span class="s2">i of e</span><span class="s1">.</span><span class="s2">missingValues</span><span class="s1">){</span><span class="s2">t</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]=</span><span class="s4">true</span><span class="s1">}</span><span class="s4">return </span><span class="s2">t</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">createMissingMap</span><span class="s1">=</span><span class="s2">i</span><span class="s1">})(</span><span class="s2">se</span><span class="s1">||(</span><span class="s2">se</span><span class="s1">={}));</span><span class="s4">const </span><span class="s2">oe</span><span class="s1">=</span><span class="s5">/^(\d+(\.\d+)?)%$/</span><span class="s1">;</span><span class="s4">const </span><span class="s2">re</span><span class="s1">=</span><span class="s5">/^(\d+(\.\d+)?)px$/</span><span class="s1">;</span><span class="s4">class </span><span class="s2">ne </span><span class="s4">extends </span><span class="s2">k</span><span class="s1">{</span><span class="s2">constructor</span><span class="s1">(</span><span class="s2">e</span><span class="s1">={}){</span><span class="s4">super</span><span class="s1">();</span><span class="s4">this</span><span class="s1">.</span><span class="s2">backgroundColor</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">backgroundColor</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">textColor</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">textColor</span><span class="s1">||</span><span class="s0">&quot;#000000&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">placeholder</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">placeholder</span><span class="s1">||</span><span class="s0">&quot;...&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">width</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">width</span><span class="s1">||</span><span class="s0">&quot;&quot;</span><span class="s1">;</span><span class="s4">this</span><span class="s1">.</span><span class="s2">height</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">height</span><span class="s1">===</span><span class="s2">undefined</span><span class="s1">?</span><span class="s0">&quot;100%&quot;</span><span class="s1">:</span><span class="s2">e</span><span class="s1">.</span><span class="s2">height</span><span class="s1">}</span><span class="s2">isReady</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">return</span><span class="s1">!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">value</span><span class="s1">||</span><span class="s2">ne</span><span class="s1">.</span><span class="s2">dataCache</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">value</span><span class="s1">)!==</span><span class="s2">undefined</span><span class="s1">}</span><span class="s2">async load</span><span class="s1">(</span><span class="s2">e</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">e</span><span class="s1">.</span><span class="s2">value</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">t</span><span class="s1">=</span><span class="s2">e</span><span class="s1">.</span><span class="s2">value</span><span class="s1">;</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s4">new </span><span class="s2">p</span><span class="s1">.</span><span class="s2">PromiseDelegate</span><span class="s1">;</span><span class="s2">ne</span><span class="s1">.</span><span class="s2">dataCache</span><span class="s1">.</span><span class="s2">set</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">undefined</span><span class="s1">);</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Image</span><span class="s1">;</span><span class="s2">s</span><span class="s1">.</span><span class="s2">onload</span><span class="s1">=()=&gt;{</span><span class="s2">ne</span><span class="s1">.</span><span class="s2">dataCache</span><span class="s1">.</span><span class="s2">set</span><span class="s1">(</span><span class="s2">t</span><span class="s1">,</span><span class="s2">s</span><span class="s1">);</span><span class="s2">i</span><span class="s1">.</span><span class="s2">resolve</span><span class="s1">()};</span><span class="s2">s</span><span class="s1">.</span><span class="s2">src</span><span class="s1">=</span><span class="s2">t</span><span class="s1">;</span><span class="s4">return </span><span class="s2">i</span><span class="s1">.</span><span class="s2">promise</span><span class="s1">}</span><span class="s2">paintPlaceholder</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">drawBackground</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">drawPlaceholder</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">paint</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">this</span><span class="s1">.</span><span class="s2">drawBackground</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">this</span><span class="s1">.</span><span class="s2">drawImage</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s2">drawBackground</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">backgroundColor</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">i</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillRect</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">)}</span><span class="s2">drawPlaceholder</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">placeholder</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">textColor</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">/</span><span class="s3">2</span><span class="s1">;</span><span class="s4">const </span><span class="s2">r</span><span class="s1">=</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">+</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">/</span><span class="s3">2</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillStyle</span><span class="s1">=</span><span class="s2">s</span><span class="s1">;</span><span class="s2">e</span><span class="s1">.</span><span class="s2">fillText</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">o</span><span class="s1">,</span><span class="s2">r</span><span class="s1">)}</span><span class="s2">drawImage</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">){</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">t</span><span class="s1">.</span><span class="s2">value</span><span class="s1">){</span><span class="s4">return</span><span class="s1">}</span><span class="s4">const </span><span class="s2">i</span><span class="s1">=</span><span class="s2">ne</span><span class="s1">.</span><span class="s2">dataCache</span><span class="s1">.</span><span class="s2">get</span><span class="s1">(</span><span class="s2">t</span><span class="s1">.</span><span class="s2">value</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">i</span><span class="s1">){</span><span class="s4">return this</span><span class="s1">.</span><span class="s2">drawPlaceholder</span><span class="s1">(</span><span class="s2">e</span><span class="s1">,</span><span class="s2">t</span><span class="s1">)}</span><span class="s4">const </span><span class="s2">s</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">width</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">const </span><span class="s2">o</span><span class="s1">=</span><span class="s2">x</span><span class="s1">.</span><span class="s2">resolveOption</span><span class="s1">(</span><span class="s4">this</span><span class="s1">.</span><span class="s2">height</span><span class="s1">,</span><span class="s2">t</span><span class="s1">);</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">s</span><span class="s1">&amp;&amp;!</span><span class="s2">o</span><span class="s1">){</span><span class="s2">e</span><span class="s1">.</span><span class="s2">drawImage</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">);</span><span class="s4">return</span><span class="s1">}</span><span class="s4">let </span><span class="s2">r</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">width</span><span class="s1">;</span><span class="s4">let </span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">height</span><span class="s1">;</span><span class="s4">let </span><span class="s2">l</span><span class="s1">;</span><span class="s4">let </span><span class="s2">a</span><span class="s1">;</span><span class="s4">let </span><span class="s2">h</span><span class="s1">;</span><span class="s4">let </span><span class="s2">c</span><span class="s1">;</span><span class="s4">if</span><span class="s1">(</span><span class="s2">l</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">oe</span><span class="s1">)){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">parseFloat</span><span class="s1">(</span><span class="s2">l</span><span class="s1">[</span><span class="s3">1</span><span class="s1">])/</span><span class="s3">100</span><span class="s1">*</span><span class="s2">t</span><span class="s1">.</span><span class="s2">width</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">a</span><span class="s1">=</span><span class="s2">s</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">re</span><span class="s1">)){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">parseFloat</span><span class="s1">(</span><span class="s2">a</span><span class="s1">[</span><span class="s3">1</span><span class="s1">])}</span><span class="s4">if</span><span class="s1">(</span><span class="s2">h</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">oe</span><span class="s1">)){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">parseFloat</span><span class="s1">(</span><span class="s2">h</span><span class="s1">[</span><span class="s3">1</span><span class="s1">])/</span><span class="s3">100</span><span class="s1">*</span><span class="s2">t</span><span class="s1">.</span><span class="s2">height</span><span class="s1">}</span><span class="s4">else if</span><span class="s1">(</span><span class="s2">c</span><span class="s1">=</span><span class="s2">o</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">re</span><span class="s1">)){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">parseFloat</span><span class="s1">(</span><span class="s2">c</span><span class="s1">[</span><span class="s3">1</span><span class="s1">])}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">s</span><span class="s1">){</span><span class="s2">r</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">width</span><span class="s1">/</span><span class="s2">i</span><span class="s1">.</span><span class="s2">height</span><span class="s1">*</span><span class="s2">n</span><span class="s1">}</span><span class="s4">if</span><span class="s1">(!</span><span class="s2">o</span><span class="s1">){</span><span class="s2">n</span><span class="s1">=</span><span class="s2">i</span><span class="s1">.</span><span class="s2">height</span><span class="s1">/</span><span class="s2">i</span><span class="s1">.</span><span class="s2">width</span><span class="s1">*</span><span class="s2">r</span><span class="s1">}</span><span class="s2">e</span><span class="s1">.</span><span class="s2">drawImage</span><span class="s1">(</span><span class="s2">i</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">x</span><span class="s1">,</span><span class="s2">t</span><span class="s1">.</span><span class="s2">y</span><span class="s1">,</span><span class="s2">r</span><span class="s1">,</span><span class="s2">n</span><span class="s1">)}}</span><span class="s2">ne</span><span class="s1">.</span><span class="s2">dataCache</span><span class="s1">=</span><span class="s4">new </span><span class="s2">Map</span><span class="s1">}}]);</span></pre>
</body>
</html>