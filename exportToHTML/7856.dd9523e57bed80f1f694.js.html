<html>
<head>
<title>7856.dd9523e57bed80f1f694.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #bcbec4;}
.s2 { color: #6aab73;}
.s3 { color: #2aacb8;}
.s4 { color: #cf8e6d;}
.s5 { color: #42c3d4;}
.ln { color: #4b5059; font-weight: normal; font-style: normal; }
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
7856.dd9523e57bed80f1f694.js</font>
</center></td></tr></table>
<pre><a name="l1"><span class="ln">1    </span></a><span class="s0">(</span><span class="s1">self</span><span class="s0">[</span><span class="s2">&quot;webpackChunk_jupyterlab_application_top&quot;</span><span class="s0">]=</span><span class="s1">self</span><span class="s0">[</span><span class="s2">&quot;webpackChunk_jupyterlab_application_top&quot;</span><span class="s0">]||[]).</span><span class="s1">push</span><span class="s0">([[</span><span class="s3">7856</span><span class="s0">,</span><span class="s3">5606</span><span class="s0">],{</span><span class="s3">97856</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">65606</span><span class="s0">);!</span><span class="s4">function</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">true</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">exports</span><span class="s0">=</span><span class="s1">i</span><span class="s0">();</span><span class="s4">else</span><span class="s0">{</span><span class="s4">var </span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">}}(</span><span class="s1">globalThis</span><span class="s0">,(()=&gt;(()=&gt;{</span><span class="s2">&quot;use strict&quot;</span><span class="s0">;</span><span class="s4">var </span><span class="s1">e</span><span class="s0">={</span><span class="s3">4567</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">AccessibilityManager</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">9042</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">9924</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4725</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3656</span><span class="s0">);</span><span class="s4">let </span><span class="s1">d</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">AccessibilityManager</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">a</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowColumns</span><span class="s0">=</span><span class="s4">new </span><span class="s1">WeakMap</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegionLineCount</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsToConsume</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsToAnnounce</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_accessibilityContainer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">mainDocument</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_accessibilityContainer</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-accessibility&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">mainDocument</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;role&quot;</span><span class="s0">,</span><span class="s2">&quot;list&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-accessibility-tree&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">;</span><span class="s1">r</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s1">r</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createAccessibilityTreeNode</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s1">r</span><span class="s0">]);</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_topBoundaryFocusListener</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleBoundaryFocus</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bottomBoundaryFocusListener</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleBoundaryFocus</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;focus&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_topBoundaryFocusListener</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">].</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;focus&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bottomBoundaryFocusListener</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshRowsDimensions</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_accessibilityContainer</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegion</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">mainDocument</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegion</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;live-region&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegion</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-live&quot;</span><span class="s0">,</span><span class="s2">&quot;assertive&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_accessibilityContainer</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegion</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegionDebouncer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">TimeBasedDebouncer</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderRows</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">))),!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">element</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;Cannot enable accessibility before Terminal.open&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">insertAdjacentElement</span><span class="s0">(</span><span class="s2">&quot;afterbegin&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_accessibilityContainer</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">onResize</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleResize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">onRender</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshRows</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">end</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">onScroll</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshRows</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">onA11yChar</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleChar</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">onLineFeed</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleChar</span><span class="s0">(</span><span class="s2">&quot;</span><span class="s4">\n</span><span class="s2">&quot;</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">onA11yTab</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleTab</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">onKey</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleKey</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">onBlur</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_clearLiveRegion</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">onDimensionsChange</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshRowsDimensions</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s1">document</span><span class="s0">,</span><span class="s2">&quot;selectionchange&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleSelectionChange</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">onDprChange</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshRowsDimensions</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshRows</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_accessibilityContainer</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">})))}</span><span class="s1">_handleTab</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleChar</span><span class="s0">(</span><span class="s2">&quot; &quot;</span><span class="s0">)}</span><span class="s1">_handleChar</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegionLineCount</span><span class="s0">&lt;</span><span class="s3">21</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsToConsume</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsToConsume</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">()!==</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsToAnnounce</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsToAnnounce</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\n</span><span class="s2">&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegionLineCount</span><span class="s0">++,</span><span class="s3">21</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegionLineCount</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegion</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">+=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">tooMuchOutput</span><span class="s0">)))}</span><span class="s1">_clearLiveRegion</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegion</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegionLineCount</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">_handleKey</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_clearLiveRegion</span><span class="s0">(),</span><span class="s5">/\p{Control}/u</span><span class="s0">.</span><span class="s1">test</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsToConsume</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">_refreshRows</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegionDebouncer</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">)}</span><span class="s1">_renderRows</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">.</span><span class="s1">toString</span><span class="s0">();</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s1">r</span><span class="s0">&lt;=</span><span class="s1">t</span><span class="s0">;</span><span class="s1">r</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">+</span><span class="s1">r</span><span class="s0">),</span><span class="s1">t</span><span class="s0">=[],</span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">?.</span><span class="s1">translateToString</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)||</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">+</span><span class="s1">r</span><span class="s0">+</span><span class="s3">1</span><span class="s0">).</span><span class="s1">toString</span><span class="s0">(),</span><span class="s1">a</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s1">r</span><span class="s0">];</span><span class="s1">a</span><span class="s0">&amp;&amp;(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">n</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?(</span><span class="s1">a</span><span class="s0">.</span><span class="s1">innerText</span><span class="s0">=</span><span class="s2">&quot; &quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowColumns</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">a</span><span class="s0">,[</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">])):(</span><span class="s1">a</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowColumns</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">a</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)),</span><span class="s1">a</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-posinset&quot;</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">a</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-setsize&quot;</span><span class="s0">,</span><span class="s1">s</span><span class="s0">))}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_announceCharacters</span><span class="s0">()}</span><span class="s1">_announceCharacters</span><span class="s0">(){</span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsToAnnounce</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_liveRegion</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">+=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsToAnnounce</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsToAnnounce</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">)}</span><span class="s1">_handleBoundaryFocus</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">target</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">2</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">getAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-posinset&quot;</span><span class="s0">)===(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">?</span><span class="s2">&quot;1&quot;</span><span class="s0">:</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}</span><span class="s2">`</span><span class="s0">))</span><span class="s4">return</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">relatedTarget</span><span class="s0">!==</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">let </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">?(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">removeChild</span><span class="s0">(</span><span class="s1">n</span><span class="s0">)):(</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">(),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">removeChild</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)),</span><span class="s1">r</span><span class="s0">.</span><span class="s1">removeEventListener</span><span class="s0">(</span><span class="s2">&quot;focus&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_topBoundaryFocusListener</span><span class="s0">),</span><span class="s1">n</span><span class="s0">.</span><span class="s1">removeEventListener</span><span class="s0">(</span><span class="s2">&quot;focus&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bottomBoundaryFocusListener</span><span class="s0">),</span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createAccessibilityTreeNode</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">unshift</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">insertAdjacentElement</span><span class="s0">(</span><span class="s2">&quot;afterbegin&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createAccessibilityTreeNode</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;focus&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_topBoundaryFocusListener</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">].</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;focus&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bottomBoundaryFocusListener</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">?-</span><span class="s3">1</span><span class="s0">:</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">2</span><span class="s0">].</span><span class="s1">focus</span><span class="s0">(),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">preventDefault</span><span class="s0">(),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">stopImmediatePropagation</span><span class="s0">()}</span><span class="s1">_handleSelectionChange</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">document</span><span class="s0">.</span><span class="s1">getSelection</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isCollapsed</span><span class="s0">)</span><span class="s4">return void</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">contains</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">anchorNode</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">clearSelection</span><span class="s0">());</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">anchorNode</span><span class="s0">||!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">focusNode</span><span class="s0">)</span><span class="s4">return void </span><span class="s1">console</span><span class="s0">.</span><span class="s1">error</span><span class="s0">(</span><span class="s2">&quot;anchorNode and/or focusNode are null&quot;</span><span class="s0">);</span><span class="s4">let </span><span class="s1">t</span><span class="s0">={</span><span class="s1">node</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">anchorNode</span><span class="s0">,</span><span class="s1">offset</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">anchorOffset</span><span class="s0">},</span><span class="s1">i</span><span class="s0">={</span><span class="s1">node</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">focusNode</span><span class="s0">,</span><span class="s1">offset</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">focusOffset</span><span class="s0">};</span><span class="s4">if</span><span class="s0">((</span><span class="s1">t</span><span class="s0">.</span><span class="s1">node</span><span class="s0">.</span><span class="s1">compareDocumentPosition</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">node</span><span class="s0">)&amp;</span><span class="s1">Node</span><span class="s0">.</span><span class="s1">DOCUMENT_POSITION_PRECEDING</span><span class="s0">||</span><span class="s1">t</span><span class="s0">.</span><span class="s1">node</span><span class="s0">===</span><span class="s1">i</span><span class="s0">.</span><span class="s1">node</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">offset</span><span class="s0">&gt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">offset</span><span class="s0">)&amp;&amp;([</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">]=[</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">]),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">node</span><span class="s0">.</span><span class="s1">compareDocumentPosition</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])&amp;(</span><span class="s1">Node</span><span class="s0">.</span><span class="s1">DOCUMENT_POSITION_CONTAINED_BY</span><span class="s0">|</span><span class="s1">Node</span><span class="s0">.</span><span class="s1">DOCUMENT_POSITION_FOLLOWING</span><span class="s0">)&amp;&amp;(</span><span class="s1">t</span><span class="s0">={</span><span class="s1">node</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">childNodes</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">offset</span><span class="s0">:</span><span class="s3">0</span><span class="s0">}),!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">contains</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">node</span><span class="s0">))</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(-</span><span class="s3">1</span><span class="s0">)[</span><span class="s3">0</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">node</span><span class="s0">.</span><span class="s1">compareDocumentPosition</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)&amp;(</span><span class="s1">Node</span><span class="s0">.</span><span class="s1">DOCUMENT_POSITION_CONTAINED_BY</span><span class="s0">|</span><span class="s1">Node</span><span class="s0">.</span><span class="s1">DOCUMENT_POSITION_PRECEDING</span><span class="s0">)&amp;&amp;(</span><span class="s1">i</span><span class="s0">={</span><span class="s1">node</span><span class="s0">:</span><span class="s1">s</span><span class="s0">,</span><span class="s1">offset</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">?.</span><span class="s1">length</span><span class="s0">??</span><span class="s3">0</span><span class="s0">}),!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">contains</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">node</span><span class="s0">))</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=({</span><span class="s1">node</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">offset</span><span class="s0">:</span><span class="s1">t</span><span class="s0">})=&gt;{</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e </span><span class="s4">instanceof </span><span class="s1">Text</span><span class="s0">?</span><span class="s1">e</span><span class="s0">.</span><span class="s1">parentNode</span><span class="s0">:</span><span class="s1">e</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">i</span><span class="s0">?.</span><span class="s1">getAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-posinset&quot;</span><span class="s0">),</span><span class="s3">10</span><span class="s0">)-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">isNaN</span><span class="s0">(</span><span class="s1">s</span><span class="s0">))</span><span class="s4">return </span><span class="s1">console</span><span class="s0">.</span><span class="s1">warn</span><span class="s0">(</span><span class="s2">&quot;row is invalid. Race condition?&quot;</span><span class="s0">),</span><span class="s4">null</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowColumns</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">r</span><span class="s0">)</span><span class="s4">return </span><span class="s1">console</span><span class="s0">.</span><span class="s1">warn</span><span class="s0">(</span><span class="s2">&quot;columns is null. Race condition?&quot;</span><span class="s0">),</span><span class="s4">null</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">r</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s1">r</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]:</span><span class="s1">r</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(-</span><span class="s3">1</span><span class="s0">)[</span><span class="s3">0</span><span class="s0">]+</span><span class="s3">1</span><span class="s0">;</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">&amp;&amp;(++</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">),{</span><span class="s1">row</span><span class="s0">:</span><span class="s1">s</span><span class="s0">,</span><span class="s1">column</span><span class="s0">:</span><span class="s1">n</span><span class="s0">}},</span><span class="s1">n</span><span class="s0">=</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">r</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">row</span><span class="s0">&gt;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">row</span><span class="s0">||</span><span class="s1">n</span><span class="s0">.</span><span class="s1">row</span><span class="s0">===</span><span class="s1">o</span><span class="s0">.</span><span class="s1">row</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">column</span><span class="s0">&gt;=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">column</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;invalid range&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">select</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">column</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">row</span><span class="s0">,(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">row</span><span class="s0">-</span><span class="s1">n</span><span class="s0">.</span><span class="s1">row</span><span class="s0">)*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s1">n</span><span class="s0">.</span><span class="s1">column</span><span class="s0">+</span><span class="s1">o</span><span class="s0">.</span><span class="s1">column</span><span class="s0">)}}</span><span class="s1">_handleResize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">].</span><span class="s1">removeEventListener</span><span class="s0">(</span><span class="s2">&quot;focus&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bottomBoundaryFocusListener</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">children</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createAccessibilityTreeNode</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]);</span><span class="s4">for</span><span class="s0">(;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">removeChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">());</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">].</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;focus&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bottomBoundaryFocusListener</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshRowsDimensions</span><span class="s0">()}</span><span class="s1">_createAccessibilityTreeNode</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">mainDocument</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;role&quot;</span><span class="s0">,</span><span class="s2">&quot;listitem&quot;</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">tabIndex</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshRowDimensions</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">e</span><span class="s0">}</span><span class="s1">_refreshRowsDimensions</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_accessibilityContainer</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleResize</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">;</span><span class="s1">e</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshRowDimensions</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s1">e</span><span class="s0">])}}</span><span class="s1">_refreshRowDimensions</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">AccessibilityManager</span><span class="s0">=</span><span class="s1">d</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">IInstantiationService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">ICoreBrowserService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IRenderService</span><span class="s0">)],</span><span class="s1">d</span><span class="s0">)},</span><span class="s3">3614</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s4">function </span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">replace</span><span class="s0">(</span><span class="s5">/\r?\n/g</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\r</span><span class="s2">&quot;</span><span class="s0">)}</span><span class="s4">function </span><span class="s1">s</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">?</span><span class="s2">&quot;[200~&quot;</span><span class="s0">+</span><span class="s1">e</span><span class="s0">+</span><span class="s2">&quot;[201~&quot;</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}</span><span class="s4">function </span><span class="s1">r</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s1">e</span><span class="s0">=</span><span class="s1">s</span><span class="s0">(</span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">r</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">bracketedPasteMode</span><span class="s0">&amp;&amp;!</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">n</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">ignoreBracketedPasteMode</span><span class="s0">),</span><span class="s1">r</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s4">function </span><span class="s1">n</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">getBoundingClientRect</span><span class="s0">(),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">clientX</span><span class="s0">-</span><span class="s1">s</span><span class="s0">.</span><span class="s1">left</span><span class="s0">-</span><span class="s3">10</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">clientY</span><span class="s0">-</span><span class="s1">s</span><span class="s0">.</span><span class="s1">top</span><span class="s0">-</span><span class="s3">10</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s2">&quot;20px&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s2">&quot;20px&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">left</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">r</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">top</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">zIndex</span><span class="s0">=</span><span class="s2">&quot;1000&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">focus</span><span class="s0">()}</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rightClickHandler</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">moveTextAreaUnderMouseCursor</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">paste</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">handlePasteEvent</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">copyHandler</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bracketTextForPaste</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">prepareTextForTerminal</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">prepareTextForTerminal</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bracketTextForPaste</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">copyHandler</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">clipboardData</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">clipboardData</span><span class="s0">.</span><span class="s1">setData</span><span class="s0">(</span><span class="s2">&quot;text/plain&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">selectionText</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">preventDefault</span><span class="s0">()},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">handlePasteEvent</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">stopPropagation</span><span class="s0">(),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">clipboardData</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">clipboardData</span><span class="s0">.</span><span class="s1">getData</span><span class="s0">(</span><span class="s2">&quot;text/plain&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">paste</span><span class="s0">=</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">moveTextAreaUnderMouseCursor</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rightClickHandler</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">){</span><span class="s1">n</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">rightClickSelect</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">selectionText</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">select</span><span class="s0">()}},</span><span class="s3">7239</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ColorContrastCache</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">1505</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ColorContrastCache</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_color</span><span class="s0">=</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">TwoKeyMap</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_css</span><span class="s0">=</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">TwoKeyMap</span><span class="s0">}</span><span class="s1">setCss</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_css</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">getCss</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_css</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">setColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_color</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">getColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_color</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_color</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_css</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">()}}},</span><span class="s3">3656</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">return</span><span class="s0">{</span><span class="s1">dispose</span><span class="s0">:()=&gt;{</span><span class="s1">r</span><span class="s0">||(</span><span class="s1">r</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">removeEventListener</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">))}}}},</span><span class="s3">3551</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Linkifier</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3656</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4725</span><span class="s0">);</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Linkifier</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">a</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">get currentLink</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkProviderService</span><span class="s0">=</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkCacheDisposables</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isMouseOut</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_wasResized</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeLine</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onShowLinkUnderline</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onShowLinkUnderline</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onShowLinkUnderline</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onHideLinkUnderline</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onHideLinkUnderline</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onHideLinkUnderline</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">getDisposeArrayDisposable</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkCacheDisposables</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastMouseEvent</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">?.</span><span class="s1">clear</span><span class="s0">()}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">onResize</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_clearCurrentLink</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_wasResized</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">,</span><span class="s2">&quot;mouseleave&quot;</span><span class="s0">,(()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isMouseOut</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_clearCurrentLink</span><span class="s0">()}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">,</span><span class="s2">&quot;mousemove&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleMouseMove</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">,</span><span class="s2">&quot;mousedown&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleMouseDown</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">,</span><span class="s2">&quot;mouseup&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleMouseUp</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">)))}</span><span class="s1">_handleMouseMove</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastMouseEvent</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_positionFromMouseEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseService</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isMouseOut</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">composedPath</span><span class="s0">();</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">[</span><span class="s1">s</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">contains</span><span class="s0">(</span><span class="s2">&quot;xterm&quot;</span><span class="s0">))</span><span class="s4">break</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">contains</span><span class="s0">(</span><span class="s2">&quot;xterm-hover&quot;</span><span class="s0">))</span><span class="s4">return</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastBufferCell</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">x</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastBufferCell</span><span class="s0">.</span><span class="s1">x</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">y</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastBufferCell</span><span class="s0">.</span><span class="s1">y</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleHover</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastBufferCell</span><span class="s0">=</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">_handleHover</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeLine</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">y</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_wasResized</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_clearCurrentLink</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_askForLink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">),</span><span class="s4">void</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_wasResized</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkAtPosition</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">link</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_clearCurrentLink</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_askForLink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">))}</span><span class="s1">_askForLink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">?.</span><span class="s1">forEach</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s1">e</span><span class="s0">?.</span><span class="s1">forEach</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">()}))})),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Map</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeLine</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">y</span><span class="s0">);</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const</span><span class="s0">[</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">]</span><span class="s1">of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkProviderService</span><span class="s0">.</span><span class="s1">linkProviders</span><span class="s0">.</span><span class="s1">entries</span><span class="s0">())</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">?.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">s</span><span class="s0">);</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_checkLinkProviderResult</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))}</span><span class="s4">else </span><span class="s1">r</span><span class="s0">.</span><span class="s1">provideLinks</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,(</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isMouseOut</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;({</span><span class="s1">link</span><span class="s0">:</span><span class="s1">e</span><span class="s0">})));</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">?.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">),</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_checkLinkProviderResult</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">?.</span><span class="s1">size</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkProviderService</span><span class="s0">.</span><span class="s1">linkProviders</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_removeIntersectingLinks</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">)}))}</span><span class="s1">_removeIntersectingLinks</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Set</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">size</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">r</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">r</span><span class="s0">[</span><span class="s1">t</span><span class="s0">],</span><span class="s1">n</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">x</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">n</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s1">o</span><span class="s0">;</span><span class="s1">e</span><span class="s0">++){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">has</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)){</span><span class="s1">r</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">t</span><span class="s0">--,</span><span class="s3">1</span><span class="s0">);</span><span class="s4">break</span><span class="s0">}</span><span class="s1">i</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}}}}</span><span class="s1">_checkLinkProviderResult</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">)</span><span class="s4">return </span><span class="s1">i</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">;</span><span class="s1">n</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">.</span><span class="s1">has</span><span class="s0">(</span><span class="s1">n</span><span class="s0">)&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">n</span><span class="s0">)||(</span><span class="s1">r</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">find</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkAtPosition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)));</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleNewLink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">.</span><span class="s1">size</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkProviderService</span><span class="s0">.</span><span class="s1">linkProviders</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;!</span><span class="s1">i</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">.</span><span class="s1">size</span><span class="s0">;</span><span class="s1">n</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProviderReplies</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">n</span><span class="s0">)?.</span><span class="s1">find</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkAtPosition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">i</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleNewLink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">break</span><span class="s0">}}</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s1">_handleMouseDown</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseDownLink</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">}</span><span class="s1">_handleMouseUp</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_positionFromMouseEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseService</span><span class="s0">);</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseDownLink</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkAtPosition</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">link</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">activate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">text</span><span class="s0">)}</span><span class="s1">_clearCurrentLink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastMouseEvent</span><span class="s0">&amp;&amp;(!</span><span class="s1">e</span><span class="s0">||!</span><span class="s1">t</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;=</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&lt;=</span><span class="s1">t</span><span class="s0">)&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkLeave</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">link</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastMouseEvent</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">disposeArray</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkCacheDisposables</span><span class="s0">))}</span><span class="s1">_handleNewLink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastMouseEvent</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_positionFromMouseEvent</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastMouseEvent</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseService</span><span class="s0">);</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkAtPosition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">state</span><span class="s0">={</span><span class="s1">decorations</span><span class="s0">:{</span><span class="s1">underline</span><span class="s0">:</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">underline</span><span class="s0">,</span><span class="s1">pointerCursor</span><span class="s0">:</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">pointerCursor</span><span class="s0">},</span><span class="s1">isHovered</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkHover</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastMouseEvent</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">={},</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperties</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">,{</span><span class="s1">pointerCursor</span><span class="s0">:{</span><span class="s1">get</span><span class="s0">:()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">?.</span><span class="s1">state</span><span class="s0">?.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">pointerCursor</span><span class="s0">,</span><span class="s1">set</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">?.</span><span class="s1">state</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">pointerCursor</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">pointerCursor</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">isHovered</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">toggle</span><span class="s0">(</span><span class="s2">&quot;xterm-cursor-pointer&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">))}},</span><span class="s1">underline</span><span class="s0">:{</span><span class="s1">get</span><span class="s0">:()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">?.</span><span class="s1">state</span><span class="s0">?.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">underline</span><span class="s0">,</span><span class="s1">set</span><span class="s0">:</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">?.</span><span class="s1">state</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">?.</span><span class="s1">state</span><span class="s0">?.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">underline</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">underline</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">isHovered</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fireUnderlineEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">link</span><span class="s0">,</span><span class="s1">t</span><span class="s0">))}}}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkCacheDisposables</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">onRenderedViewportChange</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">+</span><span class="s3">1</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">+</span><span class="s3">1</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">end</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;=</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">link</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&lt;=</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_clearCurrentLink</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastMouseEvent</span><span class="s0">)){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_positionFromMouseEvent</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastMouseEvent</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseService</span><span class="s0">);</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_askForLink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">)}}))))}</span><span class="s1">_linkHover</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">?.</span><span class="s1">state</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">isHovered</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">underline</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fireUnderlineEvent</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">pointerCursor</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-cursor-pointer&quot;</span><span class="s0">)),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">hover</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">hover</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">text</span><span class="s0">)}</span><span class="s1">_fireUnderlineEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">range</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createLinkUnderlineEvent</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">x</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">y</span><span class="s0">-</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">y</span><span class="s0">-</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">void </span><span class="s3">0</span><span class="s0">);(</span><span class="s1">t</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onShowLinkUnderline</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onHideLinkUnderline</span><span class="s0">).</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)}</span><span class="s1">_linkLeave</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">?.</span><span class="s1">state</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">isHovered</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">underline</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fireUnderlineEvent</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentLink</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">pointerCursor</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(</span><span class="s2">&quot;xterm-cursor-pointer&quot;</span><span class="s0">)),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">leave</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">leave</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">text</span><span class="s0">)}</span><span class="s1">_linkAtPosition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">y</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">y</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">y</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">x</span><span class="s0">;</span><span class="s4">return </span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">&lt;=</span><span class="s1">s</span><span class="s0">}</span><span class="s1">_positionFromMouseEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">getCoords</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return</span><span class="s0">{</span><span class="s1">x</span><span class="s0">:</span><span class="s1">s</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">y</span><span class="s0">:</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">}}</span><span class="s1">_createLinkUnderlineEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">){</span><span class="s4">return</span><span class="s0">{</span><span class="s1">x1</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">y1</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">x2</span><span class="s0">:</span><span class="s1">i</span><span class="s0">,</span><span class="s1">y2</span><span class="s0">:</span><span class="s1">s</span><span class="s0">,</span><span class="s1">cols</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s1">fg</span><span class="s0">:</span><span class="s1">r</span><span class="s0">}}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Linkifier</span><span class="s0">=</span><span class="s1">l</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">IMouseService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">IRenderService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">4</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">ILinkProviderService</span><span class="s0">)],</span><span class="s1">l</span><span class="s0">)},</span><span class="s3">9042</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">tooMuchOutput</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">promptLabel</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">promptLabel</span><span class="s0">=</span><span class="s2">&quot;Terminal input&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">tooMuchOutput</span><span class="s0">=</span><span class="s2">&quot;Too much output to announce, navigate to rows manually to read&quot;</span><span class="s0">},</span><span class="s3">3730</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OscLinkProvider</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">511</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">);</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OscLinkProvider</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscLinkService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">}</span><span class="s1">provideLinks</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return void </span><span class="s1">t</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">);</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=[],</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">linkHandler</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">getTrimmedLength</span><span class="s0">();</span><span class="s4">let </span><span class="s1">c</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">l</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">d</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s1">a</span><span class="s0">;</span><span class="s1">n</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">l</span><span class="s0">||</span><span class="s1">i</span><span class="s0">.</span><span class="s1">hasContent</span><span class="s0">(</span><span class="s1">n</span><span class="s0">)){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">hasExtendedAttrs</span><span class="s0">()&amp;&amp;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">urlId</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(-</span><span class="s3">1</span><span class="s0">===</span><span class="s1">l</span><span class="s0">){</span><span class="s1">l</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s1">c</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">urlId</span><span class="s0">;</span><span class="s4">continue</span><span class="s0">}</span><span class="s1">d</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">urlId</span><span class="s0">!==</span><span class="s1">c</span><span class="s0">}</span><span class="s4">else</span><span class="s0">-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">l</span><span class="s0">&amp;&amp;(</span><span class="s1">d</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">d</span><span class="s0">||-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">l</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">===</span><span class="s1">a</span><span class="s0">-</span><span class="s3">1</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscLinkService</span><span class="s0">.</span><span class="s1">getLinkData</span><span class="s0">(</span><span class="s1">c</span><span class="s0">)?.</span><span class="s1">uri</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">={</span><span class="s1">start</span><span class="s0">:{</span><span class="s1">x</span><span class="s0">:</span><span class="s1">l</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,</span><span class="s1">y</span><span class="s0">:</span><span class="s1">e</span><span class="s0">},</span><span class="s1">end</span><span class="s0">:{</span><span class="s1">x</span><span class="s0">:</span><span class="s1">n</span><span class="s0">+(</span><span class="s1">d</span><span class="s0">||</span><span class="s1">n</span><span class="s0">!==</span><span class="s1">a</span><span class="s0">-</span><span class="s3">1</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s3">1</span><span class="s0">),</span><span class="s1">y</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}};</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">r</span><span class="s0">?.</span><span class="s1">allowNonHttpProtocols</span><span class="s0">)</span><span class="s4">try</span><span class="s0">{</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">URL</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);[</span><span class="s2">&quot;http:&quot;</span><span class="s0">,</span><span class="s2">&quot;https:&quot;</span><span class="s0">].</span><span class="s1">includes</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">protocol</span><span class="s0">)||(</span><span class="s1">o</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">o</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">o</span><span class="s0">||</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">({</span><span class="s1">text</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">range</span><span class="s0">:</span><span class="s1">i</span><span class="s0">,</span><span class="s1">activate</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;</span><span class="s1">r</span><span class="s0">?</span><span class="s1">r</span><span class="s0">.</span><span class="s1">activate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">h</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">hover</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;</span><span class="s1">r</span><span class="s0">?.</span><span class="s1">hover</span><span class="s0">?.(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">leave</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;</span><span class="s1">r</span><span class="s0">?.</span><span class="s1">leave</span><span class="s0">?.(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)})}</span><span class="s1">d</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">hasExtendedAttrs</span><span class="s0">()&amp;&amp;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">urlId</span><span class="s0">?(</span><span class="s1">l</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s1">c</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">urlId</span><span class="s0">):(</span><span class="s1">l</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">c</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">)}}</span><span class="s1">t</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)}};</span><span class="s4">function </span><span class="s1">h</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">confirm</span><span class="s0">(</span><span class="s2">`Do you want to navigate to </span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">}</span><span class="s2">?</span><span class="s4">\n\n</span><span class="s2">WARNING: This link could potentially be dangerous`</span><span class="s0">)){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">window</span><span class="s0">.</span><span class="s1">open</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">try</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">opener</span><span class="s0">=</span><span class="s4">null</span><span class="s0">}</span><span class="s4">catch</span><span class="s0">{}</span><span class="s1">e</span><span class="s0">.</span><span class="s1">location</span><span class="s0">.</span><span class="s1">href</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s4">else </span><span class="s1">console</span><span class="s0">.</span><span class="s1">warn</span><span class="s0">(</span><span class="s2">&quot;Opening link blocked as opener could not be cleared&quot;</span><span class="s0">)}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OscLinkProvider</span><span class="s0">=</span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">IOscLinkService</span><span class="s0">)],</span><span class="s1">a</span><span class="s0">)},</span><span class="s3">6193</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">RenderDebouncer</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">RenderDebouncer</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderCallback</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshCallbacks</span><span class="s0">=[]}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">.</span><span class="s1">cancelAnimationFrame</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">)}</span><span class="s1">addRefreshCallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_refreshCallbacks</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">.</span><span class="s1">requestAnimationFrame</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_innerRefresh</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">}</span><span class="s1">refresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">?</span><span class="s1">e</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowStart</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowStart</span><span class="s0">?</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowStart</span><span class="s0">,</span><span class="s1">e</span><span class="s0">):</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowEnd</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowEnd</span><span class="s0">?</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowEnd</span><span class="s0">,</span><span class="s1">t</span><span class="s0">):</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">.</span><span class="s1">requestAnimationFrame</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_innerRefresh</span><span class="s0">())))}</span><span class="s1">_innerRefresh</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowStart</span><span class="s0">||</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowEnd</span><span class="s0">||</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">)</span><span class="s4">return void this</span><span class="s0">.</span><span class="s1">_runRefreshCallbacks</span><span class="s0">();</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowStart</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">t</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowEnd</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowStart</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowEnd</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderCallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_runRefreshCallbacks</span><span class="s0">()}</span><span class="s1">_runRefreshCallbacks</span><span class="s0">(){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">e of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshCallbacks</span><span class="s0">)</span><span class="s1">e</span><span class="s0">(</span><span class="s3">0</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshCallbacks</span><span class="s0">=[]}}},</span><span class="s3">3236</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Terminal</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3614</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3656</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3551</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">9042</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3730</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">1680</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3107</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">5744</span><span class="s0">),</span><span class="s1">d</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2950</span><span class="s0">),</span><span class="s1">_</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">1296</span><span class="s0">),</span><span class="s1">u</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">428</span><span class="s0">),</span><span class="s1">f</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4269</span><span class="s0">),</span><span class="s1">v</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">5114</span><span class="s0">),</span><span class="s1">p</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8934</span><span class="s0">),</span><span class="s1">g</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3230</span><span class="s0">),</span><span class="s1">m</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">9312</span><span class="s0">),</span><span class="s1">S</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4725</span><span class="s0">),</span><span class="s1">C</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6731</span><span class="s0">),</span><span class="s1">b</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8055</span><span class="s0">),</span><span class="s1">w</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8969</span><span class="s0">),</span><span class="s1">y</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">E</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">k</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6114</span><span class="s0">),</span><span class="s1">L</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8437</span><span class="s0">),</span><span class="s1">D</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2584</span><span class="s0">),</span><span class="s1">R</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">7399</span><span class="s0">),</span><span class="s1">x</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">5941</span><span class="s0">),</span><span class="s1">A</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">9074</span><span class="s0">),</span><span class="s1">B</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">T</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">5435</span><span class="s0">),</span><span class="s1">M</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4567</span><span class="s0">),</span><span class="s1">O</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">779</span><span class="s0">);</span><span class="s4">class </span><span class="s1">P </span><span class="s4">extends </span><span class="s1">w</span><span class="s0">.</span><span class="s1">CoreTerminal</span><span class="s0">{</span><span class="s1">get onFocus</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_onFocus</span><span class="s0">.</span><span class="s1">event</span><span class="s0">}</span><span class="s1">get onBlur</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_onBlur</span><span class="s0">.</span><span class="s1">event</span><span class="s0">}</span><span class="s1">get onA11yChar</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_onA11yCharEmitter</span><span class="s0">.</span><span class="s1">event</span><span class="s0">}</span><span class="s1">get onA11yTab</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_onA11yTabEmitter</span><span class="s0">.</span><span class="s1">event</span><span class="s0">}</span><span class="s1">get onWillOpen</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_onWillOpen</span><span class="s0">.</span><span class="s1">event</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">={}){</span><span class="s4">super</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">browser</span><span class="s0">=</span><span class="s1">k</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyDownHandled</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyDownSeen</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyPressHandled</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_unprocessedDeadKey</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_accessibilityManager</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">E</span><span class="s0">.</span><span class="s1">MutableDisposable</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onCursorMove</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">y</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onCursorMove</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onCursorMove</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onKey</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">y</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onKey</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onKey</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRender</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">y</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRender</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRender</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onSelectionChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">y</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onSelectionChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onSelectionChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onTitleChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">y</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onTitleChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onTitleChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBell</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">y</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onBell</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBell</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onFocus</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">y</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBlur</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">y</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onA11yCharEmitter</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">y</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onA11yTabEmitter</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">y</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onWillOpen</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">y</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setup</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">A</span><span class="s0">.</span><span class="s1">DecorationService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">B</span><span class="s0">.</span><span class="s1">IDecorationService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkProviderService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">O</span><span class="s0">.</span><span class="s1">LinkProviderService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">S</span><span class="s0">.</span><span class="s1">ILinkProviderService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkProviderService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkProviderService</span><span class="s0">.</span><span class="s1">registerLinkProvider</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">a</span><span class="s0">.</span><span class="s1">OscLinkProvider</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onRequestBell</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBell</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onRequestRefreshRows</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onRequestSendFocus</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_reportFocus</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onRequestReset</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onRequestWindowsOptionsReport</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_reportWindowsOptions</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onColor</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleColorEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">y</span><span class="s0">.</span><span class="s1">forwardEvent</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onCursorMove</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onCursorMove</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">y</span><span class="s0">.</span><span class="s1">forwardEvent</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onTitleChange</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onTitleChange</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">y</span><span class="s0">.</span><span class="s1">forwardEvent</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onA11yChar</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onA11yCharEmitter</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">y</span><span class="s0">.</span><span class="s1">forwardEvent</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onA11yTab</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onA11yTabEmitter</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">onResize</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_afterResize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">E</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customKeyEventHandler</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">?.</span><span class="s1">parentNode</span><span class="s0">?.</span><span class="s1">removeChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">)})))}</span><span class="s1">_handleColorEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t of e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">index</span><span class="s0">){</span><span class="s4">case </span><span class="s3">256</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=</span><span class="s2">&quot;foreground&quot;</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s2">&quot;10&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">257</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=</span><span class="s2">&quot;background&quot;</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s2">&quot;11&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">258</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=</span><span class="s2">&quot;cursor&quot;</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s2">&quot;12&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">default</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=</span><span class="s2">&quot;ansi&quot;</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s2">&quot;4;&quot;</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">index</span><span class="s0">}</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">type</span><span class="s0">){</span><span class="s4">case </span><span class="s3">0</span><span class="s0">:</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">b</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">toColorRGB</span><span class="s0">(</span><span class="s2">&quot;ansi&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">.</span><span class="s1">colors</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s1">t</span><span class="s0">.</span><span class="s1">index</span><span class="s0">]:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">.</span><span class="s1">colors</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">D</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">}</span><span class="s2">]</span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">}</span><span class="s2">;</span><span class="s1">$</span><span class="s0">{(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">x</span><span class="s0">.</span><span class="s1">toRgbString</span><span class="s0">)(</span><span class="s1">s</span><span class="s0">)}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">D</span><span class="s0">.</span><span class="s1">C1_ESCAPED</span><span class="s0">.</span><span class="s1">ST</span><span class="s0">}</span><span class="s2">`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;ansi&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">.</span><span class="s1">modifyColors</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s1">t</span><span class="s0">.</span><span class="s1">index</span><span class="s0">]=</span><span class="s1">b</span><span class="s0">.</span><span class="s1">channels</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s1">...t</span><span class="s0">.</span><span class="s1">color</span><span class="s0">)));</span><span class="s4">else</span><span class="s0">{</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">.</span><span class="s1">modifyColors</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]=</span><span class="s1">b</span><span class="s0">.</span><span class="s1">channels</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s1">...t</span><span class="s0">.</span><span class="s1">color</span><span class="s0">)))}</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">2</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">.</span><span class="s1">restoreColor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">index</span><span class="s0">)}}}</span><span class="s1">_setup</span><span class="s0">(){</span><span class="s4">super</span><span class="s0">.</span><span class="s1">_setup</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customKeyEventHandler</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">}</span><span class="s1">get buffer</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">}</span><span class="s1">focus</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">focus</span><span class="s0">({</span><span class="s1">preventScroll</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">})}</span><span class="s1">_handleScreenReaderModeOptionChange</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">e</span><span class="s0">?!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_accessibilityManager</span><span class="s0">.</span><span class="s1">value</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_accessibilityManager</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">M</span><span class="s0">.</span><span class="s1">AccessibilityManager</span><span class="s0">,</span><span class="s4">this</span><span class="s0">)):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_accessibilityManager</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">()}</span><span class="s1">_handleTextAreaFocus</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">sendFocus</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">D</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[I&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;focus&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_showCursor</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onFocus</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">()}</span><span class="s1">blur</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">?.</span><span class="s1">blur</span><span class="s0">()}</span><span class="s1">_handleTextAreaBlur</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">sendFocus</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">D</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[O&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(</span><span class="s2">&quot;focus&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBlur</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">()}</span><span class="s1">_syncTextArea</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">||!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">isCursorInViewport</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionHelper</span><span class="s0">.</span><span class="s1">isComposing</span><span class="s0">||!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">*</span><span class="s1">r</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">left</span><span class="s0">=</span><span class="s1">a</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">top</span><span class="s0">=</span><span class="s1">o</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s1">n</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s1">s</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">lineHeight</span><span class="s0">=</span><span class="s1">s</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">zIndex</span><span class="s0">=</span><span class="s2">&quot;-5&quot;</span><span class="s0">}</span><span class="s1">_initGlobal</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bindKeys</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">,</span><span class="s2">&quot;copy&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">hasSelection</span><span class="s0">()&amp;&amp;(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">copyHandler</span><span class="s0">)(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">)})));</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">handlePasteEvent</span><span class="s0">)(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s2">&quot;paste&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">,</span><span class="s2">&quot;paste&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)),</span><span class="s1">k</span><span class="s0">.</span><span class="s1">isFirefox</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">,</span><span class="s2">&quot;mousedown&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s3">2</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&amp;&amp;(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">rightClickHandler</span><span class="s0">)(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">rightClickSelectsWord</span><span class="s0">)}))):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">,</span><span class="s2">&quot;contextmenu&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">rightClickHandler</span><span class="s0">)(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">rightClickSelectsWord</span><span class="s0">)}))),</span><span class="s1">k</span><span class="s0">.</span><span class="s1">isLinux</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">,</span><span class="s2">&quot;auxclick&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s3">1</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&amp;&amp;(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">moveTextAreaUnderMouseCursor</span><span class="s0">)(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">)})))}</span><span class="s1">_bindKeys</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s2">&quot;keyup&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyUp</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)),!</span><span class="s3">0</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s2">&quot;keydown&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyDown</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)),!</span><span class="s3">0</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s2">&quot;keypress&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyPress</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)),!</span><span class="s3">0</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s2">&quot;compositionstart&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionHelper</span><span class="s0">.</span><span class="s1">compositionstart</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s2">&quot;compositionupdate&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionHelper</span><span class="s0">.</span><span class="s1">compositionupdate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s2">&quot;compositionend&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionHelper</span><span class="s0">.</span><span class="s1">compositionend</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s2">&quot;input&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)),!</span><span class="s3">0</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRender</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionHelper</span><span class="s0">.</span><span class="s1">updateCompositionElements</span><span class="s0">())))}</span><span class="s1">open</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;Terminal requires a parent element.&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isConnected</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Terminal.open was called on an element that was not attached to the DOM&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">?.</span><span class="s1">ownerDocument</span><span class="s0">.</span><span class="s1">defaultView</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">)</span><span class="s4">return void</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">ownerDocument</span><span class="s0">.</span><span class="s1">defaultView</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">ownerDocument</span><span class="s0">.</span><span class="s1">defaultView</span><span class="s0">));</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ownerDocument</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">documentOverride</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">documentOverride </span><span class="s4">instanceof </span><span class="s1">Document</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">documentOverride</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">dir</span><span class="s0">=</span><span class="s2">&quot;ltr&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;terminal&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm&quot;</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">);</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createDocumentFragment</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-viewport&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportScrollArea</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportScrollArea</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-scroll-area&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportScrollArea</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-screen&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">,</span><span class="s2">&quot;mousemove&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateCursorStyle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_helperContainer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_helperContainer</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-helpers&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_helperContainer</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;textarea&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-helper-textarea&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-label&quot;</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">promptLabel</span><span class="s0">),</span><span class="s1">k</span><span class="s0">.</span><span class="s1">isChromeOS</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-multiline&quot;</span><span class="s0">,</span><span class="s2">&quot;false&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;autocorrect&quot;</span><span class="s0">,</span><span class="s2">&quot;off&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;autocapitalize&quot;</span><span class="s0">,</span><span class="s2">&quot;off&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;spellcheck&quot;</span><span class="s0">,</span><span class="s2">&quot;false&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">tabIndex</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">v</span><span class="s0">.</span><span class="s1">CoreBrowserService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ownerDocument</span><span class="s0">.</span><span class="s1">defaultView</span><span class="s0">??</span><span class="s1">window</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">??</span><span class="s2">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s4">typeof </span><span class="s1">window</span><span class="s0">?</span><span class="s1">window</span><span class="s0">.</span><span class="s1">document</span><span class="s0">:</span><span class="s4">null</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">S</span><span class="s0">.</span><span class="s1">ICoreBrowserService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s2">&quot;focus&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleTextAreaFocus</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s2">&quot;blur&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleTextAreaBlur</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_helperContainer</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">u</span><span class="s0">.</span><span class="s1">CharSizeService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_helperContainer</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">S</span><span class="s0">.</span><span class="s1">ICharSizeService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">C</span><span class="s0">.</span><span class="s1">ThemeService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">S</span><span class="s0">.</span><span class="s1">IThemeService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoinerService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">f</span><span class="s0">.</span><span class="s1">CharacterJoinerService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">S</span><span class="s0">.</span><span class="s1">ICharacterJoinerService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoinerService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">g</span><span class="s0">.</span><span class="s1">RenderService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">S</span><span class="s0">.</span><span class="s1">IRenderService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">onRenderedViewportChange</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRender</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onResize</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;composition-view&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionHelper</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">d</span><span class="s0">.</span><span class="s1">CompositionHelper</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_helperContainer</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">p</span><span class="s0">.</span><span class="s1">MouseService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">S</span><span class="s0">.</span><span class="s1">IMouseService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">linkifier</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">Linkifier</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">try</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onWillOpen</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">{}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">hasRenderer</span><span class="s0">()||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">setRenderer</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createRenderer</span><span class="s0">()),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">h</span><span class="s0">.</span><span class="s1">Viewport</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportScrollArea</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">.</span><span class="s1">onRequestScrollLines</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">amount</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">suppressScrollEvent</span><span class="s0">,</span><span class="s3">1</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onRequestSyncScrollBar</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">.</span><span class="s1">syncScrollArea</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onCursorMove</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">handleCursorMove</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_syncTextArea</span><span class="s0">()}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onResize</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">handleResize</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onBlur</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">handleBlur</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onFocus</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">handleFocus</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">onDimensionsChange</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">.</span><span class="s1">syncScrollArea</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">m</span><span class="s0">.</span><span class="s1">SelectionService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">linkifier</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">S</span><span class="s0">.</span><span class="s1">ISelectionService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">onRequestScrollLines</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">amount</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">suppressScrollEvent</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">onSelectionChange</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onSelectionChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">onRequestRedraw</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">handleSelectionChanged</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">end</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">columnSelectMode</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">onLinuxMouseSelection</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">focus</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">select</span><span class="s0">()}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">.</span><span class="s1">event</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">.</span><span class="s1">syncScrollArea</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">()}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">,</span><span class="s2">&quot;scroll&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">c</span><span class="s0">.</span><span class="s1">BufferDecorationRenderer</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">,</span><span class="s2">&quot;mousedown&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">handleMouseDown</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">.</span><span class="s1">areMouseEventsActive</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">disable</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;enable-mouse-events&quot;</span><span class="s0">)):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">enable</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">screenReaderMode</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_accessibilityManager</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">M</span><span class="s0">.</span><span class="s1">AccessibilityManager</span><span class="s0">,</span><span class="s4">this</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">.</span><span class="s1">onSpecificOptionChange</span><span class="s0">(</span><span class="s2">&quot;screenReaderMode&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleScreenReaderModeOptionChange</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerWidth</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_overviewRulerRenderer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">OverviewRulerRenderer</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">.</span><span class="s1">onSpecificOptionChange</span><span class="s0">(</span><span class="s2">&quot;overviewRulerWidth&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_overviewRulerRenderer</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_overviewRulerRenderer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">OverviewRulerRenderer</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">)))})),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">.</span><span class="s1">measure</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_initGlobal</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bindMouse</span><span class="s0">()}</span><span class="s1">_createRenderer</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">_</span><span class="s0">.</span><span class="s1">DomRenderer</span><span class="s0">,</span><span class="s4">this</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_helperContainer</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">linkifier</span><span class="s0">)}</span><span class="s1">bindMouse</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">;</span><span class="s4">function </span><span class="s1">i</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_mouseService</span><span class="s0">.</span><span class="s1">getMouseReportCoords</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">screenElement</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">;</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">overrideType</span><span class="s0">||</span><span class="s1">t</span><span class="s0">.</span><span class="s1">type</span><span class="s0">){</span><span class="s4">case</span><span class="s2">&quot;mousemove&quot;</span><span class="s0">:</span><span class="s1">r</span><span class="s0">=</span><span class="s3">32</span><span class="s0">,</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buttons</span><span class="s0">?(</span><span class="s1">s</span><span class="s0">=</span><span class="s3">3</span><span class="s0">,</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">.</span><span class="s1">button</span><span class="s0">:</span><span class="s3">3</span><span class="s0">)):</span><span class="s1">s</span><span class="s0">=</span><span class="s3">1</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buttons</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s3">4</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buttons</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">2</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buttons</span><span class="s0">?</span><span class="s3">2</span><span class="s0">:</span><span class="s3">3</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;mouseup&quot;</span><span class="s0">:</span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">.</span><span class="s1">button</span><span class="s0">:</span><span class="s3">3</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;mousedown&quot;</span><span class="s0">:</span><span class="s1">r</span><span class="s0">=</span><span class="s3">1</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">.</span><span class="s1">button</span><span class="s0">:</span><span class="s3">3</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;wheel&quot;</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_customWheelEventHandler</span><span class="s0">&amp;&amp;!</span><span class="s3">1</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_customWheelEventHandler</span><span class="s0">(</span><span class="s1">t</span><span class="s0">))</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">.</span><span class="s1">getLinesScrolled</span><span class="s0">(</span><span class="s1">t</span><span class="s0">))</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">deltaY</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s3">1</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s3">4</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">default</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return</span><span class="s0">!(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">r</span><span class="s0">||</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">s</span><span class="s0">||</span><span class="s1">s</span><span class="s0">&gt;</span><span class="s3">4</span><span class="s0">)&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">.</span><span class="s1">triggerMouseEvent</span><span class="s0">({</span><span class="s1">col</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">col</span><span class="s0">,</span><span class="s1">row</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">row</span><span class="s0">,</span><span class="s1">x</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">y</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s1">button</span><span class="s0">:</span><span class="s1">s</span><span class="s0">,</span><span class="s1">action</span><span class="s0">:</span><span class="s1">r</span><span class="s0">,</span><span class="s1">ctrl</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">,</span><span class="s1">alt</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">,</span><span class="s1">shift</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">})}</span><span class="s4">const </span><span class="s1">s</span><span class="s0">={</span><span class="s1">mouseup</span><span class="s0">:</span><span class="s4">null</span><span class="s0">,</span><span class="s1">wheel</span><span class="s0">:</span><span class="s4">null</span><span class="s0">,</span><span class="s1">mousedrag</span><span class="s0">:</span><span class="s4">null</span><span class="s0">,</span><span class="s1">mousemove</span><span class="s0">:</span><span class="s4">null</span><span class="s0">},</span><span class="s1">n</span><span class="s0">={</span><span class="s1">mouseup</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;(</span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buttons</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">removeEventListener</span><span class="s0">(</span><span class="s2">&quot;mouseup&quot;</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mouseup</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mousedrag</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">removeEventListener</span><span class="s0">(</span><span class="s2">&quot;mousemove&quot;</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mousedrag</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)),</span><span class="s1">wheel</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;(</span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)),</span><span class="s1">mousedrag</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buttons</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)},</span><span class="s1">mousemove</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buttons</span><span class="s0">||</span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}};</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">.</span><span class="s1">onProtocolChange</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s1">e</span><span class="s0">?(</span><span class="s2">&quot;debug&quot;</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">logLevel</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Binding to mouse events:&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">.</span><span class="s1">explainEvents</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;enable-mouse-events&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">disable</span><span class="s0">()):(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Unbinding from mouse events.&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(</span><span class="s2">&quot;enable-mouse-events&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">enable</span><span class="s0">()),</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mousemove</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;mousemove&quot;</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">mousemove</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mousemove</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">mousemove</span><span class="s0">):(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">removeEventListener</span><span class="s0">(</span><span class="s2">&quot;mousemove&quot;</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mousemove</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mousemove</span><span class="s0">=</span><span class="s4">null</span><span class="s0">),</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">wheel</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;wheel&quot;</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">wheel</span><span class="s0">,{</span><span class="s1">passive</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">}),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">wheel</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">wheel</span><span class="s0">):(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">removeEventListener</span><span class="s0">(</span><span class="s2">&quot;wheel&quot;</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">wheel</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">wheel</span><span class="s0">=</span><span class="s4">null</span><span class="s0">),</span><span class="s3">2</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mouseup</span><span class="s0">||(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mouseup</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">mouseup</span><span class="s0">):(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">removeEventListener</span><span class="s0">(</span><span class="s2">&quot;mouseup&quot;</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mouseup</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mouseup</span><span class="s0">=</span><span class="s4">null</span><span class="s0">),</span><span class="s3">4</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mousedrag</span><span class="s0">||(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mousedrag</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">mousedrag</span><span class="s0">):(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">removeEventListener</span><span class="s0">(</span><span class="s2">&quot;mousemove&quot;</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mousedrag</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mousedrag</span><span class="s0">=</span><span class="s4">null</span><span class="s0">)}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">.</span><span class="s1">activeProtocol</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">.</span><span class="s1">activeProtocol</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;mousedown&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">preventDefault</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">focus</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">.</span><span class="s1">areMouseEventsActive</span><span class="s0">&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">shouldForceSelection</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))</span><span class="s4">return </span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mouseup</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;mouseup&quot;</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mouseup</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mousedrag</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;mousemove&quot;</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">mousedrag</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;wheel&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">.</span><span class="s1">wheel</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customWheelEventHandler</span><span class="s0">&amp;&amp;!</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customWheelEventHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">hasScrollback</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">.</span><span class="s1">getLinesScrolled</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">D</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">applicationCursorKeys</span><span class="s0">?</span><span class="s2">&quot;O&quot;</span><span class="s0">:</span><span class="s2">&quot;[&quot;</span><span class="s0">)+(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">deltaY</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s2">&quot;A&quot;</span><span class="s0">:</span><span class="s2">&quot;B&quot;</span><span class="s0">);</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">abs</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s1">e</span><span class="s0">++)</span><span class="s1">s</span><span class="s0">+=</span><span class="s1">i</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">.</span><span class="s1">handleWheel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">):</span><span class="s4">void </span><span class="s3">0</span><span class="s0">}}),{</span><span class="s1">passive</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">})),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;touchstart&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">.</span><span class="s1">areMouseEventsActive</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">.</span><span class="s1">handleTouchStart</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}),{</span><span class="s1">passive</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">})),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;touchmove&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">.</span><span class="s1">areMouseEventsActive</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">.</span><span class="s1">handleTouchMove</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)?</span><span class="s4">void </span><span class="s3">0</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}),{</span><span class="s1">passive</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">}))}</span><span class="s1">refresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">?.</span><span class="s1">refreshRows</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">updateCursorStyle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">?.</span><span class="s1">shouldColumnSelect</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;column-select&quot;</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(</span><span class="s2">&quot;column-select&quot;</span><span class="s0">)}</span><span class="s1">_showCursor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">isCursorInitialized</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">isCursorInitialized</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">))}</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">){</span><span class="s3">1</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?(</span><span class="s4">super</span><span class="s0">.</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">?.</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">paste</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">paste</span><span class="s0">)(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">)}</span><span class="s1">attachCustomKeyEventHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customKeyEventHandler</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">attachCustomWheelEventHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customWheelEventHandler</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">registerLinkProvider</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_linkProviderService</span><span class="s0">.</span><span class="s1">registerLinkProvider</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">registerCharacterJoiner</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoinerService</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;Terminal must be opened first&quot;</span><span class="s0">);</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoinerService</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">t</span><span class="s0">}</span><span class="s1">deregisterCharacterJoiner</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoinerService</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;Terminal must be opened first&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoinerService</span><span class="s0">.</span><span class="s1">deregister</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">get markers</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">}</span><span class="s1">registerMarker</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">addMarker</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">+</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">registerDecoration</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">.</span><span class="s1">registerDecoration</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">hasSelection</span><span class="s0">(){</span><span class="s4">return</span><span class="s0">!!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">hasSelection</span><span class="s0">}</span><span class="s1">select</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">setSelection</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">getSelection</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">selectionText</span><span class="s0">:</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s1">getSelectionPosition</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">hasSelection</span><span class="s0">)</span><span class="s4">return</span><span class="s0">{</span><span class="s1">start</span><span class="s0">:{</span><span class="s1">x</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">y</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]},</span><span class="s1">end</span><span class="s0">:{</span><span class="s1">x</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">y</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]}}}</span><span class="s1">clearSelection</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">?.</span><span class="s1">clearSelection</span><span class="s0">()}</span><span class="s1">selectAll</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">?.</span><span class="s1">selectAll</span><span class="s0">()}</span><span class="s1">selectLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">?.</span><span class="s1">selectLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">_keyDown</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyDownHandled</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyDownSeen</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customKeyEventHandler</span><span class="s0">&amp;&amp;!</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customKeyEventHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">browser</span><span class="s0">.</span><span class="s1">isMac</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">macOptionIsMeta</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionHelper</span><span class="s0">.</span><span class="s1">keydown</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">scrollOnUserInput</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollToBottom</span><span class="s0">(),!</span><span class="s3">1</span><span class="s0">;</span><span class="s1">t</span><span class="s0">||</span><span class="s2">&quot;Dead&quot;</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;AltGraph&quot;</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_unprocessedDeadKey</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">);</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">R</span><span class="s0">.</span><span class="s1">evaluateKeyboardEvent</span><span class="s0">)(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">applicationCursorKeys</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">browser</span><span class="s0">.</span><span class="s1">isMac</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">macOptionIsMeta</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateCursorStyle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s3">3</span><span class="s0">===</span><span class="s1">i</span><span class="s0">.</span><span class="s1">type</span><span class="s0">||</span><span class="s3">2</span><span class="s0">===</span><span class="s1">i</span><span class="s0">.</span><span class="s1">type</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s3">2</span><span class="s0">===</span><span class="s1">i</span><span class="s0">.</span><span class="s1">type</span><span class="s0">?-</span><span class="s1">t</span><span class="s0">:</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">return </span><span class="s3">1</span><span class="s0">===</span><span class="s1">i</span><span class="s0">.</span><span class="s1">type</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectAll</span><span class="s0">(),!!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isThirdLevelShift</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">browser</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)||(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">),!</span><span class="s1">i</span><span class="s0">.</span><span class="s1">key</span><span class="s0">||!!(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">&amp;&amp;!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">&amp;&amp;!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">&amp;&amp;!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">&amp;&amp;</span><span class="s3">1</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)&gt;=</span><span class="s3">65</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)&lt;=</span><span class="s3">90</span><span class="s0">)||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_unprocessedDeadKey</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_unprocessedDeadKey</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">):(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">key</span><span class="s0">!==</span><span class="s1">D</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ETX</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">key</span><span class="s0">!==</span><span class="s1">D</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">CR</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onKey</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">key</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">key</span><span class="s0">,</span><span class="s1">domEvent</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_showCursor</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">key</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">),!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">screenReaderMode</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">):</span><span class="s4">void</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyDownHandled</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">))))}</span><span class="s1">_isThirdLevelShift</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isMac</span><span class="s0">&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">macOptionIsMeta</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">&amp;&amp;!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">&amp;&amp;!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isWindows</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">&amp;&amp;!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isWindows</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getModifierState</span><span class="s0">(</span><span class="s2">&quot;AltGraph&quot;</span><span class="s0">);</span><span class="s4">return</span><span class="s2">&quot;keypress&quot;</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">type</span><span class="s0">?</span><span class="s1">i</span><span class="s0">:</span><span class="s1">i</span><span class="s0">&amp;&amp;(!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">||</span><span class="s1">t</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">&gt;</span><span class="s3">47</span><span class="s0">)}</span><span class="s1">_keyUp</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyDownSeen</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customKeyEventHandler</span><span class="s0">&amp;&amp;!</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customKeyEventHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)||(</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">16</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">||</span><span class="s3">17</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">||</span><span class="s3">18</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">}(</span><span class="s1">e</span><span class="s0">)||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">focus</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateCursorStyle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyPressHandled</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">_keyPress</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyPressHandled</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyDownHandled</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customKeyEventHandler</span><span class="s0">&amp;&amp;!</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customKeyEventHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCode</span><span class="s0">)</span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCode</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(</span><span class="s4">null</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">which</span><span class="s0">||</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">which</span><span class="s0">)</span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">;</span><span class="s4">else</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">which</span><span class="s0">||</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCode</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">which</span><span class="s0">}</span><span class="s4">return</span><span class="s0">!(!</span><span class="s1">t</span><span class="s0">||(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">)&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isThirdLevelShift</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">browser</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)||(</span><span class="s1">t</span><span class="s0">=</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onKey</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">key</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">domEvent</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_showCursor</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyPressHandled</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_unprocessedDeadKey</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">))}</span><span class="s1">_inputEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">data</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;insertText&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">inputType</span><span class="s0">&amp;&amp;(!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">composed</span><span class="s0">||!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyDownSeen</span><span class="s0">)&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">screenReaderMode</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_keyPressHandled</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_unprocessedDeadKey</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">data</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s1">e</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">||</span><span class="s1">t</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">?</span><span class="s4">super</span><span class="s0">.</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">.</span><span class="s1">hasValidSize</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">.</span><span class="s1">measure</span><span class="s0">()}</span><span class="s1">_afterResize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">?.</span><span class="s1">measure</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">?.</span><span class="s1">syncScrollArea</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">||</span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">clearAllMarkers</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">;</span><span class="s1">e</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">getBlankLine</span><span class="s0">(</span><span class="s1">L</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">));</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">position</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">,</span><span class="s1">source</span><span class="s0">:</span><span class="s3">0</span><span class="s0">}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">?.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)}}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customKeyEventHandler</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setup</span><span class="s0">(),</span><span class="s4">super</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionService</span><span class="s0">?.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewport</span><span class="s0">?.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_customKeyEventHandler</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">clearTextureAtlas</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">?.</span><span class="s1">clearTextureAtlas</span><span class="s0">()}</span><span class="s1">_reportFocus</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">element</span><span class="s0">?.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">contains</span><span class="s0">(</span><span class="s2">&quot;focus&quot;</span><span class="s0">)?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">D</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[I&quot;</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">D</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[O&quot;</span><span class="s0">)}</span><span class="s1">_reportWindowsOptions</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">)</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">case </span><span class="s1">T</span><span class="s0">.</span><span class="s1">WindowsOptionsReportType</span><span class="s0">.</span><span class="s1">GET_WIN_SIZE_PIXELS</span><span class="s0">:</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">.</span><span class="s1">toFixed</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">.</span><span class="s1">toFixed</span><span class="s0">(</span><span class="s3">0</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">D</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">}</span><span class="s2">[4;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">}</span><span class="s2">;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">t`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s1">T</span><span class="s0">.</span><span class="s1">WindowsOptionsReportType</span><span class="s0">.</span><span class="s1">GET_CELL_SIZE_PIXELS</span><span class="s0">:</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">.</span><span class="s1">toFixed</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">.</span><span class="s1">toFixed</span><span class="s0">(</span><span class="s3">0</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">D</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">}</span><span class="s2">[6;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">s</span><span class="s0">}</span><span class="s2">;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">}</span><span class="s2">t`</span><span class="s0">)}}</span><span class="s1">cancel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">cancelEvents</span><span class="s0">||</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">preventDefault</span><span class="s0">(),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">stopPropagation</span><span class="s0">(),!</span><span class="s3">1</span><span class="s0">}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Terminal</span><span class="s0">=</span><span class="s1">P</span><span class="s0">},</span><span class="s3">9924</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">TimeBasedDebouncer</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">TimeBasedDebouncer</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s3">1e3</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderCallback</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_debounceThresholdMS</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRefreshMs</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_additionalRefreshRequested</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshTimeoutID</span><span class="s0">&amp;&amp;</span><span class="s1">clearTimeout</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshTimeoutID</span><span class="s0">)}</span><span class="s1">refresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">?</span><span class="s1">e</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowStart</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowStart</span><span class="s0">?</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowStart</span><span class="s0">,</span><span class="s1">e</span><span class="s0">):</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowEnd</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowEnd</span><span class="s0">?</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowEnd</span><span class="s0">,</span><span class="s1">t</span><span class="s0">):</span><span class="s1">t</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRefreshMs</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_debounceThresholdMS</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRefreshMs</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_innerRefresh</span><span class="s0">();</span><span class="s4">else if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_additionalRefreshRequested</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">s</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRefreshMs</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_debounceThresholdMS</span><span class="s0">-</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_additionalRefreshRequested</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshTimeoutID</span><span class="s0">=</span><span class="s1">window</span><span class="s0">.</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRefreshMs</span><span class="s0">=</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_innerRefresh</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_additionalRefreshRequested</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshTimeoutID</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">)}}</span><span class="s1">_innerRefresh</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowStart</span><span class="s0">||</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowEnd</span><span class="s0">||</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowStart</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">t</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowEnd</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowStart</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowEnd</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderCallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}}},</span><span class="s3">1680</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Viewport</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3656</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4725</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">);</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Viewport</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">h</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">h</span><span class="s0">,</span><span class="s1">c</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_scrollArea</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">=</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">=</span><span class="s1">o</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">=</span><span class="s1">h</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollBarWidth</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentRowHeight</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentDeviceCellHeight</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedBufferLength</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedViewportHeight</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedBufferHeight</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastTouchY</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastScrollTop</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_wheelPartialScroll</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshAnimationFrame</span><span class="s0">=</span><span class="s4">null</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ignoreNextScrollEvent</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">={</span><span class="s1">startTime</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">origin</span><span class="s0">:-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">target</span><span class="s0">:-</span><span class="s3">1</span><span class="s0">},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestScrollLines</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">a</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRequestScrollLines</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestScrollLines</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollBarWidth</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">offsetWidth</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_scrollArea</span><span class="s0">.</span><span class="s1">offsetWidth</span><span class="s0">||</span><span class="s3">15</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">,</span><span class="s2">&quot;scroll&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleScroll</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">onBufferActivate</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">activeBuffer</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderDimensions</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">onDimensionsChange</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderDimensions</span><span class="s0">=</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleThemeChange</span><span class="s0">(</span><span class="s1">c</span><span class="s0">.</span><span class="s1">colors</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">c</span><span class="s0">.</span><span class="s1">onChangeColors</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleThemeChange</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">onSpecificOptionChange</span><span class="s0">(</span><span class="s2">&quot;scrollback&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">syncScrollArea</span><span class="s0">()))),</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">syncScrollArea</span><span class="s0">()))}</span><span class="s1">_handleThemeChange</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">backgroundColor</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">background</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentRowHeight</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentDeviceCellHeight</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedBufferLength</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedViewportHeight</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedBufferHeight</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastTouchY</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastScrollTop</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">.</span><span class="s1">requestAnimationFrame</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">syncScrollArea</span><span class="s0">()))}</span><span class="s1">_refresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_innerRefresh</span><span class="s0">(),</span><span class="s4">void</span><span class="s0">(</span><span class="s4">null</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshAnimationFrame</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">.</span><span class="s1">cancelAnimationFrame</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshAnimationFrame</span><span class="s0">));</span><span class="s4">null</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshAnimationFrame</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshAnimationFrame</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">.</span><span class="s1">requestAnimationFrame</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_innerRefresh</span><span class="s0">())))}</span><span class="s1">_innerRefresh</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">.</span><span class="s1">height</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentRowHeight</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderDimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">dpr</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentDeviceCellHeight</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderDimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedViewportHeight</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">offsetHeight</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentRowHeight</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedBufferLength</span><span class="s0">)+(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedViewportHeight</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderDimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedBufferHeight</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedBufferHeight</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_scrollArea</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedBufferHeight</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">)}</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentRowHeight</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ignoreNextScrollEvent</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">=</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshAnimationFrame</span><span class="s0">=</span><span class="s4">null</span><span class="s0">}</span><span class="s1">syncScrollArea</span><span class="s0">(</span><span class="s1">e</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedBufferLength</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_lastRecordedBufferLength</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s4">void this</span><span class="s0">.</span><span class="s1">_refresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedViewportHeight</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastScrollTop</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentRowHeight</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderDimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentDeviceCellHeight</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">_handleScroll</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastScrollTop</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">offsetParent</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ignoreNextScrollEvent</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_ignoreNextScrollEvent</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">void this</span><span class="s0">.</span><span class="s1">_onRequestScrollLines</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">amount</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">suppressScrollEvent</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">});</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastScrollTop</span><span class="s0">/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentRowHeight</span><span class="s0">)-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestScrollLines</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">amount</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">suppressScrollEvent</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">})}</span><span class="s1">_smoothScroll</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isDisposed</span><span class="s0">||-</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">||-</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">target</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollPercent</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s1">e</span><span class="s0">*(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">target</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">)),</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">1</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">.</span><span class="s1">requestAnimationFrame</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScroll</span><span class="s0">())):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_clearSmoothScrollState</span><span class="s0">()}</span><span class="s1">_smoothScrollPercent</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">smoothScrollDuration</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">startTime</span><span class="s0">?</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">((</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">()-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">startTime</span><span class="s0">)/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">smoothScrollDuration</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s3">0</span><span class="s0">):</span><span class="s3">1</span><span class="s0">}</span><span class="s1">_clearSmoothScrollState</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">startTime</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">target</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">}</span><span class="s1">_bubbleScroll</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedViewportHeight</span><span class="s0">;</span><span class="s4">return</span><span class="s0">!(</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">||</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastRecordedBufferHeight</span><span class="s0">)||(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cancelable</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">preventDefault</span><span class="s0">(),!</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">handleWheel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getPixelsScrolled</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">smoothScrollDuration</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">startTime</span><span class="s0">=</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollPercent</span><span class="s0">()&lt;</span><span class="s3">1</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">target</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">target</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">+</span><span class="s1">t</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">target</span><span class="s0">+=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">target</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">target</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollHeight</span><span class="s0">),</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScroll</span><span class="s0">()):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_clearSmoothScrollState</span><span class="s0">()):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">+=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bubbleScroll</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">))}</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">smoothScrollDuration</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentRowHeight</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">startTime</span><span class="s0">=</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollPercent</span><span class="s0">()&lt;</span><span class="s3">1</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">target</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">+</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">target</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScrollState</span><span class="s0">.</span><span class="s1">target</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollHeight</span><span class="s0">),</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_smoothScroll</span><span class="s0">()):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_clearSmoothScrollState</span><span class="s0">()}</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">_onRequestScrollLines</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">amount</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">suppressScrollEvent</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">})}</span><span class="s1">_getPixelsScrolled</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">deltaY</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">)</span><span class="s4">return </span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_applyScrollModifier</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">deltaY</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">deltaMode</span><span class="s0">===</span><span class="s1">WheelEvent</span><span class="s0">.</span><span class="s1">DOM_DELTA_LINE</span><span class="s0">?</span><span class="s1">t</span><span class="s0">*=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentRowHeight</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">deltaMode</span><span class="s0">===</span><span class="s1">WheelEvent</span><span class="s0">.</span><span class="s1">DOM_DELTA_PAGE</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">*=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentRowHeight</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">),</span><span class="s1">t</span><span class="s0">}</span><span class="s1">getBufferElements</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=[],</span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">??</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&lt;</span><span class="s1">n</span><span class="s0">;</span><span class="s1">a</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">a</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)?.</span><span class="s1">isWrapped</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">translateToString</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">),!</span><span class="s1">t</span><span class="s0">||</span><span class="s1">a</span><span class="s0">===</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">}}</span><span class="s4">return</span><span class="s0">{</span><span class="s1">bufferElements</span><span class="s0">:</span><span class="s1">r</span><span class="s0">,</span><span class="s1">cursorElement</span><span class="s0">:</span><span class="s1">i</span><span class="s0">}}</span><span class="s1">getLinesScrolled</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">deltaY</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">)</span><span class="s4">return </span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_applyScrollModifier</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">deltaY</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">deltaMode</span><span class="s0">===</span><span class="s1">WheelEvent</span><span class="s0">.</span><span class="s1">DOM_DELTA_PIXEL</span><span class="s0">?(</span><span class="s1">t</span><span class="s0">/=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentRowHeight</span><span class="s0">+</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_wheelPartialScroll</span><span class="s0">+=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">abs</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_wheelPartialScroll</span><span class="s0">))*(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_wheelPartialScroll</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:-</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_wheelPartialScroll</span><span class="s0">%=</span><span class="s3">1</span><span class="s0">):</span><span class="s1">e</span><span class="s0">.</span><span class="s1">deltaMode</span><span class="s0">===</span><span class="s1">WheelEvent</span><span class="s0">.</span><span class="s1">DOM_DELTA_PAGE</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">*=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">),</span><span class="s1">t</span><span class="s0">}</span><span class="s1">_applyScrollModifier</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fastScrollModifier</span><span class="s0">;</span><span class="s4">return</span><span class="s2">&quot;alt&quot;</span><span class="s0">===</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">||</span><span class="s2">&quot;ctrl&quot;</span><span class="s0">===</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">||</span><span class="s2">&quot;shift&quot;</span><span class="s0">===</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">?</span><span class="s1">e</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fastScrollSensitivity</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">scrollSensitivity</span><span class="s0">:</span><span class="s1">e</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">scrollSensitivity</span><span class="s0">}</span><span class="s1">handleTouchStart</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastTouchY</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">touches</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">pageY</span><span class="s0">}</span><span class="s1">handleTouchMove</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastTouchY</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">touches</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">pageY</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_lastTouchY</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">touches</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">pageY</span><span class="s0">,</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">+=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bubbleScroll</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">))}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Viewport</span><span class="s0">=</span><span class="s1">l</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">4</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">ICharSizeService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">5</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">IRenderService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">6</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">ICoreBrowserService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">7</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">IThemeService</span><span class="s0">)],</span><span class="s1">l</span><span class="s0">)},</span><span class="s3">3107</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferDecorationRenderer</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4725</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">);</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferDecorationRenderer</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">o</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">=</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationElements</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Map</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_altBufferIsActive</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dimensionsChanged</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">=</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-decoration-container&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">onRenderedViewportChange</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_doRefreshDecorations</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">onDimensionsChange</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dimensionsChanged</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queueRefresh</span><span class="s0">()}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">onDprChange</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queueRefresh</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">onBufferActivate</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_altBufferIsActive</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">alt</span><span class="s0">}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">.</span><span class="s1">onDecorationRegistered</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queueRefresh</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">.</span><span class="s1">onDecorationRemoved</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_removeDecoration</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationElements</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">()})))}</span><span class="s1">_queueRefresh</span><span class="s0">(){</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">addRefreshCallback</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_doRefreshDecorations</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">})))}</span><span class="s1">_doRefreshDecorations</span><span class="s0">(){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">e of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderDecoration</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dimensionsChanged</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">_renderDecoration</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshStyle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dimensionsChanged</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshXPosition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">_createElement</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">mainDocument</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-decoration&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">toggle</span><span class="s0">(</span><span class="s2">&quot;xterm-decoration-top-layer&quot;</span><span class="s0">,</span><span class="s2">&quot;top&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">?.</span><span class="s1">options</span><span class="s0">?.</span><span class="s1">layer</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">((</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">width</span><span class="s0">||</span><span class="s3">1</span><span class="s0">)*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">)}</span><span class="s2">px`</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">height</span><span class="s0">||</span><span class="s3">1</span><span class="s0">)*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">top</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">.</span><span class="s1">line</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">)*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">lineHeight</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">x</span><span class="s0">??</span><span class="s3">0</span><span class="s0">;</span><span class="s4">return </span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">display</span><span class="s0">=</span><span class="s2">&quot;none&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshXPosition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">t</span><span class="s0">}</span><span class="s1">_refreshStyle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">.</span><span class="s1">line</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">element</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">element</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">display</span><span class="s0">=</span><span class="s2">&quot;none&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">onRenderEmitter</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">element</span><span class="s0">));</span><span class="s4">else</span><span class="s0">{</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationElements</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s1">i</span><span class="s0">||(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createElement</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">element</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationElements</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">onDispose</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationElements</span><span class="s0">.</span><span class="s1">delete</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">()}))),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">top</span><span class="s0">=</span><span class="s1">t</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">display</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_altBufferIsActive</span><span class="s0">?</span><span class="s2">&quot;none&quot;</span><span class="s0">:</span><span class="s2">&quot;block&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">onRenderEmitter</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)}}</span><span class="s1">_refreshXPosition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">element</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">x</span><span class="s0">??</span><span class="s3">0</span><span class="s0">;</span><span class="s2">&quot;right&quot;</span><span class="s0">===(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">anchor</span><span class="s0">||</span><span class="s2">&quot;left&quot;</span><span class="s0">)?</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">right</span><span class="s0">=</span><span class="s1">i</span><span class="s0">?</span><span class="s1">i</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">:</span><span class="s2">&quot;&quot;</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">left</span><span class="s0">=</span><span class="s1">i</span><span class="s0">?</span><span class="s1">i</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">:</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s1">_removeDecoration</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationElements</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)?.</span><span class="s1">remove</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationElements</span><span class="s0">.</span><span class="s1">delete</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">()}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferDecorationRenderer</span><span class="s0">=</span><span class="s1">h</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">ICoreBrowserService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">IDecorationService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">4</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">IRenderService</span><span class="s0">)],</span><span class="s1">h</span><span class="s0">)},</span><span class="s3">5871</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ColorZoneStore</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ColorZoneStore</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zones</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePool</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePoolIndex</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linePadding</span><span class="s0">={</span><span class="s1">full</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">left</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">center</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">right</span><span class="s0">:</span><span class="s3">0</span><span class="s0">}}</span><span class="s1">get zones</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_zonePool</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePool</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zones</span><span class="s0">.</span><span class="s1">length</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zones</span><span class="s0">}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zones</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePoolIndex</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">addDecoration</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerOptions</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zones</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">color</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerOptions</span><span class="s0">.</span><span class="s1">color</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">position</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerOptions</span><span class="s0">.</span><span class="s1">position</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lineIntersectsZone</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">.</span><span class="s1">line</span><span class="s0">))</span><span class="s4">return</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lineAdjacentToZone</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">.</span><span class="s1">line</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerOptions</span><span class="s0">.</span><span class="s1">position</span><span class="s0">))</span><span class="s4">return void this</span><span class="s0">.</span><span class="s1">_addLineToZone</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">.</span><span class="s1">line</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePoolIndex</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePool</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_zonePool</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePoolIndex</span><span class="s0">].</span><span class="s1">color</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerOptions</span><span class="s0">.</span><span class="s1">color</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePool</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePoolIndex</span><span class="s0">].</span><span class="s1">position</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerOptions</span><span class="s0">.</span><span class="s1">position</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePool</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePoolIndex</span><span class="s0">].</span><span class="s1">startBufferLine</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">.</span><span class="s1">line</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePool</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePoolIndex</span><span class="s0">].</span><span class="s1">endBufferLine</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">.</span><span class="s1">line</span><span class="s0">,</span><span class="s4">void this</span><span class="s0">.</span><span class="s1">_zones</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePool</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePoolIndex</span><span class="s0">++]);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zones</span><span class="s0">.</span><span class="s1">push</span><span class="s0">({</span><span class="s1">color</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerOptions</span><span class="s0">.</span><span class="s1">color</span><span class="s0">,</span><span class="s1">position</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerOptions</span><span class="s0">.</span><span class="s1">position</span><span class="s0">,</span><span class="s1">startBufferLine</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">.</span><span class="s1">line</span><span class="s0">,</span><span class="s1">endBufferLine</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">.</span><span class="s1">line</span><span class="s0">}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePool</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zones</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zones</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_zonePoolIndex</span><span class="s0">++}}</span><span class="s1">setPadding</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linePadding</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">_lineIntersectsZone</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">startBufferLine</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">endBufferLine</span><span class="s0">}</span><span class="s1">_lineAdjacentToZone</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">startBufferLine</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linePadding</span><span class="s0">[</span><span class="s1">i</span><span class="s0">||</span><span class="s2">&quot;full&quot;</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">endBufferLine</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linePadding</span><span class="s0">[</span><span class="s1">i</span><span class="s0">||</span><span class="s2">&quot;full&quot;</span><span class="s0">]}</span><span class="s1">_addLineToZone</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">startBufferLine</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">startBufferLine</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">endBufferLine</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">endBufferLine</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}}},</span><span class="s3">5744</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OverviewRulerRenderer</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">5871</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4725</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">c</span><span class="s0">={</span><span class="s1">full</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">left</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">center</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">right</span><span class="s0">:</span><span class="s3">0</span><span class="s0">},</span><span class="s1">l</span><span class="s0">={</span><span class="s1">full</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">left</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">center</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">right</span><span class="s0">:</span><span class="s3">0</span><span class="s0">},</span><span class="s1">d</span><span class="s0">={</span><span class="s1">full</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">left</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">center</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">right</span><span class="s0">:</span><span class="s3">0</span><span class="s0">};</span><span class="s4">let </span><span class="s1">_</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OverviewRulerRenderer</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">a</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">get _width</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerWidth</span><span class="s0">||</span><span class="s3">0</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">h</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">=</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">o</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">=</span><span class="s1">h</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colorZoneStore</span><span class="s0">=</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">ColorZoneStore</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_shouldUpdateDimensions</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_shouldUpdateAnchor</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastKnownBufferLength</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">mainDocument</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;canvas&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-decoration-overview-ruler&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshCanvasDimensions</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">parentElement</span><span class="s0">?.</span><span class="s1">insertBefore</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">);</span><span class="s4">const </span><span class="s1">c</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">getContext</span><span class="s0">(</span><span class="s2">&quot;2d&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">c</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;Ctx cannot be null&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ctx</span><span class="s0">=</span><span class="s1">c</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_registerDecorationListeners</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_registerBufferChangeListeners</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_registerDimensionChangeListeners</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">?.</span><span class="s1">remove</span><span class="s0">()})))}</span><span class="s1">_registerDecorationListeners</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">.</span><span class="s1">onDecorationRegistered</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queueRefresh</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">.</span><span class="s1">onDecorationRemoved</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queueRefresh</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">))))}</span><span class="s1">_registerBufferChangeListeners</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">onRenderedViewportChange</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queueRefresh</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">onBufferActivate</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">display</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">alt</span><span class="s0">?</span><span class="s2">&quot;none&quot;</span><span class="s0">:</span><span class="s2">&quot;block&quot;</span><span class="s0">}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">onScroll</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastKnownBufferLength</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">normal</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshDrawHeightConstants</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshColorZonePadding</span><span class="s0">())})))}</span><span class="s1">_registerDimensionChangeListeners</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">onRender</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_containerHeight</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_containerHeight</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">clientHeight</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queueRefresh</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_containerHeight</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">clientHeight</span><span class="s0">)}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">onSpecificOptionChange</span><span class="s0">(</span><span class="s2">&quot;overviewRulerWidth&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queueRefresh</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">onDprChange</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queueRefresh</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queueRefresh</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">_refreshDrawConstants</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">/</span><span class="s3">3</span><span class="s0">),</span><span class="s1">t</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">ceil</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">/</span><span class="s3">3</span><span class="s0">);</span><span class="s1">l</span><span class="s0">.</span><span class="s1">full</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">left</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">center</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">right</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshDrawHeightConstants</span><span class="s0">(),</span><span class="s1">d</span><span class="s0">.</span><span class="s1">full</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">d</span><span class="s0">.</span><span class="s1">left</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">d</span><span class="s0">.</span><span class="s1">center</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">left</span><span class="s0">,</span><span class="s1">d</span><span class="s0">.</span><span class="s1">right</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">left</span><span class="s0">+</span><span class="s1">l</span><span class="s0">.</span><span class="s1">center</span><span class="s0">}</span><span class="s1">_refreshDrawHeightConstants</span><span class="s0">(){</span><span class="s1">c</span><span class="s0">.</span><span class="s1">full</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s3">2</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">dpr</span><span class="s0">);</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">12</span><span class="s0">),</span><span class="s3">6</span><span class="s0">)*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">dpr</span><span class="s0">);</span><span class="s1">c</span><span class="s0">.</span><span class="s1">left</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">center</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">right</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s1">_refreshColorZonePadding</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colorZoneStore</span><span class="s0">.</span><span class="s1">setPadding</span><span class="s0">({</span><span class="s1">full</span><span class="s0">:</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">/(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)*</span><span class="s1">c</span><span class="s0">.</span><span class="s1">full</span><span class="s0">),</span><span class="s1">left</span><span class="s0">:</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">/(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)*</span><span class="s1">c</span><span class="s0">.</span><span class="s1">left</span><span class="s0">),</span><span class="s1">center</span><span class="s0">:</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">/(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)*</span><span class="s1">c</span><span class="s0">.</span><span class="s1">center</span><span class="s0">),</span><span class="s1">right</span><span class="s0">:</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">/(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)*</span><span class="s1">c</span><span class="s0">.</span><span class="s1">right</span><span class="s0">)}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastKnownBufferLength</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">normal</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}</span><span class="s1">_refreshCanvasDimensions</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_width</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_width</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">dpr</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">clientHeight</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">clientHeight</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">dpr</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshDrawConstants</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshColorZonePadding</span><span class="s0">()}</span><span class="s1">_refreshDecorations</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_shouldUpdateDimensions</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshCanvasDimensions</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ctx</span><span class="s0">.</span><span class="s1">clearRect</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colorZoneStore</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">();</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colorZoneStore</span><span class="s0">.</span><span class="s1">addDecoration</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ctx</span><span class="s0">.</span><span class="s1">lineWidth</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colorZoneStore</span><span class="s0">.</span><span class="s1">zones</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t of e</span><span class="s0">)</span><span class="s2">&quot;full&quot;</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">position</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderColorZone</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t of e</span><span class="s0">)</span><span class="s2">&quot;full&quot;</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">position</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderColorZone</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_shouldUpdateDimensions</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_shouldUpdateAnchor</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">_renderColorZone</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ctx</span><span class="s0">.</span><span class="s1">fillStyle</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">color</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ctx</span><span class="s0">.</span><span class="s1">fillRect</span><span class="s0">(</span><span class="s1">d</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">position</span><span class="s0">||</span><span class="s2">&quot;full&quot;</span><span class="s0">],</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">((</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)*(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">startBufferLine</span><span class="s0">/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)-</span><span class="s1">c</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">position</span><span class="s0">||</span><span class="s2">&quot;full&quot;</span><span class="s0">]/</span><span class="s3">2</span><span class="s0">),</span><span class="s1">l</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">position</span><span class="s0">||</span><span class="s2">&quot;full&quot;</span><span class="s0">],</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">((</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)*((</span><span class="s1">e</span><span class="s0">.</span><span class="s1">endBufferLine</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">startBufferLine</span><span class="s0">)/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)+</span><span class="s1">c</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">position</span><span class="s0">||</span><span class="s2">&quot;full&quot;</span><span class="s0">]))}</span><span class="s1">_queueRefresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_shouldUpdateDimensions</span><span class="s0">=</span><span class="s1">e</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_shouldUpdateDimensions</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_shouldUpdateAnchor</span><span class="s0">=</span><span class="s1">t</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_shouldUpdateAnchor</span><span class="s0">,</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">.</span><span class="s1">requestAnimationFrame</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshDecorations</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_animationFrame</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">})))}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OverviewRulerRenderer</span><span class="s0">=</span><span class="s1">_</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IDecorationService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">4</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">IRenderService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">5</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">6</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">ICoreBrowserService</span><span class="s0">)],</span><span class="s1">_</span><span class="s0">)},</span><span class="s3">2950</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CompositionHelper</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4725</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2584</span><span class="s0">);</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CompositionHelper</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">get isComposing</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_isComposing</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">=</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isComposing</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isSendingComposition</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionPosition</span><span class="s0">={</span><span class="s1">start</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">end</span><span class="s0">:</span><span class="s3">0</span><span class="s0">},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dataAlreadySent</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s1">compositionstart</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isComposing</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionPosition</span><span class="s0">.</span><span class="s1">start</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dataAlreadySent</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;active&quot;</span><span class="s0">)}</span><span class="s1">compositionupdate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">data</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateCompositionElements</span><span class="s0">(),</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionPosition</span><span class="s0">.</span><span class="s1">end</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}),</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">compositionend</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_finalizeComposition</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">keydown</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isComposing</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isSendingComposition</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">229</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s3">16</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">||</span><span class="s3">17</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">||</span><span class="s3">18</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_finalizeComposition</span><span class="s0">(!</span><span class="s3">1</span><span class="s0">)}</span><span class="s4">return </span><span class="s3">229</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleAnyTextareaChanges</span><span class="s0">(),!</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">_finalizeComposition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(</span><span class="s2">&quot;active&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isComposing</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">={</span><span class="s1">start</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionPosition</span><span class="s0">.</span><span class="s1">start</span><span class="s0">,</span><span class="s1">end</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionPosition</span><span class="s0">.</span><span class="s1">end</span><span class="s0">};</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isSendingComposition</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isSendingComposition</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isSendingComposition</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">+=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dataAlreadySent</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isComposing</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">substring</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">end</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">substring</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)}}),</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isSendingComposition</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">substring</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionPosition</span><span class="s0">.</span><span class="s1">start</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionPosition</span><span class="s0">.</span><span class="s1">end</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)}}</span><span class="s1">_handleAnyTextareaChanges</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">value</span><span class="s0">;</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;{</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isComposing</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">value</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">replace</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s2">&quot;&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dataAlreadySent</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">):</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">a</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">DEL</span><span class="s0">}</span><span class="s2">`</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">):</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)}}),</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">updateCompositionElements</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isComposing</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">isCursorInViewport</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">left</span><span class="s0">=</span><span class="s1">s</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">top</span><span class="s0">=</span><span class="s1">i</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s1">t</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">lineHeight</span><span class="s0">=</span><span class="s1">t</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontFamily</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontFamily</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontSize</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontSize</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_compositionView</span><span class="s0">.</span><span class="s1">getBoundingClientRect</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">left</span><span class="s0">=</span><span class="s1">s</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">top</span><span class="s0">=</span><span class="s1">i</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">width</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">height</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">lineHeight</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">height</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">}</span><span class="s1">e</span><span class="s0">||</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateCompositionElements</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">)),</span><span class="s3">0</span><span class="s0">)}}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CompositionHelper</span><span class="s0">=</span><span class="s1">h</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">4</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">ICoreService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">5</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">IRenderService</span><span class="s0">)],</span><span class="s1">h</span><span class="s0">)},</span><span class="s3">9806</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s4">function </span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">getBoundingClientRect</span><span class="s0">(),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">getComputedStyle</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">getPropertyValue</span><span class="s0">(</span><span class="s2">&quot;padding-left&quot;</span><span class="s0">)),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">getPropertyValue</span><span class="s0">(</span><span class="s2">&quot;padding-top&quot;</span><span class="s0">));</span><span class="s4">return</span><span class="s0">[</span><span class="s1">t</span><span class="s0">.</span><span class="s1">clientX</span><span class="s0">-</span><span class="s1">s</span><span class="s0">.</span><span class="s1">left</span><span class="s0">-</span><span class="s1">n</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">clientY</span><span class="s0">-</span><span class="s1">s</span><span class="s0">.</span><span class="s1">top</span><span class="s0">-</span><span class="s1">o</span><span class="s0">]}</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getCoords</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getCoordsRelativeToElement</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getCoordsRelativeToElement</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getCoords</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">h</span><span class="s0">,</span><span class="s1">c</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">o</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">l</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">return </span><span class="s1">l</span><span class="s0">?(</span><span class="s1">l</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">ceil</span><span class="s0">((</span><span class="s1">l</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]+(</span><span class="s1">c</span><span class="s0">?</span><span class="s1">a</span><span class="s0">/</span><span class="s3">2</span><span class="s0">:</span><span class="s3">0</span><span class="s0">))/</span><span class="s1">a</span><span class="s0">),</span><span class="s1">l</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">ceil</span><span class="s0">(</span><span class="s1">l</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]/</span><span class="s1">h</span><span class="s0">),</span><span class="s1">l</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">l</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s3">1</span><span class="s0">),</span><span class="s1">r</span><span class="s0">+(</span><span class="s1">c</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)),</span><span class="s1">l</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">l</span><span class="s0">[</span><span class="s3">1</span><span class="s0">],</span><span class="s3">1</span><span class="s0">),</span><span class="s1">n</span><span class="s0">),</span><span class="s1">l</span><span class="s0">):</span><span class="s4">void </span><span class="s3">0</span><span class="s0">}},</span><span class="s3">9504</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">moveToCellSequence</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2584</span><span class="s0">);</span><span class="s4">function </span><span class="s1">r</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">-</span><span class="s1">n</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">t</span><span class="s0">-</span><span class="s1">n</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">abs</span><span class="s0">(</span><span class="s1">r</span><span class="s0">-</span><span class="s1">a</span><span class="s0">)-</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">-</span><span class="s1">n</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">t</span><span class="s0">-</span><span class="s1">n</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">abs</span><span class="s0">(</span><span class="s1">r</span><span class="s0">-</span><span class="s1">a</span><span class="s0">);</span><span class="s1">n</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">a</span><span class="s0">=</span><span class="s2">&quot;A&quot;</span><span class="s0">===</span><span class="s1">o</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)?-</span><span class="s3">1</span><span class="s0">:</span><span class="s3">1</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">r</span><span class="s0">+</span><span class="s1">a</span><span class="s0">*</span><span class="s1">n</span><span class="s0">);</span><span class="s1">h</span><span class="s0">?.</span><span class="s1">isWrapped</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">++}</span><span class="s4">return </span><span class="s1">s</span><span class="s0">}(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">return </span><span class="s1">c</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,</span><span class="s1">h</span><span class="s0">(</span><span class="s1">o</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">s</span><span class="s0">))}</span><span class="s4">function </span><span class="s1">n</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">s</span><span class="s0">?.</span><span class="s1">isWrapped</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">;)</span><span class="s1">i</span><span class="s0">++,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(--</span><span class="s1">e</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">s</span><span class="s0">?.</span><span class="s1">isWrapped</span><span class="s0">;</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s4">function </span><span class="s1">o</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">?</span><span class="s2">&quot;A&quot;</span><span class="s0">:</span><span class="s2">&quot;B&quot;</span><span class="s0">}</span><span class="s4">function </span><span class="s1">a</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">o</span><span class="s0">!==</span><span class="s1">i</span><span class="s0">||</span><span class="s1">a</span><span class="s0">!==</span><span class="s1">s</span><span class="s0">;)</span><span class="s1">o</span><span class="s0">+=</span><span class="s1">r</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&gt;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">?(</span><span class="s1">h</span><span class="s0">+=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">translateBufferLineToString</span><span class="s0">(</span><span class="s1">a</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">++):!</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">h</span><span class="s0">+=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">translateBufferLineToString</span><span class="s0">(</span><span class="s1">a</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">+</span><span class="s3">1</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s1">o</span><span class="s0">,</span><span class="s1">a</span><span class="s0">--);</span><span class="s4">return </span><span class="s1">h</span><span class="s0">+</span><span class="s1">n</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">translateBufferLineToString</span><span class="s0">(</span><span class="s1">a</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">o</span><span class="s0">)}</span><span class="s4">function </span><span class="s1">h</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?</span><span class="s2">&quot;O&quot;</span><span class="s0">:</span><span class="s2">&quot;[&quot;</span><span class="s0">;</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s1">i</span><span class="s0">+</span><span class="s1">e</span><span class="s0">}</span><span class="s4">function </span><span class="s1">c</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s1">e</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++)</span><span class="s1">i</span><span class="s0">+=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">moveToCellSequence</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">const </span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">l</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">hasScrollback</span><span class="s0">)</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">l</span><span class="s0">){</span><span class="s4">return </span><span class="s3">0</span><span class="s0">===</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">l</span><span class="s0">).</span><span class="s1">length</span><span class="s0">?</span><span class="s2">&quot;&quot;</span><span class="s0">:</span><span class="s1">c</span><span class="s0">(</span><span class="s1">a</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">-</span><span class="s1">n</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">o</span><span class="s0">).</span><span class="s1">length</span><span class="s0">,</span><span class="s1">h</span><span class="s0">(</span><span class="s2">&quot;D&quot;</span><span class="s0">,</span><span class="s1">l</span><span class="s0">))}(</span><span class="s1">o</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)+</span><span class="s1">r</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)+</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">l</span><span class="s0">){</span><span class="s4">let </span><span class="s1">d</span><span class="s0">;</span><span class="s1">d</span><span class="s0">=</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">l</span><span class="s0">).</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">?</span><span class="s1">s</span><span class="s0">-</span><span class="s1">n</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">t</span><span class="s0">;</span><span class="s4">const </span><span class="s1">_</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s1">u</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">a</span><span class="s0">){</span><span class="s4">let </span><span class="s1">h</span><span class="s0">;</span><span class="s4">return </span><span class="s1">h</span><span class="s0">=</span><span class="s1">r</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">a</span><span class="s0">).</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">?</span><span class="s1">s</span><span class="s0">-</span><span class="s1">n</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">h</span><span class="s0">&lt;=</span><span class="s1">s</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">?</span><span class="s2">&quot;C&quot;</span><span class="s0">:</span><span class="s2">&quot;D&quot;</span><span class="s0">}(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">l</span><span class="s0">);</span><span class="s4">return </span><span class="s1">c</span><span class="s0">(</span><span class="s1">a</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">d</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">_</span><span class="s0">,</span><span class="s2">&quot;C&quot;</span><span class="s0">===</span><span class="s1">u</span><span class="s0">,</span><span class="s1">o</span><span class="s0">).</span><span class="s1">length</span><span class="s0">,</span><span class="s1">h</span><span class="s0">(</span><span class="s1">u</span><span class="s0">,</span><span class="s1">l</span><span class="s0">))}(</span><span class="s1">o</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">let </span><span class="s1">d</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">===</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return </span><span class="s1">d</span><span class="s0">=</span><span class="s1">o</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">?</span><span class="s2">&quot;D&quot;</span><span class="s0">:</span><span class="s2">&quot;C&quot;</span><span class="s0">,</span><span class="s1">c</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">abs</span><span class="s0">(</span><span class="s1">o</span><span class="s0">-</span><span class="s1">e</span><span class="s0">),</span><span class="s1">h</span><span class="s0">(</span><span class="s1">d</span><span class="s0">,</span><span class="s1">s</span><span class="s0">));</span><span class="s1">d</span><span class="s0">=</span><span class="s1">l</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">?</span><span class="s2">&quot;D&quot;</span><span class="s0">:</span><span class="s2">&quot;C&quot;</span><span class="s0">;</span><span class="s4">const </span><span class="s1">_</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">abs</span><span class="s0">(</span><span class="s1">l</span><span class="s0">-</span><span class="s1">t</span><span class="s0">);</span><span class="s4">return </span><span class="s1">c</span><span class="s0">(</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s1">e</span><span class="s0">}(</span><span class="s1">l</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">?</span><span class="s1">e</span><span class="s0">:</span><span class="s1">o</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)+(</span><span class="s1">_</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)*</span><span class="s1">i</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">+</span><span class="s3">1</span><span class="s0">+((</span><span class="s1">l</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">?</span><span class="s1">o</span><span class="s0">:</span><span class="s1">e</span><span class="s0">)-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">h</span><span class="s0">(</span><span class="s1">d</span><span class="s0">,</span><span class="s1">s</span><span class="s0">))}},</span><span class="s3">1296</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DomRenderer</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3787</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2550</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2223</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6171</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6052</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4725</span><span class="s0">),</span><span class="s1">d</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8055</span><span class="s0">),</span><span class="s1">_</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">u</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">f</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">v</span><span class="s0">=</span><span class="s2">&quot;xterm-dom-renderer-owner-&quot;</span><span class="s0">,</span><span class="s1">p</span><span class="s0">=</span><span class="s2">&quot;xterm-rows&quot;</span><span class="s0">,</span><span class="s1">g</span><span class="s0">=</span><span class="s2">&quot;xterm-fg-&quot;</span><span class="s0">,</span><span class="s1">m</span><span class="s0">=</span><span class="s2">&quot;xterm-bg-&quot;</span><span class="s0">,</span><span class="s1">S</span><span class="s0">=</span><span class="s2">&quot;xterm-focus&quot;</span><span class="s0">,</span><span class="s1">C</span><span class="s0">=</span><span class="s2">&quot;xterm-selection&quot;</span><span class="s0">;</span><span class="s4">let </span><span class="s1">b</span><span class="s0">=</span><span class="s3">1</span><span class="s0">,</span><span class="s1">w</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DomRenderer</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">u</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">d</span><span class="s0">,</span><span class="s1">f</span><span class="s0">,</span><span class="s1">g</span><span class="s0">,</span><span class="s1">m</span><span class="s0">,</span><span class="s1">S</span><span class="s0">,</span><span class="s1">w</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">=</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_helperContainer</span><span class="s0">=</span><span class="s1">a</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkifier2</span><span class="s0">=</span><span class="s1">l</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">=</span><span class="s1">f</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">g</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">m</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">=</span><span class="s1">S</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">=</span><span class="s1">w</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalClass</span><span class="s0">=</span><span class="s1">b</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionRenderModel</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">createSelectionRenderModel</span><span class="s0">)(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRequestRedraw</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">_</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">).</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s1">p</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">lineHeight</span><span class="s0">=</span><span class="s2">&quot;normal&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-hidden&quot;</span><span class="s0">,</span><span class="s2">&quot;true&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshRowElements</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionContainer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionContainer</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s1">C</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionContainer</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-hidden&quot;</span><span class="s0">,</span><span class="s2">&quot;true&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">createRenderDimensions</span><span class="s0">)(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateDimensions</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">onOptionChange</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleOptionsChanged</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">.</span><span class="s1">onChangeColors</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_injectCss</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_injectCss</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">.</span><span class="s1">colors</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowFactory</span><span class="s0">=</span><span class="s1">d</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">DomRendererRowFactory</span><span class="s0">,</span><span class="s1">document</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s1">v</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalClass</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionContainer</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkifier2</span><span class="s0">.</span><span class="s1">onShowLinkUnderline</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleLinkHover</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkifier2</span><span class="s0">.</span><span class="s1">onHideLinkUnderline</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleLinkLeave</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">u</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(</span><span class="s1">v</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalClass</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionContainer</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_widthCache</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeStyleElement</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dimensionsStyleElement</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">()}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_widthCache</span><span class="s0">=</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">WidthCache</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_helperContainer</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_widthCache</span><span class="s0">.</span><span class="s1">setFont</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontFamily</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontSize</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontWeight</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontWeightBold</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setDefaultSpacing</span><span class="s0">()}</span><span class="s1">_updateDimensions</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">dpr</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">char</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">.</span><span class="s1">width</span><span class="s0">*</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">char</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">ceil</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">.</span><span class="s1">height</span><span class="s0">*</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">char</span><span class="s0">.</span><span class="s1">width</span><span class="s0">+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">letterSpacing</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">char</span><span class="s0">.</span><span class="s1">height</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">lineHeight</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">char</span><span class="s0">.</span><span class="s1">left</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">char</span><span class="s0">.</span><span class="s1">top</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">/</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">device</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">/</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">i of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">)</span><span class="s1">i</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">lineHeight</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">overflow</span><span class="s0">=</span><span class="s2">&quot;hidden&quot;</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dimensionsStyleElement</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dimensionsStyleElement</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;style&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dimensionsStyleElement</span><span class="s0">));</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">p</span><span class="s0">} </span><span class="s2">span { display: inline-block; height: 100%; vertical-align: top;}`</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dimensionsStyleElement</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionContainer</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_viewportElement</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">}</span><span class="s1">_injectCss</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeStyleElement</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeStyleElement</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;style&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeStyleElement</span><span class="s0">));</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">p</span><span class="s0">} </span><span class="s2">{ color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">foreground</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">; font-family: </span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontFamily</span><span class="s0">}</span><span class="s2">; font-size: </span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontSize</span><span class="s0">}</span><span class="s2">px; font-kerning: none; white-space: pre}`</span><span class="s0">;</span><span class="s1">t</span><span class="s0">+=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">p</span><span class="s0">} </span><span class="s2">.xterm-dim { color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">d</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">multiplyOpacity</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">foreground</span><span class="s0">,</span><span class="s3">.5</span><span class="s0">).</span><span class="s1">css</span><span class="s0">}</span><span class="s2">;}`</span><span class="s0">,</span><span class="s1">t</span><span class="s0">+=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">span:not(.xterm-bold) { font-weight: </span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontWeight</span><span class="s0">}</span><span class="s2">;}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">span.xterm-bold { font-weight: </span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontWeightBold</span><span class="s0">}</span><span class="s2">;}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">span.xterm-italic { font-style: italic;}`</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s2">`blink_underline_</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalClass</span><span class="s0">}</span><span class="s2">`</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s2">`blink_bar_</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalClass</span><span class="s0">}</span><span class="s2">`</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s2">`blink_block_</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalClass</span><span class="s0">}</span><span class="s2">`</span><span class="s0">;</span><span class="s1">t</span><span class="s0">+=</span><span class="s2">`@keyframes </span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">} </span><span class="s2">{ 50% {  border-bottom-style: hidden; }}`</span><span class="s0">,</span><span class="s1">t</span><span class="s0">+=</span><span class="s2">`@keyframes </span><span class="s1">$</span><span class="s0">{</span><span class="s1">s</span><span class="s0">} </span><span class="s2">{ 50% {  box-shadow: none; }}`</span><span class="s0">,</span><span class="s1">t</span><span class="s0">+=</span><span class="s2">`@keyframes </span><span class="s1">$</span><span class="s0">{</span><span class="s1">r</span><span class="s0">} </span><span class="s2">{ 0% {  background-color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">;  color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cursorAccent</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">; } 50% {  background-color: inherit;  color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">; }}`</span><span class="s0">,</span><span class="s1">t</span><span class="s0">+=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">p</span><span class="s0">}</span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">S</span><span class="s0">} </span><span class="s2">.xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">} </span><span class="s2">1s step-end infinite;}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">p</span><span class="s0">}</span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">S</span><span class="s0">} </span><span class="s2">.xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">s</span><span class="s0">} </span><span class="s2">1s step-end infinite;}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">p</span><span class="s0">}</span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">S</span><span class="s0">} </span><span class="s2">.xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">r</span><span class="s0">} </span><span class="s2">1s step-end infinite;}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">p</span><span class="s0">} </span><span class="s2">.xterm-cursor.xterm-cursor-block { background-color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">; color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cursorAccent</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">;}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">p</span><span class="s0">} </span><span class="s2">.xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">.</span><span class="s1">css</span><span class="s0">} </span><span class="s2">!important; color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cursorAccent</span><span class="s0">.</span><span class="s1">css</span><span class="s0">} </span><span class="s2">!important;}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">p</span><span class="s0">} </span><span class="s2">.xterm-cursor.xterm-cursor-outline { outline: 1px solid </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">; outline-offset: -1px;}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">p</span><span class="s0">} </span><span class="s2">.xterm-cursor.xterm-cursor-bar { box-shadow: </span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">cursorWidth</span><span class="s0">}</span><span class="s2">px 0 0 </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">.</span><span class="s1">css</span><span class="s0">} </span><span class="s2">inset;}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">p</span><span class="s0">} </span><span class="s2">.xterm-cursor.xterm-cursor-underline { border-bottom: 1px </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">; border-bottom-style: solid; height: calc(100% - 1px);}`</span><span class="s0">,</span><span class="s1">t</span><span class="s0">+=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">C</span><span class="s0">} </span><span class="s2">{ position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">}</span><span class="s2">.focus .</span><span class="s1">$</span><span class="s0">{</span><span class="s1">C</span><span class="s0">} </span><span class="s2">div { position: absolute; background-color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selectionBackgroundOpaque</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">;}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">C</span><span class="s0">} </span><span class="s2">div { position: absolute; background-color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selectionInactiveBackgroundOpaque</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">;}`</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const</span><span class="s0">[</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">]</span><span class="s1">of e</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">.</span><span class="s1">entries</span><span class="s0">())</span><span class="s1">t</span><span class="s0">+=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">g</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">} </span><span class="s2">{ color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">; }</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">g</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">}</span><span class="s2">.xterm-dim { color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">d</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">multiplyOpacity</span><span class="s0">(</span><span class="s1">o</span><span class="s0">,</span><span class="s3">.5</span><span class="s0">).</span><span class="s1">css</span><span class="s0">}</span><span class="s2">; }</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">m</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">} </span><span class="s2">{ background-color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">; }`</span><span class="s0">;</span><span class="s1">t</span><span class="s0">+=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">g</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">a</span><span class="s0">.</span><span class="s1">INVERTED_DEFAULT_COLOR</span><span class="s0">} </span><span class="s2">{ color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">d</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">opaque</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">background</span><span class="s0">).</span><span class="s1">css</span><span class="s0">}</span><span class="s2">; }</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">g</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">a</span><span class="s0">.</span><span class="s1">INVERTED_DEFAULT_COLOR</span><span class="s0">}</span><span class="s2">.xterm-dim { color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">d</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">multiplyOpacity</span><span class="s0">(</span><span class="s1">d</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">opaque</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">background</span><span class="s0">),</span><span class="s3">.5</span><span class="s0">).</span><span class="s1">css</span><span class="s0">}</span><span class="s2">; }</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalSelector</span><span class="s0">} </span><span class="s2">.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">m</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">a</span><span class="s0">.</span><span class="s1">INVERTED_DEFAULT_COLOR</span><span class="s0">} </span><span class="s2">{ background-color: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">foreground</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">; }`</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeStyleElement</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s1">_setDefaultSpacing</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_widthCache</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s2">&quot;W&quot;</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">letterSpacing</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowFactory</span><span class="s0">.</span><span class="s1">defaultSpacing</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">handleDevicePixelRatioChange</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateDimensions</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_widthCache</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setDefaultSpacing</span><span class="s0">()}</span><span class="s1">_refreshRowElements</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s1">t</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">for</span><span class="s0">(;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">removeChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">())}</span><span class="s1">handleResize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshRowElements</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateDimensions</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">handleSelectionChanged</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionRenderModel</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionRenderModel</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionRenderModel</span><span class="s0">.</span><span class="s1">columnSelectMode</span><span class="s0">)}</span><span class="s1">handleCharSizeChanged</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateDimensions</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_widthCache</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setDefaultSpacing</span><span class="s0">()}</span><span class="s1">handleBlur</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(</span><span class="s1">S</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">renderRows</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">handleFocus</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowContainer</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s1">S</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">renderRows</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)}</span><span class="s1">handleSelectionChanged</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionContainer</span><span class="s0">.</span><span class="s1">replaceChildren</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowFactory</span><span class="s0">.</span><span class="s1">handleSelectionChanged</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">renderRows</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),!</span><span class="s1">e</span><span class="s0">||!</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionRenderModel</span><span class="s0">.</span><span class="s1">update</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminal</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionRenderModel</span><span class="s0">.</span><span class="s1">viewportStartRow</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionRenderModel</span><span class="s0">.</span><span class="s1">viewportEndRow</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionRenderModel</span><span class="s0">.</span><span class="s1">viewportCappedStartRow</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionRenderModel</span><span class="s0">.</span><span class="s1">viewportCappedEndRow</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">||</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">a</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createDocumentFragment</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&gt;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s1">a</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createSelectionElement</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">i</span><span class="s0">?</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]:</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">i</span><span class="s0">?</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]:</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">o</span><span class="s0">-</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">))}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">s</span><span class="s0">===</span><span class="s1">n</span><span class="s0">?</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s1">n</span><span class="s0">===</span><span class="s1">r</span><span class="s0">?</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">;</span><span class="s1">a</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createSelectionElement</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">h</span><span class="s0">));</span><span class="s4">const </span><span class="s1">c</span><span class="s0">=</span><span class="s1">o</span><span class="s0">-</span><span class="s1">n</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createSelectionElement</span><span class="s0">(</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s1">c</span><span class="s0">)),</span><span class="s1">n</span><span class="s0">!==</span><span class="s1">o</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">r</span><span class="s0">===</span><span class="s1">o</span><span class="s0">?</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">;</span><span class="s1">a</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createSelectionElement</span><span class="s0">(</span><span class="s1">o</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">))}}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionContainer</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">a</span><span class="s0">)}</span><span class="s1">_createSelectionElement</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s3">1</span><span class="s0">){</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">*(</span><span class="s1">i</span><span class="s0">-</span><span class="s1">t</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">+</span><span class="s1">o</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">-</span><span class="s1">n</span><span class="s0">),</span><span class="s1">r</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s1">s</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">top</span><span class="s0">=</span><span class="s1">e</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">+</span><span class="s2">&quot;px&quot;</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">left</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">o</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s1">r</span><span class="s0">}</span><span class="s1">handleCursorMove</span><span class="s0">(){}</span><span class="s1">_handleOptionsChanged</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateDimensions</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_injectCss</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">.</span><span class="s1">colors</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_widthCache</span><span class="s0">.</span><span class="s1">setFont</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontFamily</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontSize</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontWeight</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontWeightBold</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setDefaultSpacing</span><span class="s0">()}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">e of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">replaceChildren</span><span class="s0">()}</span><span class="s1">renderRows</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">i</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">cursorBlink</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">cursorStyle</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">cursorInactiveStyle</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s1">h</span><span class="s0">&lt;=</span><span class="s1">t</span><span class="s0">;</span><span class="s1">h</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">h</span><span class="s0">+</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s1">h</span><span class="s0">],</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">||!</span><span class="s1">c</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">replaceChildren</span><span class="s0">(</span><span class="s1">...</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowFactory</span><span class="s0">.</span><span class="s1">createRow</span><span class="s0">(</span><span class="s1">c</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">e</span><span class="s0">===</span><span class="s1">s</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_widthCache</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">))}}</span><span class="s1">get _terminalSelector</span><span class="s0">(){</span><span class="s4">return</span><span class="s2">`.</span><span class="s1">$</span><span class="s0">{</span><span class="s1">v</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_terminalClass</span><span class="s0">}</span><span class="s2">`</span><span class="s0">}</span><span class="s1">_handleLinkHover</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setCellUnderline</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">x1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">x2</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">y1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">y2</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">_handleLinkLeave</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setCellUnderline</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">x1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">x2</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">y1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">y2</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">_setCellUnderline</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">),</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">);</span><span class="s4">const </span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">i</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s3">0</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s3">0</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">);</span><span class="s4">const </span><span class="s1">a</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s1">a</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">a</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s1">c</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">a</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">r</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">cursorBlink</span><span class="s0">,</span><span class="s1">d</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">cursorStyle</span><span class="s0">,</span><span class="s1">_</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">cursorInactiveStyle</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">u</span><span class="s0">=</span><span class="s1">i</span><span class="s0">;</span><span class="s1">u</span><span class="s0">&lt;=</span><span class="s1">s</span><span class="s0">;++</span><span class="s1">u</span><span class="s0">){</span><span class="s4">const </span><span class="s1">o</span><span class="s0">=</span><span class="s1">u</span><span class="s0">+</span><span class="s1">a</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">,</span><span class="s1">f</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowElements</span><span class="s0">[</span><span class="s1">u</span><span class="s0">],</span><span class="s1">v</span><span class="s0">=</span><span class="s1">a</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">o</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">f</span><span class="s0">||!</span><span class="s1">v</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s1">f</span><span class="s0">.</span><span class="s1">replaceChildren</span><span class="s0">(</span><span class="s1">...</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowFactory</span><span class="s0">.</span><span class="s1">createRow</span><span class="s0">(</span><span class="s1">v</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">o</span><span class="s0">===</span><span class="s1">h</span><span class="s0">,</span><span class="s1">d</span><span class="s0">,</span><span class="s1">_</span><span class="s0">,</span><span class="s1">c</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_widthCache</span><span class="s0">,</span><span class="s1">n</span><span class="s0">?</span><span class="s1">u</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">e</span><span class="s0">:</span><span class="s3">0</span><span class="s0">:-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">n</span><span class="s0">?(</span><span class="s1">u</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s1">r</span><span class="s0">)-</span><span class="s3">1</span><span class="s0">:-</span><span class="s3">1</span><span class="s0">))}}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DomRenderer</span><span class="s0">=</span><span class="s1">w</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">7</span><span class="s0">,</span><span class="s1">f</span><span class="s0">.</span><span class="s1">IInstantiationService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">8</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">ICharSizeService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">9</span><span class="s0">,</span><span class="s1">f</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">10</span><span class="s0">,</span><span class="s1">f</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">11</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">ICoreBrowserService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">12</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">IThemeService</span><span class="s0">)],</span><span class="s1">w</span><span class="s0">)},</span><span class="s3">3787</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DomRendererRowFactory</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2223</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">643</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">511</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8055</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4725</span><span class="s0">),</span><span class="s1">d</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4269</span><span class="s0">),</span><span class="s1">_</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6171</span><span class="s0">),</span><span class="s1">u</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3734</span><span class="s0">);</span><span class="s4">let </span><span class="s1">f</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DomRendererRowFactory</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoinerService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">=</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">=</span><span class="s1">o</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">=</span><span class="s4">new </span><span class="s1">a</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_columnSelectMode</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">defaultSpacing</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">handleSelectionChanged</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionStart</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionEnd</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_columnSelectMode</span><span class="s0">=</span><span class="s1">i</span><span class="s0">}</span><span class="s1">createRow</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">h</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">_</span><span class="s0">,</span><span class="s1">f</span><span class="s0">,</span><span class="s1">p</span><span class="s0">){</span><span class="s4">const </span><span class="s1">g</span><span class="s0">=[],</span><span class="s1">m</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoinerService</span><span class="s0">.</span><span class="s1">getJoinedCharacters</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">S</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">.</span><span class="s1">colors</span><span class="s0">;</span><span class="s4">let </span><span class="s1">C</span><span class="s0">,</span><span class="s1">b</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">getNoBgTrimmedLength</span><span class="s0">();</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">b</span><span class="s0">&lt;</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">&amp;&amp;(</span><span class="s1">b</span><span class="s0">=</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">);</span><span class="s4">let </span><span class="s1">w</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">y</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">E</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">k</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">L</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">D</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">R</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">x</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">A</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">B</span><span class="s0">=[],</span><span class="s1">T</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">f</span><span class="s0">&amp;&amp;-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">p</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">M</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">M</span><span class="s0">&lt;</span><span class="s1">b</span><span class="s0">;</span><span class="s1">M</span><span class="s0">++){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">M</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">);</span><span class="s4">let </span><span class="s1">b</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">b</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s4">let </span><span class="s1">O</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">P</span><span class="s0">=</span><span class="s1">M</span><span class="s0">,</span><span class="s1">I</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">m</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">M</span><span class="s0">===</span><span class="s1">m</span><span class="s0">[</span><span class="s3">0</span><span class="s0">][</span><span class="s3">0</span><span class="s0">]){</span><span class="s1">O</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">m</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">();</span><span class="s1">I</span><span class="s0">=</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">JoinedCellData</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">translateToString</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]),</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]-</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]),</span><span class="s1">P</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">b</span><span class="s0">=</span><span class="s1">I</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">()}</span><span class="s4">const </span><span class="s1">H</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isCellInSelection</span><span class="s0">(</span><span class="s1">M</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">F</span><span class="s0">=</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">M</span><span class="s0">===</span><span class="s1">a</span><span class="s0">,</span><span class="s1">W</span><span class="s0">=</span><span class="s1">T</span><span class="s0">&amp;&amp;</span><span class="s1">M</span><span class="s0">&gt;=</span><span class="s1">f</span><span class="s0">&amp;&amp;</span><span class="s1">M</span><span class="s0">&lt;=</span><span class="s1">p</span><span class="s0">;</span><span class="s4">let </span><span class="s1">U</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">.</span><span class="s1">forEachDecorationAtCell</span><span class="s0">(</span><span class="s1">M</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s1">U</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">}));</span><span class="s4">let </span><span class="s1">N</span><span class="s0">=</span><span class="s1">I</span><span class="s0">.</span><span class="s1">getChars</span><span class="s0">()||</span><span class="s1">o</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CHAR</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot; &quot;</span><span class="s0">===</span><span class="s1">N</span><span class="s0">&amp;&amp;(</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isUnderline</span><span class="s0">()||</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isOverline</span><span class="s0">())&amp;&amp;(</span><span class="s1">N</span><span class="s0">=</span><span class="s2">&quot; &quot;</span><span class="s0">),</span><span class="s1">A</span><span class="s0">=</span><span class="s1">b</span><span class="s0">*</span><span class="s1">l</span><span class="s0">-</span><span class="s1">_</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">N</span><span class="s0">,</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isBold</span><span class="s0">(),</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isItalic</span><span class="s0">()),</span><span class="s1">C</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">w</span><span class="s0">&amp;&amp;(</span><span class="s1">H</span><span class="s0">&amp;&amp;</span><span class="s1">x</span><span class="s0">||!</span><span class="s1">H</span><span class="s0">&amp;&amp;!</span><span class="s1">x</span><span class="s0">&amp;&amp;</span><span class="s1">I</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">===</span><span class="s1">E</span><span class="s0">)&amp;&amp;(</span><span class="s1">H</span><span class="s0">&amp;&amp;</span><span class="s1">x</span><span class="s0">&amp;&amp;</span><span class="s1">S</span><span class="s0">.</span><span class="s1">selectionForeground</span><span class="s0">||</span><span class="s1">I</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">===</span><span class="s1">k</span><span class="s0">)&amp;&amp;</span><span class="s1">I</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">ext</span><span class="s0">===</span><span class="s1">L</span><span class="s0">&amp;&amp;</span><span class="s1">W</span><span class="s0">===</span><span class="s1">D</span><span class="s0">&amp;&amp;</span><span class="s1">A</span><span class="s0">===</span><span class="s1">R</span><span class="s0">&amp;&amp;!</span><span class="s1">F</span><span class="s0">&amp;&amp;!</span><span class="s1">O</span><span class="s0">&amp;&amp;!</span><span class="s1">U</span><span class="s0">){</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isInvisible</span><span class="s0">()?</span><span class="s1">y</span><span class="s0">+=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CHAR</span><span class="s0">:</span><span class="s1">y</span><span class="s0">+=</span><span class="s1">N</span><span class="s0">,</span><span class="s1">w</span><span class="s0">++;</span><span class="s4">continue</span><span class="s0">}</span><span class="s1">w</span><span class="s0">&amp;&amp;(</span><span class="s1">C</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s1">y</span><span class="s0">),</span><span class="s1">C</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;span&quot;</span><span class="s0">),</span><span class="s1">w</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">y</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s4">else </span><span class="s1">C</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;span&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">E</span><span class="s0">=</span><span class="s1">I</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">,</span><span class="s1">k</span><span class="s0">=</span><span class="s1">I</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s1">L</span><span class="s0">=</span><span class="s1">I</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">ext</span><span class="s0">,</span><span class="s1">D</span><span class="s0">=</span><span class="s1">W</span><span class="s0">,</span><span class="s1">R</span><span class="s0">=</span><span class="s1">A</span><span class="s0">,</span><span class="s1">x</span><span class="s0">=</span><span class="s1">H</span><span class="s0">,</span><span class="s1">O</span><span class="s0">&amp;&amp;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s1">M</span><span class="s0">&amp;&amp;</span><span class="s1">a</span><span class="s0">&lt;=</span><span class="s1">P</span><span class="s0">&amp;&amp;(</span><span class="s1">a</span><span class="s0">=</span><span class="s1">M</span><span class="s0">),!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">isCursorHidden</span><span class="s0">&amp;&amp;</span><span class="s1">F</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">isCursorInitialized</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;xterm-cursor&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">isFocused</span><span class="s0">)</span><span class="s1">h</span><span class="s0">&amp;&amp;</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;xterm-cursor-blink&quot;</span><span class="s0">),</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;bar&quot;</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s2">&quot;xterm-cursor-bar&quot;</span><span class="s0">:</span><span class="s2">&quot;underline&quot;</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s2">&quot;xterm-cursor-underline&quot;</span><span class="s0">:</span><span class="s2">&quot;xterm-cursor-block&quot;</span><span class="s0">);</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">r</span><span class="s0">){</span><span class="s4">case</span><span class="s2">&quot;outline&quot;</span><span class="s0">:</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;xterm-cursor-outline&quot;</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;block&quot;</span><span class="s0">:</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;xterm-cursor-block&quot;</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;bar&quot;</span><span class="s0">:</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;xterm-cursor-bar&quot;</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;underline&quot;</span><span class="s0">:</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;xterm-cursor-underline&quot;</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isBold</span><span class="s0">()&amp;&amp;</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;xterm-bold&quot;</span><span class="s0">),</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isItalic</span><span class="s0">()&amp;&amp;</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;xterm-italic&quot;</span><span class="s0">),</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isDim</span><span class="s0">()&amp;&amp;</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;xterm-dim&quot;</span><span class="s0">),</span><span class="s1">y</span><span class="s0">=</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isInvisible</span><span class="s0">()?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CHAR</span><span class="s0">:</span><span class="s1">I</span><span class="s0">.</span><span class="s1">getChars</span><span class="s0">()||</span><span class="s1">o</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CHAR</span><span class="s0">,</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isUnderline</span><span class="s0">()&amp;&amp;(</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">`xterm-underline-</span><span class="s1">$</span><span class="s0">{</span><span class="s1">I</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineStyle</span><span class="s0">}</span><span class="s2">`</span><span class="s0">),</span><span class="s2">&quot; &quot;</span><span class="s0">===</span><span class="s1">y</span><span class="s0">&amp;&amp;(</span><span class="s1">y</span><span class="s0">=</span><span class="s2">&quot; &quot;</span><span class="s0">),!</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isUnderlineColorDefault</span><span class="s0">()))</span><span class="s4">if</span><span class="s0">(</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isUnderlineColorRGB</span><span class="s0">())</span><span class="s1">C</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">textDecorationColor</span><span class="s0">=</span><span class="s2">`rgb(</span><span class="s1">$</span><span class="s0">{</span><span class="s1">u</span><span class="s0">.</span><span class="s1">AttributeData</span><span class="s0">.</span><span class="s1">toColorRGB</span><span class="s0">(</span><span class="s1">I</span><span class="s0">.</span><span class="s1">getUnderlineColor</span><span class="s0">()).</span><span class="s1">join</span><span class="s0">(</span><span class="s2">&quot;,&quot;</span><span class="s0">)}</span><span class="s2">)`</span><span class="s0">;</span><span class="s4">else</span><span class="s0">{</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">I</span><span class="s0">.</span><span class="s1">getUnderlineColor</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">drawBoldTextInBrightColors</span><span class="s0">&amp;&amp;</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isBold</span><span class="s0">()&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">8</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">+=</span><span class="s3">8</span><span class="s0">),</span><span class="s1">C</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">textDecorationColor</span><span class="s0">=</span><span class="s1">S</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">css</span><span class="s0">}</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isOverline</span><span class="s0">()&amp;&amp;(</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;xterm-overline&quot;</span><span class="s0">),</span><span class="s2">&quot; &quot;</span><span class="s0">===</span><span class="s1">y</span><span class="s0">&amp;&amp;(</span><span class="s1">y</span><span class="s0">=</span><span class="s2">&quot; &quot;</span><span class="s0">)),</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isStrikethrough</span><span class="s0">()&amp;&amp;</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;xterm-strikethrough&quot;</span><span class="s0">),</span><span class="s1">W</span><span class="s0">&amp;&amp;(</span><span class="s1">C</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">textDecoration</span><span class="s0">=</span><span class="s2">&quot;underline&quot;</span><span class="s0">);</span><span class="s4">let </span><span class="s1">$</span><span class="s0">=</span><span class="s1">I</span><span class="s0">.</span><span class="s1">getFgColor</span><span class="s0">(),</span><span class="s1">j</span><span class="s0">=</span><span class="s1">I</span><span class="s0">.</span><span class="s1">getFgColorMode</span><span class="s0">(),</span><span class="s1">z</span><span class="s0">=</span><span class="s1">I</span><span class="s0">.</span><span class="s1">getBgColor</span><span class="s0">(),</span><span class="s1">K</span><span class="s0">=</span><span class="s1">I</span><span class="s0">.</span><span class="s1">getBgColorMode</span><span class="s0">();</span><span class="s4">const </span><span class="s1">q</span><span class="s0">=!!</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isInverse</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s1">q</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">$</span><span class="s0">;</span><span class="s1">$</span><span class="s0">=</span><span class="s1">z</span><span class="s0">,</span><span class="s1">z</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">j</span><span class="s0">;</span><span class="s1">j</span><span class="s0">=</span><span class="s1">K</span><span class="s0">,</span><span class="s1">K</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s4">let </span><span class="s1">V</span><span class="s0">,</span><span class="s1">G</span><span class="s0">,</span><span class="s1">X</span><span class="s0">,</span><span class="s1">J</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">switch</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorationService</span><span class="s0">.</span><span class="s1">forEachDecorationAtCell</span><span class="s0">(</span><span class="s1">M</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s2">&quot;top&quot;</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">layer</span><span class="s0">&amp;&amp;</span><span class="s1">J</span><span class="s0">||(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">backgroundColorRGB</span><span class="s0">&amp;&amp;(</span><span class="s1">K</span><span class="s0">=</span><span class="s3">50331648</span><span class="s0">,</span><span class="s1">z</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">backgroundColorRGB</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">16777215</span><span class="s0">,</span><span class="s1">V</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">backgroundColorRGB</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">foregroundColorRGB</span><span class="s0">&amp;&amp;(</span><span class="s1">j</span><span class="s0">=</span><span class="s3">50331648</span><span class="s0">,</span><span class="s1">$</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">foregroundColorRGB</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">16777215</span><span class="s0">,</span><span class="s1">G</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">foregroundColorRGB</span><span class="s0">),</span><span class="s1">J</span><span class="s0">=</span><span class="s2">&quot;top&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">layer</span><span class="s0">)})),!</span><span class="s1">J</span><span class="s0">&amp;&amp;</span><span class="s1">H</span><span class="s0">&amp;&amp;(</span><span class="s1">V</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">isFocused</span><span class="s0">?</span><span class="s1">S</span><span class="s0">.</span><span class="s1">selectionBackgroundOpaque</span><span class="s0">:</span><span class="s1">S</span><span class="s0">.</span><span class="s1">selectionInactiveBackgroundOpaque</span><span class="s0">,</span><span class="s1">z</span><span class="s0">=</span><span class="s1">V</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">16777215</span><span class="s0">,</span><span class="s1">K</span><span class="s0">=</span><span class="s3">50331648</span><span class="s0">,</span><span class="s1">J</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">S</span><span class="s0">.</span><span class="s1">selectionForeground</span><span class="s0">&amp;&amp;(</span><span class="s1">j</span><span class="s0">=</span><span class="s3">50331648</span><span class="s0">,</span><span class="s1">$</span><span class="s0">=</span><span class="s1">S</span><span class="s0">.</span><span class="s1">selectionForeground</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">16777215</span><span class="s0">,</span><span class="s1">G</span><span class="s0">=</span><span class="s1">S</span><span class="s0">.</span><span class="s1">selectionForeground</span><span class="s0">)),</span><span class="s1">J</span><span class="s0">&amp;&amp;</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;xterm-decoration-top&quot;</span><span class="s0">),</span><span class="s1">K</span><span class="s0">){</span><span class="s4">case </span><span class="s3">16777216</span><span class="s0">:</span><span class="s4">case </span><span class="s3">33554432</span><span class="s0">:</span><span class="s1">X</span><span class="s0">=</span><span class="s1">S</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s1">z</span><span class="s0">],</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">`xterm-bg-</span><span class="s1">$</span><span class="s0">{</span><span class="s1">z</span><span class="s0">}</span><span class="s2">`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">50331648</span><span class="s0">:</span><span class="s1">X</span><span class="s0">=</span><span class="s1">c</span><span class="s0">.</span><span class="s1">channels</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s1">z</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">,</span><span class="s1">z</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">z</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addStyle</span><span class="s0">(</span><span class="s1">C</span><span class="s0">,</span><span class="s2">`background-color:#</span><span class="s1">$</span><span class="s0">{</span><span class="s1">v</span><span class="s0">((</span><span class="s1">z</span><span class="s0">&gt;&gt;&gt;</span><span class="s3">0</span><span class="s0">).</span><span class="s1">toString</span><span class="s0">(</span><span class="s3">16</span><span class="s0">),</span><span class="s2">&quot;0&quot;</span><span class="s0">,</span><span class="s3">6</span><span class="s0">)}</span><span class="s2">`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">default</span><span class="s0">:</span><span class="s1">q</span><span class="s0">?(</span><span class="s1">X</span><span class="s0">=</span><span class="s1">S</span><span class="s0">.</span><span class="s1">foreground</span><span class="s0">,</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">`xterm-bg-</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">.</span><span class="s1">INVERTED_DEFAULT_COLOR</span><span class="s0">}</span><span class="s2">`</span><span class="s0">)):</span><span class="s1">X</span><span class="s0">=</span><span class="s1">S</span><span class="s0">.</span><span class="s1">background</span><span class="s0">}</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">V</span><span class="s0">||</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isDim</span><span class="s0">()&amp;&amp;(</span><span class="s1">V</span><span class="s0">=</span><span class="s1">c</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">multiplyOpacity</span><span class="s0">(</span><span class="s1">X</span><span class="s0">,</span><span class="s3">.5</span><span class="s0">)),</span><span class="s1">j</span><span class="s0">){</span><span class="s4">case </span><span class="s3">16777216</span><span class="s0">:</span><span class="s4">case </span><span class="s3">33554432</span><span class="s0">:</span><span class="s1">I</span><span class="s0">.</span><span class="s1">isBold</span><span class="s0">()&amp;&amp;</span><span class="s1">$</span><span class="s0">&lt;</span><span class="s3">8</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">drawBoldTextInBrightColors</span><span class="s0">&amp;&amp;(</span><span class="s1">$</span><span class="s0">+=</span><span class="s3">8</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_applyMinimumContrast</span><span class="s0">(</span><span class="s1">C</span><span class="s0">,</span><span class="s1">X</span><span class="s0">,</span><span class="s1">S</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s1">$</span><span class="s0">],</span><span class="s1">I</span><span class="s0">,</span><span class="s1">V</span><span class="s0">,</span><span class="s4">void </span><span class="s3">0</span><span class="s0">)||</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">`xterm-fg-</span><span class="s1">$</span><span class="s0">{</span><span class="s1">$</span><span class="s0">}</span><span class="s2">`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">50331648</span><span class="s0">:</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">c</span><span class="s0">.</span><span class="s1">channels</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s1">$</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">$</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">$</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_applyMinimumContrast</span><span class="s0">(</span><span class="s1">C</span><span class="s0">,</span><span class="s1">X</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">I</span><span class="s0">,</span><span class="s1">V</span><span class="s0">,</span><span class="s1">G</span><span class="s0">)||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addStyle</span><span class="s0">(</span><span class="s1">C</span><span class="s0">,</span><span class="s2">`color:#</span><span class="s1">$</span><span class="s0">{</span><span class="s1">v</span><span class="s0">(</span><span class="s1">$</span><span class="s0">.</span><span class="s1">toString</span><span class="s0">(</span><span class="s3">16</span><span class="s0">),</span><span class="s2">&quot;0&quot;</span><span class="s0">,</span><span class="s3">6</span><span class="s0">)}</span><span class="s2">`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">default</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_applyMinimumContrast</span><span class="s0">(</span><span class="s1">C</span><span class="s0">,</span><span class="s1">X</span><span class="s0">,</span><span class="s1">S</span><span class="s0">.</span><span class="s1">foreground</span><span class="s0">,</span><span class="s1">I</span><span class="s0">,</span><span class="s1">V</span><span class="s0">,</span><span class="s1">G</span><span class="s0">)||</span><span class="s1">q</span><span class="s0">&amp;&amp;</span><span class="s1">B</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">`xterm-fg-</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">.</span><span class="s1">INVERTED_DEFAULT_COLOR</span><span class="s0">}</span><span class="s2">`</span><span class="s0">)}</span><span class="s1">B</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;(</span><span class="s1">C</span><span class="s0">.</span><span class="s1">className</span><span class="s0">=</span><span class="s1">B</span><span class="s0">.</span><span class="s1">join</span><span class="s0">(</span><span class="s2">&quot; &quot;</span><span class="s0">),</span><span class="s1">B</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">),</span><span class="s1">F</span><span class="s0">||</span><span class="s1">O</span><span class="s0">||</span><span class="s1">U</span><span class="s0">?</span><span class="s1">C</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s1">y</span><span class="s0">:</span><span class="s1">w</span><span class="s0">++,</span><span class="s1">A</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">defaultSpacing</span><span class="s0">&amp;&amp;(</span><span class="s1">C</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">letterSpacing</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">A</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">),</span><span class="s1">g</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">C</span><span class="s0">),</span><span class="s1">M</span><span class="s0">=</span><span class="s1">P</span><span class="s0">}</span><span class="s4">return </span><span class="s1">C</span><span class="s0">&amp;&amp;</span><span class="s1">w</span><span class="s0">&amp;&amp;(</span><span class="s1">C</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s1">y</span><span class="s0">),</span><span class="s1">g</span><span class="s0">}</span><span class="s1">_applyMinimumContrast</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">minimumContrastRatio</span><span class="s0">||(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">_</span><span class="s0">.</span><span class="s1">treatGlyphAsBackgroundColor</span><span class="s0">)(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">getCode</span><span class="s0">()))</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getContrastCache</span><span class="s0">(</span><span class="s1">s</span><span class="s0">);</span><span class="s4">let </span><span class="s1">a</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">||</span><span class="s1">n</span><span class="s0">||(</span><span class="s1">a</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">getColor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">)),</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">a</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">minimumContrastRatio</span><span class="s0">/(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">isDim</span><span class="s0">()?</span><span class="s3">2</span><span class="s0">:</span><span class="s3">1</span><span class="s0">);</span><span class="s1">a</span><span class="s0">=</span><span class="s1">c</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">ensureContrastRatio</span><span class="s0">(</span><span class="s1">r</span><span class="s0">||</span><span class="s1">t</span><span class="s0">,</span><span class="s1">n</span><span class="s0">||</span><span class="s1">i</span><span class="s0">,</span><span class="s1">e</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">setColor</span><span class="s0">((</span><span class="s1">r</span><span class="s0">||</span><span class="s1">t</span><span class="s0">).</span><span class="s1">rgba</span><span class="s0">,(</span><span class="s1">n</span><span class="s0">||</span><span class="s1">i</span><span class="s0">).</span><span class="s1">rgba</span><span class="s0">,</span><span class="s1">a</span><span class="s0">??</span><span class="s4">null</span><span class="s0">)}</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">a</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addStyle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s2">`color:</span><span class="s1">$</span><span class="s0">{</span><span class="s1">a</span><span class="s0">.</span><span class="s1">css</span><span class="s0">}</span><span class="s2">`</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">_getContrastCache</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">isDim</span><span class="s0">()?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">.</span><span class="s1">colors</span><span class="s0">.</span><span class="s1">halfContrastCache</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_themeService</span><span class="s0">.</span><span class="s1">colors</span><span class="s0">.</span><span class="s1">contrastCache</span><span class="s0">}</span><span class="s1">_addStyle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;style&quot;</span><span class="s0">,</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">getAttribute</span><span class="s0">(</span><span class="s2">&quot;style&quot;</span><span class="s0">)||</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">}</span><span class="s2">;`</span><span class="s0">)}</span><span class="s1">_isCellInSelection</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionStart</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionEnd</span><span class="s0">;</span><span class="s4">return</span><span class="s0">!(!</span><span class="s1">i</span><span class="s0">||!</span><span class="s1">s</span><span class="s0">)&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_columnSelectMode</span><span class="s0">?</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&lt;=</span><span class="s1">s</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]?</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;=</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]:</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s1">s</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;=</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]:</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]||</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">===</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">===</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">===</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])}};</span><span class="s4">function </span><span class="s1">v</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">;)</span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">+</span><span class="s1">e</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DomRendererRowFactory</span><span class="s0">=</span><span class="s1">f</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">ICharacterJoinerService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">ICoreBrowserService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">4</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">ICoreService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">5</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IDecorationService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">6</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">IThemeService</span><span class="s0">)],</span><span class="s1">f</span><span class="s0">)},</span><span class="s3">2550</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">WidthCache</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">WidthCache</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_flat</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Float32Array</span><span class="s0">(</span><span class="s3">256</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_font</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fontSize</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_weight</span><span class="s0">=</span><span class="s2">&quot;normal&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_weightBold</span><span class="s0">=</span><span class="s2">&quot;bold&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElements</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-width-cache-measure-container&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-hidden&quot;</span><span class="s0">,</span><span class="s2">&quot;true&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">whiteSpace</span><span class="s0">=</span><span class="s2">&quot;pre&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontKerning</span><span class="s0">=</span><span class="s2">&quot;none&quot;</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;span&quot;</span><span class="s0">);</span><span class="s1">i</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-char-measure-element&quot;</span><span class="s0">);</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;span&quot;</span><span class="s0">);</span><span class="s1">s</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-char-measure-element&quot;</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontWeight</span><span class="s0">=</span><span class="s2">&quot;bold&quot;</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;span&quot;</span><span class="s0">);</span><span class="s1">r</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-char-measure-element&quot;</span><span class="s0">),</span><span class="s1">r</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontStyle</span><span class="s0">=</span><span class="s2">&quot;italic&quot;</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;span&quot;</span><span class="s0">);</span><span class="s1">n</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-char-measure-element&quot;</span><span class="s0">),</span><span class="s1">n</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontWeight</span><span class="s0">=</span><span class="s2">&quot;bold&quot;</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontStyle</span><span class="s0">=</span><span class="s2">&quot;italic&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElements</span><span class="s0">=[</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">s</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">r</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">n</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">()}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElements</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_holey</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_flat</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(-</span><span class="s3">9999</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_holey</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Map</span><span class="s0">}</span><span class="s1">setFont</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">e</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_font</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fontSize</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_weight</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_weightBold</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_font</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fontSize</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_weight</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_weightBold</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontFamily</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_font</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_container</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontSize</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fontSize</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElements</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontWeight</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">}</span><span class="s2">`</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElements</span><span class="s0">[</span><span class="s3">1</span><span class="s0">].</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontWeight</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">s</span><span class="s0">}</span><span class="s2">`</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElements</span><span class="s0">[</span><span class="s3">2</span><span class="s0">].</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontWeight</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">}</span><span class="s2">`</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElements</span><span class="s0">[</span><span class="s3">3</span><span class="s0">].</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontWeight</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">s</span><span class="s0">}</span><span class="s2">`</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">())}</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">&amp;&amp;!</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s3">1</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">))&lt;</span><span class="s3">256</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(-</span><span class="s3">9999</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_flat</span><span class="s0">[</span><span class="s1">s</span><span class="s0">])</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_flat</span><span class="s0">[</span><span class="s1">s</span><span class="s0">];</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measure</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">);</span><span class="s4">return </span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_flat</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">),</span><span class="s1">t</span><span class="s0">}</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s1">r</span><span class="s0">+=</span><span class="s2">&quot;B&quot;</span><span class="s0">),</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s1">r</span><span class="s0">+=</span><span class="s2">&quot;I&quot;</span><span class="s0">);</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_holey</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">r</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">n</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">|=</span><span class="s3">1</span><span class="s0">),</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">|=</span><span class="s3">2</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measure</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">),</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_holey</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)}</span><span class="s4">return </span><span class="s1">n</span><span class="s0">}</span><span class="s1">_measure</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElements</span><span class="s0">[</span><span class="s1">t</span><span class="s0">];</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">repeat</span><span class="s0">(</span><span class="s3">32</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">offsetWidth</span><span class="s0">/</span><span class="s3">32</span><span class="s0">}}},</span><span class="s3">2223</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">TEXT_BASELINE</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DIM_OPACITY</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">INVERTED_DEFAULT_COLOR</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6114</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">INVERTED_DEFAULT_COLOR</span><span class="s0">=</span><span class="s3">257</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DIM_OPACITY</span><span class="s0">=</span><span class="s3">.5</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">TEXT_BASELINE</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">isFirefox</span><span class="s0">||</span><span class="s1">s</span><span class="s0">.</span><span class="s1">isLegacyEdge</span><span class="s0">?</span><span class="s2">&quot;bottom&quot;</span><span class="s0">:</span><span class="s2">&quot;ideographic&quot;</span><span class="s0">},</span><span class="s3">6171</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s4">function </span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">57508</span><span class="s0">&lt;=</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">57558</span><span class="s0">}</span><span class="s4">function </span><span class="s1">s</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">128512</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">128591</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">127744</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">128511</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">128640</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">128767</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">9728</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">9983</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">9984</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">10175</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">65024</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">65039</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">129280</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">129535</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">127462</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">127487</span><span class="s0">}</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">computeNextVariantOffset</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">createRenderDimensions</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">treatGlyphAsBackgroundColor</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">allowRescaling</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isEmoji</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isRestrictedPowerlineGlyph</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isPowerlineGlyph</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">throwIfFalsy</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">throwIfFalsy</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;value must not be falsy&quot;</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isPowerlineGlyph</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isRestrictedPowerlineGlyph</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">57520</span><span class="s0">&lt;=</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">57527</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isEmoji</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">allowRescaling</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">return </span><span class="s3">1</span><span class="s0">===</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">ceil</span><span class="s0">(</span><span class="s3">1.5</span><span class="s0">*</span><span class="s1">n</span><span class="s0">)&amp;&amp;</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">255</span><span class="s0">&amp;&amp;!</span><span class="s1">s</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)&amp;&amp;!</span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)&amp;&amp;!</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">57344</span><span class="s0">&lt;=</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">63743</span><span class="s0">}(</span><span class="s1">e</span><span class="s0">)},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">treatGlyphAsBackgroundColor</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">9472</span><span class="s0">&lt;=</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">9631</span><span class="s0">}(</span><span class="s1">e</span><span class="s0">)},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">createRenderDimensions</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(){</span><span class="s4">return</span><span class="s0">{</span><span class="s1">css</span><span class="s0">:{</span><span class="s1">canvas</span><span class="s0">:{</span><span class="s1">width</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">height</span><span class="s0">:</span><span class="s3">0</span><span class="s0">},</span><span class="s1">cell</span><span class="s0">:{</span><span class="s1">width</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">height</span><span class="s0">:</span><span class="s3">0</span><span class="s0">}},</span><span class="s1">device</span><span class="s0">:{</span><span class="s1">canvas</span><span class="s0">:{</span><span class="s1">width</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">height</span><span class="s0">:</span><span class="s3">0</span><span class="s0">},</span><span class="s1">cell</span><span class="s0">:{</span><span class="s1">width</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">height</span><span class="s0">:</span><span class="s3">0</span><span class="s0">},</span><span class="s1">char</span><span class="s0">:{</span><span class="s1">width</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">height</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">left</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">top</span><span class="s0">:</span><span class="s3">0</span><span class="s0">}}}},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">computeNextVariantOffset</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">){</span><span class="s4">return</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-(</span><span class="s3">2</span><span class="s0">*</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)-</span><span class="s1">i</span><span class="s0">))%(</span><span class="s3">2</span><span class="s0">*</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s1">t</span><span class="s0">))}},</span><span class="s3">6052</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">createSelectionRenderModel</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">class </span><span class="s1">i</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">()}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">hasSelection</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">columnSelectMode</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportStartRow</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportEndRow</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportCappedStartRow</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportCappedEndRow</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">startCol</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">endCol</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">}</span><span class="s1">update</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,!</span><span class="s1">t</span><span class="s0">||!</span><span class="s1">i</span><span class="s0">||</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]===</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">])</span><span class="s4">return void this</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">();</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]-</span><span class="s1">r</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]-</span><span class="s1">r</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">o</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">);</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">||</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">():(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">hasSelection</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">columnSelectMode</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportStartRow</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportEndRow</span><span class="s0">=</span><span class="s1">o</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportCappedStartRow</span><span class="s0">=</span><span class="s1">a</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportCappedEndRow</span><span class="s0">=</span><span class="s1">h</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">startCol</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">endCol</span><span class="s0">=</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])}</span><span class="s1">isCellSelected</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">return</span><span class="s0">!!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">hasSelection</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">-=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">viewportY</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">columnSelectMode</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">startCol</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">endCol</span><span class="s0">?</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">startCol</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportCappedStartRow</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">endCol</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportCappedEndRow</span><span class="s0">:</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">startCol</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportCappedStartRow</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">endCol</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportCappedEndRow</span><span class="s0">:</span><span class="s1">i</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportStartRow</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportEndRow</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportStartRow</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportEndRow</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportStartRow</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">startCol</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">endCol</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportStartRow</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportEndRow</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportEndRow</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">endCol</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportStartRow</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportEndRow</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">viewportStartRow</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">startCol</span><span class="s0">)}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">createSelectionRenderModel</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(){</span><span class="s4">return new </span><span class="s1">i</span><span class="s0">}},</span><span class="s3">456</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">SelectionModel</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">SelectionModel</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isSelectAllActive</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStartLength</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">clearSelection</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isSelectAllActive</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStartLength</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">get finalSelectionStart</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">isSelectAllActive</span><span class="s0">?[</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">]:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">areSelectionValuesReversed</span><span class="s0">()?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">}</span><span class="s1">get finalSelectionEnd</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isSelectAllActive</span><span class="s0">)</span><span class="s4">return</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">areSelectionValuesReversed</span><span class="s0">()){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStartLength</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">?</span><span class="s1">e</span><span class="s0">%</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">==</span><span class="s3">0</span><span class="s0">?[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">)-</span><span class="s3">1</span><span class="s0">]:[</span><span class="s1">e</span><span class="s0">%</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">)]:[</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]]}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStartLength</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStartLength</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">?[</span><span class="s1">e</span><span class="s0">%</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">)]:[</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]]}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">}}</span><span class="s1">areSelectionValuesReversed</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">;</span><span class="s4">return</span><span class="s0">!(!</span><span class="s1">e</span><span class="s0">||!</span><span class="s1">t</span><span class="s0">)&amp;&amp;(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&gt;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]||</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&gt;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])}</span><span class="s1">handleTrim</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]-=</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]-=</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;</span><span class="s3">0</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clearSelection</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">):(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]=</span><span class="s3">0</span><span class="s0">),!</span><span class="s3">1</span><span class="s0">)}}},</span><span class="s3">428</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CharSizeService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">);</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CharSizeService</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">a</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">get hasValidSize</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">width</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">height</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onCharSizeChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onCharSizeChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onCharSizeChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">;</span><span class="s4">try</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureStrategy</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">))}</span><span class="s4">catch</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureStrategy</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">l</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">))}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">onMultipleOptionChange</span><span class="s0">([</span><span class="s2">&quot;fontFamily&quot;</span><span class="s0">,</span><span class="s2">&quot;fontSize&quot;</span><span class="s0">],(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">measure</span><span class="s0">())))}</span><span class="s1">measure</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureStrategy</span><span class="s0">.</span><span class="s1">measure</span><span class="s0">();</span><span class="s1">e</span><span class="s0">.</span><span class="s1">width</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">width</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">height</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">height</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">width</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">height</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onCharSizeChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">())}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CharSizeService</span><span class="s0">=</span><span class="s1">h</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">)],</span><span class="s1">h</span><span class="s0">);</span><span class="s4">class </span><span class="s1">c </span><span class="s4">extends </span><span class="s1">a</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">super</span><span class="s0">(</span><span class="s1">...arguments</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_result</span><span class="s0">={</span><span class="s1">width</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">height</span><span class="s0">:</span><span class="s3">0</span><span class="s0">}}</span><span class="s1">_validateAndSet</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_result</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_result</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s1">t</span><span class="s0">)}}</span><span class="s4">class </span><span class="s1">l </span><span class="s4">extends </span><span class="s1">c</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parentElement</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElement</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;span&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElement</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;xterm-char-measure-element&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElement</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s2">&quot;W&quot;</span><span class="s0">.</span><span class="s1">repeat</span><span class="s0">(</span><span class="s3">32</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElement</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-hidden&quot;</span><span class="s0">,</span><span class="s2">&quot;true&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElement</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">whiteSpace</span><span class="s0">=</span><span class="s2">&quot;pre&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElement</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontKerning</span><span class="s0">=</span><span class="s2">&quot;none&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parentElement</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElement</span><span class="s0">)}</span><span class="s1">measure</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_measureElement</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontFamily</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontFamily</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElement</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">fontSize</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontSize</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_validateAndSet</span><span class="s0">(</span><span class="s1">Number</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElement</span><span class="s0">.</span><span class="s1">offsetWidth</span><span class="s0">)/</span><span class="s3">32</span><span class="s0">,</span><span class="s1">Number</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_measureElement</span><span class="s0">.</span><span class="s1">offsetHeight</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_result</span><span class="s0">}}</span><span class="s4">class </span><span class="s1">d </span><span class="s4">extends </span><span class="s1">c</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">=</span><span class="s4">new </span><span class="s1">OffscreenCanvas</span><span class="s0">(</span><span class="s3">100</span><span class="s0">,</span><span class="s3">100</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ctx</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvas</span><span class="s0">.</span><span class="s1">getContext</span><span class="s0">(</span><span class="s2">&quot;2d&quot;</span><span class="s0">);</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ctx</span><span class="s0">.</span><span class="s1">measureText</span><span class="s0">(</span><span class="s2">&quot;W&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!(</span><span class="s2">&quot;width&quot;</span><span class="s4">in </span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;fontBoundingBoxAscent&quot;</span><span class="s4">in </span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;fontBoundingBoxDescent&quot;</span><span class="s4">in </span><span class="s1">t</span><span class="s0">))</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;Required font metrics not supported&quot;</span><span class="s0">)}</span><span class="s1">measure</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ctx</span><span class="s0">.</span><span class="s1">font</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontSize</span><span class="s0">}</span><span class="s2">px </span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">fontFamily</span><span class="s0">}</span><span class="s2">`</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ctx</span><span class="s0">.</span><span class="s1">measureText</span><span class="s0">(</span><span class="s2">&quot;W&quot;</span><span class="s0">);</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_validateAndSet</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">width</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">fontBoundingBoxAscent</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">fontBoundingBoxDescent</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_result</span><span class="s0">}}},</span><span class="s3">4269</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CharacterJoinerService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">JoinedCellData</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3734</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">643</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">511</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">);</span><span class="s4">class </span><span class="s1">c </span><span class="s4">extends </span><span class="s1">n</span><span class="s0">.</span><span class="s1">AttributeData</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">content</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">combinedData</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">combinedData</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_width</span><span class="s0">=</span><span class="s1">i</span><span class="s0">}</span><span class="s1">isCombined</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">2097152</span><span class="s0">}</span><span class="s1">getWidth</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_width</span><span class="s0">}</span><span class="s1">getChars</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">combinedData</span><span class="s0">}</span><span class="s1">getCode</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">2097151</span><span class="s0">}</span><span class="s1">setFromCharData</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;not implemented&quot;</span><span class="s0">)}</span><span class="s1">getAsCharData</span><span class="s0">(){</span><span class="s4">return</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getChars</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getCode</span><span class="s0">()]}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">JoinedCellData</span><span class="s0">=</span><span class="s1">c</span><span class="s0">;</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CharacterJoinerService</span><span class="s0">=</span><span class="s4">class </span><span class="s1">e</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoiners</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nextCharacterJoinerId</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">=</span><span class="s4">new </span><span class="s1">a</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">}</span><span class="s1">register</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">={</span><span class="s1">id</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nextCharacterJoinerId</span><span class="s0">++,</span><span class="s1">handler</span><span class="s0">:</span><span class="s1">e</span><span class="s0">};</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_characterJoiners</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">id</span><span class="s0">}</span><span class="s1">deregister</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoiners</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoiners</span><span class="s0">[</span><span class="s1">t</span><span class="s0">].</span><span class="s1">id</span><span class="s0">===</span><span class="s1">e</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_characterJoiners</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">getJoinedCharacters</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoiners</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return</span><span class="s0">[];</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">||</span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return</span><span class="s0">[];</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=[],</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">translateToString</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">);</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getFg</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getBg</span><span class="s0">(</span><span class="s3">0</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">l</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getTrimmedLength</span><span class="s0">();</span><span class="s1">l</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">),</span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">()){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">!==</span><span class="s1">h</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">!==</span><span class="s1">c</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">-</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getJoinedRanges</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">r</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s1">i</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">])}</span><span class="s1">r</span><span class="s0">=</span><span class="s1">l</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s1">c</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">}</span><span class="s1">n</span><span class="s0">+=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">.</span><span class="s1">getChars</span><span class="s0">().</span><span class="s1">length</span><span class="s0">||</span><span class="s1">o</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CHAR</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getJoinedRanges</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">r</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s1">i</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">])}</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s1">_getJoinedRanges</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">const </span><span class="s1">o</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">substring</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=[];</span><span class="s4">try</span><span class="s0">{</span><span class="s1">a</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoiners</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">handler</span><span class="s0">(</span><span class="s1">o</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">console</span><span class="s0">.</span><span class="s1">error</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoiners</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">h</span><span class="s0">++)</span><span class="s4">try</span><span class="s0">{</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_characterJoiners</span><span class="s0">[</span><span class="s1">h</span><span class="s0">].</span><span class="s1">handler</span><span class="s0">(</span><span class="s1">o</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_mergeRanges</span><span class="s0">(</span><span class="s1">a</span><span class="s0">,</span><span class="s1">t</span><span class="s0">[</span><span class="s1">i</span><span class="s0">])}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">console</span><span class="s0">.</span><span class="s1">error</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_stringRangesToCellRanges</span><span class="s0">(</span><span class="s1">a</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">),</span><span class="s1">a</span><span class="s0">}</span><span class="s1">_stringRangesToCellRanges</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">;</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">;</span><span class="s1">h</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">h</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getString</span><span class="s0">(</span><span class="s1">h</span><span class="s0">).</span><span class="s1">length</span><span class="s0">||</span><span class="s1">o</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CHAR</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">a</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&lt;=</span><span class="s1">n</span><span class="s0">&amp;&amp;(</span><span class="s1">a</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">h</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">),</span><span class="s1">a</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;=</span><span class="s1">n</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">h</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[++</span><span class="s1">s</span><span class="s0">],!</span><span class="s1">a</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s1">a</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&lt;=</span><span class="s1">n</span><span class="s0">?(</span><span class="s1">a</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">h</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">):</span><span class="s1">r</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">n</span><span class="s0">+=</span><span class="s1">c</span><span class="s0">}}</span><span class="s1">a</span><span class="s0">&amp;&amp;(</span><span class="s1">a</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">)}}</span><span class="s4">static </span><span class="s1">_mergeRanges</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;=</span><span class="s1">r</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])</span><span class="s4">return </span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">][</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">],</span><span class="s1">e</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;=</span><span class="s1">r</span><span class="s0">[</span><span class="s3">1</span><span class="s0">])</span><span class="s4">return </span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">][</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">],</span><span class="s1">r</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s1">e</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s1">s</span><span class="s0">--}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;=</span><span class="s1">r</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">e</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;=</span><span class="s1">r</span><span class="s0">[</span><span class="s3">1</span><span class="s0">])</span><span class="s4">return </span><span class="s1">r</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">r</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]),</span><span class="s1">e</span><span class="s0">;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&lt;</span><span class="s1">r</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;(</span><span class="s1">r</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">r</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">)}}</span><span class="s4">return </span><span class="s1">i</span><span class="s0">?</span><span class="s1">e</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">][</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">e</span><span class="s0">}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CharacterJoinerService</span><span class="s0">=</span><span class="s1">l</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">)],</span><span class="s1">l</span><span class="s0">)},</span><span class="s3">5114</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CoreBrowserService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3656</span><span class="s0">);</span><span class="s4">class </span><span class="s1">o </span><span class="s4">extends </span><span class="s1">s</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_window</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">mainDocument</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isFocused</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedIsFocused</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenDprMonitor</span><span class="s0">=</span><span class="s4">new </span><span class="s1">a</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_window</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDprChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onDprChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDprChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onWindowChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onWindowChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onWindowChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onWindowChange</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenDprMonitor</span><span class="s0">.</span><span class="s1">setWindow</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">forwardEvent</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenDprMonitor</span><span class="s0">.</span><span class="s1">onDprChange</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDprChange</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;focus&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isFocused</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;blur&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isFocused</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">))}</span><span class="s1">get window</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_window</span><span class="s0">}</span><span class="s1">set window</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_window</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_window</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onWindowChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_window</span><span class="s0">))}</span><span class="s1">get dpr</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">window</span><span class="s0">.</span><span class="s1">devicePixelRatio</span><span class="s0">}</span><span class="s1">get isFocused</span><span class="s0">(){</span><span class="s4">return void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedIsFocused</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedIsFocused</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isFocused</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_textarea</span><span class="s0">.</span><span class="s1">ownerDocument</span><span class="s0">.</span><span class="s1">hasFocus</span><span class="s0">(),</span><span class="s1">queueMicrotask</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedIsFocused</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedIsFocused</span><span class="s0">}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CoreBrowserService</span><span class="s0">=</span><span class="s1">o</span><span class="s0">;</span><span class="s4">class </span><span class="s1">a </span><span class="s4">extends </span><span class="s1">s</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parentWindow</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowResizeListener</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">MutableDisposable</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDprChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onDprChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDprChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_outerListener</span><span class="s0">=()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setDprAndFireIfDiffers</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentDevicePixelRatio</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parentWindow</span><span class="s0">.</span><span class="s1">devicePixelRatio</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateDpr</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setWindowResizeListener</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clearListener</span><span class="s0">())))}</span><span class="s1">setWindow</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parentWindow</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setWindowResizeListener</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setDprAndFireIfDiffers</span><span class="s0">()}</span><span class="s1">_setWindowResizeListener</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowResizeListener</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">addDisposableDomListener</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parentWindow</span><span class="s0">,</span><span class="s2">&quot;resize&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setDprAndFireIfDiffers</span><span class="s0">()))}</span><span class="s1">_setDprAndFireIfDiffers</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parentWindow</span><span class="s0">.</span><span class="s1">devicePixelRatio</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentDevicePixelRatio</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDprChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parentWindow</span><span class="s0">.</span><span class="s1">devicePixelRatio</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateDpr</span><span class="s0">()}</span><span class="s1">_updateDpr</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_outerListener</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_resolutionMediaMatchList</span><span class="s0">?.</span><span class="s1">removeListener</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_outerListener</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_currentDevicePixelRatio</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parentWindow</span><span class="s0">.</span><span class="s1">devicePixelRatio</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_resolutionMediaMatchList</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parentWindow</span><span class="s0">.</span><span class="s1">matchMedia</span><span class="s0">(</span><span class="s2">`screen and (resolution: </span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parentWindow</span><span class="s0">.</span><span class="s1">devicePixelRatio</span><span class="s0">}</span><span class="s2">dppx)`</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_resolutionMediaMatchList</span><span class="s0">.</span><span class="s1">addListener</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_outerListener</span><span class="s0">))}</span><span class="s1">clearListener</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_resolutionMediaMatchList</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_outerListener</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_resolutionMediaMatchList</span><span class="s0">.</span><span class="s1">removeListener</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_outerListener</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_resolutionMediaMatchList</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_outerListener</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">)}}},</span><span class="s3">779</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">LinkProviderService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">);</span><span class="s4">class </span><span class="s1">r </span><span class="s4">extends </span><span class="s1">s</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">linkProviders</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">linkProviders</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">)))}</span><span class="s1">registerLinkProvider</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">linkProviders</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),{</span><span class="s1">dispose</span><span class="s0">:()=&gt;{</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">linkProviders</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">linkProviders</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)}}}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">LinkProviderService</span><span class="s0">=</span><span class="s1">r</span><span class="s0">},</span><span class="s3">8934</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MouseService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4725</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">9806</span><span class="s0">);</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MouseService</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s1">getCoords</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">){</span><span class="s4">return</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">getCoords</span><span class="s0">)(</span><span class="s1">window</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">.</span><span class="s1">hasValidSize</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">,</span><span class="s1">r</span><span class="s0">)}</span><span class="s1">getMouseReportCoords</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">getCoordsRelativeToElement</span><span class="s0">)(</span><span class="s1">window</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">.</span><span class="s1">hasValidSize</span><span class="s0">)</span><span class="s4">return </span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">],</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),{</span><span class="s1">col</span><span class="s0">:</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">width</span><span class="s0">),</span><span class="s1">row</span><span class="s0">:</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]/</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">cell</span><span class="s0">.</span><span class="s1">height</span><span class="s0">),</span><span class="s1">x</span><span class="s0">:</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]),</span><span class="s1">y</span><span class="s0">:</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">])}}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MouseService</span><span class="s0">=</span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">IRenderService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">ICharSizeService</span><span class="s0">)],</span><span class="s1">a</span><span class="s0">)},</span><span class="s3">3230</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">RenderService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6193</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4725</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">7226</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">);</span><span class="s4">let </span><span class="s1">d</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">RenderService</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">h</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">get dimensions</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">d</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">h</span><span class="s0">.</span><span class="s1">MutableDisposable</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_pausedResizeTask</span><span class="s0">=</span><span class="s4">new </span><span class="s1">c</span><span class="s0">.</span><span class="s1">DebouncedIdleTask</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_observerDisposable</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">h</span><span class="s0">.</span><span class="s1">MutableDisposable</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isPaused</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_needsFullRefresh</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isNextRenderRedrawOnly</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_needsSelectionRefresh</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvasWidth</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvasHeight</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionState</span><span class="s0">={</span><span class="s1">start</span><span class="s0">:</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">end</span><span class="s0">:</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">columnSelectMode</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDimensionsChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">a</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onDimensionsChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDimensionsChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRenderedViewportChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">a</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRenderedViewportChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRenderedViewportChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRender</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">a</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRender</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRender</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRefreshRequest</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">a</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRefreshRequest</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRefreshRequest</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderDebouncer</span><span class="s0">=</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">RenderDebouncer</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderRows</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)),</span><span class="s1">l</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderDebouncer</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">onDprChange</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">handleDevicePixelRatioChange</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">onResize</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fullRefresh</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">onBufferActivate</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">?.</span><span class="s1">clear</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">onOptionChange</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleOptionsChanged</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">.</span><span class="s1">onCharSizeChange</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">handleCharSizeChanged</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">onDecorationRegistered</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fullRefresh</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">onDecorationRemoved</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fullRefresh</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">onMultipleOptionChange</span><span class="s0">([</span><span class="s2">&quot;customGlyphs&quot;</span><span class="s0">,</span><span class="s2">&quot;drawBoldTextInBrightColors&quot;</span><span class="s0">,</span><span class="s2">&quot;letterSpacing&quot;</span><span class="s0">,</span><span class="s2">&quot;lineHeight&quot;</span><span class="s0">,</span><span class="s2">&quot;fontFamily&quot;</span><span class="s0">,</span><span class="s2">&quot;fontSize&quot;</span><span class="s0">,</span><span class="s2">&quot;fontWeight&quot;</span><span class="s0">,</span><span class="s2">&quot;fontWeightBold&quot;</span><span class="s0">,</span><span class="s2">&quot;minimumContrastRatio&quot;</span><span class="s0">,</span><span class="s2">&quot;rescaleOverlappingGlyphs&quot;</span><span class="s0">],(()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">handleResize</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fullRefresh</span><span class="s0">()}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">onMultipleOptionChange</span><span class="s0">([</span><span class="s2">&quot;cursorBlink&quot;</span><span class="s0">,</span><span class="s2">&quot;cursorStyle&quot;</span><span class="s0">],(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refreshRows</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">d</span><span class="s0">.</span><span class="s1">onChangeColors</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fullRefresh</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_registerIntersectionObserver</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">window</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">onWindowChange</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_registerIntersectionObserver</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">))))}</span><span class="s1">_registerIntersectionObserver</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;IntersectionObserver&quot;</span><span class="s4">in </span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">new </span><span class="s1">e</span><span class="s0">.</span><span class="s1">IntersectionObserver</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleIntersectionChange</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">])),{</span><span class="s1">threshold</span><span class="s0">:</span><span class="s3">0</span><span class="s0">});</span><span class="s1">i</span><span class="s0">.</span><span class="s1">observe</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_observerDisposable</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">disconnect</span><span class="s0">()))}}</span><span class="s1">_handleIntersectionChange</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isPaused</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isIntersecting</span><span class="s0">?</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">intersectionRatio</span><span class="s0">:!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isIntersecting</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isPaused</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">.</span><span class="s1">hasValidSize</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">.</span><span class="s1">measure</span><span class="s0">(),!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isPaused</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_needsFullRefresh</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_pausedResizeTask</span><span class="s0">.</span><span class="s1">flush</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refreshRows</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_needsFullRefresh</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">refreshRows</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isPaused</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_needsFullRefresh</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">:(</span><span class="s1">i</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isNextRenderRedrawOnly</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderDebouncer</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">))}</span><span class="s1">_renderRows</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">t</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">renderRows</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_needsSelectionRefresh</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">handleSelectionChanged</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionState</span><span class="s0">.</span><span class="s1">start</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionState</span><span class="s0">.</span><span class="s1">end</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionState</span><span class="s0">.</span><span class="s1">columnSelectMode</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_needsSelectionRefresh</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isNextRenderRedrawOnly</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRenderedViewportChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">start</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">end</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRender</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">start</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">end</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isNextRenderRedrawOnly</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fireOnCanvasResize</span><span class="s0">()}</span><span class="s1">_handleOptionsChanged</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refreshRows</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fireOnCanvasResize</span><span class="s0">())}</span><span class="s1">_fireOnCanvasResize</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">width</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvasWidth</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_canvasHeight</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDimensionsChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">))}</span><span class="s1">hasRenderer</span><span class="s0">(){</span><span class="s4">return</span><span class="s0">!!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">}</span><span class="s1">setRenderer</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">onRequestRedraw</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refreshRows</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">end</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_needsSelectionRefresh</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fullRefresh</span><span class="s0">())}</span><span class="s1">addRefreshCallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_renderDebouncer</span><span class="s0">.</span><span class="s1">addRefreshCallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">_fullRefresh</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isPaused</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_needsFullRefresh</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refreshRows</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">clearTextureAtlas</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">clearTextureAtlas</span><span class="s0">?.(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fullRefresh</span><span class="s0">())}</span><span class="s1">handleDevicePixelRatioChange</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charSizeService</span><span class="s0">.</span><span class="s1">measure</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">handleDevicePixelRatioChange</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refreshRows</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rowCount</span><span class="s0">-</span><span class="s3">1</span><span class="s0">))}</span><span class="s1">handleResize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isPaused</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_pausedResizeTask</span><span class="s0">.</span><span class="s1">set</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">?.</span><span class="s1">handleResize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">))):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">.</span><span class="s1">handleResize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fullRefresh</span><span class="s0">())}</span><span class="s1">handleCharSizeChanged</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">?.</span><span class="s1">handleCharSizeChanged</span><span class="s0">()}</span><span class="s1">handleBlur</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">?.</span><span class="s1">handleBlur</span><span class="s0">()}</span><span class="s1">handleFocus</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">?.</span><span class="s1">handleFocus</span><span class="s0">()}</span><span class="s1">handleSelectionChanged</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionState</span><span class="s0">.</span><span class="s1">start</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionState</span><span class="s0">.</span><span class="s1">end</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectionState</span><span class="s0">.</span><span class="s1">columnSelectMode</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">?.</span><span class="s1">handleSelectionChanged</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">handleCursorMove</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">?.</span><span class="s1">handleCursorMove</span><span class="s0">()}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderer</span><span class="s0">.</span><span class="s1">value</span><span class="s0">?.</span><span class="s1">clear</span><span class="s0">()}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">RenderService</span><span class="s0">=</span><span class="s1">d</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">ICharSizeService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">4</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">IDecorationService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">5</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">6</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">ICoreBrowserService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">7</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">IThemeService</span><span class="s0">)],</span><span class="s1">d</span><span class="s0">)},</span><span class="s3">9312</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">SelectionService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">9806</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">9504</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">456</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4725</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">d</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6114</span><span class="s0">),</span><span class="s1">_</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4841</span><span class="s0">),</span><span class="s1">u</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">511</span><span class="s0">),</span><span class="s1">f</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">v</span><span class="s0">=</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s3">160</span><span class="s0">),</span><span class="s1">p</span><span class="s0">=</span><span class="s4">new </span><span class="s1">RegExp</span><span class="s0">(</span><span class="s1">v</span><span class="s0">,</span><span class="s2">&quot;g&quot;</span><span class="s0">);</span><span class="s4">let </span><span class="s1">g</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">SelectionService</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">l</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">h</span><span class="s0">,</span><span class="s1">d</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkifier</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">=</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseService</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">o</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">=</span><span class="s1">h</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">=</span><span class="s1">d</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dragScrollAmount</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_enabled</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">=</span><span class="s4">new </span><span class="s1">u</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseDownTimeStamp</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldHasSelection</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldSelectionStart</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldSelectionEnd</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onLinuxMouseSelection</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">c</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onLinuxMouseSelection</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onLinuxMouseSelection</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRedrawRequest</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">c</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRequestRedraw</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRedrawRequest</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onSelectionChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">c</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onSelectionChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onSelectionChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestScrollLines</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">c</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRequestScrollLines</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestScrollLines</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseMoveListener</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleMouseMove</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseUpListener</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleMouseUp</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">onUserInput</span><span class="s0">((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">hasSelection</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clearSelection</span><span class="s0">()})),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_trimListener</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">onTrim</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleTrim</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">onBufferActivate</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleBufferActivate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">enable</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">=</span><span class="s4">new </span><span class="s1">a</span><span class="s0">.</span><span class="s1">SelectionModel</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeSelectionMode</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_removeMouseDownListeners</span><span class="s0">()})))}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clearSelection</span><span class="s0">()}</span><span class="s1">disable</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clearSelection</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_enabled</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">enable</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_enabled</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">get selectionStart</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionStart</span><span class="s0">}</span><span class="s1">get selectionEnd</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionEnd</span><span class="s0">}</span><span class="s1">get hasSelection</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionStart</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionEnd</span><span class="s0">;</span><span class="s4">return</span><span class="s0">!(!</span><span class="s1">e</span><span class="s0">||!</span><span class="s1">t</span><span class="s0">||</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]===</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">])}</span><span class="s1">get selectionText</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionStart</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionEnd</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">||!</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=[];</span><span class="s4">if</span><span class="s0">(</span><span class="s3">3</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeSelectionMode</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]===</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])</span><span class="s4">return</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&lt;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]?</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]:</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&lt;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]?</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]:</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">];</span><span class="s1">o</span><span class="s0">&lt;=</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">];</span><span class="s1">o</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">translateBufferLineToString</span><span class="s0">(</span><span class="s1">o</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">);</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]?</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]:</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">translateBufferLineToString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">],!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">r</span><span class="s0">));</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]+</span><span class="s3">1</span><span class="s0">;</span><span class="s1">n</span><span class="s0">&lt;=</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">n</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">n</span><span class="s0">),</span><span class="s1">t</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">translateBufferLineToString</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">);</span><span class="s1">e</span><span class="s0">?.</span><span class="s1">isWrapped</span><span class="s0">?</span><span class="s1">s</span><span class="s0">[</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]+=</span><span class="s1">t</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]!==</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">translateBufferLineToString</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">],!</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]);</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">?</span><span class="s1">s</span><span class="s0">[</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]+=</span><span class="s1">r</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)}}</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">replace</span><span class="s0">(</span><span class="s1">p</span><span class="s0">,</span><span class="s2">&quot; &quot;</span><span class="s0">))).</span><span class="s1">join</span><span class="s0">(</span><span class="s1">d</span><span class="s0">.</span><span class="s1">isWindows</span><span class="s0">?</span><span class="s2">&quot;</span><span class="s4">\r\n</span><span class="s2">&quot;</span><span class="s0">:</span><span class="s2">&quot;</span><span class="s4">\n</span><span class="s2">&quot;</span><span class="s0">)}</span><span class="s1">clearSelection</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">clearSelection</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_removeMouseDownListeners</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onSelectionChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">()}</span><span class="s1">refresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshAnimationFrame</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshAnimationFrame</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">.</span><span class="s1">requestAnimationFrame</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refresh</span><span class="s0">()))),</span><span class="s1">d</span><span class="s0">.</span><span class="s1">isLinux</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionText</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onLinuxMouseSelection</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionText</span><span class="s0">)}</span><span class="s1">_refresh</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_refreshAnimationFrame</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRedrawRequest</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">start</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionStart</span><span class="s0">,</span><span class="s1">end</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionEnd</span><span class="s0">,</span><span class="s1">columnSelectMode</span><span class="s0">:</span><span class="s3">3</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeSelectionMode</span><span class="s0">})}</span><span class="s1">_isClickInSelection</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getMouseBufferCoords</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionStart</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionEnd</span><span class="s0">;</span><span class="s4">return</span><span class="s0">!!(</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_areCoordsInSelection</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)}</span><span class="s1">isCellInSelection</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionStart</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionEnd</span><span class="s0">;</span><span class="s4">return</span><span class="s0">!(!</span><span class="s1">i</span><span class="s0">||!</span><span class="s1">s</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_areCoordsInSelection</span><span class="s0">([</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">],</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)}</span><span class="s1">_areCoordsInSelection</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&gt;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]||</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&gt;=</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&lt;</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&lt;</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;</span><span class="s1">i</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&gt;=</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]}</span><span class="s1">_selectWordAtCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_linkifier</span><span class="s0">.</span><span class="s1">currentLink</span><span class="s0">?.</span><span class="s1">link</span><span class="s0">?.</span><span class="s1">range</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">=[</span><span class="s1">i</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">x</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">y</span><span class="s0">-</span><span class="s3">1</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStartLength</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">_</span><span class="s0">.</span><span class="s1">getRangeLength</span><span class="s0">)(</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getMouseBufferCoords</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">s</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectWordAt</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">selectAll</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">isSelectAllActive</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onSelectionChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">()}</span><span class="s1">selectLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">clearSelection</span><span class="s0">(),</span><span class="s1">e</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">t</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">=[</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">=[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s1">t</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onSelectionChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">()}</span><span class="s1">_handleTrim</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">handleTrim</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">()}</span><span class="s1">_getMouseBufferCoords</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseService</span><span class="s0">.</span><span class="s1">getCoords</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return </span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]--,</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]--,</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]+=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">,</span><span class="s1">t</span><span class="s0">}</span><span class="s1">_getMouseEventScrollAmount</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">getCoordsRelativeToElement</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">)[</span><span class="s3">1</span><span class="s0">];</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_renderService</span><span class="s0">.</span><span class="s1">dimensions</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">canvas</span><span class="s0">.</span><span class="s1">height</span><span class="s0">;</span><span class="s4">return </span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;=</span><span class="s1">i</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">-=</span><span class="s1">i</span><span class="s0">),</span><span class="s1">t</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,-</span><span class="s3">50</span><span class="s0">),</span><span class="s3">50</span><span class="s0">),</span><span class="s1">t</span><span class="s0">/=</span><span class="s3">50</span><span class="s0">,</span><span class="s1">t</span><span class="s0">/</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">abs</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s3">14</span><span class="s0">*</span><span class="s1">t</span><span class="s0">))}</span><span class="s1">shouldForceSelection</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">d</span><span class="s0">.</span><span class="s1">isMac</span><span class="s0">?</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">macOptionClickForcesSelection</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">}</span><span class="s1">handleMouseDown</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseDownTimeStamp</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">timeStamp</span><span class="s0">,(</span><span class="s3">2</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">||!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">hasSelection</span><span class="s0">)&amp;&amp;</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_enabled</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">shouldForceSelection</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))</span><span class="s4">return</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">stopPropagation</span><span class="s0">()}</span><span class="s1">e</span><span class="s0">.</span><span class="s1">preventDefault</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dragScrollAmount</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_enabled</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleIncrementalClick</span><span class="s0">(</span><span class="s1">e</span><span class="s0">):</span><span class="s3">1</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">detail</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleSingleClick</span><span class="s0">(</span><span class="s1">e</span><span class="s0">):</span><span class="s3">2</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">detail</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleDoubleClick</span><span class="s0">(</span><span class="s1">e</span><span class="s0">):</span><span class="s3">3</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">detail</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleTripleClick</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addMouseDownListeners</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">)}}</span><span class="s1">_addMouseDownListeners</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">ownerDocument</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">ownerDocument</span><span class="s0">.</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;mousemove&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseMoveListener</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">ownerDocument</span><span class="s0">.</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;mouseup&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseUpListener</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dragScrollIntervalTimer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">.</span><span class="s1">setInterval</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dragScroll</span><span class="s0">()),</span><span class="s3">50</span><span class="s0">)}</span><span class="s1">_removeMouseDownListeners</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">ownerDocument</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">ownerDocument</span><span class="s0">.</span><span class="s1">removeEventListener</span><span class="s0">(</span><span class="s2">&quot;mousemove&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseMoveListener</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_screenElement</span><span class="s0">.</span><span class="s1">ownerDocument</span><span class="s0">.</span><span class="s1">removeEventListener</span><span class="s0">(</span><span class="s2">&quot;mouseup&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseUpListener</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreBrowserService</span><span class="s0">.</span><span class="s1">window</span><span class="s0">.</span><span class="s1">clearInterval</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dragScrollIntervalTimer</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dragScrollIntervalTimer</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">}</span><span class="s1">_handleIncrementalClick</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getMouseBufferCoords</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))}</span><span class="s1">_handleSingleClick</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStartLength</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">isSelectAllActive</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeSelectionMode</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">shouldColumnSelect</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)?</span><span class="s3">3</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getMouseBufferCoords</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]);</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">hasWidth</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]++}</span><span class="s1">_handleDoubleClick</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectWordAtCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeSelectionMode</span><span class="s0">=</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">_handleTripleClick</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getMouseBufferCoords</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeSelectionMode</span><span class="s0">=</span><span class="s3">2</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectLineAt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]))}</span><span class="s1">shouldColumnSelect</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">&amp;&amp;!(</span><span class="s1">d</span><span class="s0">.</span><span class="s1">isMac</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">macOptionClickForcesSelection</span><span class="s0">)}</span><span class="s1">_handleMouseMove</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">stopImmediatePropagation</span><span class="s0">(),!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">?[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]]:</span><span class="s4">null</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getMouseBufferCoords</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">)</span><span class="s4">return void this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">);</span><span class="s3">2</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeSelectionMode</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s3">0</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">:</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeSelectionMode</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectToWordAt</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dragScrollAmount</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getMouseEventScrollAmount</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s3">3</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeSelectionMode</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dragScrollAmount</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dragScrollAmount</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s3">0</span><span class="s0">));</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]);</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">hasWidth</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]++}</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">_dragScroll</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dragScrollAmount</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestScrollLines</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">amount</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dragScrollAmount</span><span class="s0">,</span><span class="s1">suppressScrollEvent</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">});</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dragScrollAmount</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">?(</span><span class="s3">3</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeSelectionMode</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)):(</span><span class="s3">3</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeSelectionMode</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">()}}</span><span class="s1">_handleMouseUp</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">timeStamp</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseDownTimeStamp</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_removeMouseDownListeners</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectionText</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;=</span><span class="s3">1</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s3">500</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">altClickMovesCursor</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_mouseService</span><span class="s0">.</span><span class="s1">getCoords</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_element</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">moveToCellSequence</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">applicationCursorKeys</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)}}}</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">_fireEventIfSelectionChanged</span><span class="s0">()}</span><span class="s1">_fireEventIfSelectionChanged</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionStart</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">finalSelectionEnd</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=!(!</span><span class="s1">e</span><span class="s0">||!</span><span class="s1">t</span><span class="s0">||</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]===</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]);</span><span class="s1">i</span><span class="s0">?</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldSelectionStart</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldSelectionEnd</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldSelectionStart</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldSelectionStart</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldSelectionEnd</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldSelectionEnd</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fireOnSelectionChange</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldHasSelection</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fireOnSelectionChange</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">_fireOnSelectionChange</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldSelectionStart</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldSelectionEnd</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oldHasSelection</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onSelectionChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">()}</span><span class="s1">_handleBufferActivate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clearSelection</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_trimListener</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_trimListener</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">onTrim</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleTrim</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))}</span><span class="s1">_convertViewportColToCharacterIndex</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s1">s</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">).</span><span class="s1">getChars</span><span class="s0">().</span><span class="s1">length</span><span class="s0">;</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">()?</span><span class="s1">i</span><span class="s0">--:</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">!==</span><span class="s1">s</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">+=</span><span class="s1">r</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)}</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s1">setSelection</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">clearSelection</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_removeMouseDownListeners</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">=[</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStartLength</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fireEventIfSelectionChanged</span><span class="s0">()}</span><span class="s1">rightClickSelect</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isClickInSelection</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_selectWordAtCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_fireEventIfSelectionChanged</span><span class="s0">())}</span><span class="s1">_getWordAt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">n</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">o</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">translateBufferLineToString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">],!</span><span class="s3">1</span><span class="s0">);</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_convertViewportColToCharacterIndex</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">a</span><span class="s0">;</span><span class="s4">const </span><span class="s1">c</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]-</span><span class="s1">a</span><span class="s0">;</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">d</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">_</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">u</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot; &quot;</span><span class="s0">===</span><span class="s1">o</span><span class="s0">.</span><span class="s1">charAt</span><span class="s0">(</span><span class="s1">a</span><span class="s0">)){</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">a</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s2">&quot; &quot;</span><span class="s0">===</span><span class="s1">o</span><span class="s0">.</span><span class="s1">charAt</span><span class="s0">(</span><span class="s1">a</span><span class="s0">-</span><span class="s3">1</span><span class="s0">);)</span><span class="s1">a</span><span class="s0">--;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s2">&quot; &quot;</span><span class="s0">===</span><span class="s1">o</span><span class="s0">.</span><span class="s1">charAt</span><span class="s0">(</span><span class="s1">h</span><span class="s0">+</span><span class="s3">1</span><span class="s0">);)</span><span class="s1">h</span><span class="s0">++}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s3">0</span><span class="s0">===</span><span class="s1">n</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)&amp;&amp;(</span><span class="s1">l</span><span class="s0">++,</span><span class="s1">t</span><span class="s0">--),</span><span class="s3">2</span><span class="s0">===</span><span class="s1">n</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)&amp;&amp;(</span><span class="s1">d</span><span class="s0">++,</span><span class="s1">i</span><span class="s0">++);</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">getString</span><span class="s0">(</span><span class="s1">i</span><span class="s0">).</span><span class="s1">length</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">&amp;&amp;(</span><span class="s1">u</span><span class="s0">+=</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">h</span><span class="s0">+=</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">);</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">a</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isCharWordSeparator</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">));){</span><span class="s1">n</span><span class="s0">.</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">);</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">.</span><span class="s1">getChars</span><span class="s0">().</span><span class="s1">length</span><span class="s0">;</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">()?(</span><span class="s1">l</span><span class="s0">++,</span><span class="s1">t</span><span class="s0">--):</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">&amp;&amp;(</span><span class="s1">_</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">a</span><span class="s0">-=</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">a</span><span class="s0">--,</span><span class="s1">t</span><span class="s0">--}</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s1">h</span><span class="s0">+</span><span class="s3">1</span><span class="s0">&lt;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isCharWordSeparator</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">i</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">));){</span><span class="s1">n</span><span class="s0">.</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">i</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">);</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">.</span><span class="s1">getChars</span><span class="s0">().</span><span class="s1">length</span><span class="s0">;</span><span class="s3">2</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">()?(</span><span class="s1">d</span><span class="s0">++,</span><span class="s1">i</span><span class="s0">++):</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">&amp;&amp;(</span><span class="s1">u</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">h</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">h</span><span class="s0">++,</span><span class="s1">i</span><span class="s0">++}}</span><span class="s1">h</span><span class="s0">++;</span><span class="s4">let </span><span class="s1">f</span><span class="s0">=</span><span class="s1">a</span><span class="s0">+</span><span class="s1">c</span><span class="s0">-</span><span class="s1">l</span><span class="s0">+</span><span class="s1">_</span><span class="s0">,</span><span class="s1">v</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s1">h</span><span class="s0">-</span><span class="s1">a</span><span class="s0">+</span><span class="s1">l</span><span class="s0">+</span><span class="s1">d</span><span class="s0">-</span><span class="s1">_</span><span class="s0">-</span><span class="s1">u</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">||</span><span class="s2">&quot;&quot;</span><span class="s0">!==</span><span class="s1">o</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">a</span><span class="s0">,</span><span class="s1">h</span><span class="s0">).</span><span class="s1">trim</span><span class="s0">()){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s3">0</span><span class="s0">===</span><span class="s1">f</span><span class="s0">&amp;&amp;</span><span class="s3">32</span><span class="s0">!==</span><span class="s1">n</span><span class="s0">.</span><span class="s1">getCodePoint</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">&amp;&amp;</span><span class="s3">32</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getCodePoint</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getWordAt</span><span class="s0">([</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]-</span><span class="s3">1</span><span class="s0">],!</span><span class="s3">1</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">start</span><span class="s0">;</span><span class="s1">f</span><span class="s0">-=</span><span class="s1">e</span><span class="s0">,</span><span class="s1">v</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">}}}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">f</span><span class="s0">+</span><span class="s1">v</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">&amp;&amp;</span><span class="s3">32</span><span class="s0">!==</span><span class="s1">n</span><span class="s0">.</span><span class="s1">getCodePoint</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]+</span><span class="s3">1</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">?.</span><span class="s1">isWrapped</span><span class="s0">&amp;&amp;</span><span class="s3">32</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getCodePoint</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getWordAt</span><span class="s0">([</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]+</span><span class="s3">1</span><span class="s0">],!</span><span class="s3">1</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">);</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s1">v</span><span class="s0">+=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)}}</span><span class="s4">return</span><span class="s0">{</span><span class="s1">start</span><span class="s0">:</span><span class="s1">f</span><span class="s0">,</span><span class="s1">length</span><span class="s0">:</span><span class="s1">v</span><span class="s0">}}}</span><span class="s1">_selectWordAt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getWordAt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">start</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">;)</span><span class="s1">i</span><span class="s0">.</span><span class="s1">start</span><span class="s0">+=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]--;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">=[</span><span class="s1">i</span><span class="s0">.</span><span class="s1">start</span><span class="s0">,</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStartLength</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}}</span><span class="s1">_selectToWordAt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getWordAt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">];</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">start</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">;)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">start</span><span class="s0">+=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s1">i</span><span class="s0">--;</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">areSelectionValuesReversed</span><span class="s0">())</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">start</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">;)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s1">i</span><span class="s0">++;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">=[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">areSelectionValuesReversed</span><span class="s0">()?</span><span class="s1">t</span><span class="s0">.</span><span class="s1">start</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">start</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">i</span><span class="s0">]}}</span><span class="s1">_isCharWordSeparator</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">()&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">wordSeparator</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">getChars</span><span class="s0">())&gt;=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">_selectLineAt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">getWrappedRangeForLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">i</span><span class="s0">={</span><span class="s1">start</span><span class="s0">:{</span><span class="s1">x</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">y</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">first</span><span class="s0">},</span><span class="s1">end</span><span class="s0">:{</span><span class="s1">x</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">y</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">last</span><span class="s0">}};</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStart</span><span class="s0">=[</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">first</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionEnd</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_model</span><span class="s0">.</span><span class="s1">selectionStartLength</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">_</span><span class="s0">.</span><span class="s1">getRangeLength</span><span class="s0">)(</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">)}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">SelectionService</span><span class="s0">=</span><span class="s1">g</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s1">f</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">4</span><span class="s0">,</span><span class="s1">f</span><span class="s0">.</span><span class="s1">ICoreService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">5</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IMouseService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">6</span><span class="s0">,</span><span class="s1">f</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">7</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IRenderService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">8</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">ICoreBrowserService</span><span class="s0">)],</span><span class="s1">g</span><span class="s0">)},</span><span class="s3">4725</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ILinkProviderService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IThemeService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ICharacterJoinerService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ISelectionService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IRenderService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IMouseService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ICoreBrowserService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ICharSizeService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8343</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ICharSizeService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;CharSizeService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ICoreBrowserService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;CoreBrowserService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IMouseService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;MouseService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IRenderService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;RenderService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ISelectionService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;SelectionService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ICharacterJoinerService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;CharacterJoinerService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IThemeService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;ThemeService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ILinkProviderService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;LinkProviderService&quot;</span><span class="s0">)},</span><span class="s3">6731</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ThemeService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">7239</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8055</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#ffffff&quot;</span><span class="s0">),</span><span class="s1">d</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#000000&quot;</span><span class="s0">),</span><span class="s1">_</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#ffffff&quot;</span><span class="s0">),</span><span class="s1">u</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#000000&quot;</span><span class="s0">),</span><span class="s1">f</span><span class="s0">={</span><span class="s1">css</span><span class="s0">:</span><span class="s2">&quot;rgba(255, 255, 255, 0.3)&quot;</span><span class="s0">,</span><span class="s1">rgba</span><span class="s0">:</span><span class="s3">4294967117</span><span class="s0">};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">freeze</span><span class="s0">((()=&gt;{</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=[</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#2e3436&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#cc0000&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#4e9a06&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#c4a000&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#3465a4&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#75507b&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#06989a&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#d3d7cf&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#555753&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#ef2929&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#8ae234&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#fce94f&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#729fcf&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#ad7fa8&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#34e2e2&quot;</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s2">&quot;#eeeeec&quot;</span><span class="s0">)],</span><span class="s1">t</span><span class="s0">=[</span><span class="s3">0</span><span class="s0">,</span><span class="s3">95</span><span class="s0">,</span><span class="s3">135</span><span class="s0">,</span><span class="s3">175</span><span class="s0">,</span><span class="s3">215</span><span class="s0">,</span><span class="s3">255</span><span class="s0">];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s3">216</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">i</span><span class="s0">/</span><span class="s3">36</span><span class="s0">%</span><span class="s3">6</span><span class="s0">|</span><span class="s3">0</span><span class="s0">],</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">i</span><span class="s0">/</span><span class="s3">6</span><span class="s0">%</span><span class="s3">6</span><span class="s0">|</span><span class="s3">0</span><span class="s0">],</span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">i</span><span class="s0">%</span><span class="s3">6</span><span class="s0">];</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">({</span><span class="s1">css</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">channels</span><span class="s0">.</span><span class="s1">toCss</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">),</span><span class="s1">rgba</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">channels</span><span class="s0">.</span><span class="s1">toRgba</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)})}</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s3">24</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s3">8</span><span class="s0">+</span><span class="s3">10</span><span class="s0">*</span><span class="s1">i</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">({</span><span class="s1">css</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">channels</span><span class="s0">.</span><span class="s1">toCss</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">rgba</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">channels</span><span class="s0">.</span><span class="s1">toRgba</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)})}</span><span class="s4">return </span><span class="s1">e</span><span class="s0">})());</span><span class="s4">let </span><span class="s1">v</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ThemeService</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">h</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">get colors</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_contrastCache</span><span class="s0">=</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">ColorContrastCache</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_halfContrastCache</span><span class="s0">=</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">ColorContrastCache</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onChangeColors</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">a</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onChangeColors</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onChangeColors</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">={</span><span class="s1">foreground</span><span class="s0">:</span><span class="s1">l</span><span class="s0">,</span><span class="s1">background</span><span class="s0">:</span><span class="s1">d</span><span class="s0">,</span><span class="s1">cursor</span><span class="s0">:</span><span class="s1">_</span><span class="s0">,</span><span class="s1">cursorAccent</span><span class="s0">:</span><span class="s1">u</span><span class="s0">,</span><span class="s1">selectionForeground</span><span class="s0">:</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">selectionBackgroundTransparent</span><span class="s0">:</span><span class="s1">f</span><span class="s0">,</span><span class="s1">selectionBackgroundOpaque</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">blend</span><span class="s0">(</span><span class="s1">d</span><span class="s0">,</span><span class="s1">f</span><span class="s0">),</span><span class="s1">selectionInactiveBackgroundTransparent</span><span class="s0">:</span><span class="s1">f</span><span class="s0">,</span><span class="s1">selectionInactiveBackgroundOpaque</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">blend</span><span class="s0">(</span><span class="s1">d</span><span class="s0">,</span><span class="s1">f</span><span class="s0">),</span><span class="s1">ansi</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(),</span><span class="s1">contrastCache</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_contrastCache</span><span class="s0">,</span><span class="s1">halfContrastCache</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_halfContrastCache</span><span class="s0">},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateRestoreColors</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setTheme</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">theme</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">onSpecificOptionChange</span><span class="s0">(</span><span class="s2">&quot;minimumContrastRatio&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_contrastCache</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">onSpecificOptionChange</span><span class="s0">(</span><span class="s2">&quot;theme&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setTheme</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">theme</span><span class="s0">))))}</span><span class="s1">_setTheme</span><span class="s0">(</span><span class="s1">e</span><span class="s0">={}){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">foreground</span><span class="s0">=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">foreground</span><span class="s0">,</span><span class="s1">l</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">background</span><span class="s0">=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">background</span><span class="s0">,</span><span class="s1">d</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">,</span><span class="s1">_</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">cursorAccent</span><span class="s0">=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cursorAccent</span><span class="s0">,</span><span class="s1">u</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionBackgroundTransparent</span><span class="s0">=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selectionBackground</span><span class="s0">,</span><span class="s1">f</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionBackgroundOpaque</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">blend</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">background</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionBackgroundTransparent</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionInactiveBackgroundTransparent</span><span class="s0">=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selectionInactiveBackground</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionBackgroundTransparent</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionInactiveBackgroundOpaque</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">blend</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">background</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionInactiveBackgroundTransparent</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionForeground</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selectionForeground</span><span class="s0">?</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selectionForeground</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">NULL_COLOR</span><span class="s0">):</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionForeground</span><span class="s0">===</span><span class="s1">o</span><span class="s0">.</span><span class="s1">NULL_COLOR</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionForeground</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">isOpaque</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionBackgroundTransparent</span><span class="s0">)){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s3">.3</span><span class="s0">;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionBackgroundTransparent</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">opacity</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionBackgroundTransparent</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">isOpaque</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionInactiveBackgroundTransparent</span><span class="s0">)){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s3">.3</span><span class="s0">;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionInactiveBackgroundTransparent</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">color</span><span class="s0">.</span><span class="s1">opacity</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selectionInactiveBackgroundTransparent</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">black</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">red</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">2</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">green</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">2</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">3</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">yellow</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">3</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">4</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">blue</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">4</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">5</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">magenta</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">5</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">6</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cyan</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">6</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">7</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">white</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">7</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">8</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">brightBlack</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">8</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">9</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">brightRed</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">9</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">10</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">brightGreen</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">10</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">11</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">brightYellow</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">11</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">12</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">brightBlue</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">12</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">13</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">brightMagenta</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">13</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">14</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">brightCyan</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">14</span><span class="s0">]),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s3">15</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">brightWhite</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s3">15</span><span class="s0">]),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">extendedAnsi</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">16</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">extendedAnsi</span><span class="s0">.</span><span class="s1">length</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">;</span><span class="s1">r</span><span class="s0">++)</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s1">r</span><span class="s0">+</span><span class="s3">16</span><span class="s0">]=</span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">extendedAnsi</span><span class="s0">[</span><span class="s1">r</span><span class="s0">],</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ANSI_COLORS</span><span class="s0">[</span><span class="s1">r</span><span class="s0">+</span><span class="s3">16</span><span class="s0">])}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_contrastCache</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_halfContrastCache</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateRestoreColors</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onChangeColors</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">colors</span><span class="s0">)}</span><span class="s1">restoreColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restoreColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onChangeColors</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">colors</span><span class="s0">)}</span><span class="s1">_restoreColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">)</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">case </span><span class="s3">256</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">.</span><span class="s1">foreground</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restoreColors</span><span class="s0">.</span><span class="s1">foreground</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">257</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">.</span><span class="s1">background</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restoreColors</span><span class="s0">.</span><span class="s1">background</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">258</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restoreColors</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">default</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restoreColors</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]}</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restoreColors</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">t</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restoreColors</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]}</span><span class="s1">modifyColors</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">e</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onChangeColors</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">colors</span><span class="s0">)}</span><span class="s1">_updateRestoreColors</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restoreColors</span><span class="s0">={</span><span class="s1">foreground</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">.</span><span class="s1">foreground</span><span class="s0">,</span><span class="s1">background</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">.</span><span class="s1">background</span><span class="s0">,</span><span class="s1">cursor</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">,</span><span class="s1">ansi</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_colors</span><span class="s0">.</span><span class="s1">ansi</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">()}}};</span><span class="s4">function </span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">)</span><span class="s4">try</span><span class="s0">{</span><span class="s4">return </span><span class="s1">o</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">{}</span><span class="s4">return </span><span class="s1">t</span><span class="s0">}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ThemeService</span><span class="s0">=</span><span class="s1">v</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">)],</span><span class="s1">v</span><span class="s0">)},</span><span class="s3">6349</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CircularList</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">);</span><span class="s4">class </span><span class="s1">n </span><span class="s4">extends </span><span class="s1">r</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onDeleteEmitter</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onDelete</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onDeleteEmitter</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onInsertEmitter</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onInsert</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onInsertEmitter</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onTrimEmitter</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onTrim</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onTrimEmitter</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Array</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_startIndex</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">get maxLength</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">}</span><span class="s1">set maxLength</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">===</span><span class="s1">e</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Array</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">);</span><span class="s1">i</span><span class="s0">++)</span><span class="s1">t</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCyclicIndex</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_startIndex</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">get length</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">}</span><span class="s1">set length</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCyclicIndex</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)]}</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCyclicIndex</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)]=</span><span class="s1">t</span><span class="s0">}</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCyclicIndex</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">)]=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_startIndex</span><span class="s0">=++</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_startIndex</span><span class="s0">%</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onTrimEmitter</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s3">1</span><span class="s0">)):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">++}</span><span class="s1">recycle</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;Can only recycle when the buffer is full&quot;</span><span class="s0">);</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_startIndex</span><span class="s0">=++</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_startIndex</span><span class="s0">%</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onTrimEmitter</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCyclicIndex</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)]}</span><span class="s1">get isFull</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">}</span><span class="s1">pop</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCyclicIndex</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">---</span><span class="s3">1</span><span class="s0">)]}</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">...i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">-</span><span class="s1">t</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCyclicIndex</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCyclicIndex</span><span class="s0">(</span><span class="s1">i</span><span class="s0">+</span><span class="s1">t</span><span class="s0">)];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">-=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onDeleteEmitter</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">index</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">amount</span><span class="s0">:</span><span class="s1">t</span><span class="s0">})}</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s1">e</span><span class="s0">;</span><span class="s1">s</span><span class="s0">--)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCyclicIndex</span><span class="s0">(</span><span class="s1">s</span><span class="s0">+</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCyclicIndex</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCyclicIndex</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s1">s</span><span class="s0">)]=</span><span class="s1">i</span><span class="s0">[</span><span class="s1">s</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onInsertEmitter</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">index</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">amount</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">+</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">+</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_startIndex</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onTrimEmitter</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">+=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}</span><span class="s1">trimStart</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_startIndex</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">-=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onTrimEmitter</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">shiftElements</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!(</span><span class="s1">t</span><span class="s0">&lt;=</span><span class="s3">0</span><span class="s0">)){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;start argument out of range&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;Cannot shift elements in list beyond index 0&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">r</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">r</span><span class="s0">--)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s1">r</span><span class="s0">+</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s1">r</span><span class="s0">));</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">+</span><span class="s1">t</span><span class="s0">+</span><span class="s1">i</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">+=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_length</span><span class="s0">--,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_startIndex</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onTrimEmitter</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s3">1</span><span class="s0">)}</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s1">s</span><span class="s0">+</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s1">s</span><span class="s0">))}}</span><span class="s1">_getCyclicIndex</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_startIndex</span><span class="s0">+</span><span class="s1">e</span><span class="s0">)%</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_maxLength</span><span class="s0">}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CircularList</span><span class="s0">=</span><span class="s1">n</span><span class="s0">},</span><span class="s3">1439</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">=</span><span class="s4">function </span><span class="s1">e</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s3">5</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">!=</span><span class="s4">typeof </span><span class="s1">t</span><span class="s0">)</span><span class="s4">return </span><span class="s1">t</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">Array</span><span class="s0">.</span><span class="s1">isArray</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)?[]:{};</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">r </span><span class="s4">in </span><span class="s1">t</span><span class="s0">)</span><span class="s1">s</span><span class="s0">[</span><span class="s1">r</span><span class="s0">]=</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s3">1</span><span class="s0">?</span><span class="s1">t</span><span class="s0">[</span><span class="s1">r</span><span class="s0">]:</span><span class="s1">t</span><span class="s0">[</span><span class="s1">r</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s1">r</span><span class="s0">],</span><span class="s1">i</span><span class="s0">-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">return </span><span class="s1">s</span><span class="s0">}},</span><span class="s3">8055</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">contrastRatio</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">toPaddedHex</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rgb</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">css</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">color</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">channels</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">NULL_COLOR</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">var </span><span class="s1">o</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">h</span><span class="s0">,</span><span class="s1">c</span><span class="s0">,</span><span class="s1">l</span><span class="s0">;</span><span class="s4">function </span><span class="s1">d</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toString</span><span class="s0">(</span><span class="s3">16</span><span class="s0">);</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s3">2</span><span class="s0">?</span><span class="s2">&quot;0&quot;</span><span class="s0">+</span><span class="s1">t</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}</span><span class="s4">function </span><span class="s1">_</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">?(</span><span class="s1">t</span><span class="s0">+</span><span class="s3">.05</span><span class="s0">)/(</span><span class="s1">e</span><span class="s0">+</span><span class="s3">.05</span><span class="s0">):(</span><span class="s1">e</span><span class="s0">+</span><span class="s3">.05</span><span class="s0">)/(</span><span class="s1">t</span><span class="s0">+</span><span class="s3">.05</span><span class="s0">)}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">NULL_COLOR</span><span class="s0">={</span><span class="s1">css</span><span class="s0">:</span><span class="s2">&quot;#00000000&quot;</span><span class="s0">,</span><span class="s1">rgba</span><span class="s0">:</span><span class="s3">0</span><span class="s0">},</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toCss</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">return void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">s</span><span class="s0">?</span><span class="s2">`#</span><span class="s1">$</span><span class="s0">{</span><span class="s1">d</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">d</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">d</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">d</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)}</span><span class="s2">`</span><span class="s0">:</span><span class="s2">`#</span><span class="s1">$</span><span class="s0">{</span><span class="s1">d</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">d</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">d</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)}</span><span class="s2">`</span><span class="s0">},</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toRgba</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s3">255</span><span class="s0">){</span><span class="s4">return</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;&lt;</span><span class="s3">24</span><span class="s0">|</span><span class="s1">t</span><span class="s0">&lt;&lt;</span><span class="s3">16</span><span class="s0">|</span><span class="s1">i</span><span class="s0">&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s1">s</span><span class="s0">)&gt;&gt;&gt;</span><span class="s3">0</span><span class="s0">},</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">){</span><span class="s4">return</span><span class="s0">{</span><span class="s1">css</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toCss</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">),</span><span class="s1">rgba</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toRgba</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">)}}}(</span><span class="s1">o</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">channels</span><span class="s0">=</span><span class="s1">o</span><span class="s0">={})),</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">function </span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">n</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s3">255</span><span class="s0">*</span><span class="s1">t</span><span class="s0">),[</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">]=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">toChannels</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">),{</span><span class="s1">css</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toCss</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">),</span><span class="s1">rgba</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toRgba</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)}}</span><span class="s1">e</span><span class="s0">.</span><span class="s1">blend</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">=(</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">)/</span><span class="s3">255</span><span class="s0">,</span><span class="s3">1</span><span class="s0">===</span><span class="s1">n</span><span class="s0">)</span><span class="s4">return</span><span class="s0">{</span><span class="s1">css</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">css</span><span class="s0">,</span><span class="s1">rgba</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">};</span><span class="s4">const </span><span class="s1">a</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">24</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">c</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">l</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">24</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">d</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">_</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">;</span><span class="s4">return </span><span class="s1">i</span><span class="s0">=</span><span class="s1">l</span><span class="s0">+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">((</span><span class="s1">a</span><span class="s0">-</span><span class="s1">l</span><span class="s0">)*</span><span class="s1">n</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s1">d</span><span class="s0">+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">((</span><span class="s1">h</span><span class="s0">-</span><span class="s1">d</span><span class="s0">)*</span><span class="s1">n</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">_</span><span class="s0">+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">((</span><span class="s1">c</span><span class="s0">-</span><span class="s1">_</span><span class="s0">)*</span><span class="s1">n</span><span class="s0">),{</span><span class="s1">css</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toCss</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">),</span><span class="s1">rgba</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toRgba</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">)}},</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isOpaque</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">255</span><span class="s0">==(</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">)},</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ensureContrastRatio</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">ensureContrastRatio</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return </span><span class="s1">o</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&gt;&gt;</span><span class="s3">24</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">s</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">s</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">)},</span><span class="s1">e</span><span class="s0">.</span><span class="s1">opaque</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=(</span><span class="s3">255</span><span class="s0">|</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">)&gt;&gt;&gt;</span><span class="s3">0</span><span class="s0">;</span><span class="s4">return</span><span class="s0">[</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">]=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">toChannels</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),{</span><span class="s1">css</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toCss</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">),</span><span class="s1">rgba</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}},</span><span class="s1">e</span><span class="s0">.</span><span class="s1">opacity</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">multiplyOpacity</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">return </span><span class="s1">n</span><span class="s0">=</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">,</span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">n</span><span class="s0">*</span><span class="s1">i</span><span class="s0">/</span><span class="s3">255</span><span class="s0">)},</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toColorRGB</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">24</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">]}}(</span><span class="s1">a</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">color</span><span class="s0">=</span><span class="s1">a</span><span class="s0">={})),</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">,</span><span class="s1">a</span><span class="s0">;</span><span class="s4">try</span><span class="s0">{</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;canvas&quot;</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">width</span><span class="s0">=</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">height</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">getContext</span><span class="s0">(</span><span class="s2">&quot;2d&quot;</span><span class="s0">,{</span><span class="s1">willReadFrequently</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">});</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">globalCompositeOperation</span><span class="s0">=</span><span class="s2">&quot;copy&quot;</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">createLinearGradient</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s3">1</span><span class="s0">))}</span><span class="s4">catch</span><span class="s0">{}</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">match</span><span class="s0">(</span><span class="s5">/#[\da-f]{3,8}/i</span><span class="s0">))</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">case </span><span class="s3">4</span><span class="s0">:</span><span class="s4">return </span><span class="s1">i</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s3">2</span><span class="s0">).</span><span class="s1">repeat</span><span class="s0">(</span><span class="s3">2</span><span class="s0">),</span><span class="s3">16</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s3">3</span><span class="s0">).</span><span class="s1">repeat</span><span class="s0">(</span><span class="s3">2</span><span class="s0">),</span><span class="s3">16</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s3">4</span><span class="s0">).</span><span class="s1">repeat</span><span class="s0">(</span><span class="s3">2</span><span class="s0">),</span><span class="s3">16</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">);</span><span class="s4">case </span><span class="s3">5</span><span class="s0">:</span><span class="s4">return </span><span class="s1">i</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s3">2</span><span class="s0">).</span><span class="s1">repeat</span><span class="s0">(</span><span class="s3">2</span><span class="s0">),</span><span class="s3">16</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s3">3</span><span class="s0">).</span><span class="s1">repeat</span><span class="s0">(</span><span class="s3">2</span><span class="s0">),</span><span class="s3">16</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s3">4</span><span class="s0">).</span><span class="s1">repeat</span><span class="s0">(</span><span class="s3">2</span><span class="s0">),</span><span class="s3">16</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">4</span><span class="s0">,</span><span class="s3">5</span><span class="s0">).</span><span class="s1">repeat</span><span class="s0">(</span><span class="s3">2</span><span class="s0">),</span><span class="s3">16</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">);</span><span class="s4">case </span><span class="s3">7</span><span class="s0">:</span><span class="s4">return</span><span class="s0">{</span><span class="s1">css</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">rgba</span><span class="s0">:(</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">1</span><span class="s0">),</span><span class="s3">16</span><span class="s0">)&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s3">255</span><span class="s0">)&gt;&gt;&gt;</span><span class="s3">0</span><span class="s0">};</span><span class="s4">case </span><span class="s3">9</span><span class="s0">:</span><span class="s4">return</span><span class="s0">{</span><span class="s1">css</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">rgba</span><span class="s0">:</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">1</span><span class="s0">),</span><span class="s3">16</span><span class="s0">)&gt;&gt;&gt;</span><span class="s3">0</span><span class="s0">}}</span><span class="s4">const </span><span class="s1">h</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">match</span><span class="s0">(</span><span class="s5">/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">)</span><span class="s4">return </span><span class="s1">i</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">h</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]),</span><span class="s1">s</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">h</span><span class="s0">[</span><span class="s3">2</span><span class="s0">]),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">h</span><span class="s0">[</span><span class="s3">3</span><span class="s0">]),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s3">255</span><span class="s0">*(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">h</span><span class="s0">[</span><span class="s3">5</span><span class="s0">]?</span><span class="s3">1</span><span class="s0">:</span><span class="s1">parseFloat</span><span class="s0">(</span><span class="s1">h</span><span class="s0">[</span><span class="s3">5</span><span class="s0">]))),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">||!</span><span class="s1">a</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;css.toColor: Unsupported css format&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">fillStyle</span><span class="s0">=</span><span class="s1">a</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">fillStyle</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s2">&quot;string&quot;</span><span class="s0">!=</span><span class="s4">typeof </span><span class="s1">t</span><span class="s0">.</span><span class="s1">fillStyle</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;css.toColor: Unsupported css format&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">fillRect</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),[</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getImageData</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s3">1</span><span class="s0">).</span><span class="s1">data</span><span class="s0">,</span><span class="s3">255</span><span class="s0">!==</span><span class="s1">n</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;css.toColor: Unsupported css format&quot;</span><span class="s0">);</span><span class="s4">return</span><span class="s0">{</span><span class="s1">rgba</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toRgba</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">),</span><span class="s1">css</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}}}(</span><span class="s1">h</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">css</span><span class="s0">=</span><span class="s1">h</span><span class="s0">={})),</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">function </span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">/</span><span class="s3">255</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">/</span><span class="s3">255</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">/</span><span class="s3">255</span><span class="s0">;</span><span class="s4">return</span><span class="s3">.2126</span><span class="s0">*(</span><span class="s1">s</span><span class="s0">&lt;=</span><span class="s3">.03928</span><span class="s0">?</span><span class="s1">s</span><span class="s0">/</span><span class="s3">12.92</span><span class="s0">:</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">pow</span><span class="s0">((</span><span class="s1">s</span><span class="s0">+</span><span class="s3">.055</span><span class="s0">)/</span><span class="s3">1.055</span><span class="s0">,</span><span class="s3">2.4</span><span class="s0">))+</span><span class="s3">.7152</span><span class="s0">*(</span><span class="s1">r</span><span class="s0">&lt;=</span><span class="s3">.03928</span><span class="s0">?</span><span class="s1">r</span><span class="s0">/</span><span class="s3">12.92</span><span class="s0">:</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">pow</span><span class="s0">((</span><span class="s1">r</span><span class="s0">+</span><span class="s3">.055</span><span class="s0">)/</span><span class="s3">1.055</span><span class="s0">,</span><span class="s3">2.4</span><span class="s0">))+</span><span class="s3">.0722</span><span class="s0">*(</span><span class="s1">n</span><span class="s0">&lt;=</span><span class="s3">.03928</span><span class="s0">?</span><span class="s1">n</span><span class="s0">/</span><span class="s3">12.92</span><span class="s0">:</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">pow</span><span class="s0">((</span><span class="s1">n</span><span class="s0">+</span><span class="s3">.055</span><span class="s0">)/</span><span class="s3">1.055</span><span class="s0">,</span><span class="s3">2.4</span><span class="s0">))}</span><span class="s1">e</span><span class="s0">.</span><span class="s1">relativeLuminance</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">)},</span><span class="s1">e</span><span class="s0">.</span><span class="s1">relativeLuminance2</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}(</span><span class="s1">c</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rgb</span><span class="s0">=</span><span class="s1">c</span><span class="s0">={})),</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">function </span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">24</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">24</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">l</span><span class="s0">=</span><span class="s1">_</span><span class="s0">(</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance2</span><span class="s0">(</span><span class="s1">o</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">h</span><span class="s0">),</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance2</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">));</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">l</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">a</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">h</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">);)</span><span class="s1">o</span><span class="s0">-=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">ceil</span><span class="s0">(</span><span class="s3">.1</span><span class="s0">*</span><span class="s1">o</span><span class="s0">)),</span><span class="s1">a</span><span class="s0">-=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">ceil</span><span class="s0">(</span><span class="s3">.1</span><span class="s0">*</span><span class="s1">a</span><span class="s0">)),</span><span class="s1">h</span><span class="s0">-=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">ceil</span><span class="s0">(</span><span class="s3">.1</span><span class="s0">*</span><span class="s1">h</span><span class="s0">)),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">_</span><span class="s0">(</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance2</span><span class="s0">(</span><span class="s1">o</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">h</span><span class="s0">),</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance2</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">));</span><span class="s4">return</span><span class="s0">(</span><span class="s1">o</span><span class="s0">&lt;&lt;</span><span class="s3">24</span><span class="s0">|</span><span class="s1">a</span><span class="s0">&lt;&lt;</span><span class="s3">16</span><span class="s0">|</span><span class="s1">h</span><span class="s0">&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s3">255</span><span class="s0">)&gt;&gt;&gt;</span><span class="s3">0</span><span class="s0">}</span><span class="s4">function </span><span class="s1">a</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">24</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">24</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">l</span><span class="s0">=</span><span class="s1">_</span><span class="s0">(</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance2</span><span class="s0">(</span><span class="s1">o</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">h</span><span class="s0">),</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance2</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">));</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">l</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s3">255</span><span class="s0">||</span><span class="s1">a</span><span class="s0">&lt;</span><span class="s3">255</span><span class="s0">||</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s3">255</span><span class="s0">);)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s3">255</span><span class="s0">,</span><span class="s1">o</span><span class="s0">+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">ceil</span><span class="s0">(</span><span class="s3">.1</span><span class="s0">*(</span><span class="s3">255</span><span class="s0">-</span><span class="s1">o</span><span class="s0">))),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s3">255</span><span class="s0">,</span><span class="s1">a</span><span class="s0">+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">ceil</span><span class="s0">(</span><span class="s3">.1</span><span class="s0">*(</span><span class="s3">255</span><span class="s0">-</span><span class="s1">a</span><span class="s0">))),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s3">255</span><span class="s0">,</span><span class="s1">h</span><span class="s0">+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">ceil</span><span class="s0">(</span><span class="s3">.1</span><span class="s0">*(</span><span class="s3">255</span><span class="s0">-</span><span class="s1">h</span><span class="s0">))),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">_</span><span class="s0">(</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance2</span><span class="s0">(</span><span class="s1">o</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">h</span><span class="s0">),</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance2</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">));</span><span class="s4">return</span><span class="s0">(</span><span class="s1">o</span><span class="s0">&lt;&lt;</span><span class="s3">24</span><span class="s0">|</span><span class="s1">a</span><span class="s0">&lt;&lt;</span><span class="s3">16</span><span class="s0">|</span><span class="s1">h</span><span class="s0">&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s3">255</span><span class="s0">)&gt;&gt;&gt;</span><span class="s3">0</span><span class="s0">}</span><span class="s1">e</span><span class="s0">.</span><span class="s1">blend</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">=(</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">)/</span><span class="s3">255</span><span class="s0">,</span><span class="s3">1</span><span class="s0">===</span><span class="s1">n</span><span class="s0">)</span><span class="s4">return </span><span class="s1">t</span><span class="s0">;</span><span class="s4">const </span><span class="s1">a</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">24</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">c</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">l</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">24</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">d</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">_</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">;</span><span class="s4">return </span><span class="s1">i</span><span class="s0">=</span><span class="s1">l</span><span class="s0">+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">((</span><span class="s1">a</span><span class="s0">-</span><span class="s1">l</span><span class="s0">)*</span><span class="s1">n</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s1">d</span><span class="s0">+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">((</span><span class="s1">h</span><span class="s0">-</span><span class="s1">d</span><span class="s0">)*</span><span class="s1">n</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">_</span><span class="s0">+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">((</span><span class="s1">c</span><span class="s0">-</span><span class="s1">_</span><span class="s0">)*</span><span class="s1">n</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toRgba</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">)},</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ensureContrastRatio</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">_</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)&lt;</span><span class="s1">s</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s1">r</span><span class="s0">){</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">_</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">a</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">return </span><span class="s1">o</span><span class="s0">&gt;</span><span class="s1">_</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">))?</span><span class="s1">n</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}</span><span class="s4">return </span><span class="s1">n</span><span class="s0">}</span><span class="s4">const </span><span class="s1">o</span><span class="s0">=</span><span class="s1">a</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">_</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance</span><span class="s0">(</span><span class="s1">o</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">){</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">return </span><span class="s1">h</span><span class="s0">&gt;</span><span class="s1">_</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">relativeLuminance</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">))?</span><span class="s1">o</span><span class="s0">:</span><span class="s1">n</span><span class="s0">}</span><span class="s4">return </span><span class="s1">o</span><span class="s0">}},</span><span class="s1">e</span><span class="s0">.</span><span class="s1">reduceLuminance</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">increaseLuminance</span><span class="s0">=</span><span class="s1">a</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toChannels</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s0">[</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">24</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">]}}(</span><span class="s1">l</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rgba</span><span class="s0">=</span><span class="s1">l</span><span class="s0">={})),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">toPaddedHex</span><span class="s0">=</span><span class="s1">d</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">contrastRatio</span><span class="s0">=</span><span class="s1">_</span><span class="s0">},</span><span class="s3">8969</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CoreTerminal</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4348</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">7866</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">744</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">7302</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6975</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">d</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">1753</span><span class="s0">),</span><span class="s1">_</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">1480</span><span class="s0">),</span><span class="s1">u</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">7994</span><span class="s0">),</span><span class="s1">f</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">9282</span><span class="s0">),</span><span class="s1">v</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">5435</span><span class="s0">),</span><span class="s1">p</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">5981</span><span class="s0">),</span><span class="s1">g</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2660</span><span class="s0">);</span><span class="s4">let </span><span class="s1">m</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">class </span><span class="s1">S </span><span class="s4">extends </span><span class="s1">s</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">get onScroll</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_onScrollApi</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScrollApi</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">l</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">.</span><span class="s1">event</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScrollApi</span><span class="s0">?.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">position</span><span class="s0">)}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScrollApi</span><span class="s0">.</span><span class="s1">event</span><span class="s0">}</span><span class="s1">get cols</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">}</span><span class="s1">get rows</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">}</span><span class="s1">get buffers</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">}</span><span class="s1">get options</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">}</span><span class="s1">set options</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t </span><span class="s4">in </span><span class="s1">e</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowsWrappingHeuristics</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">MutableDisposable</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBinary</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">l</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onBinary</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBinary</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onData</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">l</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onData</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onData</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onLineFeed</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">l</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onLineFeed</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onLineFeed</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onResize</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">l</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onResize</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onResize</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onWriteParsed</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">l</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onWriteParsed</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onWriteParsed</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">l</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">=</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">InstantiationService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">h</span><span class="s0">.</span><span class="s1">OptionsService</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">a</span><span class="s0">.</span><span class="s1">BufferService</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogService</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">ILogService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">c</span><span class="s0">.</span><span class="s1">CoreService</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">ICoreService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">d</span><span class="s0">.</span><span class="s1">CoreMouseService</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">ICoreMouseService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">unicodeService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">_</span><span class="s0">.</span><span class="s1">UnicodeService</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">IUnicodeService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">unicodeService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">u</span><span class="s0">.</span><span class="s1">CharsetService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">ICharsetService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscLinkService</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscLinkService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_instantiationService</span><span class="s0">.</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">IOscLinkService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscLinkService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">v</span><span class="s0">.</span><span class="s1">InputHandler</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscLinkService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">unicodeService</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">forwardEvent</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onLineFeed</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onLineFeed</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">forwardEvent</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">onResize</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onResize</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">forwardEvent</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">onData</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onData</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">forwardEvent</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">onBinary</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBinary</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">onRequestScrollToBottom</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollToBottom</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">onUserInput</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">handleUserInput</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">.</span><span class="s1">onMultipleOptionChange</span><span class="s0">([</span><span class="s2">&quot;windowsMode&quot;</span><span class="s0">,</span><span class="s2">&quot;windowsPty&quot;</span><span class="s0">],(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleWindowsPtyOptionChange</span><span class="s0">()))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">onScroll</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">position</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">,</span><span class="s1">source</span><span class="s0">:</span><span class="s3">0</span><span class="s0">}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">)}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">onScroll</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">position</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">,</span><span class="s1">source</span><span class="s0">:</span><span class="s3">0</span><span class="s0">}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">)}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">p</span><span class="s0">.</span><span class="s1">WriteBuffer</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">parse</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">forwardEvent</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">onWriteParsed</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onWriteParsed</span><span class="s0">))}</span><span class="s1">write</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">write</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">writeSync</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">logLevel</span><span class="s0">&lt;=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">WARN</span><span class="s0">&amp;&amp;!</span><span class="s1">m</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">warn</span><span class="s0">(</span><span class="s2">&quot;writeSync is unreliable and will be removed soon.&quot;</span><span class="s0">),</span><span class="s1">m</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">writeSync</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">input</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s1">isNaN</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)||</span><span class="s1">isNaN</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)||(</span><span class="s1">e</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">MINIMUM_COLS</span><span class="s0">),</span><span class="s1">t</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">MINIMUM_ROWS</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">))}</span><span class="s1">scroll</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">scroll</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">scrollPages</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">*(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">))}</span><span class="s1">scrollToTop</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollLines</span><span class="s0">(-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">)}</span><span class="s1">scrollToBottom</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">)}</span><span class="s1">scrollToLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">;</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">registerEscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">registerDcsHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">registerDcsHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">registerCsiHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">_setup</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handleWindowsPtyOptionChange</span><span class="s0">()}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_inputHandler</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">()}</span><span class="s1">_handleWindowsPtyOptionChange</span><span class="s0">(){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">windowsPty</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buildNumber</span><span class="s0">&amp;&amp;</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buildNumber</span><span class="s0">?</span><span class="s1">e</span><span class="s0">=!!(</span><span class="s2">&quot;conpty&quot;</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">backend</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buildNumber</span><span class="s0">&lt;</span><span class="s3">21376</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">windowsMode</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_enableWindowsWrappingHeuristics</span><span class="s0">():</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowsWrappingHeuristics</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">()}</span><span class="s1">_enableWindowsWrappingHeuristics</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowsWrappingHeuristics</span><span class="s0">.</span><span class="s1">value</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=[];</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onLineFeed</span><span class="s0">(</span><span class="s1">f</span><span class="s0">.</span><span class="s1">updateWindowsModeWrappedState</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">null</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">))),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;H&quot;</span><span class="s0">},(()=&gt;((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">f</span><span class="s0">.</span><span class="s1">updateWindowsModeWrappedState</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">),!</span><span class="s3">1</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowsWrappingHeuristics</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;{</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t of e</span><span class="s0">)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">()}))}}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CoreTerminal</span><span class="s0">=</span><span class="s1">S</span><span class="s0">},</span><span class="s3">8460</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">runAndSubscribe</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">forwardEvent</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_listeners</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_disposed</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">get event</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_event</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_event</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_listeners</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),{</span><span class="s1">dispose</span><span class="s0">:()=&gt;{</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_disposed</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_listeners</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_listeners</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]===</span><span class="s1">e</span><span class="s0">)</span><span class="s4">return void this</span><span class="s0">.</span><span class="s1">_listeners</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)}})),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_event</span><span class="s0">}</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_listeners</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++)</span><span class="s1">i</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_listeners</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++)</span><span class="s1">i</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">call</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clearListeners</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_disposed</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">clearListeners</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_listeners</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_listeners</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">)}},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">forwardEvent</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">runAndSubscribe</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))}},</span><span class="s3">5435</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">InputHandler</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">WindowsOptionsReportType</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2584</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">7116</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2015</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">482</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8437</span><span class="s0">),</span><span class="s1">d</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">_</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">643</span><span class="s0">),</span><span class="s1">u</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">511</span><span class="s0">),</span><span class="s1">f</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3734</span><span class="s0">),</span><span class="s1">v</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">p</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">1480</span><span class="s0">),</span><span class="s1">g</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6242</span><span class="s0">),</span><span class="s1">m</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6351</span><span class="s0">),</span><span class="s1">S</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">5941</span><span class="s0">),</span><span class="s1">C</span><span class="s0">={</span><span class="s2">&quot;(&quot;</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s2">&quot;)&quot;</span><span class="s0">:</span><span class="s3">1</span><span class="s0">,</span><span class="s2">&quot;*&quot;</span><span class="s0">:</span><span class="s3">2</span><span class="s0">,</span><span class="s2">&quot;+&quot;</span><span class="s0">:</span><span class="s3">3</span><span class="s0">,</span><span class="s2">&quot;-&quot;</span><span class="s0">:</span><span class="s3">1</span><span class="s0">,</span><span class="s2">&quot;.&quot;</span><span class="s0">:</span><span class="s3">2</span><span class="s0">},</span><span class="s1">b</span><span class="s0">=</span><span class="s3">131072</span><span class="s0">;</span><span class="s4">function </span><span class="s1">w</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">24</span><span class="s0">)</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">setWinLines</span><span class="s0">||!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">case </span><span class="s3">1</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">restoreWin</span><span class="s0">;</span><span class="s4">case </span><span class="s3">2</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">minimizeWin</span><span class="s0">;</span><span class="s4">case </span><span class="s3">3</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">setWinPosition</span><span class="s0">;</span><span class="s4">case </span><span class="s3">4</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">setWinSizePixels</span><span class="s0">;</span><span class="s4">case </span><span class="s3">5</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">raiseWin</span><span class="s0">;</span><span class="s4">case </span><span class="s3">6</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">lowerWin</span><span class="s0">;</span><span class="s4">case </span><span class="s3">7</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">refreshWin</span><span class="s0">;</span><span class="s4">case </span><span class="s3">8</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">setWinSizeChars</span><span class="s0">;</span><span class="s4">case </span><span class="s3">9</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">maximizeWin</span><span class="s0">;</span><span class="s4">case </span><span class="s3">10</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">fullscreenWin</span><span class="s0">;</span><span class="s4">case </span><span class="s3">11</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getWinState</span><span class="s0">;</span><span class="s4">case </span><span class="s3">13</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getWinPosition</span><span class="s0">;</span><span class="s4">case </span><span class="s3">14</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getWinSizePixels</span><span class="s0">;</span><span class="s4">case </span><span class="s3">15</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getScreenSizePixels</span><span class="s0">;</span><span class="s4">case </span><span class="s3">16</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getCellSizePixels</span><span class="s0">;</span><span class="s4">case </span><span class="s3">18</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getWinSizeChars</span><span class="s0">;</span><span class="s4">case </span><span class="s3">19</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getScreenSizeChars</span><span class="s0">;</span><span class="s4">case </span><span class="s3">20</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getIconTitle</span><span class="s0">;</span><span class="s4">case </span><span class="s3">21</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getWinTitle</span><span class="s0">;</span><span class="s4">case </span><span class="s3">22</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pushTitle</span><span class="s0">;</span><span class="s4">case </span><span class="s3">23</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">popTitle</span><span class="s0">;</span><span class="s4">case </span><span class="s3">24</span><span class="s0">:</span><span class="s4">return</span><span class="s0">!!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">setWinLines</span><span class="s0">}</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">}</span><span class="s4">var </span><span class="s1">y</span><span class="s0">;!</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">e</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">GET_WIN_SIZE_PIXELS</span><span class="s0">=</span><span class="s3">0</span><span class="s0">]=</span><span class="s2">&quot;GET_WIN_SIZE_PIXELS&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">GET_CELL_SIZE_PIXELS</span><span class="s0">=</span><span class="s3">1</span><span class="s0">]=</span><span class="s2">&quot;GET_CELL_SIZE_PIXELS&quot;</span><span class="s0">}(</span><span class="s1">y</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">WindowsOptionsReportType</span><span class="s0">=</span><span class="s1">y</span><span class="s0">={}));</span><span class="s4">let </span><span class="s1">E</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">class </span><span class="s1">k </span><span class="s4">extends </span><span class="s1">h</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">getAttrData</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">h</span><span class="s0">,</span><span class="s1">_</span><span class="s0">,</span><span class="s1">f</span><span class="s0">,</span><span class="s1">v</span><span class="s0">=</span><span class="s4">new </span><span class="s1">a</span><span class="s0">.</span><span class="s1">EscapeSequenceParser</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscLinkService</span><span class="s0">=</span><span class="s1">h</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreMouseService</span><span class="s0">=</span><span class="s1">_</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_unicodeService</span><span class="s0">=</span><span class="s1">f</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">=</span><span class="s1">v</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseBuffer</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint32Array</span><span class="s0">(</span><span class="s3">4096</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stringDecoder</span><span class="s0">=</span><span class="s4">new </span><span class="s1">c</span><span class="s0">.</span><span class="s1">StringToUtf32</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_utf8Decoder</span><span class="s0">=</span><span class="s4">new </span><span class="s1">c</span><span class="s0">.</span><span class="s1">Utf8ToUtf32</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_workCell</span><span class="s0">=</span><span class="s4">new </span><span class="s1">u</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowTitle</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_iconName</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowTitleStack</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_iconNameStack</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrDataInternal</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestBell</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRequestBell</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestBell</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestRefreshRows</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRequestRefreshRows</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestRefreshRows</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestReset</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRequestReset</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestReset</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestSendFocus</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRequestSendFocus</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestSendFocus</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestSyncScrollBar</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRequestSyncScrollBar</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestSyncScrollBar</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestWindowsOptionsReport</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRequestWindowsOptionsReport</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestWindowsOptionsReport</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onA11yChar</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onA11yChar</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onA11yChar</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onA11yTab</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onA11yTab</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onA11yTab</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onCursorMove</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onCursorMove</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onCursorMove</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onLineFeed</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onLineFeed</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onLineFeed</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onScroll</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onTitleChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onTitleChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onTitleChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onColor</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onColor</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onColor</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">={</span><span class="s1">paused</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">cursorStartX</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">cursorStartY</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">decodedLength</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">position</span><span class="s0">:</span><span class="s3">0</span><span class="s0">},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_specialColors</span><span class="s0">=[</span><span class="s3">256</span><span class="s0">,</span><span class="s3">257</span><span class="s0">,</span><span class="s3">258</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">=</span><span class="s4">new </span><span class="s1">L</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">onBufferActivate</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">activeBuffer</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setCsiHandlerFallback</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Unknown CSI code: &quot;</span><span class="s0">,{</span><span class="s1">identifier</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">identToString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">params</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">toArray</span><span class="s0">()})})),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setEscHandlerFallback</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Unknown ESC code: &quot;</span><span class="s0">,{</span><span class="s1">identifier</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">identToString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)})})),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandlerFallback</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Unknown EXECUTE code: &quot;</span><span class="s0">,{</span><span class="s1">code</span><span class="s0">:</span><span class="s1">e</span><span class="s0">})})),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setOscHandlerFallback</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Unknown OSC code: &quot;</span><span class="s0">,{</span><span class="s1">identifier</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">action</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">data</span><span class="s0">:</span><span class="s1">i</span><span class="s0">})})),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setDcsHandlerFallback</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s2">&quot;HOOK&quot;</span><span class="s0">===</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">toArray</span><span class="s0">()),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Unknown DCS code: &quot;</span><span class="s0">,{</span><span class="s1">identifier</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">identToString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">action</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">payload</span><span class="s0">:</span><span class="s1">i</span><span class="s0">})})),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setPrintHandler</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">print</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;@&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">insertChars</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot; &quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;@&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollLeft</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;A&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cursorUp</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot; &quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;A&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollRight</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;B&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cursorDown</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;C&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cursorForward</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;D&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cursorBackward</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;E&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cursorNextLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;F&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cursorPrecedingLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;G&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cursorCharAbsolute</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;H&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cursorPosition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;I&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cursorForwardTab</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;J&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">eraseInDisplay</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">prefix</span><span class="s0">:</span><span class="s2">&quot;?&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;J&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">eraseInDisplay</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;K&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">eraseInLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">prefix</span><span class="s0">:</span><span class="s2">&quot;?&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;K&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">eraseInLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;L&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">insertLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;M&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">deleteLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;P&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">deleteChars</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;S&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollUp</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;T&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollDown</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;X&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">eraseChars</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;Z&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cursorBackwardTab</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;`&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">charPosAbsolute</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;a&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">hPositionRelative</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;b&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">repeatPrecedingCharacter</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;c&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">sendDeviceAttributesPrimary</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">prefix</span><span class="s0">:</span><span class="s2">&quot;&gt;&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;c&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">sendDeviceAttributesSecondary</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;d&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">linePosAbsolute</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;e&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">vPositionRelative</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;f&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">hVPosition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;g&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tabClear</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;h&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setMode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">prefix</span><span class="s0">:</span><span class="s2">&quot;?&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;h&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setModePrivate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;l&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">resetMode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">prefix</span><span class="s0">:</span><span class="s2">&quot;?&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;l&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">resetModePrivate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;m&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">charAttributes</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;n&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">deviceStatus</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">prefix</span><span class="s0">:</span><span class="s2">&quot;?&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;n&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">deviceStatusPrivate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;!&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;p&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">softReset</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot; &quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;q&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCursorStyle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;r&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setScrollRegion</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;s&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">saveCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;t&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">windowOptions</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;u&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">restoreCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;'&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;}&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">insertColumns</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;'&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;~&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">deleteColumns</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">'&quot;'</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;q&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectProtected</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;$&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;p&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">requestMode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">({</span><span class="s1">prefix</span><span class="s0">:</span><span class="s2">&quot;?&quot;</span><span class="s0">,</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;$&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;p&quot;</span><span class="s0">},(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">requestMode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">BEL</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bell</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">LF</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lineFeed</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">VT</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lineFeed</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">FF</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lineFeed</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">CR</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">carriageReturn</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">BS</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">backspace</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">HT</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tab</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">SO</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">shiftOut</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">SI</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">shiftIn</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C1</span><span class="s0">.</span><span class="s1">IND</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C1</span><span class="s0">.</span><span class="s1">NEL</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nextLine</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C1</span><span class="s0">.</span><span class="s1">HTS</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tabSet</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setTitle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setIconName</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setIconName</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setTitle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s3">4</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setOrReportIndexedColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s3">8</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setHyperlink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s3">10</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setOrReportFgColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s3">11</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setOrReportBgColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s3">12</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setOrReportCursorColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s3">104</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">restoreIndexedColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s3">110</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">restoreFgColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s3">111</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">restoreBgColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s3">112</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">restoreCursorColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;7&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">saveCursor</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;8&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">restoreCursor</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;D&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;E&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nextLine</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;H&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tabSet</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;M&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reverseIndex</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;=&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">keypadApplicationMode</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;&gt;&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">keypadNumericMode</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;c&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fullReset</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;n&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setgLevel</span><span class="s0">(</span><span class="s3">2</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;o&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setgLevel</span><span class="s0">(</span><span class="s3">3</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;|&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setgLevel</span><span class="s0">(</span><span class="s3">3</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;}&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setgLevel</span><span class="s0">(</span><span class="s3">2</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;~&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setgLevel</span><span class="s0">(</span><span class="s3">1</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;%&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;@&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectDefaultCharset</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;%&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;G&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectDefaultCharset</span><span class="s0">()));</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">n </span><span class="s4">in </span><span class="s1">o</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;(&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s1">n</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectCharset</span><span class="s0">(</span><span class="s2">&quot;(&quot;</span><span class="s0">+</span><span class="s1">n</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;)&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s1">n</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectCharset</span><span class="s0">(</span><span class="s2">&quot;)&quot;</span><span class="s0">+</span><span class="s1">n</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;*&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s1">n</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectCharset</span><span class="s0">(</span><span class="s2">&quot;*&quot;</span><span class="s0">+</span><span class="s1">n</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;+&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s1">n</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectCharset</span><span class="s0">(</span><span class="s2">&quot;+&quot;</span><span class="s0">+</span><span class="s1">n</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;-&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s1">n</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectCharset</span><span class="s0">(</span><span class="s2">&quot;-&quot;</span><span class="s0">+</span><span class="s1">n</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;.&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s1">n</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectCharset</span><span class="s0">(</span><span class="s2">&quot;.&quot;</span><span class="s0">+</span><span class="s1">n</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;/&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s1">n</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectCharset</span><span class="s0">(</span><span class="s2">&quot;/&quot;</span><span class="s0">+</span><span class="s1">n</span><span class="s0">)));</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;#&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;8&quot;</span><span class="s0">},(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">screenAlignmentPattern</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">setErrorHandler</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">error</span><span class="s0">(</span><span class="s2">&quot;Parsing error: &quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">),</span><span class="s1">e</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerDcsHandler</span><span class="s0">({</span><span class="s1">intermediates</span><span class="s0">:</span><span class="s2">&quot;$&quot;</span><span class="s0">,</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;q&quot;</span><span class="s0">},</span><span class="s4">new </span><span class="s1">m</span><span class="s0">.</span><span class="s1">DcsHandler</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">requestStatusString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">))))}</span><span class="s1">_preserveStack</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">cursorStartX</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">cursorStartY</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">decodedLength</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">position</span><span class="s0">=</span><span class="s1">s</span><span class="s0">}</span><span class="s1">_logSlowResolvingAsync</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">logLevel</span><span class="s0">&lt;=</span><span class="s1">v</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">WARN</span><span class="s0">&amp;&amp;</span><span class="s1">Promise</span><span class="s0">.</span><span class="s1">race</span><span class="s0">([</span><span class="s1">e</span><span class="s0">,</span><span class="s4">new </span><span class="s1">Promise</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;</span><span class="s1">t</span><span class="s0">(</span><span class="s2">&quot;#SLOW_TIMEOUT&quot;</span><span class="s0">)),</span><span class="s3">5e3</span><span class="s0">)))]).</span><span class="s1">catch</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;#SLOW_TIMEOUT&quot;</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">)</span><span class="s4">throw </span><span class="s1">e</span><span class="s0">;</span><span class="s1">console</span><span class="s0">.</span><span class="s1">warn</span><span class="s0">(</span><span class="s2">&quot;async parser handler taking longer than 5000 ms&quot;</span><span class="s0">)}))}</span><span class="s1">_getCurrentLinkId</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">urlId</span><span class="s0">}</span><span class="s1">parse</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">parse</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseBuffer</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">decodedLength</span><span class="s0">,</span><span class="s1">t</span><span class="s0">))</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_logSlowResolvingAsync</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s1">i</span><span class="s0">;</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">cursorStartX</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">cursorStartY</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">b</span><span class="s0">&amp;&amp;(</span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">position</span><span class="s0">+</span><span class="s1">b</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">logLevel</span><span class="s0">&lt;=</span><span class="s1">v</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">DEBUG</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;parsing data&quot;</span><span class="s0">+(</span><span class="s2">&quot;string&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">e</span><span class="s0">?</span><span class="s2">` &quot;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">&quot;`</span><span class="s0">:</span><span class="s2">` &quot;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">Array</span><span class="s0">.</span><span class="s1">prototype</span><span class="s0">.</span><span class="s1">map</span><span class="s0">.</span><span class="s1">call</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))).</span><span class="s1">join</span><span class="s0">(</span><span class="s2">&quot;&quot;</span><span class="s0">)}</span><span class="s2">&quot;`</span><span class="s0">),</span><span class="s2">&quot;string&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">e</span><span class="s0">?</span><span class="s1">e</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s2">&quot;&quot;</span><span class="s0">).</span><span class="s1">map</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">))):</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseBuffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseBuffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s1">b</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseBuffer</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint32Array</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">b</span><span class="s0">))),</span><span class="s1">o</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">clearRange</span><span class="s0">(),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">b</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">c</span><span class="s0">=</span><span class="s1">n</span><span class="s0">;</span><span class="s1">c</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">c</span><span class="s0">+=</span><span class="s1">b</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">c</span><span class="s0">+</span><span class="s1">b</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s1">c</span><span class="s0">+</span><span class="s1">b</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s2">&quot;string&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">e</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stringDecoder</span><span class="s0">.</span><span class="s1">decode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">substring</span><span class="s0">(</span><span class="s1">c</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseBuffer</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_utf8Decoder</span><span class="s0">.</span><span class="s1">decode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">subarray</span><span class="s0">(</span><span class="s1">c</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseBuffer</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">parse</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseBuffer</span><span class="s0">,</span><span class="s1">n</span><span class="s0">))</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_preserveStack</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">c</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logSlowResolvingAsync</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s1">i</span><span class="s0">}</span><span class="s4">else if</span><span class="s0">(!</span><span class="s1">o</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s2">&quot;string&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">e</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stringDecoder</span><span class="s0">.</span><span class="s1">decode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseBuffer</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_utf8Decoder</span><span class="s0">.</span><span class="s1">decode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseBuffer</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">parse</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseBuffer</span><span class="s0">,</span><span class="s1">t</span><span class="s0">))</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_preserveStack</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logSlowResolvingAsync</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s1">i</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">===</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">===</span><span class="s1">r</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onCursorMove</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">();</span><span class="s4">const </span><span class="s1">a</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">end</span><span class="s0">+(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">start</span><span class="s0">+(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">);</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestRefreshRows</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">h</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">a</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">))}</span><span class="s1">print</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">charset</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">screenReaderMode</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">wraparound</span><span class="s0">,</span><span class="s1">d</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">modes</span><span class="s0">.</span><span class="s1">insertMode</span><span class="s0">,</span><span class="s1">u</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">;</span><span class="s4">let </span><span class="s1">f</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">-</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s3">2</span><span class="s0">===</span><span class="s1">f</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)&amp;&amp;</span><span class="s1">f</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">u</span><span class="s0">);</span><span class="s4">let </span><span class="s1">v</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">precedingJoinState</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">g</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s1">g</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">;++</span><span class="s1">g</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">g</span><span class="s0">],</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s3">127</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">n</span><span class="s0">[</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)];</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">))}</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_unicodeService</span><span class="s0">.</span><span class="s1">charProperties</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">v</span><span class="s0">);</span><span class="s1">r</span><span class="s0">=</span><span class="s1">p</span><span class="s0">.</span><span class="s1">UnicodeService</span><span class="s0">.</span><span class="s1">extractWidth</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">p</span><span class="s0">.</span><span class="s1">UnicodeService</span><span class="s0">.</span><span class="s1">extractShouldJoin</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">m</span><span class="s0">=</span><span class="s1">i</span><span class="s0">?</span><span class="s1">p</span><span class="s0">.</span><span class="s1">UnicodeService</span><span class="s0">.</span><span class="s1">extractWidth</span><span class="s0">(</span><span class="s1">v</span><span class="s0">):</span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">v</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onA11yChar</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">stringFromCodePoint</span><span class="s0">)(</span><span class="s1">s</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCurrentLinkId</span><span class="s0">()&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscLinkService</span><span class="s0">.</span><span class="s1">addLineToLink</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCurrentLinkId</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">+</span><span class="s1">r</span><span class="s0">-</span><span class="s1">m</span><span class="s0">&gt;</span><span class="s1">a</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">f</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">-</span><span class="s1">m</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s1">m</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">+</span><span class="s3">1</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">--,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">scroll</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">)):(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">).</span><span class="s1">isWrapped</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">),</span><span class="s1">f</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),</span><span class="s1">m</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">f </span><span class="s4">instanceof </span><span class="s1">l</span><span class="s0">.</span><span class="s1">BufferLine</span><span class="s0">&amp;&amp;</span><span class="s1">f</span><span class="s0">.</span><span class="s1">copyCellsFrom</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">m</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">);</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">a</span><span class="s0">;)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s1">t</span><span class="s0">++,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">u</span><span class="s0">)}</span><span class="s4">else if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s1">a</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s3">2</span><span class="s0">===</span><span class="s1">r</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">f</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">2</span><span class="s0">;</span><span class="s1">f</span><span class="s0">.</span><span class="s1">addCodepointToCell</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">-</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">r</span><span class="s0">-</span><span class="s1">m</span><span class="s0">;--</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;)</span><span class="s1">f</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">++,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">u</span><span class="s0">)}</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">d</span><span class="s0">&amp;&amp;(</span><span class="s1">f</span><span class="s0">.</span><span class="s1">insertCells</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">r</span><span class="s0">-</span><span class="s1">m</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s1">u</span><span class="s0">)),</span><span class="s3">2</span><span class="s0">===</span><span class="s1">f</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">a</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)&amp;&amp;</span><span class="s1">f</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s1">a</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">_</span><span class="s0">.</span><span class="s1">NULL_CELL_CODE</span><span class="s0">,</span><span class="s1">_</span><span class="s0">.</span><span class="s1">NULL_CELL_WIDTH</span><span class="s0">,</span><span class="s1">u</span><span class="s0">)),</span><span class="s1">f</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">++,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">u</span><span class="s0">),</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(;--</span><span class="s1">r</span><span class="s0">;)</span><span class="s1">f</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">++,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">u</span><span class="s0">)}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">precedingJoinState</span><span class="s0">=</span><span class="s1">v</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">&lt;</span><span class="s1">a</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">-</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s3">0</span><span class="s0">===</span><span class="s1">f</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">)&amp;&amp;!</span><span class="s1">f</span><span class="s0">.</span><span class="s1">hasContent</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">)&amp;&amp;</span><span class="s1">f</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">u</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)}</span><span class="s1">registerCsiHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return</span><span class="s2">&quot;t&quot;</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">final</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">prefix</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">intermediates</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;!</span><span class="s1">w</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">windowOptions</span><span class="s0">)||</span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))}</span><span class="s1">registerDcsHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerDcsHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">new </span><span class="s1">m</span><span class="s0">.</span><span class="s1">DcsHandler</span><span class="s0">(</span><span class="s1">t</span><span class="s0">))}</span><span class="s1">registerEscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">new </span><span class="s1">g</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">(</span><span class="s1">t</span><span class="s0">))}</span><span class="s1">bell</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_onRequestBell</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">lineFeed</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">convertEol</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">+</span><span class="s3">1</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">--,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">scroll</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">())):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">).</span><span class="s1">isWrapped</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">--,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onLineFeed</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">carriageReturn</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">backspace</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">reverseWraparound</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">--,!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">--;</span><span class="s4">else if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)?.</span><span class="s1">isWrapped</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">).</span><span class="s1">isWrapped</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">--,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">hasWidth</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">)&amp;&amp;!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">hasContent</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">--}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">tab</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">nextStop</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">screenReaderMode</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onA11yTab</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">-</span><span class="s1">e</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">shiftOut</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">setgLevel</span><span class="s0">(</span><span class="s3">1</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">shiftIn</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">setgLevel</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">_restrictCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">?</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)):</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)}</span><span class="s1">_setCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">+</span><span class="s1">t</span><span class="s0">):(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)}</span><span class="s1">_moveCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setCursor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">+</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">+</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">cursorUp</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">;</span><span class="s4">return </span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_moveCursor</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,-</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">)):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_moveCursor</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,-(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">)),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">cursorDown</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">;</span><span class="s4">return </span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_moveCursor</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">)):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_moveCursor</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">cursorForward</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_moveCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">cursorBackward</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_moveCursor</span><span class="s0">(-(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">),</span><span class="s3">0</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">cursorNextLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">cursorDown</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">cursorPrecedingLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">cursorUp</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">cursorCharAbsolute</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_setCursor</span><span class="s0">((</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">)-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">cursorPosition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_setCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;=</span><span class="s3">2</span><span class="s0">?(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">)-</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">)-</span><span class="s3">1</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">charPosAbsolute</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_setCursor</span><span class="s0">((</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">)-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">hPositionRelative</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_moveCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">linePosAbsolute</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_setCursor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">)-</span><span class="s3">1</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">vPositionRelative</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_moveCursor</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">hVPosition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">cursorPosition</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">tabClear</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s4">return </span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">?</span><span class="s4">delete this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">tabs</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">]:</span><span class="s3">3</span><span class="s0">===</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">tabs</span><span class="s0">={}),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">cursorForwardTab</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">t</span><span class="s0">--;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">nextStop</span><span class="s0">();</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">cursorBackwardTab</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">t</span><span class="s0">--;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">prevStop</span><span class="s0">();</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">selectProtected</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s4">return </span><span class="s3">1</span><span class="s0">===</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">|=</span><span class="s3">536870912</span><span class="s0">),</span><span class="s3">2</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;=-</span><span class="s3">536870913</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">_eraseInBufferLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">e</span><span class="s0">);</span><span class="s1">n</span><span class="s0">.</span><span class="s1">replaceCells</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">()),</span><span class="s1">r</span><span class="s0">),</span><span class="s1">s</span><span class="s0">&amp;&amp;(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">_resetBufferLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">e</span><span class="s0">);</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">()),</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">clearMarkers</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">e</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">eraseInDisplay</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">;</span><span class="s4">switch</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]){</span><span class="s4">case </span><span class="s3">0</span><span class="s0">:</span><span class="s4">for</span><span class="s0">(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseInBufferLine</span><span class="s0">(</span><span class="s1">i</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_resetBufferLine</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1</span><span class="s0">:</span><span class="s4">for</span><span class="s0">(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseInBufferLine</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">+</span><span class="s3">1</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">i</span><span class="s0">+</span><span class="s3">1</span><span class="s0">).</span><span class="s1">isWrapped</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">);</span><span class="s1">i</span><span class="s0">--;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_resetBufferLine</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s3">0</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">2</span><span class="s0">:</span><span class="s4">for</span><span class="s0">(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s1">i</span><span class="s0">-</span><span class="s3">1</span><span class="s0">);</span><span class="s1">i</span><span class="s0">--;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_resetBufferLine</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s3">0</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">3</span><span class="s0">:</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">trimStart</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">-</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">-</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s3">0</span><span class="s0">))}</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">eraseInLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">switch</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]){</span><span class="s4">case </span><span class="s3">0</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseInBufferLine</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseInBufferLine</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">2</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseInBufferLine</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">insertLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">();</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">-</span><span class="s1">s</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">t</span><span class="s0">--;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">r</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getBlankLine</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">()));</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">deleteLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">();</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">-</span><span class="s1">s</span><span class="s0">;</span><span class="s1">t</span><span class="s0">--;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getBlankLine</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">()));</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">insertChars</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">();</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">);</span><span class="s4">return </span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">insertCells</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">deleteChars</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">();</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">);</span><span class="s4">return </span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">deleteCells</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">scrollUp</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">t</span><span class="s0">--;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getBlankLine</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">()));</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">scrollDown</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">t</span><span class="s0">--;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getBlankLine</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">));</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">scrollLeft</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">;++</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">i</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">deleteCells</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">())),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">scrollRight</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">;++</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">i</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">insertCells</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">())),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">insertColumns</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">;++</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">i</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">insertCells</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">())),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">deleteColumns</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">;++</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">i</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">deleteCells</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">())),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">eraseChars</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">();</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">);</span><span class="s4">return </span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">replaceCells</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">+(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">repeatPrecedingCharacter</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">precedingJoinState</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">p</span><span class="s0">.</span><span class="s1">UnicodeService</span><span class="s0">.</span><span class="s1">extractWidth</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">-</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">).</span><span class="s1">getString</span><span class="s0">(</span><span class="s1">r</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint32Array</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">length</span><span class="s0">*</span><span class="s1">i</span><span class="s0">);</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">c</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">c</span><span class="s0">&lt;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">codePointAt</span><span class="s0">(</span><span class="s1">c</span><span class="s0">)||</span><span class="s3">0</span><span class="s0">;</span><span class="s1">o</span><span class="s0">[</span><span class="s1">a</span><span class="s0">++]=</span><span class="s1">e</span><span class="s0">,</span><span class="s1">c</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">65535</span><span class="s0">?</span><span class="s3">2</span><span class="s0">:</span><span class="s3">1</span><span class="s0">}</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s1">a</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">c</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s1">c</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">;++</span><span class="s1">c</span><span class="s0">)</span><span class="s1">o</span><span class="s0">.</span><span class="s1">copyWithin</span><span class="s0">(</span><span class="s1">h</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">),</span><span class="s1">h</span><span class="s0">+=</span><span class="s1">a</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">print</span><span class="s0">(</span><span class="s1">o</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">h</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">sendDeviceAttributesPrimary</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&gt;</span><span class="s3">0</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_is</span><span class="s0">(</span><span class="s2">&quot;xterm&quot;</span><span class="s0">)||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_is</span><span class="s0">(</span><span class="s2">&quot;rxvt-unicode&quot;</span><span class="s0">)||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_is</span><span class="s0">(</span><span class="s2">&quot;screen&quot;</span><span class="s0">)?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[?1;2c&quot;</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_is</span><span class="s0">(</span><span class="s2">&quot;linux&quot;</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[?6c&quot;</span><span class="s0">)),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">sendDeviceAttributesSecondary</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&gt;</span><span class="s3">0</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_is</span><span class="s0">(</span><span class="s2">&quot;xterm&quot;</span><span class="s0">)?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[&gt;0;276;0c&quot;</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_is</span><span class="s0">(</span><span class="s2">&quot;rxvt-unicode&quot;</span><span class="s0">)?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[&gt;85;95;0c&quot;</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_is</span><span class="s0">(</span><span class="s2">&quot;linux&quot;</span><span class="s0">)?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]+</span><span class="s2">&quot;c&quot;</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_is</span><span class="s0">(</span><span class="s2">&quot;screen&quot;</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[&gt;83;40003;0c&quot;</span><span class="s0">)),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">_is</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">0</span><span class="s0">===(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">termName</span><span class="s0">+</span><span class="s2">&quot;&quot;</span><span class="s0">).</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">setMode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]){</span><span class="s4">case </span><span class="s3">4</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">modes</span><span class="s0">.</span><span class="s1">insertMode</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">20</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">convertEol</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">}</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">setModePrivate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]){</span><span class="s4">case </span><span class="s3">1</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">applicationCursorKeys</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">2</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">setgCharset</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_CHARSET</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">setgCharset</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_CHARSET</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">setgCharset</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_CHARSET</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">setgCharset</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_CHARSET</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">3</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">windowOptions</span><span class="s0">.</span><span class="s1">setWinLines</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">resize</span><span class="s0">(</span><span class="s3">132</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestReset</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">());</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">6</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setCursor</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">7</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">wraparound</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">12</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">cursorBlink</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">45</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">reverseWraparound</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">66</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Serial port requested application keypad.&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">applicationKeypad</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestSyncScrollBar</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">();</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">9</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreMouseService</span><span class="s0">.</span><span class="s1">activeProtocol</span><span class="s0">=</span><span class="s2">&quot;X10&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1e3</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreMouseService</span><span class="s0">.</span><span class="s1">activeProtocol</span><span class="s0">=</span><span class="s2">&quot;VT200&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1002</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreMouseService</span><span class="s0">.</span><span class="s1">activeProtocol</span><span class="s0">=</span><span class="s2">&quot;DRAG&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1003</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreMouseService</span><span class="s0">.</span><span class="s1">activeProtocol</span><span class="s0">=</span><span class="s2">&quot;ANY&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1004</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">sendFocus</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestSendFocus</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">();</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1005</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;DECSET 1005 not supported (see #2507)&quot;</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1006</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreMouseService</span><span class="s0">.</span><span class="s1">activeEncoding</span><span class="s0">=</span><span class="s2">&quot;SGR&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1015</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;DECSET 1015 not supported (see #2507)&quot;</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1016</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreMouseService</span><span class="s0">.</span><span class="s1">activeEncoding</span><span class="s0">=</span><span class="s2">&quot;SGR_PIXELS&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">25</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">isCursorHidden</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1048</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">saveCursor</span><span class="s0">();</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1049</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">saveCursor</span><span class="s0">();</span><span class="s4">case </span><span class="s3">47</span><span class="s0">:</span><span class="s4">case </span><span class="s3">1047</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">activateAltBuffer</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">()),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">isCursorInitialized</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestRefreshRows</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestSyncScrollBar</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">();</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">2004</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">bracketedPasteMode</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">}</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">resetMode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]){</span><span class="s4">case </span><span class="s3">4</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">modes</span><span class="s0">.</span><span class="s1">insertMode</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">20</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">convertEol</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">resetModePrivate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]){</span><span class="s4">case </span><span class="s3">1</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">applicationCursorKeys</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">3</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">windowOptions</span><span class="s0">.</span><span class="s1">setWinLines</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">resize</span><span class="s0">(</span><span class="s3">80</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestReset</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">());</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">6</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setCursor</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">7</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">wraparound</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">12</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">cursorBlink</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">45</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">reverseWraparound</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">66</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Switching back to normal keypad.&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">applicationKeypad</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestSyncScrollBar</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">();</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">9</span><span class="s0">:</span><span class="s4">case </span><span class="s3">1e3</span><span class="s0">:</span><span class="s4">case </span><span class="s3">1002</span><span class="s0">:</span><span class="s4">case </span><span class="s3">1003</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreMouseService</span><span class="s0">.</span><span class="s1">activeProtocol</span><span class="s0">=</span><span class="s2">&quot;NONE&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1004</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">sendFocus</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1005</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;DECRST 1005 not supported (see #2507)&quot;</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1006</span><span class="s0">:</span><span class="s4">case </span><span class="s3">1016</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreMouseService</span><span class="s0">.</span><span class="s1">activeEncoding</span><span class="s0">=</span><span class="s2">&quot;DEFAULT&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1015</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;DECRST 1015 not supported (see #2507)&quot;</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">25</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">isCursorHidden</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1048</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">restoreCursor</span><span class="s0">();</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1049</span><span class="s0">:</span><span class="s4">case </span><span class="s3">47</span><span class="s0">:</span><span class="s4">case </span><span class="s3">1047</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">activateNormalBuffer</span><span class="s0">(),</span><span class="s3">1049</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">restoreCursor</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">isCursorInitialized</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestRefreshRows</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestSyncScrollBar</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">();</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">2004</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">bracketedPasteMode</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">requestMode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">,{</span><span class="s1">activeProtocol</span><span class="s0">:</span><span class="s1">s</span><span class="s0">,</span><span class="s1">activeEncoding</span><span class="s0">:</span><span class="s1">r</span><span class="s0">}=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreMouseService</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">,{</span><span class="s1">buffers</span><span class="s0">:</span><span class="s1">a</span><span class="s0">,</span><span class="s1">cols</span><span class="s0">:</span><span class="s1">h</span><span class="s0">}=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">,{</span><span class="s1">active</span><span class="s0">:</span><span class="s1">c</span><span class="s0">,</span><span class="s1">alt</span><span class="s0">:</span><span class="s1">l</span><span class="s0">}=</span><span class="s1">a</span><span class="s0">,</span><span class="s1">d</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">,</span><span class="s1">_</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">2</span><span class="s0">,</span><span class="s1">u</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s4">return </span><span class="s1">f</span><span class="s0">=</span><span class="s1">u</span><span class="s0">,</span><span class="s1">v</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?</span><span class="s3">2</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s3">4</span><span class="s0">:</span><span class="s3">4</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">modes</span><span class="s0">.</span><span class="s1">insertMode</span><span class="s0">):</span><span class="s3">12</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s3">3</span><span class="s0">:</span><span class="s3">20</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s1">d</span><span class="s0">.</span><span class="s1">convertEol</span><span class="s0">):</span><span class="s3">0</span><span class="s0">:</span><span class="s3">1</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">applicationCursorKeys</span><span class="s0">):</span><span class="s3">3</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">d</span><span class="s0">.</span><span class="s1">windowOptions</span><span class="s0">.</span><span class="s1">setWinLines</span><span class="s0">?</span><span class="s3">80</span><span class="s0">===</span><span class="s1">h</span><span class="s0">?</span><span class="s3">2</span><span class="s0">:</span><span class="s3">132</span><span class="s0">===</span><span class="s1">h</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">:</span><span class="s3">0</span><span class="s0">:</span><span class="s3">6</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">):</span><span class="s3">7</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">wraparound</span><span class="s0">):</span><span class="s3">8</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s3">3</span><span class="s0">:</span><span class="s3">9</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s2">&quot;X10&quot;</span><span class="s0">===</span><span class="s1">s</span><span class="s0">):</span><span class="s3">12</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s1">d</span><span class="s0">.</span><span class="s1">cursorBlink</span><span class="s0">):</span><span class="s3">25</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(!</span><span class="s1">o</span><span class="s0">.</span><span class="s1">isCursorHidden</span><span class="s0">):</span><span class="s3">45</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">reverseWraparound</span><span class="s0">):</span><span class="s3">66</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">applicationKeypad</span><span class="s0">):</span><span class="s3">67</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s3">4</span><span class="s0">:</span><span class="s3">1e3</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s2">&quot;VT200&quot;</span><span class="s0">===</span><span class="s1">s</span><span class="s0">):</span><span class="s3">1002</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s2">&quot;DRAG&quot;</span><span class="s0">===</span><span class="s1">s</span><span class="s0">):</span><span class="s3">1003</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s2">&quot;ANY&quot;</span><span class="s0">===</span><span class="s1">s</span><span class="s0">):</span><span class="s3">1004</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">sendFocus</span><span class="s0">):</span><span class="s3">1005</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s3">4</span><span class="s0">:</span><span class="s3">1006</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s2">&quot;SGR&quot;</span><span class="s0">===</span><span class="s1">r</span><span class="s0">):</span><span class="s3">1015</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s3">4</span><span class="s0">:</span><span class="s3">1016</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s2">&quot;SGR_PIXELS&quot;</span><span class="s0">===</span><span class="s1">r</span><span class="s0">):</span><span class="s3">1048</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">47</span><span class="s0">===</span><span class="s1">u</span><span class="s0">||</span><span class="s3">1047</span><span class="s0">===</span><span class="s1">u</span><span class="s0">||</span><span class="s3">1049</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s1">c</span><span class="s0">===</span><span class="s1">l</span><span class="s0">):</span><span class="s3">2004</span><span class="s0">===</span><span class="s1">u</span><span class="s0">?</span><span class="s1">_</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">bracketedPasteMode</span><span class="s0">):</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">}</span><span class="s2">[</span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">?</span><span class="s2">&quot;&quot;</span><span class="s0">:</span><span class="s2">&quot;?&quot;</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">f</span><span class="s0">}</span><span class="s2">;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">v</span><span class="s0">}</span><span class="s2">$y`</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">var </span><span class="s1">f</span><span class="s0">,</span><span class="s1">v</span><span class="s0">}</span><span class="s1">_updateAttrColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">){</span><span class="s4">return </span><span class="s3">2</span><span class="s0">===</span><span class="s1">t</span><span class="s0">?(</span><span class="s1">e</span><span class="s0">|=</span><span class="s3">50331648</span><span class="s0">,</span><span class="s1">e</span><span class="s0">&amp;=-</span><span class="s3">16777216</span><span class="s0">,</span><span class="s1">e</span><span class="s0">|=</span><span class="s1">f</span><span class="s0">.</span><span class="s1">AttributeData</span><span class="s0">.</span><span class="s1">fromColorRGB</span><span class="s0">([</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">])):</span><span class="s3">5</span><span class="s0">===</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">&amp;=-</span><span class="s3">50331904</span><span class="s0">,</span><span class="s1">e</span><span class="s0">|=</span><span class="s3">33554432</span><span class="s0">|</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">i</span><span class="s0">),</span><span class="s1">e</span><span class="s0">}</span><span class="s1">_extractColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=[</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">];</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">do</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">[</span><span class="s1">n</span><span class="s0">+</span><span class="s1">r</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s1">t</span><span class="s0">+</span><span class="s1">n</span><span class="s0">],</span><span class="s1">e</span><span class="s0">.</span><span class="s1">hasSubParams</span><span class="s0">(</span><span class="s1">t</span><span class="s0">+</span><span class="s1">n</span><span class="s0">)){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">getSubParams</span><span class="s0">(</span><span class="s1">t</span><span class="s0">+</span><span class="s1">n</span><span class="s0">);</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">do</span><span class="s0">{</span><span class="s3">5</span><span class="s0">===</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;(</span><span class="s1">r</span><span class="s0">=</span><span class="s3">1</span><span class="s0">),</span><span class="s1">s</span><span class="s0">[</span><span class="s1">n</span><span class="s0">+</span><span class="s1">o</span><span class="s0">+</span><span class="s3">1</span><span class="s0">+</span><span class="s1">r</span><span class="s0">]=</span><span class="s1">i</span><span class="s0">[</span><span class="s1">o</span><span class="s0">]}</span><span class="s4">while</span><span class="s0">(++</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">+</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">+</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">);</span><span class="s4">break</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s3">5</span><span class="s0">===</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">n</span><span class="s0">+</span><span class="s1">r</span><span class="s0">&gt;=</span><span class="s3">2</span><span class="s0">||</span><span class="s3">2</span><span class="s0">===</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;</span><span class="s1">n</span><span class="s0">+</span><span class="s1">r</span><span class="s0">&gt;=</span><span class="s3">5</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&amp;&amp;(</span><span class="s1">r</span><span class="s0">=</span><span class="s3">1</span><span class="s0">)}</span><span class="s4">while</span><span class="s0">(++</span><span class="s1">n</span><span class="s0">+</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">+</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s3">2</span><span class="s0">;</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">o</span><span class="s0">)-</span><span class="s3">1</span><span class="s0">===</span><span class="s1">s</span><span class="s0">[</span><span class="s1">o</span><span class="s0">]&amp;&amp;(</span><span class="s1">s</span><span class="s0">[</span><span class="s1">o</span><span class="s0">]=</span><span class="s3">0</span><span class="s0">);</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">s</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]){</span><span class="s4">case </span><span class="s3">38</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateAttrColor</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">],</span><span class="s1">s</span><span class="s0">[</span><span class="s3">3</span><span class="s0">],</span><span class="s1">s</span><span class="s0">[</span><span class="s3">4</span><span class="s0">],</span><span class="s1">s</span><span class="s0">[</span><span class="s3">5</span><span class="s0">]);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">48</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateAttrColor</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">,</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">],</span><span class="s1">s</span><span class="s0">[</span><span class="s3">3</span><span class="s0">],</span><span class="s1">s</span><span class="s0">[</span><span class="s3">4</span><span class="s0">],</span><span class="s1">s</span><span class="s0">[</span><span class="s3">5</span><span class="s0">]);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">58</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">(),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateAttrColor</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">,</span><span class="s1">s</span><span class="s0">[</span><span class="s3">1</span><span class="s0">],</span><span class="s1">s</span><span class="s0">[</span><span class="s3">3</span><span class="s0">],</span><span class="s1">s</span><span class="s0">[</span><span class="s3">4</span><span class="s0">],</span><span class="s1">s</span><span class="s0">[</span><span class="s3">5</span><span class="s0">])}</span><span class="s4">return </span><span class="s1">n</span><span class="s0">}</span><span class="s1">_processUnderline</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s1">t</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">(),(!~</span><span class="s1">e</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">5</span><span class="s0">)&amp;&amp;(</span><span class="s1">e</span><span class="s0">=</span><span class="s3">1</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineStyle</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">|=</span><span class="s3">268435456</span><span class="s0">,</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;=-</span><span class="s3">268435457</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">updateExtended</span><span class="s0">()}</span><span class="s1">_processSGR0</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">(),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineStyle</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">&amp;=-</span><span class="s3">67108864</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">updateExtended</span><span class="s0">()}</span><span class="s1">charAttributes</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">1</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_processSGR0</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">let </span><span class="s1">i</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">;</span><span class="s1">r</span><span class="s0">++)</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s1">r</span><span class="s0">],</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s3">30</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s3">37</span><span class="s0">?(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;=-</span><span class="s3">50331904</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">|=</span><span class="s3">16777216</span><span class="s0">|</span><span class="s1">i</span><span class="s0">-</span><span class="s3">30</span><span class="s0">):</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s3">40</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s3">47</span><span class="s0">?(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;=-</span><span class="s3">50331904</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">|=</span><span class="s3">16777216</span><span class="s0">|</span><span class="s1">i</span><span class="s0">-</span><span class="s3">40</span><span class="s0">):</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s3">90</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s3">97</span><span class="s0">?(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;=-</span><span class="s3">50331904</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">|=</span><span class="s3">16777224</span><span class="s0">|</span><span class="s1">i</span><span class="s0">-</span><span class="s3">90</span><span class="s0">):</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s3">100</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s3">107</span><span class="s0">?(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;=-</span><span class="s3">50331904</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">|=</span><span class="s3">16777224</span><span class="s0">|</span><span class="s1">i</span><span class="s0">-</span><span class="s3">100</span><span class="s0">):</span><span class="s3">0</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_processSGR0</span><span class="s0">(</span><span class="s1">s</span><span class="s0">):</span><span class="s3">1</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">|=</span><span class="s3">134217728</span><span class="s0">:</span><span class="s3">3</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">|=</span><span class="s3">67108864</span><span class="s0">:</span><span class="s3">4</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">|=</span><span class="s3">268435456</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_processUnderline</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">hasSubParams</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)?</span><span class="s1">e</span><span class="s0">.</span><span class="s1">getSubParams</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)[</span><span class="s3">0</span><span class="s0">]:</span><span class="s3">1</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)):</span><span class="s3">5</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">|=</span><span class="s3">536870912</span><span class="s0">:</span><span class="s3">7</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">|=</span><span class="s3">67108864</span><span class="s0">:</span><span class="s3">8</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">|=</span><span class="s3">1073741824</span><span class="s0">:</span><span class="s3">9</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">|=</span><span class="s3">2147483648</span><span class="s0">:</span><span class="s3">2</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">|=</span><span class="s3">134217728</span><span class="s0">:</span><span class="s3">21</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_processUnderline</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">s</span><span class="s0">):</span><span class="s3">22</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;=-</span><span class="s3">134217729</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;=-</span><span class="s3">134217729</span><span class="s0">):</span><span class="s3">23</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;=-</span><span class="s3">67108865</span><span class="s0">:</span><span class="s3">24</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;=-</span><span class="s3">268435457</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_processUnderline</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)):</span><span class="s3">25</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;=-</span><span class="s3">536870913</span><span class="s0">:</span><span class="s3">27</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;=-</span><span class="s3">67108865</span><span class="s0">:</span><span class="s3">28</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;=-</span><span class="s3">1073741825</span><span class="s0">:</span><span class="s3">29</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;=</span><span class="s3">2147483647</span><span class="s0">:</span><span class="s3">39</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;=-</span><span class="s3">67108864</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">|=</span><span class="s3">16777215</span><span class="s0">&amp;</span><span class="s1">l</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">):</span><span class="s3">49</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;=-</span><span class="s3">67108864</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">|=</span><span class="s3">16777215</span><span class="s0">&amp;</span><span class="s1">l</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">):</span><span class="s3">38</span><span class="s0">===</span><span class="s1">i</span><span class="s0">||</span><span class="s3">48</span><span class="s0">===</span><span class="s1">i</span><span class="s0">||</span><span class="s3">58</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">r</span><span class="s0">+=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_extractColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">s</span><span class="s0">):</span><span class="s3">53</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">|=</span><span class="s3">1073741824</span><span class="s0">:</span><span class="s3">55</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;=-</span><span class="s3">1073741825</span><span class="s0">:</span><span class="s3">59</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">(),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">updateExtended</span><span class="s0">()):</span><span class="s3">100</span><span class="s0">===</span><span class="s1">i</span><span class="s0">?(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;=-</span><span class="s3">67108864</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">|=</span><span class="s3">16777215</span><span class="s0">&amp;</span><span class="s1">l</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;=-</span><span class="s3">67108864</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">|=</span><span class="s3">16777215</span><span class="s0">&amp;</span><span class="s1">l</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Unknown SGR attribute: %d.&quot;</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">deviceStatus</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]){</span><span class="s4">case </span><span class="s3">5</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">}</span><span class="s2">[0n`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">6</span><span class="s0">:</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">}</span><span class="s2">[</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">}</span><span class="s2">R`</span><span class="s0">)}</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">deviceStatusPrivate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">6</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">}</span><span class="s2">[?</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">}</span><span class="s2">R`</span><span class="s0">)}</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">softReset</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">isCursorHidden</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestSyncScrollBar</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedX</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedY</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedCurAttrData</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedCurAttrData</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedCharset</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">charset</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">setCursorStyle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">;</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">case </span><span class="s3">1</span><span class="s0">:</span><span class="s4">case </span><span class="s3">2</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">cursorStyle</span><span class="s0">=</span><span class="s2">&quot;block&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">3</span><span class="s0">:</span><span class="s4">case </span><span class="s3">4</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">cursorStyle</span><span class="s0">=</span><span class="s2">&quot;underline&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">5</span><span class="s0">:</span><span class="s4">case </span><span class="s3">6</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">cursorStyle</span><span class="s0">=</span><span class="s2">&quot;bar&quot;</span><span class="s0">}</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">%</span><span class="s3">2</span><span class="s0">==</span><span class="s3">1</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">cursorBlink</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">setScrollRegion</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">1</span><span class="s0">;</span><span class="s4">let </span><span class="s1">i</span><span class="s0">;</span><span class="s4">return</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s3">2</span><span class="s0">||(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">1</span><span class="s0">])&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">||</span><span class="s3">0</span><span class="s0">===</span><span class="s1">i</span><span class="s0">)&amp;&amp;(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">),</span><span class="s1">i</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">=</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">=</span><span class="s1">i</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setCursor</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">windowOptions</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">w</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">windowOptions</span><span class="s0">))</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">?</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]:</span><span class="s3">0</span><span class="s0">;</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]){</span><span class="s4">case </span><span class="s3">14</span><span class="s0">:</span><span class="s3">2</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestWindowsOptionsReport</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">y</span><span class="s0">.</span><span class="s1">GET_WIN_SIZE_PIXELS</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">16</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestWindowsOptionsReport</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">y</span><span class="s0">.</span><span class="s1">GET_CELL_SIZE_PIXELS</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">18</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">}</span><span class="s2">[8;</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">}</span><span class="s2">;</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">}</span><span class="s2">t`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">22</span><span class="s0">:</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s3">2</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowTitleStack</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowTitle</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowTitleStack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">10</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowTitleStack</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">()),</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_iconNameStack</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_iconName</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_iconNameStack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">10</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_iconNameStack</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">());</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">23</span><span class="s0">:</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s3">2</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowTitleStack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setTitle</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_windowTitleStack</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">()),</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_iconNameStack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setIconName</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_iconNameStack</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">())}</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">saveCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedX</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedY</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedCurAttrData</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedCurAttrData</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedCharset</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">charset</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">restoreCursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedX</span><span class="s0">||</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedY</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedCurAttrData</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedCurAttrData</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">charset</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_savedCharset</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedCharset</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">charset</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">savedCharset</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">setTitle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_windowTitle</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onTitleChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">setIconName</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_iconName</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">setOrReportIndexedColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=[],</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s2">&quot;;&quot;</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">;){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">(),</span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s5">/^\d+$/</span><span class="s0">.</span><span class="s1">exec</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">D</span><span class="s0">(</span><span class="s1">i</span><span class="s0">))</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;?&quot;</span><span class="s0">===</span><span class="s1">s</span><span class="s0">)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">push</span><span class="s0">({</span><span class="s1">type</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">index</span><span class="s0">:</span><span class="s1">i</span><span class="s0">});</span><span class="s4">else</span><span class="s0">{</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">S</span><span class="s0">.</span><span class="s1">parseColor</span><span class="s0">)(</span><span class="s1">s</span><span class="s0">);</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">push</span><span class="s0">({</span><span class="s1">type</span><span class="s0">:</span><span class="s3">1</span><span class="s0">,</span><span class="s1">index</span><span class="s0">:</span><span class="s1">i</span><span class="s0">,</span><span class="s1">color</span><span class="s0">:</span><span class="s1">e</span><span class="s0">})}}}</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onColor</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">setHyperlink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s2">&quot;;&quot;</span><span class="s0">);</span><span class="s4">return</span><span class="s0">!(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s3">2</span><span class="s0">)&amp;&amp;(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createHyperlink</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]):!</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_finishHyperlink</span><span class="s0">())}</span><span class="s1">_createHyperlink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCurrentLinkId</span><span class="s0">()&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_finishHyperlink</span><span class="s0">();</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s2">&quot;:&quot;</span><span class="s0">);</span><span class="s4">let </span><span class="s1">s</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">findIndex</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">startsWith</span><span class="s0">(</span><span class="s2">&quot;id=&quot;</span><span class="s0">)));</span><span class="s4">return</span><span class="s0">-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">r</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">[</span><span class="s1">r</span><span class="s0">].</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">3</span><span class="s0">)||</span><span class="s4">void </span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">urlId</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscLinkService</span><span class="s0">.</span><span class="s1">registerLink</span><span class="s0">({</span><span class="s1">id</span><span class="s0">:</span><span class="s1">s</span><span class="s0">,</span><span class="s1">uri</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">updateExtended</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">_finishHyperlink</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">urlId</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">updateExtended</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">_setOrReportSpecialColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s2">&quot;;&quot;</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;!(</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_specialColors</span><span class="s0">.</span><span class="s1">length</span><span class="s0">);++</span><span class="s1">s</span><span class="s0">,++</span><span class="s1">t</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;?&quot;</span><span class="s0">===</span><span class="s1">i</span><span class="s0">[</span><span class="s1">s</span><span class="s0">])</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onColor</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">([{</span><span class="s1">type</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">index</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_specialColors</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]}]);</span><span class="s4">else</span><span class="s0">{</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">S</span><span class="s0">.</span><span class="s1">parseColor</span><span class="s0">)(</span><span class="s1">i</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]);</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onColor</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">([{</span><span class="s1">type</span><span class="s0">:</span><span class="s3">1</span><span class="s0">,</span><span class="s1">index</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_specialColors</span><span class="s0">[</span><span class="s1">t</span><span class="s0">],</span><span class="s1">color</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}])}</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">setOrReportFgColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_setOrReportSpecialColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">setOrReportBgColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_setOrReportSpecialColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)}</span><span class="s1">setOrReportCursorColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_setOrReportSpecialColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">2</span><span class="s0">)}</span><span class="s1">restoreIndexedColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_onColor</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">([{</span><span class="s1">type</span><span class="s0">:</span><span class="s3">2</span><span class="s0">}]),!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=[],</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s2">&quot;;&quot;</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">s</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s5">/^\d+$/</span><span class="s0">.</span><span class="s1">exec</span><span class="s0">(</span><span class="s1">i</span><span class="s0">[</span><span class="s1">s</span><span class="s0">])){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">i</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]);</span><span class="s1">D</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">push</span><span class="s0">({</span><span class="s1">type</span><span class="s0">:</span><span class="s3">2</span><span class="s0">,</span><span class="s1">index</span><span class="s0">:</span><span class="s1">e</span><span class="s0">})}</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onColor</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">restoreFgColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_onColor</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">([{</span><span class="s1">type</span><span class="s0">:</span><span class="s3">2</span><span class="s0">,</span><span class="s1">index</span><span class="s0">:</span><span class="s3">256</span><span class="s0">}]),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">restoreBgColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_onColor</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">([{</span><span class="s1">type</span><span class="s0">:</span><span class="s3">2</span><span class="s0">,</span><span class="s1">index</span><span class="s0">:</span><span class="s3">257</span><span class="s0">}]),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">restoreCursorColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_onColor</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">([{</span><span class="s1">type</span><span class="s0">:</span><span class="s3">2</span><span class="s0">,</span><span class="s1">index</span><span class="s0">:</span><span class="s3">258</span><span class="s0">}]),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">nextLine</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">keypadApplicationMode</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Serial port requested application keypad.&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">applicationKeypad</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestSyncScrollBar</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">keypadNumericMode</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">&quot;Switching back to normal keypad.&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">.</span><span class="s1">applicationKeypad</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestSyncScrollBar</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">selectDefaultCharset</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">setgLevel</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">setgCharset</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_CHARSET</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">selectCharset</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">2</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selectDefaultCharset</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">):(</span><span class="s2">&quot;/&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">setgCharset</span><span class="s0">(</span><span class="s1">C</span><span class="s0">[</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]],</span><span class="s1">o</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">[</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]]||</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_CHARSET</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">index</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">+</span><span class="s3">1</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">--,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">scroll</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">())):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">tabSet</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">tabs</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">]=!</span><span class="s3">0</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">reverseIndex</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">shiftElements</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">getBlankLine</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrData</span><span class="s0">())),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">)}</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">--,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_restrictCursor</span><span class="s0">();</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">fullReset</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestReset</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrDataInternal</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">()}</span><span class="s1">_eraseAttrData</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_eraseAttrDataInternal</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;=-</span><span class="s3">67108864</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrDataInternal</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">|=</span><span class="s3">67108863</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_eraseAttrDataInternal</span><span class="s0">}</span><span class="s1">setgLevel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_charsetService</span><span class="s0">.</span><span class="s1">setgLevel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">screenAlignmentPattern</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">u</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">content</span><span class="s0">=</span><span class="s3">1</span><span class="s0">&lt;&lt;</span><span class="s3">22</span><span class="s0">|</span><span class="s2">&quot;E&quot;</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setCursor</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">;++</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">+</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s1">s</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">)}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markAllDirty</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setCursor</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">requestStatusString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">;</span><span class="s4">return</span><span class="s0">(</span><span class="s1">e</span><span class="s0">=&gt;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">}</span><span class="s4">\\</span><span class="s2">`</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">))(</span><span class="s2">'&quot;q'</span><span class="s0">===</span><span class="s1">e</span><span class="s0">?</span><span class="s2">`P1$r</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_curAttrData</span><span class="s0">.</span><span class="s1">isProtected</span><span class="s0">()?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">}</span><span class="s2">&quot;q`</span><span class="s0">:</span><span class="s2">'&quot;p'</span><span class="s0">===</span><span class="s1">e</span><span class="s0">?</span><span class="s2">'P1$r61;1&quot;p'</span><span class="s0">:</span><span class="s2">&quot;r&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">?</span><span class="s2">`P1$r</span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">+</span><span class="s3">1</span><span class="s0">}</span><span class="s2">;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">+</span><span class="s3">1</span><span class="s0">}</span><span class="s2">r`</span><span class="s0">:</span><span class="s2">&quot;m&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">?</span><span class="s2">&quot;P1$r0m&quot;</span><span class="s0">:</span><span class="s2">&quot; q&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">?</span><span class="s2">`P1$r</span><span class="s1">$</span><span class="s0">{{</span><span class="s1">block</span><span class="s0">:</span><span class="s3">2</span><span class="s0">,</span><span class="s1">underline</span><span class="s0">:</span><span class="s3">4</span><span class="s0">,</span><span class="s1">bar</span><span class="s0">:</span><span class="s3">6</span><span class="s0">}[</span><span class="s1">s</span><span class="s0">.</span><span class="s1">cursorStyle</span><span class="s0">]-(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">cursorBlink</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)} </span><span class="s2">q`</span><span class="s0">:</span><span class="s2">&quot;P0$r&quot;</span><span class="s0">)}</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dirtyRowTracker</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">InputHandler</span><span class="s0">=</span><span class="s1">k</span><span class="s0">;</span><span class="s4">let </span><span class="s1">L</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clearRange</span><span class="s0">()}</span><span class="s1">clearRange</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">end</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">}</span><span class="s1">markDirty</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">=</span><span class="s1">e</span><span class="s0">:</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">end</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">end</span><span class="s0">=</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s1">E</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s1">E</span><span class="s0">),</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">=</span><span class="s1">e</span><span class="s0">),</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">end</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">end</span><span class="s0">=</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">markAllDirty</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">markRangeDirty</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)}};</span><span class="s4">function </span><span class="s1">D</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">0</span><span class="s0">&lt;=</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">256</span><span class="s0">}</span><span class="s1">L</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">v</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">)],</span><span class="s1">L</span><span class="s0">)},</span><span class="s3">844</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s4">function </span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t of e</span><span class="s0">)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">();</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getDisposeArrayDisposable</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">disposeArray</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MutableDisposable</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_disposables</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isDisposed</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isDisposed</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">e of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">_disposables</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_disposables</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">register</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_disposables</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">e</span><span class="s0">}</span><span class="s1">unregister</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_disposables</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_disposables</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)}},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MutableDisposable</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isDisposed</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">get value</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_isDisposed</span><span class="s0">?</span><span class="s4">void </span><span class="s3">0</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_value</span><span class="s0">}</span><span class="s1">set value</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isDisposed</span><span class="s0">||</span><span class="s1">e</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_value</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_value</span><span class="s0">?.</span><span class="s1">dispose</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_value</span><span class="s0">=</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isDisposed</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_value</span><span class="s0">?.</span><span class="s1">dispose</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_value</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">}},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s0">{</span><span class="s1">dispose</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">disposeArray</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getDisposeArrayDisposable</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s0">{</span><span class="s1">dispose</span><span class="s0">:()=&gt;</span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}}},</span><span class="s3">1505</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">FourKeyMap</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">TwoKeyMap</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">class </span><span class="s1">i</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">={}}</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]={}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s1">e</span><span class="s0">][</span><span class="s1">t</span><span class="s0">]=</span><span class="s1">i</span><span class="s0">}</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s1">e</span><span class="s0">][</span><span class="s1">t</span><span class="s0">]:</span><span class="s4">void </span><span class="s3">0</span><span class="s0">}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">={}}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">TwoKeyMap</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">FourKeyMap</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s4">new </span><span class="s1">i</span><span class="s0">}</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">new </span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">).</span><span class="s1">set</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)}</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)?.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">()}}},</span><span class="s3">6114</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isChromeOS</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isLinux</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isWindows</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isIphone</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isIpad</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isMac</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getSafariVersion</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isSafari</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isLegacyEdge</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isFirefox</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isNode</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isNode</span><span class="s0">=</span><span class="s2">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s4">typeof </span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;title&quot;</span><span class="s4">in </span><span class="s1">s</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isNode</span><span class="s0">?</span><span class="s2">&quot;node&quot;</span><span class="s0">:</span><span class="s1">navigator</span><span class="s0">.</span><span class="s1">userAgent</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isNode</span><span class="s0">?</span><span class="s2">&quot;node&quot;</span><span class="s0">:</span><span class="s1">navigator</span><span class="s0">.</span><span class="s1">platform</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isFirefox</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">includes</span><span class="s0">(</span><span class="s2">&quot;Firefox&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isLegacyEdge</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">includes</span><span class="s0">(</span><span class="s2">&quot;Edge&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isSafari</span><span class="s0">=</span><span class="s5">/^((?!chrome|android).)*safari/i</span><span class="s0">.</span><span class="s1">test</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getSafariVersion</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isSafari</span><span class="s0">)</span><span class="s4">return </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">match</span><span class="s0">(</span><span class="s5">/Version\/(\d+)/</span><span class="s0">);</span><span class="s4">return null</span><span class="s0">===</span><span class="s1">e</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s3">2</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">])},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isMac</span><span class="s0">=[</span><span class="s2">&quot;Macintosh&quot;</span><span class="s0">,</span><span class="s2">&quot;MacIntel&quot;</span><span class="s0">,</span><span class="s2">&quot;MacPPC&quot;</span><span class="s0">,</span><span class="s2">&quot;Mac68K&quot;</span><span class="s0">].</span><span class="s1">includes</span><span class="s0">(</span><span class="s1">r</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isIpad</span><span class="s0">=</span><span class="s2">&quot;iPad&quot;</span><span class="s0">===</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isIphone</span><span class="s0">=</span><span class="s2">&quot;iPhone&quot;</span><span class="s0">===</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isWindows</span><span class="s0">=[</span><span class="s2">&quot;Windows&quot;</span><span class="s0">,</span><span class="s2">&quot;Win16&quot;</span><span class="s0">,</span><span class="s2">&quot;Win32&quot;</span><span class="s0">,</span><span class="s2">&quot;WinCE&quot;</span><span class="s0">].</span><span class="s1">includes</span><span class="s0">(</span><span class="s1">r</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isLinux</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s2">&quot;Linux&quot;</span><span class="s0">)&gt;=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isChromeOS</span><span class="s0">=</span><span class="s5">/\bCrOS\b/</span><span class="s0">.</span><span class="s1">test</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)},</span><span class="s3">6106</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">SortedList</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">SortedList</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getKey</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">=[]}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">insert</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_search</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getKey</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">delete</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getKey</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_search</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),-</span><span class="s3">1</span><span class="s0">===</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getKey</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s1">i</span><span class="s0">])!==</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">do</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]===</span><span class="s1">e</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">}</span><span class="s4">while</span><span class="s0">(++</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getKey</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s1">i</span><span class="s0">])===</span><span class="s1">t</span><span class="s0">);</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">}*</span><span class="s1">getKeyIterator</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_search</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),!(</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getKey</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s1">i</span><span class="s0">])===</span><span class="s1">e</span><span class="s0">))</span><span class="s4">do</span><span class="s0">{</span><span class="s4">yield this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]}</span><span class="s4">while</span><span class="s0">(++</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getKey</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s1">i</span><span class="s0">])===</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">forEachByKey</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_search</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),!(</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getKey</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s1">i</span><span class="s0">])===</span><span class="s1">e</span><span class="s0">))</span><span class="s4">do</span><span class="s0">{</span><span class="s1">t</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s1">i</span><span class="s0">])}</span><span class="s4">while</span><span class="s0">(++</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getKey</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s1">i</span><span class="s0">])===</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">values</span><span class="s0">(){</span><span class="s4">return</span><span class="s0">[</span><span class="s1">...</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">].</span><span class="s1">values</span><span class="s0">()}</span><span class="s1">_search</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s1">t</span><span class="s0">;){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">+</span><span class="s1">i</span><span class="s0">&gt;&gt;</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getKey</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">)</span><span class="s1">i</span><span class="s0">=</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">else</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(!(</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">)){</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">s</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getKey</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_array</span><span class="s0">[</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">])===</span><span class="s1">e</span><span class="s0">;)</span><span class="s1">s</span><span class="s0">--;</span><span class="s4">return </span><span class="s1">s</span><span class="s0">}</span><span class="s1">t</span><span class="s0">=</span><span class="s1">s</span><span class="s0">+</span><span class="s3">1</span><span class="s0">}}</span><span class="s4">return </span><span class="s1">t</span><span class="s0">}}},</span><span class="s3">7226</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DebouncedIdleTask</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IdleTaskQueue</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">PriorityTaskQueue</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6114</span><span class="s0">);</span><span class="s4">class </span><span class="s1">r</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_tasks</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">enqueue</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_tasks</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_start</span><span class="s0">()}</span><span class="s1">flush</span><span class="s0">(){</span><span class="s4">for</span><span class="s0">(;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_tasks</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_tasks</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_i</span><span class="s0">]()||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_i</span><span class="s0">++;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">()}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_idleCallback</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cancelCallback</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_idleCallback</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_idleCallback</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_tasks</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">_start</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_idleCallback</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_idleCallback</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_requestCallback</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_process</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">)))}</span><span class="s1">_process</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_idleCallback</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">timeRemaining</span><span class="s0">(),</span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_tasks</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">=</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_tasks</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_i</span><span class="s0">]()||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_i</span><span class="s0">++,</span><span class="s1">t</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">()-</span><span class="s1">t</span><span class="s0">),</span><span class="s1">i</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">timeRemaining</span><span class="s0">(),</span><span class="s3">1.5</span><span class="s0">*</span><span class="s1">i</span><span class="s0">&gt;</span><span class="s1">r</span><span class="s0">)</span><span class="s4">return </span><span class="s1">s</span><span class="s0">-</span><span class="s1">t</span><span class="s0">&lt;-</span><span class="s3">20</span><span class="s0">&amp;&amp;</span><span class="s1">console</span><span class="s0">.</span><span class="s1">warn</span><span class="s0">(</span><span class="s2">`task queue exceeded allotted deadline by </span><span class="s1">$</span><span class="s0">{</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">abs</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s1">s</span><span class="s0">-</span><span class="s1">t</span><span class="s0">))}</span><span class="s2">ms`</span><span class="s0">),</span><span class="s4">void this</span><span class="s0">.</span><span class="s1">_start</span><span class="s0">();</span><span class="s1">s</span><span class="s0">=</span><span class="s1">r</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">()}}</span><span class="s4">class </span><span class="s1">n </span><span class="s4">extends </span><span class="s1">r</span><span class="s0">{</span><span class="s1">_requestCallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">setTimeout</span><span class="s0">((()=&gt;</span><span class="s1">e</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_createDeadline</span><span class="s0">(</span><span class="s3">16</span><span class="s0">))))}</span><span class="s1">_cancelCallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">clearTimeout</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">_createDeadline</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">()+</span><span class="s1">e</span><span class="s0">;</span><span class="s4">return</span><span class="s0">{</span><span class="s1">timeRemaining</span><span class="s0">:()=&gt;</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">-</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">())}}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">PriorityTaskQueue</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IdleTaskQueue</span><span class="s0">=!</span><span class="s1">s</span><span class="s0">.</span><span class="s1">isNode</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;requestIdleCallback&quot;</span><span class="s4">in </span><span class="s1">window</span><span class="s0">?</span><span class="s4">class extends </span><span class="s1">r</span><span class="s0">{</span><span class="s1">_requestCallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">requestIdleCallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">_cancelCallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">cancelIdleCallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}}:</span><span class="s1">n</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DebouncedIdleTask</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queue</span><span class="s0">=</span><span class="s4">new </span><span class="s1">t</span><span class="s0">.</span><span class="s1">IdleTaskQueue</span><span class="s0">}</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queue</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queue</span><span class="s0">.</span><span class="s1">enqueue</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">flush</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_queue</span><span class="s0">.</span><span class="s1">flush</span><span class="s0">()}}},</span><span class="s3">9282</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">updateWindowsModeWrappedState</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">643</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">updateWindowsModeWrappedState</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">);</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">=</span><span class="s1">i</span><span class="s0">[</span><span class="s1">s</span><span class="s0">.</span><span class="s1">CHAR_DATA_CODE_INDEX</span><span class="s0">]!==</span><span class="s1">s</span><span class="s0">.</span><span class="s1">NULL_CELL_CODE</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">[</span><span class="s1">s</span><span class="s0">.</span><span class="s1">CHAR_DATA_CODE_INDEX</span><span class="s0">]!==</span><span class="s1">s</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CODE</span><span class="s0">)}},</span><span class="s3">3734</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ExtendedAttrs</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">AttributeData</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">class </span><span class="s1">i</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s4">new </span><span class="s1">s</span><span class="s0">}</span><span class="s4">static </span><span class="s1">toColorRGB</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s0">[</span><span class="s1">e</span><span class="s0">&gt;&gt;&gt;</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s1">e</span><span class="s0">&gt;&gt;&gt;</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s3">255</span><span class="s0">,</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">]}</span><span class="s4">static </span><span class="s1">fromColorRGB</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s0">(</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])&lt;&lt;</span><span class="s3">16</span><span class="s0">|(</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">])&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s3">2</span><span class="s0">]}</span><span class="s1">clone</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">i</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">(),</span><span class="s1">e</span><span class="s0">}</span><span class="s1">isInverse</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">67108864</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">}</span><span class="s1">isBold</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">134217728</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">}</span><span class="s1">isUnderline</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">hasExtendedAttrs</span><span class="s0">()&amp;&amp;</span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineStyle</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">}</span><span class="s1">isBlink</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">536870912</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">}</span><span class="s1">isInvisible</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">1073741824</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">}</span><span class="s1">isItalic</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">67108864</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">}</span><span class="s1">isDim</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">134217728</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">}</span><span class="s1">isStrikethrough</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">2147483648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">}</span><span class="s1">isProtected</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">536870912</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">}</span><span class="s1">isOverline</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">1073741824</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">}</span><span class="s1">getFgColorMode</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">}</span><span class="s1">getBgColorMode</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">}</span><span class="s1">isFgRGB</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">50331648</span><span class="s0">==(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">)}</span><span class="s1">isBgRGB</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">50331648</span><span class="s0">==(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">)}</span><span class="s1">isFgPalette</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">16777216</span><span class="s0">==(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">)||</span><span class="s3">33554432</span><span class="s0">==(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">)}</span><span class="s1">isBgPalette</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">16777216</span><span class="s0">==(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">)||</span><span class="s3">33554432</span><span class="s0">==(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">)}</span><span class="s1">isFgDefault</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">0</span><span class="s0">==(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">)}</span><span class="s1">isBgDefault</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">0</span><span class="s0">==(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">)}</span><span class="s1">isAttributeDefault</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;&amp;</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">}</span><span class="s1">getFgColor</span><span class="s0">(){</span><span class="s4">switch</span><span class="s0">(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">){</span><span class="s4">case </span><span class="s3">16777216</span><span class="s0">:</span><span class="s4">case </span><span class="s3">33554432</span><span class="s0">:</span><span class="s4">return </span><span class="s3">255</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">;</span><span class="s4">case </span><span class="s3">50331648</span><span class="s0">:</span><span class="s4">return </span><span class="s3">16777215</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">;</span><span class="s4">default</span><span class="s0">:</span><span class="s4">return</span><span class="s0">-</span><span class="s3">1</span><span class="s0">}}</span><span class="s1">getBgColor</span><span class="s0">(){</span><span class="s4">switch</span><span class="s0">(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">){</span><span class="s4">case </span><span class="s3">16777216</span><span class="s0">:</span><span class="s4">case </span><span class="s3">33554432</span><span class="s0">:</span><span class="s4">return </span><span class="s3">255</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">;</span><span class="s4">case </span><span class="s3">50331648</span><span class="s0">:</span><span class="s4">return </span><span class="s3">16777215</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">;</span><span class="s4">default</span><span class="s0">:</span><span class="s4">return</span><span class="s0">-</span><span class="s3">1</span><span class="s0">}}</span><span class="s1">hasExtendedAttrs</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">}</span><span class="s1">updateExtended</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">isEmpty</span><span class="s0">()?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;=-</span><span class="s3">268435457</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">|=</span><span class="s3">268435456</span><span class="s0">}</span><span class="s1">getUnderlineColor</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;&amp;~</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">)</span><span class="s4">switch</span><span class="s0">(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">){</span><span class="s4">case </span><span class="s3">16777216</span><span class="s0">:</span><span class="s4">case </span><span class="s3">33554432</span><span class="s0">:</span><span class="s4">return </span><span class="s3">255</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">;</span><span class="s4">case </span><span class="s3">50331648</span><span class="s0">:</span><span class="s4">return </span><span class="s3">16777215</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">;</span><span class="s4">default</span><span class="s0">:</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">getFgColor</span><span class="s0">()}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">getFgColor</span><span class="s0">()}</span><span class="s1">getUnderlineColorMode</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;&amp;~</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">?</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getFgColorMode</span><span class="s0">()}</span><span class="s1">isUnderlineColorRGB</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;&amp;~</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">?</span><span class="s3">50331648</span><span class="s0">==(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isFgRGB</span><span class="s0">()}</span><span class="s1">isUnderlineColorPalette</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;&amp;~</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">?</span><span class="s3">16777216</span><span class="s0">==(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">)||</span><span class="s3">33554432</span><span class="s0">==(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isFgPalette</span><span class="s0">()}</span><span class="s1">isUnderlineColorDefault</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;&amp;~</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">?</span><span class="s3">0</span><span class="s0">==(</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineColor</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isFgDefault</span><span class="s0">()}</span><span class="s1">getUnderlineStyle</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">?</span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineStyle</span><span class="s0">:</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">}</span><span class="s1">getUnderlineVariantOffset</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">.</span><span class="s1">underlineVariantOffset</span><span class="s0">}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">AttributeData</span><span class="s0">=</span><span class="s1">i</span><span class="s0">;</span><span class="s4">class </span><span class="s1">s</span><span class="s0">{</span><span class="s1">get ext</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_urlId</span><span class="s0">?-</span><span class="s3">469762049</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">|</span><span class="s4">this</span><span class="s0">.</span><span class="s1">underlineStyle</span><span class="s0">&lt;&lt;</span><span class="s3">26</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">}</span><span class="s1">set ext</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">get underlineStyle</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_urlId</span><span class="s0">?</span><span class="s3">5</span><span class="s0">:(</span><span class="s3">469762048</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">)&gt;&gt;</span><span class="s3">26</span><span class="s0">}</span><span class="s1">set underlineStyle</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">&amp;=-</span><span class="s3">469762049</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">|=</span><span class="s1">e</span><span class="s0">&lt;&lt;</span><span class="s3">26</span><span class="s0">&amp;</span><span class="s3">469762048</span><span class="s0">}</span><span class="s1">get underlineColor</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">67108863</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">}</span><span class="s1">set underlineColor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">&amp;=-</span><span class="s3">67108864</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">|=</span><span class="s3">67108863</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">}</span><span class="s1">get urlId</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_urlId</span><span class="s0">}</span><span class="s1">set urlId</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_urlId</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">get underlineVariantOffset</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=(</span><span class="s3">3758096384</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">)&gt;&gt;</span><span class="s3">29</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s3">4294967288</span><span class="s0">^</span><span class="s1">e</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}</span><span class="s1">set underlineVariantOffset</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">&amp;=</span><span class="s3">536870911</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">|=</span><span class="s1">e</span><span class="s0">&lt;&lt;</span><span class="s3">29</span><span class="s0">&amp;</span><span class="s3">3758096384</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_urlId</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_urlId</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s1">clone</span><span class="s0">(){</span><span class="s4">return new </span><span class="s1">s</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ext</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_urlId</span><span class="s0">)}</span><span class="s1">isEmpty</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">underlineStyle</span><span class="s0">&amp;&amp;</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_urlId</span><span class="s0">}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ExtendedAttrs</span><span class="s0">=</span><span class="s1">s</span><span class="s0">},</span><span class="s3">9092</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Buffer</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MAX_BUFFER_SIZE</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6349</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">7226</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3734</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8437</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4634</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">511</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">643</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">4863</span><span class="s0">),</span><span class="s1">d</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">7116</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MAX_BUFFER_SIZE</span><span class="s0">=</span><span class="s3">4294967295</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Buffer</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hasScrollback</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tabs</span><span class="s0">={},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">savedY</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">savedX</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">savedCurAttrData</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">savedCharset</span><span class="s0">=</span><span class="s1">d</span><span class="s0">.</span><span class="s1">DEFAULT_CHARSET</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nullCell</span><span class="s0">=</span><span class="s1">h</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">.</span><span class="s1">fromCharData</span><span class="s0">([</span><span class="s3">0</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">NULL_CELL_CHAR</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">NULL_CELL_WIDTH</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">NULL_CELL_CODE</span><span class="s0">]),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_whitespaceCell</span><span class="s0">=</span><span class="s1">h</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">.</span><span class="s1">fromCharData</span><span class="s0">([</span><span class="s3">0</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CHAR</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_WIDTH</span><span class="s0">,</span><span class="s1">c</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CODE</span><span class="s0">]),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isClearing</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_memoryCleanupQueue</span><span class="s0">=</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">IdleTaskQueue</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_memoryCleanupPosition</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rows</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">=</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">CircularList</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCorrectBufferLength</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rows</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setupTabStops</span><span class="s0">()}</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nullCell</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nullCell</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nullCell</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">):(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nullCell</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nullCell</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nullCell</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">ExtendedAttrs</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nullCell</span><span class="s0">}</span><span class="s1">getWhitespaceCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_whitespaceCell</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_whitespaceCell</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_whitespaceCell</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">):(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_whitespaceCell</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_whitespaceCell</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_whitespaceCell</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">ExtendedAttrs</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_whitespaceCell</span><span class="s0">}</span><span class="s1">getBlankLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">BufferLine</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">get hasScrollback</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_hasScrollback</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rows</span><span class="s0">}</span><span class="s1">get isCursorInViewport</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rows</span><span class="s0">}</span><span class="s1">_getCorrectBufferLength</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hasScrollback</span><span class="s0">)</span><span class="s4">return </span><span class="s1">e</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">scrollback</span><span class="s0">;</span><span class="s4">return </span><span class="s1">i</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MAX_BUFFER_SIZE</span><span class="s0">?</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MAX_BUFFER_SIZE</span><span class="s0">:</span><span class="s1">i</span><span class="s0">}</span><span class="s1">fillViewportRows</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">);</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rows</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">t</span><span class="s0">--;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getBlankLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))}}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">=</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">CircularList</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCorrectBufferLength</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rows</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rows</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setupTabStops</span><span class="s0">()}</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">);</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getCorrectBufferLength</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">=</span><span class="s1">r</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s1">s</span><span class="s0">+=+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">t</span><span class="s0">).</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rows</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rows</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">windowsMode</span><span class="s0">||</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">windowsPty</span><span class="s0">.</span><span class="s1">backend</span><span class="s0">||</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">windowsPty</span><span class="s0">.</span><span class="s1">buildNumber</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">BufferLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">+</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">--,</span><span class="s1">n</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">--):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">BufferLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)));</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rows</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">;</span><span class="s1">e</span><span class="s0">--)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">+</span><span class="s3">1</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">():(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">++));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">r</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">trimStart</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">-</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">-</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">savedY</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">savedY</span><span class="s0">-</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">=</span><span class="s1">r</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">n</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">+=</span><span class="s1">n</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">savedX</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">savedX</span><span class="s0">,</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">=</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isReflowEnabled</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_reflow</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">))</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">n</span><span class="s0">++)</span><span class="s1">s</span><span class="s0">+=+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">n</span><span class="s0">).</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rows</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_memoryCleanupQueue</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">(),</span><span class="s1">s</span><span class="s0">&gt;</span><span class="s3">.1</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_memoryCleanupPosition</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_memoryCleanupQueue</span><span class="s0">.</span><span class="s1">enqueue</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_batchedMemoryCleanup</span><span class="s0">())))}</span><span class="s1">_batchedMemoryCleanup</span><span class="s0">(){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_memoryCleanupPosition</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_memoryCleanupPosition</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">);</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_memoryCleanupPosition</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">+=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_memoryCleanupPosition</span><span class="s0">++).</span><span class="s1">cleanupMemory</span><span class="s0">(),</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">100</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">}</span><span class="s1">get _isReflowEnabled</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">windowsPty</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buildNumber</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hasScrollback</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;conpty&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">backend</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buildNumber</span><span class="s0">&gt;=</span><span class="s3">21376</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hasScrollback</span><span class="s0">&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">windowsMode</span><span class="s0">}</span><span class="s1">_reflow</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_reflowLarger</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_reflowSmaller</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">))}</span><span class="s1">_reflowLarger</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">reflowLargerGetLinesToRemove</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">reflowLargerCreateNewLayout</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">reflowLargerApplyNewLayout</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">layout</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_reflowLargerAdjustViewport</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">countRemoved</span><span class="s0">)}}</span><span class="s1">_reflowLargerAdjustViewport</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">);</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">r</span><span class="s0">-- &gt;</span><span class="s3">0</span><span class="s0">;)</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">--,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">BufferLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">))):(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">--,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">--);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">savedY</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">savedY</span><span class="s0">-</span><span class="s1">i</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">_reflowSmaller</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getNullCell</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=[];</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">n</span><span class="s0">--){</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">n</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">h</span><span class="s0">||!</span><span class="s1">h</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">&amp;&amp;</span><span class="s1">h</span><span class="s0">.</span><span class="s1">getTrimmedLength</span><span class="s0">()&lt;=</span><span class="s1">e</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s4">const </span><span class="s1">c</span><span class="s0">=[</span><span class="s1">h</span><span class="s0">];</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">h</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">;)</span><span class="s1">h</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(--</span><span class="s1">n</span><span class="s0">),</span><span class="s1">c</span><span class="s0">.</span><span class="s1">unshift</span><span class="s0">(</span><span class="s1">h</span><span class="s0">);</span><span class="s4">const </span><span class="s1">l</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">&gt;=</span><span class="s1">n</span><span class="s0">&amp;&amp;</span><span class="s1">l</span><span class="s0">&lt;</span><span class="s1">n</span><span class="s0">+</span><span class="s1">c</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s4">const </span><span class="s1">d</span><span class="s0">=</span><span class="s1">c</span><span class="s0">[</span><span class="s1">c</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">].</span><span class="s1">getTrimmedLength</span><span class="s0">(),</span><span class="s1">_</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">reflowSmallerGetNewLineLengths</span><span class="s0">)(</span><span class="s1">c</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">,</span><span class="s1">e</span><span class="s0">),</span><span class="s1">u</span><span class="s0">=</span><span class="s1">_</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">c</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">let </span><span class="s1">f</span><span class="s0">;</span><span class="s1">f</span><span class="s0">=</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">?</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">+</span><span class="s1">u</span><span class="s0">):</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">+</span><span class="s1">u</span><span class="s0">);</span><span class="s4">const </span><span class="s1">v</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">u</span><span class="s0">;</span><span class="s1">e</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getBlankLine</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">);</span><span class="s1">v</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">v</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">({</span><span class="s1">start</span><span class="s0">:</span><span class="s1">n</span><span class="s0">+</span><span class="s1">c</span><span class="s0">.</span><span class="s1">length</span><span class="s0">+</span><span class="s1">r</span><span class="s0">,</span><span class="s1">newLines</span><span class="s0">:</span><span class="s1">v</span><span class="s0">}),</span><span class="s1">r</span><span class="s0">+=</span><span class="s1">v</span><span class="s0">.</span><span class="s1">length</span><span class="s0">),</span><span class="s1">c</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">...v</span><span class="s0">);</span><span class="s4">let </span><span class="s1">p</span><span class="s0">=</span><span class="s1">_</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">g</span><span class="s0">=</span><span class="s1">_</span><span class="s0">[</span><span class="s1">p</span><span class="s0">];</span><span class="s3">0</span><span class="s0">===</span><span class="s1">g</span><span class="s0">&amp;&amp;(</span><span class="s1">p</span><span class="s0">--,</span><span class="s1">g</span><span class="s0">=</span><span class="s1">_</span><span class="s0">[</span><span class="s1">p</span><span class="s0">]);</span><span class="s4">let </span><span class="s1">m</span><span class="s0">=</span><span class="s1">c</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">u</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">S</span><span class="s0">=</span><span class="s1">d</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">m</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">S</span><span class="s0">,</span><span class="s1">g</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">c</span><span class="s0">[</span><span class="s1">p</span><span class="s0">])</span><span class="s4">break</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">c</span><span class="s0">[</span><span class="s1">p</span><span class="s0">].</span><span class="s1">copyCellsFrom</span><span class="s0">(</span><span class="s1">c</span><span class="s0">[</span><span class="s1">m</span><span class="s0">],</span><span class="s1">S</span><span class="s0">-</span><span class="s1">e</span><span class="s0">,</span><span class="s1">g</span><span class="s0">-</span><span class="s1">e</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">),</span><span class="s1">g</span><span class="s0">-=</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">===</span><span class="s1">g</span><span class="s0">&amp;&amp;(</span><span class="s1">p</span><span class="s0">--,</span><span class="s1">g</span><span class="s0">=</span><span class="s1">_</span><span class="s0">[</span><span class="s1">p</span><span class="s0">]),</span><span class="s1">S</span><span class="s0">-=</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">===</span><span class="s1">S</span><span class="s0">){</span><span class="s1">m</span><span class="s0">--;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">m</span><span class="s0">,</span><span class="s3">0</span><span class="s0">);</span><span class="s1">S</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">getWrappedLineTrimmedLength</span><span class="s0">)(</span><span class="s1">c</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">)}}</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">c</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s1">_</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]&lt;</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">c</span><span class="s0">[</span><span class="s1">t</span><span class="s0">].</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">_</span><span class="s0">[</span><span class="s1">t</span><span class="s0">],</span><span class="s1">i</span><span class="s0">);</span><span class="s4">let </span><span class="s1">C</span><span class="s0">=</span><span class="s1">u</span><span class="s0">-</span><span class="s1">f</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">C</span><span class="s0">-- &gt;</span><span class="s3">0</span><span class="s0">;)</span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">y</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">()):(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">++):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">&lt;</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">+</span><span class="s1">r</span><span class="s0">)-</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">++);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">savedY</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">savedY</span><span class="s0">+</span><span class="s1">u</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=[],</span><span class="s1">t</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">s</span><span class="s0">));</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">[</span><span class="s1">o</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">+</span><span class="s1">r</span><span class="s0">);</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">d</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">+</span><span class="s1">r</span><span class="s0">-</span><span class="s3">1</span><span class="s0">);</span><span class="s1">d</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">d</span><span class="s0">--)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">&amp;&amp;</span><span class="s1">a</span><span class="s0">.</span><span class="s1">start</span><span class="s0">&gt;</span><span class="s1">n</span><span class="s0">+</span><span class="s1">h</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">a</span><span class="s0">.</span><span class="s1">newLines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">--)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">d</span><span class="s0">--,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">newLines</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]);</span><span class="s1">d</span><span class="s0">++,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">({</span><span class="s1">index</span><span class="s0">:</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,</span><span class="s1">amount</span><span class="s0">:</span><span class="s1">a</span><span class="s0">.</span><span class="s1">newLines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}),</span><span class="s1">h</span><span class="s0">+=</span><span class="s1">a</span><span class="s0">.</span><span class="s1">newLines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">[++</span><span class="s1">o</span><span class="s0">]}</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">d</span><span class="s0">,</span><span class="s1">t</span><span class="s0">[</span><span class="s1">n</span><span class="s0">--]);</span><span class="s4">let </span><span class="s1">c</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">--)</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">index</span><span class="s0">+=</span><span class="s1">c</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">onInsertEmitter</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]),</span><span class="s1">c</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">amount</span><span class="s0">;</span><span class="s4">const </span><span class="s1">l</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">+</span><span class="s1">r</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">);</span><span class="s1">l</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">onTrimEmitter</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">l</span><span class="s0">)}}</span><span class="s1">translateBufferLineToString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return </span><span class="s1">r</span><span class="s0">?</span><span class="s1">r</span><span class="s0">.</span><span class="s1">translateToString</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">):</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s1">getWrappedRangeForLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">t</span><span class="s0">).</span><span class="s1">isWrapped</span><span class="s0">;)</span><span class="s1">t</span><span class="s0">--;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">i</span><span class="s0">+</span><span class="s3">1</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">i</span><span class="s0">+</span><span class="s3">1</span><span class="s0">).</span><span class="s1">isWrapped</span><span class="s0">;)</span><span class="s1">i</span><span class="s0">++;</span><span class="s4">return</span><span class="s0">{</span><span class="s1">first</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">last</span><span class="s0">:</span><span class="s1">i</span><span class="s0">}}</span><span class="s1">setupTabStops</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">null</span><span class="s0">!=</span><span class="s1">e</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tabs</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]||(</span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">prevStop</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)):(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tabs</span><span class="s0">={},</span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">);</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">;</span><span class="s1">e</span><span class="s0">+=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">tabStopWidth</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tabs</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">prevStop</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">null</span><span class="s0">==</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">x</span><span class="s0">);!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tabs</span><span class="s0">[--</span><span class="s1">e</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">;);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">:</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}</span><span class="s1">nextStop</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">null</span><span class="s0">==</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">x</span><span class="s0">);!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tabs</span><span class="s0">[++</span><span class="s1">e</span><span class="s0">]&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">;);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cols</span><span class="s0">-</span><span class="s3">1</span><span class="s0">:</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}</span><span class="s1">clearMarkers</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isClearing</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">[</span><span class="s1">t</span><span class="s0">].</span><span class="s1">line</span><span class="s0">===</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">[</span><span class="s1">t</span><span class="s0">].</span><span class="s1">dispose</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">t</span><span class="s0">--,</span><span class="s3">1</span><span class="s0">));</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isClearing</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">clearAllMarkers</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isClearing</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">e</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">dispose</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">e</span><span class="s0">--,</span><span class="s3">1</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isClearing</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">addMarker</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">new </span><span class="s1">l</span><span class="s0">.</span><span class="s1">Marker</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">onTrim</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s1">t</span><span class="s0">.</span><span class="s1">line</span><span class="s0">-=</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">line</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">()}))),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">onInsert</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s1">t</span><span class="s0">.</span><span class="s1">line</span><span class="s0">&gt;=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">index</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">line</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">amount</span><span class="s0">)}))),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">onDelete</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s1">t</span><span class="s0">.</span><span class="s1">line</span><span class="s0">&gt;=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">index</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">line</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">index</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">amount</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">(),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">line</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">index</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">line</span><span class="s0">-=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">amount</span><span class="s0">)}))),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">onDispose</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_removeMarker</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)))),</span><span class="s1">t</span><span class="s0">}</span><span class="s1">_removeMarker</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isClearing</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s3">1</span><span class="s0">)}}},</span><span class="s3">8437</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferLine</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3734</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">511</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">643</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">482</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR_DATA</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">freeze</span><span class="s0">(</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">AttributeData</span><span class="s0">);</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">class </span><span class="s1">h</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">={},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">={},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint32Array</span><span class="s0">(</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">);</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">||</span><span class="s1">r</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">.</span><span class="s1">fromCharData</span><span class="s0">([</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">NULL_CELL_CHAR</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">NULL_CELL_WIDTH</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">NULL_CELL_CODE</span><span class="s0">]);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">;++</span><span class="s1">r</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">],</span><span class="s1">i</span><span class="s0">=</span><span class="s3">2097151</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">;</span><span class="s4">return</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">1</span><span class="s0">],</span><span class="s3">2097152</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]:</span><span class="s1">i</span><span class="s0">?(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">stringFromCodePoint</span><span class="s0">)(</span><span class="s1">i</span><span class="s0">):</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">22</span><span class="s0">,</span><span class="s3">2097152</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">):</span><span class="s1">i</span><span class="s0">]}</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">n</span><span class="s0">.</span><span class="s1">CHAR_DATA_ATTR_INDEX</span><span class="s0">],</span><span class="s1">t</span><span class="s0">[</span><span class="s1">n</span><span class="s0">.</span><span class="s1">CHAR_DATA_CHAR_INDEX</span><span class="s0">].</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">]=</span><span class="s3">2097152</span><span class="s0">|</span><span class="s1">e</span><span class="s0">|</span><span class="s1">t</span><span class="s0">[</span><span class="s1">n</span><span class="s0">.</span><span class="s1">CHAR_DATA_WIDTH_INDEX</span><span class="s0">]&lt;&lt;</span><span class="s3">22</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">n</span><span class="s0">.</span><span class="s1">CHAR_DATA_CHAR_INDEX</span><span class="s0">].</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)|</span><span class="s1">t</span><span class="s0">[</span><span class="s1">n</span><span class="s0">.</span><span class="s1">CHAR_DATA_WIDTH_INDEX</span><span class="s0">]&lt;&lt;</span><span class="s3">22</span><span class="s0">}</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">]&gt;&gt;</span><span class="s3">22</span><span class="s0">}</span><span class="s1">hasWidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">12582912</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">]}</span><span class="s1">getFg</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]}</span><span class="s1">getBg</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">2</span><span class="s0">]}</span><span class="s1">hasContent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">4194303</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">]}</span><span class="s1">getCodePoint</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">];</span><span class="s4">return </span><span class="s3">2097152</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">):</span><span class="s3">2097151</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">}</span><span class="s1">isCombined</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">2097152</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">]}</span><span class="s1">getString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">];</span><span class="s4">return </span><span class="s3">2097152</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]:</span><span class="s3">2097151</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">?(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">stringFromCodePoint</span><span class="s0">)(</span><span class="s3">2097151</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">):</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s1">isProtected</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">536870912</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">2</span><span class="s0">]}</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">a</span><span class="s0">=</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">content</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s1">a</span><span class="s0">+</span><span class="s3">0</span><span class="s0">],</span><span class="s1">t</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">],</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s1">a</span><span class="s0">+</span><span class="s3">2</span><span class="s0">],</span><span class="s3">2097152</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">content</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">combinedData</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]),</span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]),</span><span class="s1">t</span><span class="s0">}</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s3">2097152</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">content</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">combinedData</span><span class="s0">),</span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">content</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">2</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">}</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">|</span><span class="s1">i</span><span class="s0">&lt;&lt;</span><span class="s3">22</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">2</span><span class="s0">]=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">}</span><span class="s1">addCodepointToCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">];</span><span class="s3">2097152</span><span class="s0">&amp;</span><span class="s1">s</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]+=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">stringFromCodePoint</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">):</span><span class="s3">2097151</span><span class="s0">&amp;</span><span class="s1">s</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">stringFromCodePoint</span><span class="s0">)(</span><span class="s3">2097151</span><span class="s0">&amp;</span><span class="s1">s</span><span class="s0">)+(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">stringFromCodePoint</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">s</span><span class="s0">&amp;=-</span><span class="s3">2097152</span><span class="s0">,</span><span class="s1">s</span><span class="s0">|=</span><span class="s3">2097152</span><span class="s0">):</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">|</span><span class="s3">1</span><span class="s0">&lt;&lt;</span><span class="s3">22</span><span class="s0">,</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">&amp;=-</span><span class="s3">12582913</span><span class="s0">,</span><span class="s1">s</span><span class="s0">|=</span><span class="s1">i</span><span class="s0">&lt;&lt;</span><span class="s3">22</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">s</span><span class="s0">}</span><span class="s1">insertCells</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">((</span><span class="s1">e</span><span class="s0">%=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)&amp;&amp;</span><span class="s3">2</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">e</span><span class="s0">-</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;--</span><span class="s1">i</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s1">t</span><span class="s0">+</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">));</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">;++</span><span class="s1">r</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s1">r</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">s</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s3">2</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">deleteCells</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">%=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">e</span><span class="s0">-</span><span class="s1">t</span><span class="s0">;++</span><span class="s1">i</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s1">t</span><span class="s0">+</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">));</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">t</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">e</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">s</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s3">2</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">hasContent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">replaceCells</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s3">2</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isProtected</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s3">2</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isProtected</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isProtected</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">e</span><span class="s0">++;</span><span class="s4">else for</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s3">2</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s3">2</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCellFromCodepoint</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">++,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return </span><span class="s3">4</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">length</span><span class="s0">*</span><span class="s3">2</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">byteLength</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">byteLength</span><span class="s0">&gt;=</span><span class="s3">4</span><span class="s0">*</span><span class="s1">i</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint32Array</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">else</span><span class="s0">{</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint32Array</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">;++</span><span class="s1">i</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">subarray</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">keys</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s1">i</span><span class="s0">],</span><span class="s3">10</span><span class="s0">);</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s4">delete this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]}</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">keys</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">s</span><span class="s0">[</span><span class="s1">i</span><span class="s0">],</span><span class="s3">10</span><span class="s0">);</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s4">delete this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]}}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s3">4</span><span class="s0">*</span><span class="s1">i</span><span class="s0">*</span><span class="s3">2</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">byteLength</span><span class="s0">}</span><span class="s1">cleanupMemory</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">4</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">length</span><span class="s0">*</span><span class="s3">2</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">byteLength</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint32Array</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">length</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return </span><span class="s3">0</span><span class="s0">}</span><span class="s1">fill</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">i</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isProtected</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">={},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">={};</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">t</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}}</span><span class="s1">copyFrom</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint32Array</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">={};</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t </span><span class="s4">in </span><span class="s1">e</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">t</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">={};</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t </span><span class="s4">in </span><span class="s1">e</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">[</span><span class="s1">t</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">}</span><span class="s1">clone</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">h</span><span class="s0">(</span><span class="s3">0</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint32Array</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t </span><span class="s4">in this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">t</span><span class="s0">];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t </span><span class="s4">in this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">[</span><span class="s1">t</span><span class="s0">];</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">,</span><span class="s1">e</span><span class="s0">}</span><span class="s1">getTrimmedLength</span><span class="s0">(){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;--</span><span class="s1">e</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s3">4194303</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">])</span><span class="s4">return </span><span class="s1">e</span><span class="s0">+(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">]&gt;&gt;</span><span class="s3">22</span><span class="s0">);</span><span class="s4">return </span><span class="s3">0</span><span class="s0">}</span><span class="s1">getNoBgTrimmedLength</span><span class="s0">(){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;--</span><span class="s1">e</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s3">4194303</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">]||</span><span class="s3">50331648</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">2</span><span class="s0">])</span><span class="s4">return </span><span class="s1">e</span><span class="s0">+(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">e</span><span class="s0">+</span><span class="s3">0</span><span class="s0">]&gt;&gt;</span><span class="s3">22</span><span class="s0">);</span><span class="s4">return </span><span class="s3">0</span><span class="s0">}</span><span class="s1">copyCellsFrom</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">){</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">;</span><span class="s1">e</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*(</span><span class="s1">i</span><span class="s0">+</span><span class="s1">a</span><span class="s0">)+</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">n</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*(</span><span class="s1">t</span><span class="s0">+</span><span class="s1">a</span><span class="s0">)+</span><span class="s1">e</span><span class="s0">];</span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s1">n</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*(</span><span class="s1">t</span><span class="s0">+</span><span class="s1">a</span><span class="s0">)+</span><span class="s3">2</span><span class="s0">]&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">[</span><span class="s1">i</span><span class="s0">+</span><span class="s1">a</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">[</span><span class="s1">t</span><span class="s0">+</span><span class="s1">a</span><span class="s0">])}</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">;</span><span class="s1">a</span><span class="s0">++){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">;</span><span class="s1">e</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*(</span><span class="s1">i</span><span class="s0">+</span><span class="s1">a</span><span class="s0">)+</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">n</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*(</span><span class="s1">t</span><span class="s0">+</span><span class="s1">a</span><span class="s0">)+</span><span class="s1">e</span><span class="s0">];</span><span class="s3">268435456</span><span class="s0">&amp;</span><span class="s1">n</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*(</span><span class="s1">t</span><span class="s0">+</span><span class="s1">a</span><span class="s0">)+</span><span class="s3">2</span><span class="s0">]&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">[</span><span class="s1">i</span><span class="s0">+</span><span class="s1">a</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_extendedAttrs</span><span class="s0">[</span><span class="s1">t</span><span class="s0">+</span><span class="s1">a</span><span class="s0">])}</span><span class="s4">const </span><span class="s1">o</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">keys</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&lt;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">a</span><span class="s0">++){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">o</span><span class="s0">[</span><span class="s1">a</span><span class="s0">],</span><span class="s3">10</span><span class="s0">);</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">s</span><span class="s0">-</span><span class="s1">t</span><span class="s0">+</span><span class="s1">i</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">s</span><span class="s0">])}}</span><span class="s1">translateToString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">=</span><span class="s1">t</span><span class="s0">??</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s1">i</span><span class="s0">??</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getTrimmedLength</span><span class="s0">())),</span><span class="s1">s</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">);</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">;){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">[</span><span class="s3">3</span><span class="s0">*</span><span class="s1">t</span><span class="s0">+</span><span class="s3">0</span><span class="s0">],</span><span class="s1">i</span><span class="s0">=</span><span class="s3">2097151</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s3">2097152</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_combined</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]:</span><span class="s1">i</span><span class="s0">?(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">stringFromCodePoint</span><span class="s0">)(</span><span class="s1">i</span><span class="s0">):</span><span class="s1">n</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CHAR</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">+=</span><span class="s1">a</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">a</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">r</span><span class="s0">)</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s1">t</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">22</span><span class="s0">||</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return </span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">r</span><span class="s0">}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferLine</span><span class="s0">=</span><span class="s1">h</span><span class="s0">},</span><span class="s3">4841</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getRangeLength</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getRangeLength</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">y</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`Buffer range end (</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">x</span><span class="s0">}</span><span class="s2">, </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">y</span><span class="s0">}</span><span class="s2">) cannot be before start (</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">x</span><span class="s0">}</span><span class="s2">, </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">y</span><span class="s0">}</span><span class="s2">)`</span><span class="s0">);</span><span class="s4">return </span><span class="s1">t</span><span class="s0">*(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">y</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)+(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">end</span><span class="s0">.</span><span class="s1">x</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">x</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)}},</span><span class="s3">4634</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s4">function </span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)</span><span class="s4">return </span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">].</span><span class="s1">getTrimmedLength</span><span class="s0">();</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=!</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">].</span><span class="s1">hasContent</span><span class="s0">(</span><span class="s1">i</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)&amp;&amp;</span><span class="s3">1</span><span class="s0">===</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">].</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">i</span><span class="s0">-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s3">2</span><span class="s0">===</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">+</span><span class="s3">1</span><span class="s0">].</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s3">0</span><span class="s0">);</span><span class="s4">return </span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">?</span><span class="s1">i</span><span class="s0">-</span><span class="s3">1</span><span class="s0">:</span><span class="s1">i</span><span class="s0">}</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getWrappedLineTrimmedLength</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reflowSmallerGetNewLineLengths</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reflowLargerApplyNewLayout</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reflowLargerCreateNewLayout</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reflowLargerGetLinesToRemove</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reflowLargerGetLinesToRemove</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">const </span><span class="s1">o</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">++){</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s1">a</span><span class="s0">,</span><span class="s1">c</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(++</span><span class="s1">h</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">c</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s4">const </span><span class="s1">l</span><span class="s0">=[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">a</span><span class="s0">)];</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s1">c</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">;)</span><span class="s1">l</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">c</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(++</span><span class="s1">h</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">&gt;=</span><span class="s1">a</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">h</span><span class="s0">){</span><span class="s1">a</span><span class="s0">+=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">continue</span><span class="s0">}</span><span class="s4">let </span><span class="s1">d</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">_</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,</span><span class="s1">d</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">u</span><span class="s0">=</span><span class="s3">1</span><span class="s0">,</span><span class="s1">f</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">u</span><span class="s0">&lt;</span><span class="s1">l</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,</span><span class="s1">u</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">-</span><span class="s1">f</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">s</span><span class="s0">-</span><span class="s1">_</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">o</span><span class="s0">);</span><span class="s1">l</span><span class="s0">[</span><span class="s1">d</span><span class="s0">].</span><span class="s1">copyCellsFrom</span><span class="s0">(</span><span class="s1">l</span><span class="s0">[</span><span class="s1">u</span><span class="s0">],</span><span class="s1">f</span><span class="s0">,</span><span class="s1">_</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">),</span><span class="s1">_</span><span class="s0">+=</span><span class="s1">a</span><span class="s0">,</span><span class="s1">_</span><span class="s0">===</span><span class="s1">s</span><span class="s0">&amp;&amp;(</span><span class="s1">d</span><span class="s0">++,</span><span class="s1">_</span><span class="s0">=</span><span class="s3">0</span><span class="s0">),</span><span class="s1">f</span><span class="s0">+=</span><span class="s1">a</span><span class="s0">,</span><span class="s1">f</span><span class="s0">===</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s1">u</span><span class="s0">++,</span><span class="s1">f</span><span class="s0">=</span><span class="s3">0</span><span class="s0">),</span><span class="s3">0</span><span class="s0">===</span><span class="s1">_</span><span class="s0">&amp;&amp;</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">d</span><span class="s0">&amp;&amp;</span><span class="s3">2</span><span class="s0">===</span><span class="s1">l</span><span class="s0">[</span><span class="s1">d</span><span class="s0">-</span><span class="s3">1</span><span class="s0">].</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)&amp;&amp;(</span><span class="s1">l</span><span class="s0">[</span><span class="s1">d</span><span class="s0">].</span><span class="s1">copyCellsFrom</span><span class="s0">(</span><span class="s1">l</span><span class="s0">[</span><span class="s1">d</span><span class="s0">-</span><span class="s3">1</span><span class="s0">],</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">_</span><span class="s0">++,</span><span class="s3">1</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">),</span><span class="s1">l</span><span class="s0">[</span><span class="s1">d</span><span class="s0">-</span><span class="s3">1</span><span class="s0">].</span><span class="s1">setCell</span><span class="s0">(</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">n</span><span class="s0">))}</span><span class="s1">l</span><span class="s0">[</span><span class="s1">d</span><span class="s0">].</span><span class="s1">replaceCells</span><span class="s0">(</span><span class="s1">_</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">);</span><span class="s4">let </span><span class="s1">v</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s1">d</span><span class="s0">||</span><span class="s3">0</span><span class="s0">===</span><span class="s1">l</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">getTrimmedLength</span><span class="s0">());</span><span class="s1">e</span><span class="s0">--)</span><span class="s1">v</span><span class="s0">++;</span><span class="s1">v</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">a</span><span class="s0">+</span><span class="s1">l</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">v</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">v</span><span class="s0">)),</span><span class="s1">a</span><span class="s0">+=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return </span><span class="s1">o</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reflowLargerCreateNewLayout</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=[];</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">],</span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">o</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">===</span><span class="s1">o</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[++</span><span class="s1">s</span><span class="s0">];</span><span class="s1">e</span><span class="s0">.</span><span class="s1">onDeleteEmitter</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">index</span><span class="s0">:</span><span class="s1">o</span><span class="s0">-</span><span class="s1">n</span><span class="s0">,</span><span class="s1">amount</span><span class="s0">:</span><span class="s1">i</span><span class="s0">}),</span><span class="s1">o</span><span class="s0">+=</span><span class="s1">i</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">n</span><span class="s0">+=</span><span class="s1">i</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[++</span><span class="s1">s</span><span class="s0">]}</span><span class="s4">else </span><span class="s1">i</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return</span><span class="s0">{</span><span class="s1">layout</span><span class="s0">:</span><span class="s1">i</span><span class="s0">,</span><span class="s1">countRemoved</span><span class="s0">:</span><span class="s1">n</span><span class="s0">}},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reflowLargerApplyNewLayout</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++)</span><span class="s1">i</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]));</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reflowSmallerGetNewLineLengths</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=[],</span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(((</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">)=&gt;</span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">))).</span><span class="s1">reduce</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;</span><span class="s1">e</span><span class="s0">+</span><span class="s1">t</span><span class="s0">));</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s1">n</span><span class="s0">;){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">-</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">){</span><span class="s1">r</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">n</span><span class="s0">-</span><span class="s1">h</span><span class="s0">);</span><span class="s4">break</span><span class="s0">}</span><span class="s1">o</span><span class="s0">+=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">const </span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s1">o</span><span class="s0">&gt;</span><span class="s1">c</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">-=</span><span class="s1">c</span><span class="s0">,</span><span class="s1">a</span><span class="s0">++);</span><span class="s4">const </span><span class="s1">l</span><span class="s0">=</span><span class="s3">2</span><span class="s0">===</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">].</span><span class="s1">getWidth</span><span class="s0">(</span><span class="s1">o</span><span class="s0">-</span><span class="s3">1</span><span class="s0">);</span><span class="s1">l</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">--;</span><span class="s4">const </span><span class="s1">d</span><span class="s0">=</span><span class="s1">l</span><span class="s0">?</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">:</span><span class="s1">s</span><span class="s0">;</span><span class="s1">r</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">d</span><span class="s0">),</span><span class="s1">h</span><span class="s0">+=</span><span class="s1">d</span><span class="s0">}</span><span class="s4">return </span><span class="s1">r</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getWrappedLineTrimmedLength</span><span class="s0">=</span><span class="s1">i</span><span class="s0">},</span><span class="s3">5295</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferSet</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">9092</span><span class="s0">);</span><span class="s4">class </span><span class="s1">o </span><span class="s4">extends </span><span class="s1">r</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBufferActivate</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onBufferActivate</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBufferActivate</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">onSpecificOptionChange</span><span class="s0">(</span><span class="s2">&quot;scrollback&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">resize</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">)))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">onSpecificOptionChange</span><span class="s0">(</span><span class="s2">&quot;tabStopWidth&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setupTabStops</span><span class="s0">())))}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">=</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">Buffer</span><span class="s0">(!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">.</span><span class="s1">fillViewportRows</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">=</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">Buffer</span><span class="s0">(!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBufferActivate</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">activeBuffer</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">,</span><span class="s1">inactiveBuffer</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setupTabStops</span><span class="s0">()}</span><span class="s1">get alt</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">}</span><span class="s1">get active</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">}</span><span class="s1">get normal</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">}</span><span class="s1">activateNormalBuffer</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">.</span><span class="s1">clearAllMarkers</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBufferActivate</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">activeBuffer</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">,</span><span class="s1">inactiveBuffer</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">}))}</span><span class="s1">activateAltBuffer</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">.</span><span class="s1">fillViewportRows</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">.</span><span class="s1">x</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">.</span><span class="s1">x</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">.</span><span class="s1">y</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">.</span><span class="s1">y</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeBuffer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBufferActivate</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">activeBuffer</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">,</span><span class="s1">inactiveBuffer</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">}))}</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">.</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">.</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setupTabStops</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">setupTabStops</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">.</span><span class="s1">setupTabStops</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alt</span><span class="s0">.</span><span class="s1">setupTabStops</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferSet</span><span class="s0">=</span><span class="s1">o</span><span class="s0">},</span><span class="s3">511</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">482</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">643</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3734</span><span class="s0">);</span><span class="s4">class </span><span class="s1">o </span><span class="s4">extends </span><span class="s1">n</span><span class="s0">.</span><span class="s1">AttributeData</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">super</span><span class="s0">(</span><span class="s1">...arguments</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">content</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">ExtendedAttrs</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">combinedData</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s4">static </span><span class="s1">fromCharData</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">new </span><span class="s1">o</span><span class="s0">;</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">setFromCharData</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">t</span><span class="s0">}</span><span class="s1">isCombined</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">2097152</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">content</span><span class="s0">}</span><span class="s1">getWidth</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">content</span><span class="s0">&gt;&gt;</span><span class="s3">22</span><span class="s0">}</span><span class="s1">getChars</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">2097152</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">content</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">combinedData</span><span class="s0">:</span><span class="s3">2097151</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">content</span><span class="s0">?(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">stringFromCodePoint</span><span class="s0">)(</span><span class="s3">2097151</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">content</span><span class="s0">):</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s1">getCode</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">isCombined</span><span class="s0">()?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">combinedData</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">combinedData</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">):</span><span class="s3">2097151</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">content</span><span class="s0">}</span><span class="s1">setFromCharData</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">r</span><span class="s0">.</span><span class="s1">CHAR_DATA_ATTR_INDEX</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s1">r</span><span class="s0">.</span><span class="s1">CHAR_DATA_CHAR_INDEX</span><span class="s0">].</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">2</span><span class="s0">)</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(</span><span class="s3">2</span><span class="s0">===</span><span class="s1">e</span><span class="s0">[</span><span class="s1">r</span><span class="s0">.</span><span class="s1">CHAR_DATA_CHAR_INDEX</span><span class="s0">].</span><span class="s1">length</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">r</span><span class="s0">.</span><span class="s1">CHAR_DATA_CHAR_INDEX</span><span class="s0">].</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s3">55296</span><span class="s0">&lt;=</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s3">56319</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">r</span><span class="s0">.</span><span class="s1">CHAR_DATA_CHAR_INDEX</span><span class="s0">].</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">1</span><span class="s0">);</span><span class="s3">56320</span><span class="s0">&lt;=</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">&lt;=</span><span class="s3">57343</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">content</span><span class="s0">=</span><span class="s3">1024</span><span class="s0">*(</span><span class="s1">i</span><span class="s0">-</span><span class="s3">55296</span><span class="s0">)+</span><span class="s1">s</span><span class="s0">-</span><span class="s3">56320</span><span class="s0">+</span><span class="s3">65536</span><span class="s0">|</span><span class="s1">e</span><span class="s0">[</span><span class="s1">r</span><span class="s0">.</span><span class="s1">CHAR_DATA_WIDTH_INDEX</span><span class="s0">]&lt;&lt;</span><span class="s3">22</span><span class="s0">:</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">}</span><span class="s4">else </span><span class="s1">t</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">}</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">content</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">r</span><span class="s0">.</span><span class="s1">CHAR_DATA_CHAR_INDEX</span><span class="s0">].</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)|</span><span class="s1">e</span><span class="s0">[</span><span class="s1">r</span><span class="s0">.</span><span class="s1">CHAR_DATA_WIDTH_INDEX</span><span class="s0">]&lt;&lt;</span><span class="s3">22</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">combinedData</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">r</span><span class="s0">.</span><span class="s1">CHAR_DATA_CHAR_INDEX</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">content</span><span class="s0">=</span><span class="s3">2097152</span><span class="s0">|</span><span class="s1">e</span><span class="s0">[</span><span class="s1">r</span><span class="s0">.</span><span class="s1">CHAR_DATA_WIDTH_INDEX</span><span class="s0">]&lt;&lt;</span><span class="s3">22</span><span class="s0">)}</span><span class="s1">getAsCharData</span><span class="s0">(){</span><span class="s4">return</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getChars</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getWidth</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getCode</span><span class="s0">()]}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">=</span><span class="s1">o</span><span class="s0">},</span><span class="s3">643</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CODE</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_WIDTH</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CHAR</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">NULL_CELL_CODE</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">NULL_CELL_WIDTH</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">NULL_CELL_CHAR</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHAR_DATA_CODE_INDEX</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHAR_DATA_WIDTH_INDEX</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHAR_DATA_CHAR_INDEX</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHAR_DATA_ATTR_INDEX</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_EXT</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_COLOR</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_COLOR</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_ATTR</span><span class="s0">=</span><span class="s3">256</span><span class="s0">|</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_COLOR</span><span class="s0">&lt;&lt;</span><span class="s3">9</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_EXT</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHAR_DATA_ATTR_INDEX</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHAR_DATA_CHAR_INDEX</span><span class="s0">=</span><span class="s3">1</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHAR_DATA_WIDTH_INDEX</span><span class="s0">=</span><span class="s3">2</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHAR_DATA_CODE_INDEX</span><span class="s0">=</span><span class="s3">3</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">NULL_CELL_CHAR</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">NULL_CELL_WIDTH</span><span class="s0">=</span><span class="s3">1</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">NULL_CELL_CODE</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CHAR</span><span class="s0">=</span><span class="s2">&quot; &quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_WIDTH</span><span class="s0">=</span><span class="s3">1</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">WHITESPACE_CELL_CODE</span><span class="s0">=</span><span class="s3">32</span><span class="s0">},</span><span class="s3">4863</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Marker</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">);</span><span class="s4">class </span><span class="s1">n</span><span class="s0">{</span><span class="s1">get id</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">line</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isDisposed</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_disposables</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">_nextId</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDispose</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onDispose</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDispose</span><span class="s0">.</span><span class="s1">event</span><span class="s0">}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isDisposed</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isDisposed</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">line</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDispose</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(),(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">disposeArray</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_disposables</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_disposables</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">register</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_disposables</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">e</span><span class="s0">}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Marker</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">_nextId</span><span class="s0">=</span><span class="s3">1</span><span class="s0">},</span><span class="s3">7116</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_CHARSET</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">={},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_CHARSET</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">.</span><span class="s1">B</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]={</span><span class="s2">&quot;`&quot;</span><span class="s0">:</span><span class="s2">&quot;◆&quot;</span><span class="s0">,</span><span class="s1">a</span><span class="s0">:</span><span class="s2">&quot;▒&quot;</span><span class="s0">,</span><span class="s1">b</span><span class="s0">:</span><span class="s2">&quot;␉&quot;</span><span class="s0">,</span><span class="s1">c</span><span class="s0">:</span><span class="s2">&quot;␌&quot;</span><span class="s0">,</span><span class="s1">d</span><span class="s0">:</span><span class="s2">&quot;␍&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">:</span><span class="s2">&quot;␊&quot;</span><span class="s0">,</span><span class="s1">f</span><span class="s0">:</span><span class="s2">&quot;°&quot;</span><span class="s0">,</span><span class="s1">g</span><span class="s0">:</span><span class="s2">&quot;±&quot;</span><span class="s0">,</span><span class="s1">h</span><span class="s0">:</span><span class="s2">&quot;␤&quot;</span><span class="s0">,</span><span class="s1">i</span><span class="s0">:</span><span class="s2">&quot;␋&quot;</span><span class="s0">,</span><span class="s1">j</span><span class="s0">:</span><span class="s2">&quot;┘&quot;</span><span class="s0">,</span><span class="s1">k</span><span class="s0">:</span><span class="s2">&quot;┐&quot;</span><span class="s0">,</span><span class="s1">l</span><span class="s0">:</span><span class="s2">&quot;┌&quot;</span><span class="s0">,</span><span class="s1">m</span><span class="s0">:</span><span class="s2">&quot;└&quot;</span><span class="s0">,</span><span class="s1">n</span><span class="s0">:</span><span class="s2">&quot;┼&quot;</span><span class="s0">,</span><span class="s1">o</span><span class="s0">:</span><span class="s2">&quot;⎺&quot;</span><span class="s0">,</span><span class="s1">p</span><span class="s0">:</span><span class="s2">&quot;⎻&quot;</span><span class="s0">,</span><span class="s1">q</span><span class="s0">:</span><span class="s2">&quot;─&quot;</span><span class="s0">,</span><span class="s1">r</span><span class="s0">:</span><span class="s2">&quot;⎼&quot;</span><span class="s0">,</span><span class="s1">s</span><span class="s0">:</span><span class="s2">&quot;⎽&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">:</span><span class="s2">&quot;├&quot;</span><span class="s0">,</span><span class="s1">u</span><span class="s0">:</span><span class="s2">&quot;┤&quot;</span><span class="s0">,</span><span class="s1">v</span><span class="s0">:</span><span class="s2">&quot;┴&quot;</span><span class="s0">,</span><span class="s1">w</span><span class="s0">:</span><span class="s2">&quot;┬&quot;</span><span class="s0">,</span><span class="s1">x</span><span class="s0">:</span><span class="s2">&quot;│&quot;</span><span class="s0">,</span><span class="s1">y</span><span class="s0">:</span><span class="s2">&quot;≤&quot;</span><span class="s0">,</span><span class="s1">z</span><span class="s0">:</span><span class="s2">&quot;≥&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">:</span><span class="s2">&quot;π&quot;</span><span class="s0">,</span><span class="s2">&quot;|&quot;</span><span class="s0">:</span><span class="s2">&quot;≠&quot;</span><span class="s0">,</span><span class="s2">&quot;}&quot;</span><span class="s0">:</span><span class="s2">&quot;£&quot;</span><span class="s0">,</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s2">&quot;·&quot;</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">.</span><span class="s1">A</span><span class="s0">={</span><span class="s2">&quot;#&quot;</span><span class="s0">:</span><span class="s2">&quot;£&quot;</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">.</span><span class="s1">B</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">[</span><span class="s3">4</span><span class="s0">]={</span><span class="s2">&quot;#&quot;</span><span class="s0">:</span><span class="s2">&quot;£&quot;</span><span class="s0">,</span><span class="s2">&quot;@&quot;</span><span class="s0">:</span><span class="s2">&quot;¾&quot;</span><span class="s0">,</span><span class="s2">&quot;[&quot;</span><span class="s0">:</span><span class="s2">&quot;ij&quot;</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">&quot;</span><span class="s0">:</span><span class="s2">&quot;½&quot;</span><span class="s0">,</span><span class="s2">&quot;]&quot;</span><span class="s0">:</span><span class="s2">&quot;|&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">:</span><span class="s2">&quot;¨&quot;</span><span class="s0">,</span><span class="s2">&quot;|&quot;</span><span class="s0">:</span><span class="s2">&quot;f&quot;</span><span class="s0">,</span><span class="s2">&quot;}&quot;</span><span class="s0">:</span><span class="s2">&quot;¼&quot;</span><span class="s0">,</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s2">&quot;´&quot;</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">.</span><span class="s1">C</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">[</span><span class="s3">5</span><span class="s0">]={</span><span class="s2">&quot;[&quot;</span><span class="s0">:</span><span class="s2">&quot;Ä&quot;</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">&quot;</span><span class="s0">:</span><span class="s2">&quot;Ö&quot;</span><span class="s0">,</span><span class="s2">&quot;]&quot;</span><span class="s0">:</span><span class="s2">&quot;Å&quot;</span><span class="s0">,</span><span class="s2">&quot;^&quot;</span><span class="s0">:</span><span class="s2">&quot;Ü&quot;</span><span class="s0">,</span><span class="s2">&quot;`&quot;</span><span class="s0">:</span><span class="s2">&quot;é&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">:</span><span class="s2">&quot;ä&quot;</span><span class="s0">,</span><span class="s2">&quot;|&quot;</span><span class="s0">:</span><span class="s2">&quot;ö&quot;</span><span class="s0">,</span><span class="s2">&quot;}&quot;</span><span class="s0">:</span><span class="s2">&quot;å&quot;</span><span class="s0">,</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s2">&quot;ü&quot;</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">.</span><span class="s1">R</span><span class="s0">={</span><span class="s2">&quot;#&quot;</span><span class="s0">:</span><span class="s2">&quot;£&quot;</span><span class="s0">,</span><span class="s2">&quot;@&quot;</span><span class="s0">:</span><span class="s2">&quot;à&quot;</span><span class="s0">,</span><span class="s2">&quot;[&quot;</span><span class="s0">:</span><span class="s2">&quot;°&quot;</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">&quot;</span><span class="s0">:</span><span class="s2">&quot;ç&quot;</span><span class="s0">,</span><span class="s2">&quot;]&quot;</span><span class="s0">:</span><span class="s2">&quot;§&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">:</span><span class="s2">&quot;é&quot;</span><span class="s0">,</span><span class="s2">&quot;|&quot;</span><span class="s0">:</span><span class="s2">&quot;ù&quot;</span><span class="s0">,</span><span class="s2">&quot;}&quot;</span><span class="s0">:</span><span class="s2">&quot;è&quot;</span><span class="s0">,</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s2">&quot;¨&quot;</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">.</span><span class="s1">Q</span><span class="s0">={</span><span class="s2">&quot;@&quot;</span><span class="s0">:</span><span class="s2">&quot;à&quot;</span><span class="s0">,</span><span class="s2">&quot;[&quot;</span><span class="s0">:</span><span class="s2">&quot;â&quot;</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">&quot;</span><span class="s0">:</span><span class="s2">&quot;ç&quot;</span><span class="s0">,</span><span class="s2">&quot;]&quot;</span><span class="s0">:</span><span class="s2">&quot;ê&quot;</span><span class="s0">,</span><span class="s2">&quot;^&quot;</span><span class="s0">:</span><span class="s2">&quot;î&quot;</span><span class="s0">,</span><span class="s2">&quot;`&quot;</span><span class="s0">:</span><span class="s2">&quot;ô&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">:</span><span class="s2">&quot;é&quot;</span><span class="s0">,</span><span class="s2">&quot;|&quot;</span><span class="s0">:</span><span class="s2">&quot;ù&quot;</span><span class="s0">,</span><span class="s2">&quot;}&quot;</span><span class="s0">:</span><span class="s2">&quot;è&quot;</span><span class="s0">,</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s2">&quot;û&quot;</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">.</span><span class="s1">K</span><span class="s0">={</span><span class="s2">&quot;@&quot;</span><span class="s0">:</span><span class="s2">&quot;§&quot;</span><span class="s0">,</span><span class="s2">&quot;[&quot;</span><span class="s0">:</span><span class="s2">&quot;Ä&quot;</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">&quot;</span><span class="s0">:</span><span class="s2">&quot;Ö&quot;</span><span class="s0">,</span><span class="s2">&quot;]&quot;</span><span class="s0">:</span><span class="s2">&quot;Ü&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">:</span><span class="s2">&quot;ä&quot;</span><span class="s0">,</span><span class="s2">&quot;|&quot;</span><span class="s0">:</span><span class="s2">&quot;ö&quot;</span><span class="s0">,</span><span class="s2">&quot;}&quot;</span><span class="s0">:</span><span class="s2">&quot;ü&quot;</span><span class="s0">,</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s2">&quot;ß&quot;</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">.</span><span class="s1">Y</span><span class="s0">={</span><span class="s2">&quot;#&quot;</span><span class="s0">:</span><span class="s2">&quot;£&quot;</span><span class="s0">,</span><span class="s2">&quot;@&quot;</span><span class="s0">:</span><span class="s2">&quot;§&quot;</span><span class="s0">,</span><span class="s2">&quot;[&quot;</span><span class="s0">:</span><span class="s2">&quot;°&quot;</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">&quot;</span><span class="s0">:</span><span class="s2">&quot;ç&quot;</span><span class="s0">,</span><span class="s2">&quot;]&quot;</span><span class="s0">:</span><span class="s2">&quot;é&quot;</span><span class="s0">,</span><span class="s2">&quot;`&quot;</span><span class="s0">:</span><span class="s2">&quot;ù&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">:</span><span class="s2">&quot;à&quot;</span><span class="s0">,</span><span class="s2">&quot;|&quot;</span><span class="s0">:</span><span class="s2">&quot;ò&quot;</span><span class="s0">,</span><span class="s2">&quot;}&quot;</span><span class="s0">:</span><span class="s2">&quot;è&quot;</span><span class="s0">,</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s2">&quot;ì&quot;</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">.</span><span class="s1">E</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">[</span><span class="s3">6</span><span class="s0">]={</span><span class="s2">&quot;@&quot;</span><span class="s0">:</span><span class="s2">&quot;Ä&quot;</span><span class="s0">,</span><span class="s2">&quot;[&quot;</span><span class="s0">:</span><span class="s2">&quot;Æ&quot;</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">&quot;</span><span class="s0">:</span><span class="s2">&quot;Ø&quot;</span><span class="s0">,</span><span class="s2">&quot;]&quot;</span><span class="s0">:</span><span class="s2">&quot;Å&quot;</span><span class="s0">,</span><span class="s2">&quot;^&quot;</span><span class="s0">:</span><span class="s2">&quot;Ü&quot;</span><span class="s0">,</span><span class="s2">&quot;`&quot;</span><span class="s0">:</span><span class="s2">&quot;ä&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">:</span><span class="s2">&quot;æ&quot;</span><span class="s0">,</span><span class="s2">&quot;|&quot;</span><span class="s0">:</span><span class="s2">&quot;ø&quot;</span><span class="s0">,</span><span class="s2">&quot;}&quot;</span><span class="s0">:</span><span class="s2">&quot;å&quot;</span><span class="s0">,</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s2">&quot;ü&quot;</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">.</span><span class="s1">Z</span><span class="s0">={</span><span class="s2">&quot;#&quot;</span><span class="s0">:</span><span class="s2">&quot;£&quot;</span><span class="s0">,</span><span class="s2">&quot;@&quot;</span><span class="s0">:</span><span class="s2">&quot;§&quot;</span><span class="s0">,</span><span class="s2">&quot;[&quot;</span><span class="s0">:</span><span class="s2">&quot;¡&quot;</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">&quot;</span><span class="s0">:</span><span class="s2">&quot;Ñ&quot;</span><span class="s0">,</span><span class="s2">&quot;]&quot;</span><span class="s0">:</span><span class="s2">&quot;¿&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">:</span><span class="s2">&quot;°&quot;</span><span class="s0">,</span><span class="s2">&quot;|&quot;</span><span class="s0">:</span><span class="s2">&quot;ñ&quot;</span><span class="s0">,</span><span class="s2">&quot;}&quot;</span><span class="s0">:</span><span class="s2">&quot;ç&quot;</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">.</span><span class="s1">H</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">[</span><span class="s3">7</span><span class="s0">]={</span><span class="s2">&quot;@&quot;</span><span class="s0">:</span><span class="s2">&quot;É&quot;</span><span class="s0">,</span><span class="s2">&quot;[&quot;</span><span class="s0">:</span><span class="s2">&quot;Ä&quot;</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">&quot;</span><span class="s0">:</span><span class="s2">&quot;Ö&quot;</span><span class="s0">,</span><span class="s2">&quot;]&quot;</span><span class="s0">:</span><span class="s2">&quot;Å&quot;</span><span class="s0">,</span><span class="s2">&quot;^&quot;</span><span class="s0">:</span><span class="s2">&quot;Ü&quot;</span><span class="s0">,</span><span class="s2">&quot;`&quot;</span><span class="s0">:</span><span class="s2">&quot;é&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">:</span><span class="s2">&quot;ä&quot;</span><span class="s0">,</span><span class="s2">&quot;|&quot;</span><span class="s0">:</span><span class="s2">&quot;ö&quot;</span><span class="s0">,</span><span class="s2">&quot;}&quot;</span><span class="s0">:</span><span class="s2">&quot;å&quot;</span><span class="s0">,</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s2">&quot;ü&quot;</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CHARSETS</span><span class="s0">[</span><span class="s2">&quot;=&quot;</span><span class="s0">]={</span><span class="s2">&quot;#&quot;</span><span class="s0">:</span><span class="s2">&quot;ù&quot;</span><span class="s0">,</span><span class="s2">&quot;@&quot;</span><span class="s0">:</span><span class="s2">&quot;à&quot;</span><span class="s0">,</span><span class="s2">&quot;[&quot;</span><span class="s0">:</span><span class="s2">&quot;é&quot;</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">&quot;</span><span class="s0">:</span><span class="s2">&quot;ç&quot;</span><span class="s0">,</span><span class="s2">&quot;]&quot;</span><span class="s0">:</span><span class="s2">&quot;ê&quot;</span><span class="s0">,</span><span class="s2">&quot;^&quot;</span><span class="s0">:</span><span class="s2">&quot;î&quot;</span><span class="s0">,</span><span class="s1">_</span><span class="s0">:</span><span class="s2">&quot;è&quot;</span><span class="s0">,</span><span class="s2">&quot;`&quot;</span><span class="s0">:</span><span class="s2">&quot;ô&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">:</span><span class="s2">&quot;ä&quot;</span><span class="s0">,</span><span class="s2">&quot;|&quot;</span><span class="s0">:</span><span class="s2">&quot;ö&quot;</span><span class="s0">,</span><span class="s2">&quot;}&quot;</span><span class="s0">:</span><span class="s2">&quot;ü&quot;</span><span class="s0">,</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s2">&quot;û&quot;</span><span class="s0">}},</span><span class="s3">2584</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s4">var </span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">C1_ESCAPED</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">C1</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">NUL</span><span class="s0">=</span><span class="s2">&quot;</span><span class="s4">\0</span><span class="s2">&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SOH</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">STX</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ETX</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">EOT</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ENQ</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ACK</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">BEL</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">BS</span><span class="s0">=</span><span class="s2">&quot;</span><span class="s4">\b</span><span class="s2">&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">HT</span><span class="s0">=</span><span class="s2">&quot;</span><span class="s4">\t</span><span class="s2">&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">LF</span><span class="s0">=</span><span class="s2">&quot;</span><span class="s4">\n</span><span class="s2">&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">VT</span><span class="s0">=</span><span class="s2">&quot;</span><span class="s4">\v</span><span class="s2">&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">FF</span><span class="s0">=</span><span class="s2">&quot;</span><span class="s4">\f</span><span class="s2">&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">CR</span><span class="s0">=</span><span class="s2">&quot;</span><span class="s4">\r</span><span class="s2">&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SO</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SI</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">DLE</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">DC1</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">DC2</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">DC3</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">DC4</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">NAK</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SYN</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ETB</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">CAN</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">EM</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SUB</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">FS</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">GS</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">RS</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">US</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SP</span><span class="s0">=</span><span class="s2">&quot; &quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">DEL</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">}(</span><span class="s1">i</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">=</span><span class="s1">i</span><span class="s0">={})),</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">PAD</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">HOP</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">BPH</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">NBH</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">IND</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">NEL</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SSA</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ESA</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">HTS</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">HTJ</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">VTS</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">PLD</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">PLU</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">RI</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SS2</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SS3</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">DCS</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">PU1</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">PU2</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">STS</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">CCH</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">MW</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SPA</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">EPA</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SOS</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SGCI</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">SCI</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">CSI</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ST</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">OSC</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">PM</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">APC</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">}(</span><span class="s1">s</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">C1</span><span class="s0">=</span><span class="s1">s</span><span class="s0">={})),</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ST</span><span class="s0">=</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">}</span><span class="s4">\\</span><span class="s2">`</span><span class="s0">}(</span><span class="s1">r</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">C1_ESCAPED</span><span class="s0">=</span><span class="s1">r</span><span class="s0">={}))},</span><span class="s3">7399</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">evaluateKeyboardEvent</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2584</span><span class="s0">),</span><span class="s1">r</span><span class="s0">={</span><span class="s3">48</span><span class="s0">:[</span><span class="s2">&quot;0&quot;</span><span class="s0">,</span><span class="s2">&quot;)&quot;</span><span class="s0">],</span><span class="s3">49</span><span class="s0">:[</span><span class="s2">&quot;1&quot;</span><span class="s0">,</span><span class="s2">&quot;!&quot;</span><span class="s0">],</span><span class="s3">50</span><span class="s0">:[</span><span class="s2">&quot;2&quot;</span><span class="s0">,</span><span class="s2">&quot;@&quot;</span><span class="s0">],</span><span class="s3">51</span><span class="s0">:[</span><span class="s2">&quot;3&quot;</span><span class="s0">,</span><span class="s2">&quot;#&quot;</span><span class="s0">],</span><span class="s3">52</span><span class="s0">:[</span><span class="s2">&quot;4&quot;</span><span class="s0">,</span><span class="s2">&quot;$&quot;</span><span class="s0">],</span><span class="s3">53</span><span class="s0">:[</span><span class="s2">&quot;5&quot;</span><span class="s0">,</span><span class="s2">&quot;%&quot;</span><span class="s0">],</span><span class="s3">54</span><span class="s0">:[</span><span class="s2">&quot;6&quot;</span><span class="s0">,</span><span class="s2">&quot;^&quot;</span><span class="s0">],</span><span class="s3">55</span><span class="s0">:[</span><span class="s2">&quot;7&quot;</span><span class="s0">,</span><span class="s2">&quot;&amp;&quot;</span><span class="s0">],</span><span class="s3">56</span><span class="s0">:[</span><span class="s2">&quot;8&quot;</span><span class="s0">,</span><span class="s2">&quot;*&quot;</span><span class="s0">],</span><span class="s3">57</span><span class="s0">:[</span><span class="s2">&quot;9&quot;</span><span class="s0">,</span><span class="s2">&quot;(&quot;</span><span class="s0">],</span><span class="s3">186</span><span class="s0">:[</span><span class="s2">&quot;;&quot;</span><span class="s0">,</span><span class="s2">&quot;:&quot;</span><span class="s0">],</span><span class="s3">187</span><span class="s0">:[</span><span class="s2">&quot;=&quot;</span><span class="s0">,</span><span class="s2">&quot;+&quot;</span><span class="s0">],</span><span class="s3">188</span><span class="s0">:[</span><span class="s2">&quot;,&quot;</span><span class="s0">,</span><span class="s2">&quot;&lt;&quot;</span><span class="s0">],</span><span class="s3">189</span><span class="s0">:[</span><span class="s2">&quot;-&quot;</span><span class="s0">,</span><span class="s2">&quot;_&quot;</span><span class="s0">],</span><span class="s3">190</span><span class="s0">:[</span><span class="s2">&quot;.&quot;</span><span class="s0">,</span><span class="s2">&quot;&gt;&quot;</span><span class="s0">],</span><span class="s3">191</span><span class="s0">:[</span><span class="s2">&quot;/&quot;</span><span class="s0">,</span><span class="s2">&quot;?&quot;</span><span class="s0">],</span><span class="s3">192</span><span class="s0">:[</span><span class="s2">&quot;`&quot;</span><span class="s0">,</span><span class="s2">&quot;~&quot;</span><span class="s0">],</span><span class="s3">219</span><span class="s0">:[</span><span class="s2">&quot;[&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">],</span><span class="s3">220</span><span class="s0">:[</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">&quot;</span><span class="s0">,</span><span class="s2">&quot;|&quot;</span><span class="s0">],</span><span class="s3">221</span><span class="s0">:[</span><span class="s2">&quot;]&quot;</span><span class="s0">,</span><span class="s2">&quot;}&quot;</span><span class="s0">],</span><span class="s3">222</span><span class="s0">:[</span><span class="s2">&quot;'&quot;</span><span class="s0">,</span><span class="s2">'&quot;'</span><span class="s0">]};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">evaluateKeyboardEvent</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">const </span><span class="s1">o</span><span class="s0">={</span><span class="s1">type</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">cancel</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">key</span><span class="s0">:</span><span class="s4">void </span><span class="s3">0</span><span class="s0">},</span><span class="s1">a</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)|(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">?</span><span class="s3">2</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)|(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">?</span><span class="s3">4</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)|(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">?</span><span class="s3">8</span><span class="s0">:</span><span class="s3">0</span><span class="s0">);</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">){</span><span class="s4">case </span><span class="s3">0</span><span class="s0">:</span><span class="s2">&quot;UIKeyInputUpArrow&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OA&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[A&quot;</span><span class="s0">:</span><span class="s2">&quot;UIKeyInputLeftArrow&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OD&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[D&quot;</span><span class="s0">:</span><span class="s2">&quot;UIKeyInputRightArrow&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OC&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[C&quot;</span><span class="s0">:</span><span class="s2">&quot;UIKeyInputDownArrow&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OB&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[B&quot;</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">8</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">?</span><span class="s2">&quot;</span><span class="s4">\b</span><span class="s2">&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">DEL</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">9</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">){</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[Z&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">}</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">HT</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">13</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">CR</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">CR</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">27</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">37</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s1">a</span><span class="s0">?(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;D&quot;</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">===</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;3D&quot;</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+(</span><span class="s1">i</span><span class="s0">?</span><span class="s2">&quot;b&quot;</span><span class="s0">:</span><span class="s2">&quot;[1;5D&quot;</span><span class="s0">))):</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OD&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[D&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">39</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s1">a</span><span class="s0">?(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;C&quot;</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">===</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;3C&quot;</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+(</span><span class="s1">i</span><span class="s0">?</span><span class="s2">&quot;f&quot;</span><span class="s0">:</span><span class="s2">&quot;[1;5C&quot;</span><span class="s0">))):</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OC&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[C&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">38</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s1">a</span><span class="s0">?(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;A&quot;</span><span class="s0">,</span><span class="s1">i</span><span class="s0">||</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">!==</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;3A&quot;</span><span class="s0">||(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;5A&quot;</span><span class="s0">)):</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OA&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[A&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">40</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s1">a</span><span class="s0">?(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;B&quot;</span><span class="s0">,</span><span class="s1">i</span><span class="s0">||</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">!==</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;3B&quot;</span><span class="s0">||(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;5B&quot;</span><span class="s0">)):</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OB&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[B&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">45</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">||(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[2~&quot;</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">46</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[3;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[3~&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">36</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;H&quot;</span><span class="s0">:</span><span class="s1">t</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OH&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[H&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">35</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;F&quot;</span><span class="s0">:</span><span class="s1">t</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OF&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[F&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">33</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">type</span><span class="s0">=</span><span class="s3">2</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[5;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[5~&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">34</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">type</span><span class="s0">=</span><span class="s3">3</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[6;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[6~&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">112</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;P&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OP&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">113</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;Q&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OQ&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">114</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;R&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OR&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">115</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[1;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;S&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;OS&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">116</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[15;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[15~&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">117</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[17;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[17~&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">118</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[18;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[18~&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">119</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[19;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[19~&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">120</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[20;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[20~&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">121</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[21;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[21~&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">122</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[23;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[23~&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">123</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">a</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[24;&quot;</span><span class="s0">+(</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)+</span><span class="s2">&quot;~&quot;</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s2">&quot;[24~&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">default</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&amp;&amp;!</span><span class="s1">n</span><span class="s0">||!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">)!</span><span class="s1">i</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">||!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">?</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">&amp;&amp;!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">&amp;&amp;!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">&amp;&amp;!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">&gt;=</span><span class="s3">48</span><span class="s0">&amp;&amp;</span><span class="s3">1</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">&amp;&amp;(</span><span class="s2">&quot;_&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">US</span><span class="s0">),</span><span class="s2">&quot;@&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">NUL</span><span class="s0">)):</span><span class="s3">65</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">type</span><span class="s0">=</span><span class="s3">1</span><span class="s0">);</span><span class="s4">else</span><span class="s0">{</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">r</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">],</span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">?.[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s1">i</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">&gt;=</span><span class="s3">65</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">&lt;=</span><span class="s3">90</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">?</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">-</span><span class="s3">64</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">+</span><span class="s3">32</span><span class="s0">;</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">toUpperCase</span><span class="s0">()),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s1">i</span><span class="s0">}</span><span class="s4">else if</span><span class="s0">(</span><span class="s3">32</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">)</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">NUL</span><span class="s0">:</span><span class="s2">&quot; &quot;</span><span class="s0">);</span><span class="s4">else if</span><span class="s0">(</span><span class="s2">&quot;Dead&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">code</span><span class="s0">.</span><span class="s1">startsWith</span><span class="s0">(</span><span class="s2">&quot;Key&quot;</span><span class="s0">)){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">code</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s3">4</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shiftKey</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">toLowerCase</span><span class="s0">()),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">+</span><span class="s1">t</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">cancel</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">}}</span><span class="s4">else </span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">&gt;=</span><span class="s3">65</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">&lt;=</span><span class="s3">90</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">-</span><span class="s3">64</span><span class="s0">):</span><span class="s3">32</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">NUL</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">&gt;=</span><span class="s3">51</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">&lt;=</span><span class="s3">55</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">-</span><span class="s3">51</span><span class="s0">+</span><span class="s3">27</span><span class="s0">):</span><span class="s3">56</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">DEL</span><span class="s0">:</span><span class="s3">219</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">ESC</span><span class="s0">:</span><span class="s3">220</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">FS</span><span class="s0">:</span><span class="s3">221</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">keyCode</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">C0</span><span class="s0">.</span><span class="s1">GS</span><span class="s0">)}</span><span class="s4">return </span><span class="s1">o</span><span class="s0">}},</span><span class="s3">482</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Utf8ToUtf32</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">StringToUtf32</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">utf32ToString</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">stringFromCodePoint</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">stringFromCodePoint</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">65535</span><span class="s0">?(</span><span class="s1">e</span><span class="s0">-=</span><span class="s3">65536</span><span class="s0">,</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s3">55296</span><span class="s0">+(</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">10</span><span class="s0">))+</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">%</span><span class="s3">1024</span><span class="s0">+</span><span class="s3">56320</span><span class="s0">)):</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">utf32ToString</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">;++</span><span class="s1">r</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">r</span><span class="s0">];</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">65535</span><span class="s0">?(</span><span class="s1">t</span><span class="s0">-=</span><span class="s3">65536</span><span class="s0">,</span><span class="s1">s</span><span class="s0">+=</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s3">55296</span><span class="s0">+(</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">10</span><span class="s0">))+</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s1">t</span><span class="s0">%</span><span class="s3">1024</span><span class="s0">+</span><span class="s3">56320</span><span class="s0">)):</span><span class="s1">s</span><span class="s0">+=</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">return </span><span class="s1">s</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">StringToUtf32</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_interim</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_interim</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">decode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return </span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_interim</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s1">r</span><span class="s0">++);</span><span class="s3">56320</span><span class="s0">&lt;=</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s3">57343</span><span class="s0">?</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">++]=</span><span class="s3">1024</span><span class="s0">*(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_interim</span><span class="s0">-</span><span class="s3">55296</span><span class="s0">)+</span><span class="s1">i</span><span class="s0">-</span><span class="s3">56320</span><span class="s0">+</span><span class="s3">65536</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">++]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_interim</span><span class="s0">,</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">++]=</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_interim</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">r</span><span class="s0">;</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">;++</span><span class="s1">n</span><span class="s0">){</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s1">n</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s3">55296</span><span class="s0">&lt;=</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">&lt;=</span><span class="s3">56319</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(++</span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_interim</span><span class="s0">=</span><span class="s1">r</span><span class="s0">,</span><span class="s1">s</span><span class="s0">;</span><span class="s4">const </span><span class="s1">o</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s1">n</span><span class="s0">);</span><span class="s3">56320</span><span class="s0">&lt;=</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&lt;=</span><span class="s3">57343</span><span class="s0">?</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">++]=</span><span class="s3">1024</span><span class="s0">*(</span><span class="s1">r</span><span class="s0">-</span><span class="s3">55296</span><span class="s0">)+</span><span class="s1">o</span><span class="s0">-</span><span class="s3">56320</span><span class="s0">+</span><span class="s3">65536</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">++]=</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">++]=</span><span class="s1">o</span><span class="s0">)}</span><span class="s4">else </span><span class="s3">65279</span><span class="s0">!==</span><span class="s1">r</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">++]=</span><span class="s1">r</span><span class="s0">)}</span><span class="s4">return </span><span class="s1">s</span><span class="s0">}},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Utf8ToUtf32</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint8Array</span><span class="s0">(</span><span class="s3">3</span><span class="s0">)}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">decode</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return </span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">c</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s1">r</span><span class="s0">&amp;=</span><span class="s3">192</span><span class="s0">==(</span><span class="s3">224</span><span class="s0">&amp;</span><span class="s1">r</span><span class="s0">)?</span><span class="s3">31</span><span class="s0">:</span><span class="s3">224</span><span class="s0">==(</span><span class="s3">240</span><span class="s0">&amp;</span><span class="s1">r</span><span class="s0">)?</span><span class="s3">15</span><span class="s0">:</span><span class="s3">7</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;(</span><span class="s1">n</span><span class="s0">=</span><span class="s3">63</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[++</span><span class="s1">o</span><span class="s0">])&amp;&amp;</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s3">4</span><span class="s0">;)</span><span class="s1">r</span><span class="s0">&lt;&lt;=</span><span class="s3">6</span><span class="s0">,</span><span class="s1">r</span><span class="s0">|=</span><span class="s1">n</span><span class="s0">;</span><span class="s4">const </span><span class="s1">h</span><span class="s0">=</span><span class="s3">192</span><span class="s0">==(</span><span class="s3">224</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])?</span><span class="s3">2</span><span class="s0">:</span><span class="s3">224</span><span class="s0">==(</span><span class="s3">240</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])?</span><span class="s3">3</span><span class="s0">:</span><span class="s3">4</span><span class="s0">,</span><span class="s1">l</span><span class="s0">=</span><span class="s1">h</span><span class="s0">-</span><span class="s1">o</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">c</span><span class="s0">&lt;</span><span class="s1">l</span><span class="s0">;){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">c</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return </span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">c</span><span class="s0">++],</span><span class="s3">128</span><span class="s0">!=(</span><span class="s3">192</span><span class="s0">&amp;</span><span class="s1">n</span><span class="s0">)){</span><span class="s1">c</span><span class="s0">--,</span><span class="s1">s</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s1">o</span><span class="s0">++]=</span><span class="s1">n</span><span class="s0">,</span><span class="s1">r</span><span class="s0">&lt;&lt;=</span><span class="s3">6</span><span class="s0">,</span><span class="s1">r</span><span class="s0">|=</span><span class="s3">63</span><span class="s0">&amp;</span><span class="s1">n</span><span class="s0">}</span><span class="s1">s</span><span class="s0">||(</span><span class="s3">2</span><span class="s0">===</span><span class="s1">h</span><span class="s0">?</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s3">128</span><span class="s0">?</span><span class="s1">c</span><span class="s0">--:</span><span class="s1">t</span><span class="s0">[</span><span class="s1">a</span><span class="s0">++]=</span><span class="s1">r</span><span class="s0">:</span><span class="s3">3</span><span class="s0">===</span><span class="s1">h</span><span class="s0">?</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s3">2048</span><span class="s0">||</span><span class="s1">r</span><span class="s0">&gt;=</span><span class="s3">55296</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">&lt;=</span><span class="s3">57343</span><span class="s0">||</span><span class="s3">65279</span><span class="s0">===</span><span class="s1">r</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">[</span><span class="s1">a</span><span class="s0">++]=</span><span class="s1">r</span><span class="s0">):</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s3">65536</span><span class="s0">||</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s3">1114111</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">[</span><span class="s1">a</span><span class="s0">++]=</span><span class="s1">r</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">const </span><span class="s1">l</span><span class="s0">=</span><span class="s1">i</span><span class="s0">-</span><span class="s3">4</span><span class="s0">;</span><span class="s4">let </span><span class="s1">d</span><span class="s0">=</span><span class="s1">c</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">d</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">;){</span><span class="s4">for</span><span class="s0">(;!(!(</span><span class="s1">d</span><span class="s0">&lt;</span><span class="s1">l</span><span class="s0">)||</span><span class="s3">128</span><span class="s0">&amp;(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">d</span><span class="s0">])||</span><span class="s3">128</span><span class="s0">&amp;(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">d</span><span class="s0">+</span><span class="s3">1</span><span class="s0">])||</span><span class="s3">128</span><span class="s0">&amp;(</span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">d</span><span class="s0">+</span><span class="s3">2</span><span class="s0">])||</span><span class="s3">128</span><span class="s0">&amp;(</span><span class="s1">o</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">d</span><span class="s0">+</span><span class="s3">3</span><span class="s0">]));)</span><span class="s1">t</span><span class="s0">[</span><span class="s1">a</span><span class="s0">++]=</span><span class="s1">s</span><span class="s0">,</span><span class="s1">t</span><span class="s0">[</span><span class="s1">a</span><span class="s0">++]=</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">[</span><span class="s1">a</span><span class="s0">++]=</span><span class="s1">n</span><span class="s0">,</span><span class="s1">t</span><span class="s0">[</span><span class="s1">a</span><span class="s0">++]=</span><span class="s1">o</span><span class="s0">,</span><span class="s1">d</span><span class="s0">+=</span><span class="s3">4</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">d</span><span class="s0">++],</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s3">128</span><span class="s0">)</span><span class="s1">t</span><span class="s0">[</span><span class="s1">a</span><span class="s0">++]=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(</span><span class="s3">192</span><span class="s0">==(</span><span class="s3">224</span><span class="s0">&amp;</span><span class="s1">s</span><span class="s0">)){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">d</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">s</span><span class="s0">,</span><span class="s1">a</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">d</span><span class="s0">++],</span><span class="s3">128</span><span class="s0">!=(</span><span class="s3">192</span><span class="s0">&amp;</span><span class="s1">r</span><span class="s0">)){</span><span class="s1">d</span><span class="s0">--;</span><span class="s4">continue</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">=(</span><span class="s3">31</span><span class="s0">&amp;</span><span class="s1">s</span><span class="s0">)&lt;&lt;</span><span class="s3">6</span><span class="s0">|</span><span class="s3">63</span><span class="s0">&amp;</span><span class="s1">r</span><span class="s0">,</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s3">128</span><span class="s0">){</span><span class="s1">d</span><span class="s0">--;</span><span class="s4">continue</span><span class="s0">}</span><span class="s1">t</span><span class="s0">[</span><span class="s1">a</span><span class="s0">++]=</span><span class="s1">h</span><span class="s0">}</span><span class="s4">else if</span><span class="s0">(</span><span class="s3">224</span><span class="s0">==(</span><span class="s3">240</span><span class="s0">&amp;</span><span class="s1">s</span><span class="s0">)){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">d</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">s</span><span class="s0">,</span><span class="s1">a</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">d</span><span class="s0">++],</span><span class="s3">128</span><span class="s0">!=(</span><span class="s3">192</span><span class="s0">&amp;</span><span class="s1">r</span><span class="s0">)){</span><span class="s1">d</span><span class="s0">--;</span><span class="s4">continue</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">d</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">r</span><span class="s0">,</span><span class="s1">a</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">d</span><span class="s0">++],</span><span class="s3">128</span><span class="s0">!=(</span><span class="s3">192</span><span class="s0">&amp;</span><span class="s1">n</span><span class="s0">)){</span><span class="s1">d</span><span class="s0">--;</span><span class="s4">continue</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">=(</span><span class="s3">15</span><span class="s0">&amp;</span><span class="s1">s</span><span class="s0">)&lt;&lt;</span><span class="s3">12</span><span class="s0">|(</span><span class="s3">63</span><span class="s0">&amp;</span><span class="s1">r</span><span class="s0">)&lt;&lt;</span><span class="s3">6</span><span class="s0">|</span><span class="s3">63</span><span class="s0">&amp;</span><span class="s1">n</span><span class="s0">,</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s3">2048</span><span class="s0">||</span><span class="s1">h</span><span class="s0">&gt;=</span><span class="s3">55296</span><span class="s0">&amp;&amp;</span><span class="s1">h</span><span class="s0">&lt;=</span><span class="s3">57343</span><span class="s0">||</span><span class="s3">65279</span><span class="s0">===</span><span class="s1">h</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s1">t</span><span class="s0">[</span><span class="s1">a</span><span class="s0">++]=</span><span class="s1">h</span><span class="s0">}</span><span class="s4">else if</span><span class="s0">(</span><span class="s3">240</span><span class="s0">==(</span><span class="s3">248</span><span class="s0">&amp;</span><span class="s1">s</span><span class="s0">)){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">d</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">s</span><span class="s0">,</span><span class="s1">a</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">d</span><span class="s0">++],</span><span class="s3">128</span><span class="s0">!=(</span><span class="s3">192</span><span class="s0">&amp;</span><span class="s1">r</span><span class="s0">)){</span><span class="s1">d</span><span class="s0">--;</span><span class="s4">continue</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">d</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">r</span><span class="s0">,</span><span class="s1">a</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">d</span><span class="s0">++],</span><span class="s3">128</span><span class="s0">!=(</span><span class="s3">192</span><span class="s0">&amp;</span><span class="s1">n</span><span class="s0">)){</span><span class="s1">d</span><span class="s0">--;</span><span class="s4">continue</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">d</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">interim</span><span class="s0">[</span><span class="s3">2</span><span class="s0">]=</span><span class="s1">n</span><span class="s0">,</span><span class="s1">a</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">d</span><span class="s0">++],</span><span class="s3">128</span><span class="s0">!=(</span><span class="s3">192</span><span class="s0">&amp;</span><span class="s1">o</span><span class="s0">)){</span><span class="s1">d</span><span class="s0">--;</span><span class="s4">continue</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">=(</span><span class="s3">7</span><span class="s0">&amp;</span><span class="s1">s</span><span class="s0">)&lt;&lt;</span><span class="s3">18</span><span class="s0">|(</span><span class="s3">63</span><span class="s0">&amp;</span><span class="s1">r</span><span class="s0">)&lt;&lt;</span><span class="s3">12</span><span class="s0">|(</span><span class="s3">63</span><span class="s0">&amp;</span><span class="s1">n</span><span class="s0">)&lt;&lt;</span><span class="s3">6</span><span class="s0">|</span><span class="s3">63</span><span class="s0">&amp;</span><span class="s1">o</span><span class="s0">,</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s3">65536</span><span class="s0">||</span><span class="s1">h</span><span class="s0">&gt;</span><span class="s3">1114111</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s1">t</span><span class="s0">[</span><span class="s1">a</span><span class="s0">++]=</span><span class="s1">h</span><span class="s0">}}</span><span class="s4">return </span><span class="s1">a</span><span class="s0">}}},</span><span class="s3">225</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">UnicodeV6</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">1480</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=[[</span><span class="s3">768</span><span class="s0">,</span><span class="s3">879</span><span class="s0">],[</span><span class="s3">1155</span><span class="s0">,</span><span class="s3">1158</span><span class="s0">],[</span><span class="s3">1160</span><span class="s0">,</span><span class="s3">1161</span><span class="s0">],[</span><span class="s3">1425</span><span class="s0">,</span><span class="s3">1469</span><span class="s0">],[</span><span class="s3">1471</span><span class="s0">,</span><span class="s3">1471</span><span class="s0">],[</span><span class="s3">1473</span><span class="s0">,</span><span class="s3">1474</span><span class="s0">],[</span><span class="s3">1476</span><span class="s0">,</span><span class="s3">1477</span><span class="s0">],[</span><span class="s3">1479</span><span class="s0">,</span><span class="s3">1479</span><span class="s0">],[</span><span class="s3">1536</span><span class="s0">,</span><span class="s3">1539</span><span class="s0">],[</span><span class="s3">1552</span><span class="s0">,</span><span class="s3">1557</span><span class="s0">],[</span><span class="s3">1611</span><span class="s0">,</span><span class="s3">1630</span><span class="s0">],[</span><span class="s3">1648</span><span class="s0">,</span><span class="s3">1648</span><span class="s0">],[</span><span class="s3">1750</span><span class="s0">,</span><span class="s3">1764</span><span class="s0">],[</span><span class="s3">1767</span><span class="s0">,</span><span class="s3">1768</span><span class="s0">],[</span><span class="s3">1770</span><span class="s0">,</span><span class="s3">1773</span><span class="s0">],[</span><span class="s3">1807</span><span class="s0">,</span><span class="s3">1807</span><span class="s0">],[</span><span class="s3">1809</span><span class="s0">,</span><span class="s3">1809</span><span class="s0">],[</span><span class="s3">1840</span><span class="s0">,</span><span class="s3">1866</span><span class="s0">],[</span><span class="s3">1958</span><span class="s0">,</span><span class="s3">1968</span><span class="s0">],[</span><span class="s3">2027</span><span class="s0">,</span><span class="s3">2035</span><span class="s0">],[</span><span class="s3">2305</span><span class="s0">,</span><span class="s3">2306</span><span class="s0">],[</span><span class="s3">2364</span><span class="s0">,</span><span class="s3">2364</span><span class="s0">],[</span><span class="s3">2369</span><span class="s0">,</span><span class="s3">2376</span><span class="s0">],[</span><span class="s3">2381</span><span class="s0">,</span><span class="s3">2381</span><span class="s0">],[</span><span class="s3">2385</span><span class="s0">,</span><span class="s3">2388</span><span class="s0">],[</span><span class="s3">2402</span><span class="s0">,</span><span class="s3">2403</span><span class="s0">],[</span><span class="s3">2433</span><span class="s0">,</span><span class="s3">2433</span><span class="s0">],[</span><span class="s3">2492</span><span class="s0">,</span><span class="s3">2492</span><span class="s0">],[</span><span class="s3">2497</span><span class="s0">,</span><span class="s3">2500</span><span class="s0">],[</span><span class="s3">2509</span><span class="s0">,</span><span class="s3">2509</span><span class="s0">],[</span><span class="s3">2530</span><span class="s0">,</span><span class="s3">2531</span><span class="s0">],[</span><span class="s3">2561</span><span class="s0">,</span><span class="s3">2562</span><span class="s0">],[</span><span class="s3">2620</span><span class="s0">,</span><span class="s3">2620</span><span class="s0">],[</span><span class="s3">2625</span><span class="s0">,</span><span class="s3">2626</span><span class="s0">],[</span><span class="s3">2631</span><span class="s0">,</span><span class="s3">2632</span><span class="s0">],[</span><span class="s3">2635</span><span class="s0">,</span><span class="s3">2637</span><span class="s0">],[</span><span class="s3">2672</span><span class="s0">,</span><span class="s3">2673</span><span class="s0">],[</span><span class="s3">2689</span><span class="s0">,</span><span class="s3">2690</span><span class="s0">],[</span><span class="s3">2748</span><span class="s0">,</span><span class="s3">2748</span><span class="s0">],[</span><span class="s3">2753</span><span class="s0">,</span><span class="s3">2757</span><span class="s0">],[</span><span class="s3">2759</span><span class="s0">,</span><span class="s3">2760</span><span class="s0">],[</span><span class="s3">2765</span><span class="s0">,</span><span class="s3">2765</span><span class="s0">],[</span><span class="s3">2786</span><span class="s0">,</span><span class="s3">2787</span><span class="s0">],[</span><span class="s3">2817</span><span class="s0">,</span><span class="s3">2817</span><span class="s0">],[</span><span class="s3">2876</span><span class="s0">,</span><span class="s3">2876</span><span class="s0">],[</span><span class="s3">2879</span><span class="s0">,</span><span class="s3">2879</span><span class="s0">],[</span><span class="s3">2881</span><span class="s0">,</span><span class="s3">2883</span><span class="s0">],[</span><span class="s3">2893</span><span class="s0">,</span><span class="s3">2893</span><span class="s0">],[</span><span class="s3">2902</span><span class="s0">,</span><span class="s3">2902</span><span class="s0">],[</span><span class="s3">2946</span><span class="s0">,</span><span class="s3">2946</span><span class="s0">],[</span><span class="s3">3008</span><span class="s0">,</span><span class="s3">3008</span><span class="s0">],[</span><span class="s3">3021</span><span class="s0">,</span><span class="s3">3021</span><span class="s0">],[</span><span class="s3">3134</span><span class="s0">,</span><span class="s3">3136</span><span class="s0">],[</span><span class="s3">3142</span><span class="s0">,</span><span class="s3">3144</span><span class="s0">],[</span><span class="s3">3146</span><span class="s0">,</span><span class="s3">3149</span><span class="s0">],[</span><span class="s3">3157</span><span class="s0">,</span><span class="s3">3158</span><span class="s0">],[</span><span class="s3">3260</span><span class="s0">,</span><span class="s3">3260</span><span class="s0">],[</span><span class="s3">3263</span><span class="s0">,</span><span class="s3">3263</span><span class="s0">],[</span><span class="s3">3270</span><span class="s0">,</span><span class="s3">3270</span><span class="s0">],[</span><span class="s3">3276</span><span class="s0">,</span><span class="s3">3277</span><span class="s0">],[</span><span class="s3">3298</span><span class="s0">,</span><span class="s3">3299</span><span class="s0">],[</span><span class="s3">3393</span><span class="s0">,</span><span class="s3">3395</span><span class="s0">],[</span><span class="s3">3405</span><span class="s0">,</span><span class="s3">3405</span><span class="s0">],[</span><span class="s3">3530</span><span class="s0">,</span><span class="s3">3530</span><span class="s0">],[</span><span class="s3">3538</span><span class="s0">,</span><span class="s3">3540</span><span class="s0">],[</span><span class="s3">3542</span><span class="s0">,</span><span class="s3">3542</span><span class="s0">],[</span><span class="s3">3633</span><span class="s0">,</span><span class="s3">3633</span><span class="s0">],[</span><span class="s3">3636</span><span class="s0">,</span><span class="s3">3642</span><span class="s0">],[</span><span class="s3">3655</span><span class="s0">,</span><span class="s3">3662</span><span class="s0">],[</span><span class="s3">3761</span><span class="s0">,</span><span class="s3">3761</span><span class="s0">],[</span><span class="s3">3764</span><span class="s0">,</span><span class="s3">3769</span><span class="s0">],[</span><span class="s3">3771</span><span class="s0">,</span><span class="s3">3772</span><span class="s0">],[</span><span class="s3">3784</span><span class="s0">,</span><span class="s3">3789</span><span class="s0">],[</span><span class="s3">3864</span><span class="s0">,</span><span class="s3">3865</span><span class="s0">],[</span><span class="s3">3893</span><span class="s0">,</span><span class="s3">3893</span><span class="s0">],[</span><span class="s3">3895</span><span class="s0">,</span><span class="s3">3895</span><span class="s0">],[</span><span class="s3">3897</span><span class="s0">,</span><span class="s3">3897</span><span class="s0">],[</span><span class="s3">3953</span><span class="s0">,</span><span class="s3">3966</span><span class="s0">],[</span><span class="s3">3968</span><span class="s0">,</span><span class="s3">3972</span><span class="s0">],[</span><span class="s3">3974</span><span class="s0">,</span><span class="s3">3975</span><span class="s0">],[</span><span class="s3">3984</span><span class="s0">,</span><span class="s3">3991</span><span class="s0">],[</span><span class="s3">3993</span><span class="s0">,</span><span class="s3">4028</span><span class="s0">],[</span><span class="s3">4038</span><span class="s0">,</span><span class="s3">4038</span><span class="s0">],[</span><span class="s3">4141</span><span class="s0">,</span><span class="s3">4144</span><span class="s0">],[</span><span class="s3">4146</span><span class="s0">,</span><span class="s3">4146</span><span class="s0">],[</span><span class="s3">4150</span><span class="s0">,</span><span class="s3">4151</span><span class="s0">],[</span><span class="s3">4153</span><span class="s0">,</span><span class="s3">4153</span><span class="s0">],[</span><span class="s3">4184</span><span class="s0">,</span><span class="s3">4185</span><span class="s0">],[</span><span class="s3">4448</span><span class="s0">,</span><span class="s3">4607</span><span class="s0">],[</span><span class="s3">4959</span><span class="s0">,</span><span class="s3">4959</span><span class="s0">],[</span><span class="s3">5906</span><span class="s0">,</span><span class="s3">5908</span><span class="s0">],[</span><span class="s3">5938</span><span class="s0">,</span><span class="s3">5940</span><span class="s0">],[</span><span class="s3">5970</span><span class="s0">,</span><span class="s3">5971</span><span class="s0">],[</span><span class="s3">6002</span><span class="s0">,</span><span class="s3">6003</span><span class="s0">],[</span><span class="s3">6068</span><span class="s0">,</span><span class="s3">6069</span><span class="s0">],[</span><span class="s3">6071</span><span class="s0">,</span><span class="s3">6077</span><span class="s0">],[</span><span class="s3">6086</span><span class="s0">,</span><span class="s3">6086</span><span class="s0">],[</span><span class="s3">6089</span><span class="s0">,</span><span class="s3">6099</span><span class="s0">],[</span><span class="s3">6109</span><span class="s0">,</span><span class="s3">6109</span><span class="s0">],[</span><span class="s3">6155</span><span class="s0">,</span><span class="s3">6157</span><span class="s0">],[</span><span class="s3">6313</span><span class="s0">,</span><span class="s3">6313</span><span class="s0">],[</span><span class="s3">6432</span><span class="s0">,</span><span class="s3">6434</span><span class="s0">],[</span><span class="s3">6439</span><span class="s0">,</span><span class="s3">6440</span><span class="s0">],[</span><span class="s3">6450</span><span class="s0">,</span><span class="s3">6450</span><span class="s0">],[</span><span class="s3">6457</span><span class="s0">,</span><span class="s3">6459</span><span class="s0">],[</span><span class="s3">6679</span><span class="s0">,</span><span class="s3">6680</span><span class="s0">],[</span><span class="s3">6912</span><span class="s0">,</span><span class="s3">6915</span><span class="s0">],[</span><span class="s3">6964</span><span class="s0">,</span><span class="s3">6964</span><span class="s0">],[</span><span class="s3">6966</span><span class="s0">,</span><span class="s3">6970</span><span class="s0">],[</span><span class="s3">6972</span><span class="s0">,</span><span class="s3">6972</span><span class="s0">],[</span><span class="s3">6978</span><span class="s0">,</span><span class="s3">6978</span><span class="s0">],[</span><span class="s3">7019</span><span class="s0">,</span><span class="s3">7027</span><span class="s0">],[</span><span class="s3">7616</span><span class="s0">,</span><span class="s3">7626</span><span class="s0">],[</span><span class="s3">7678</span><span class="s0">,</span><span class="s3">7679</span><span class="s0">],[</span><span class="s3">8203</span><span class="s0">,</span><span class="s3">8207</span><span class="s0">],[</span><span class="s3">8234</span><span class="s0">,</span><span class="s3">8238</span><span class="s0">],[</span><span class="s3">8288</span><span class="s0">,</span><span class="s3">8291</span><span class="s0">],[</span><span class="s3">8298</span><span class="s0">,</span><span class="s3">8303</span><span class="s0">],[</span><span class="s3">8400</span><span class="s0">,</span><span class="s3">8431</span><span class="s0">],[</span><span class="s3">12330</span><span class="s0">,</span><span class="s3">12335</span><span class="s0">],[</span><span class="s3">12441</span><span class="s0">,</span><span class="s3">12442</span><span class="s0">],[</span><span class="s3">43014</span><span class="s0">,</span><span class="s3">43014</span><span class="s0">],[</span><span class="s3">43019</span><span class="s0">,</span><span class="s3">43019</span><span class="s0">],[</span><span class="s3">43045</span><span class="s0">,</span><span class="s3">43046</span><span class="s0">],[</span><span class="s3">64286</span><span class="s0">,</span><span class="s3">64286</span><span class="s0">],[</span><span class="s3">65024</span><span class="s0">,</span><span class="s3">65039</span><span class="s0">],[</span><span class="s3">65056</span><span class="s0">,</span><span class="s3">65059</span><span class="s0">],[</span><span class="s3">65279</span><span class="s0">,</span><span class="s3">65279</span><span class="s0">],[</span><span class="s3">65529</span><span class="s0">,</span><span class="s3">65531</span><span class="s0">]],</span><span class="s1">n</span><span class="s0">=[[</span><span class="s3">68097</span><span class="s0">,</span><span class="s3">68099</span><span class="s0">],[</span><span class="s3">68101</span><span class="s0">,</span><span class="s3">68102</span><span class="s0">],[</span><span class="s3">68108</span><span class="s0">,</span><span class="s3">68111</span><span class="s0">],[</span><span class="s3">68152</span><span class="s0">,</span><span class="s3">68154</span><span class="s0">],[</span><span class="s3">68159</span><span class="s0">,</span><span class="s3">68159</span><span class="s0">],[</span><span class="s3">119143</span><span class="s0">,</span><span class="s3">119145</span><span class="s0">],[</span><span class="s3">119155</span><span class="s0">,</span><span class="s3">119170</span><span class="s0">],[</span><span class="s3">119173</span><span class="s0">,</span><span class="s3">119179</span><span class="s0">],[</span><span class="s3">119210</span><span class="s0">,</span><span class="s3">119213</span><span class="s0">],[</span><span class="s3">119362</span><span class="s0">,</span><span class="s3">119364</span><span class="s0">],[</span><span class="s3">917505</span><span class="s0">,</span><span class="s3">917505</span><span class="s0">],[</span><span class="s3">917536</span><span class="s0">,</span><span class="s3">917631</span><span class="s0">],[</span><span class="s3">917760</span><span class="s0">,</span><span class="s3">917999</span><span class="s0">]];</span><span class="s4">let </span><span class="s1">o</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">UnicodeV6</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">version</span><span class="s0">=</span><span class="s2">&quot;6&quot;</span><span class="s0">,!</span><span class="s1">o</span><span class="s0">){</span><span class="s1">o</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint8Array</span><span class="s0">(</span><span class="s3">65536</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">1</span><span class="s0">),</span><span class="s1">o</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s3">32</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">127</span><span class="s0">,</span><span class="s3">160</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s3">4352</span><span class="s0">,</span><span class="s3">4448</span><span class="s0">),</span><span class="s1">o</span><span class="s0">[</span><span class="s3">9001</span><span class="s0">]=</span><span class="s3">2</span><span class="s0">,</span><span class="s1">o</span><span class="s0">[</span><span class="s3">9002</span><span class="s0">]=</span><span class="s3">2</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s3">11904</span><span class="s0">,</span><span class="s3">42192</span><span class="s0">),</span><span class="s1">o</span><span class="s0">[</span><span class="s3">12351</span><span class="s0">]=</span><span class="s3">1</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s3">44032</span><span class="s0">,</span><span class="s3">55204</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s3">63744</span><span class="s0">,</span><span class="s3">64256</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s3">65040</span><span class="s0">,</span><span class="s3">65050</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s3">65072</span><span class="s0">,</span><span class="s3">65136</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s3">65280</span><span class="s0">,</span><span class="s3">65377</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s3">65504</span><span class="s0">,</span><span class="s3">65511</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">r</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">e</span><span class="s0">)</span><span class="s1">o</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">[</span><span class="s1">e</span><span class="s0">][</span><span class="s3">0</span><span class="s0">],</span><span class="s1">r</span><span class="s0">[</span><span class="s1">e</span><span class="s0">][</span><span class="s3">1</span><span class="s0">]+</span><span class="s3">1</span><span class="s0">)}}</span><span class="s1">wcwidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">32</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">127</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">65536</span><span class="s0">?</span><span class="s1">o</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">][</span><span class="s3">0</span><span class="s0">]||</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">[</span><span class="s1">r</span><span class="s0">][</span><span class="s3">1</span><span class="s0">])</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">r</span><span class="s0">&gt;=</span><span class="s1">s</span><span class="s0">;)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">s</span><span class="s0">+</span><span class="s1">r</span><span class="s0">&gt;&gt;</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">[</span><span class="s1">i</span><span class="s0">][</span><span class="s3">1</span><span class="s0">])</span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;</span><span class="s4">else</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(!(</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">[</span><span class="s1">i</span><span class="s0">][</span><span class="s3">0</span><span class="s0">]))</span><span class="s4">return</span><span class="s0">!</span><span class="s3">0</span><span class="s0">;</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">-</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">}(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)?</span><span class="s3">0</span><span class="s0">:</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">131072</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">196605</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">196608</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s3">262141</span><span class="s0">?</span><span class="s3">2</span><span class="s0">:</span><span class="s3">1</span><span class="s0">}</span><span class="s1">charProperties</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">wcwidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">===</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">UnicodeService</span><span class="s0">.</span><span class="s1">extractWidth</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">?</span><span class="s1">r</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">:</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">UnicodeService</span><span class="s0">.</span><span class="s1">createPropertyValue</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">r</span><span class="s0">)}}},</span><span class="s3">5981</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">WriteBuffer</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">);</span><span class="s4">class </span><span class="s1">n </span><span class="s4">extends </span><span class="s1">r</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_action</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_callbacks</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_pendingData</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isSyncWriting</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_syncCalls</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_didUserInput</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onWriteParsed</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onWriteParsed</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onWriteParsed</span><span class="s0">.</span><span class="s1">event</span><span class="s0">}</span><span class="s1">handleUserInput</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_didUserInput</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">writeSync</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_syncCalls</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return void</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_syncCalls</span><span class="s0">=</span><span class="s3">0</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_pendingData</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_callbacks</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_syncCalls</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isSyncWriting</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">let </span><span class="s1">i</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isSyncWriting</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">();){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_action</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_callbacks</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">();</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">()}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_pendingData</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">=</span><span class="s3">2147483647</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_isSyncWriting</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_syncCalls</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">write</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_pendingData</span><span class="s0">&gt;</span><span class="s3">5e7</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;write data discarded, use flow control to avoid losing data&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_didUserInput</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_didUserInput</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_pendingData</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_callbacks</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s4">void this</span><span class="s0">.</span><span class="s1">_innerWrite</span><span class="s0">();</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_innerWrite</span><span class="s0">()))}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_pendingData</span><span class="s0">+=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_callbacks</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">_innerWrite</span><span class="s0">(</span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">||</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">();</span><span class="s4">for</span><span class="s0">(;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">;){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">],</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_action</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">()-</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s3">12</span><span class="s0">?</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_innerWrite</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">))):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_innerWrite</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return void </span><span class="s1">s</span><span class="s0">.</span><span class="s1">catch</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;(</span><span class="s1">queueMicrotask</span><span class="s0">((()=&gt;{</span><span class="s4">throw </span><span class="s1">e</span><span class="s0">})),</span><span class="s1">Promise</span><span class="s0">.</span><span class="s1">resolve</span><span class="s0">(!</span><span class="s3">1</span><span class="s0">)))).</span><span class="s1">then</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_callbacks</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_pendingData</span><span class="s0">-=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">()-</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s3">12</span><span class="s0">)</span><span class="s4">break</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">&gt;</span><span class="s3">50</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_callbacks</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_callbacks</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">=</span><span class="s3">0</span><span class="s0">),</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_innerWrite</span><span class="s0">()))):(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_writeBuffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_callbacks</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_pendingData</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferOffset</span><span class="s0">=</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onWriteParsed</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">()}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">WriteBuffer</span><span class="s0">=</span><span class="s1">n</span><span class="s0">},</span><span class="s3">5941</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">toRgbString</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">parseColor</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s5">/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s5">/^[\da-f]+$/</span><span class="s0">;</span><span class="s4">function </span><span class="s1">r</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toString</span><span class="s0">(</span><span class="s3">16</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s3">2</span><span class="s0">?</span><span class="s2">&quot;0&quot;</span><span class="s0">+</span><span class="s1">i</span><span class="s0">:</span><span class="s1">i</span><span class="s0">;</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">case </span><span class="s3">4</span><span class="s0">:</span><span class="s4">return </span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s4">case </span><span class="s3">8</span><span class="s0">:</span><span class="s4">return </span><span class="s1">s</span><span class="s0">;</span><span class="s4">case </span><span class="s3">12</span><span class="s0">:</span><span class="s4">return</span><span class="s0">(</span><span class="s1">s</span><span class="s0">+</span><span class="s1">s</span><span class="s0">).</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">3</span><span class="s0">);</span><span class="s4">default</span><span class="s0">:</span><span class="s4">return </span><span class="s1">s</span><span class="s0">+</span><span class="s1">s</span><span class="s0">}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">parseColor</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toLowerCase</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s2">&quot;rgb:&quot;</span><span class="s0">)){</span><span class="s1">t</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">4</span><span class="s0">);</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">exec</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]?</span><span class="s3">15</span><span class="s0">:</span><span class="s1">e</span><span class="s0">[</span><span class="s3">4</span><span class="s0">]?</span><span class="s3">255</span><span class="s0">:</span><span class="s1">e</span><span class="s0">[</span><span class="s3">7</span><span class="s0">]?</span><span class="s3">4095</span><span class="s0">:</span><span class="s3">65535</span><span class="s0">;</span><span class="s4">return</span><span class="s0">[</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]||</span><span class="s1">e</span><span class="s0">[</span><span class="s3">4</span><span class="s0">]||</span><span class="s1">e</span><span class="s0">[</span><span class="s3">7</span><span class="s0">]||</span><span class="s1">e</span><span class="s0">[</span><span class="s3">10</span><span class="s0">],</span><span class="s3">16</span><span class="s0">)/</span><span class="s1">t</span><span class="s0">*</span><span class="s3">255</span><span class="s0">),</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">2</span><span class="s0">]||</span><span class="s1">e</span><span class="s0">[</span><span class="s3">5</span><span class="s0">]||</span><span class="s1">e</span><span class="s0">[</span><span class="s3">8</span><span class="s0">]||</span><span class="s1">e</span><span class="s0">[</span><span class="s3">11</span><span class="s0">],</span><span class="s3">16</span><span class="s0">)/</span><span class="s1">t</span><span class="s0">*</span><span class="s3">255</span><span class="s0">),</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">3</span><span class="s0">]||</span><span class="s1">e</span><span class="s0">[</span><span class="s3">6</span><span class="s0">]||</span><span class="s1">e</span><span class="s0">[</span><span class="s3">9</span><span class="s0">]||</span><span class="s1">e</span><span class="s0">[</span><span class="s3">12</span><span class="s0">],</span><span class="s3">16</span><span class="s0">)/</span><span class="s1">t</span><span class="s0">*</span><span class="s3">255</span><span class="s0">)]}}</span><span class="s4">else if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s2">&quot;#&quot;</span><span class="s0">)&amp;&amp;(</span><span class="s1">t</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">1</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">exec</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)&amp;&amp;[</span><span class="s3">3</span><span class="s0">,</span><span class="s3">6</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">12</span><span class="s0">].</span><span class="s1">includes</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">))){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">/</span><span class="s3">3</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=[</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">;++</span><span class="s1">s</span><span class="s0">){</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">parseInt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">e</span><span class="s0">*</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">*</span><span class="s1">s</span><span class="s0">+</span><span class="s1">e</span><span class="s0">),</span><span class="s3">16</span><span class="s0">);</span><span class="s1">i</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]=</span><span class="s3">1</span><span class="s0">===</span><span class="s1">e</span><span class="s0">?</span><span class="s1">r</span><span class="s0">&lt;&lt;</span><span class="s3">4</span><span class="s0">:</span><span class="s3">2</span><span class="s0">===</span><span class="s1">e</span><span class="s0">?</span><span class="s1">r</span><span class="s0">:</span><span class="s3">3</span><span class="s0">===</span><span class="s1">e</span><span class="s0">?</span><span class="s1">r</span><span class="s0">&gt;&gt;</span><span class="s3">4</span><span class="s0">:</span><span class="s1">r</span><span class="s0">&gt;&gt;</span><span class="s3">8</span><span class="s0">}</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">toRgbString</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s3">16</span><span class="s0">){</span><span class="s4">const</span><span class="s0">[</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">return</span><span class="s2">`rgb:</span><span class="s1">$</span><span class="s0">{</span><span class="s1">r</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s2">/</span><span class="s1">$</span><span class="s0">{</span><span class="s1">r</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s2">/</span><span class="s1">$</span><span class="s0">{</span><span class="s1">r</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s2">`</span><span class="s0">}},</span><span class="s3">5770</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">PAYLOAD_LIMIT</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">PAYLOAD_LIMIT</span><span class="s0">=</span><span class="s3">1e7</span><span class="s0">},</span><span class="s3">6351</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DcsHandler</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DcsParser</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">482</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8742</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">5770</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=[];</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DcsParser</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s1">o</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ident</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlerFb</span><span class="s0">=()=&gt;{},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">={</span><span class="s1">paused</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">loopPosition</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">fallThrough</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">}}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlerFb</span><span class="s0">=()=&gt;{},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s1">o</span><span class="s0">}</span><span class="s1">registerHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=[]);</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">];</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),{</span><span class="s1">dispose</span><span class="s0">:()=&gt;{</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)}}}</span><span class="s1">clearHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]&amp;&amp;</span><span class="s4">delete this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]}</span><span class="s1">setHandlerFallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlerFb</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">loopPosition</span><span class="s0">-</span><span class="s3">1</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;--</span><span class="s1">e</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">unhook</span><span class="s0">(!</span><span class="s3">1</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s1">o</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ident</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">hook</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ident</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]||</span><span class="s1">o</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">--)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">[</span><span class="s1">i</span><span class="s0">].</span><span class="s1">hook</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">_handlerFb</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ident</span><span class="s0">,</span><span class="s2">&quot;HOOK&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">put</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">--)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">put</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">_handlerFb</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ident</span><span class="s0">,</span><span class="s2">&quot;PUT&quot;</span><span class="s0">,(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">utf32ToString</span><span class="s0">)(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))}</span><span class="s1">unhook</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">loopPosition</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">fallThrough</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">),!</span><span class="s1">r</span><span class="s0">&amp;&amp;!</span><span class="s3">1</span><span class="s0">===</span><span class="s1">i</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">unhook</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">i</span><span class="s0">);</span><span class="s1">s</span><span class="s0">--)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i </span><span class="s4">instanceof </span><span class="s1">Promise</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">loopPosition</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">fallThrough</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">;</span><span class="s1">s</span><span class="s0">--}</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">--)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">unhook</span><span class="s0">(!</span><span class="s3">1</span><span class="s0">),</span><span class="s1">i </span><span class="s4">instanceof </span><span class="s1">Promise</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">loopPosition</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">fallThrough</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">}</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">_handlerFb</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ident</span><span class="s0">,</span><span class="s2">&quot;UNHOOK&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s1">o</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_ident</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}};</span><span class="s4">const </span><span class="s1">a</span><span class="s0">=</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">Params</span><span class="s0">;</span><span class="s1">a</span><span class="s0">.</span><span class="s1">addParam</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DcsHandler</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handler</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">=</span><span class="s1">a</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">hook</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]?</span><span class="s1">e</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">():</span><span class="s1">a</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">put</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">+=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">utf32ToString</span><span class="s0">)(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">PAYLOAD_LIMIT</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">))}</span><span class="s1">unhook</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">)</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handler</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">),</span><span class="s1">t </span><span class="s4">instanceof </span><span class="s1">Promise</span><span class="s0">))</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">then</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">=</span><span class="s1">a</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)));</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">=</span><span class="s1">a</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">t</span><span class="s0">}}},</span><span class="s3">2015</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">EscapeSequenceParser</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">VT500_TRANSITION_TABLE</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">TransitionTable</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8742</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6242</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6351</span><span class="s0">);</span><span class="s4">class </span><span class="s1">a</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">table</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint8Array</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">setDefault</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">table</span><span class="s0">.</span><span class="s1">fill</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;&lt;</span><span class="s3">4</span><span class="s0">|</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">add</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">table</span><span class="s0">[</span><span class="s1">t</span><span class="s0">&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">i</span><span class="s0">&lt;&lt;</span><span class="s3">4</span><span class="s0">|</span><span class="s1">s</span><span class="s0">}</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">r</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">table</span><span class="s0">[</span><span class="s1">t</span><span class="s0">&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s1">e</span><span class="s0">[</span><span class="s1">r</span><span class="s0">]]=</span><span class="s1">i</span><span class="s0">&lt;&lt;</span><span class="s3">4</span><span class="s0">|</span><span class="s1">s</span><span class="s0">}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">TransitionTable</span><span class="s0">=</span><span class="s1">a</span><span class="s0">;</span><span class="s4">const </span><span class="s1">h</span><span class="s0">=</span><span class="s3">160</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">VT500_TRANSITION_TABLE</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">a</span><span class="s0">(</span><span class="s3">4095</span><span class="s0">),</span><span class="s1">t</span><span class="s0">=</span><span class="s1">Array</span><span class="s0">.</span><span class="s1">apply</span><span class="s0">(</span><span class="s4">null</span><span class="s0">,</span><span class="s1">Array</span><span class="s0">(</span><span class="s3">256</span><span class="s0">)).</span><span class="s1">map</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;</span><span class="s1">t</span><span class="s0">)),</span><span class="s1">i</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">32</span><span class="s0">,</span><span class="s3">127</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">24</span><span class="s0">);</span><span class="s1">r</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s3">25</span><span class="s0">),</span><span class="s1">r</span><span class="s0">.</span><span class="s1">push</span><span class="s0">.</span><span class="s1">apply</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">i</span><span class="s0">(</span><span class="s3">28</span><span class="s0">,</span><span class="s3">32</span><span class="s0">));</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s3">14</span><span class="s0">);</span><span class="s4">let </span><span class="s1">o</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s1">o </span><span class="s4">in </span><span class="s1">e</span><span class="s0">.</span><span class="s1">setDefault</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">2</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">n</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">([</span><span class="s3">24</span><span class="s0">,</span><span class="s3">26</span><span class="s0">,</span><span class="s3">153</span><span class="s0">,</span><span class="s3">154</span><span class="s0">],</span><span class="s1">o</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">128</span><span class="s0">,</span><span class="s3">144</span><span class="s0">),</span><span class="s1">o</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">144</span><span class="s0">,</span><span class="s3">152</span><span class="s0">),</span><span class="s1">o</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">156</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">27</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s3">11</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">157</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s3">4</span><span class="s0">,</span><span class="s3">8</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">([</span><span class="s3">152</span><span class="s0">,</span><span class="s3">158</span><span class="s0">,</span><span class="s3">159</span><span class="s0">],</span><span class="s1">o</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">7</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">155</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s3">11</span><span class="s0">,</span><span class="s3">3</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">144</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s3">11</span><span class="s0">,</span><span class="s3">9</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">127</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">8</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">8</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s3">3</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">127</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">3</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">4</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s3">4</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">127</span><span class="s0">,</span><span class="s3">4</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">4</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">6</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s3">6</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">5</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s3">5</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">127</span><span class="s0">,</span><span class="s3">5</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">5</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">2</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s3">2</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">127</span><span class="s0">,</span><span class="s3">2</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">2</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">93</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s3">4</span><span class="s0">,</span><span class="s3">8</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s3">8</span><span class="s0">,</span><span class="s3">5</span><span class="s0">,</span><span class="s3">8</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">127</span><span class="s0">,</span><span class="s3">8</span><span class="s0">,</span><span class="s3">5</span><span class="s0">,</span><span class="s3">8</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">([</span><span class="s3">156</span><span class="s0">,</span><span class="s3">27</span><span class="s0">,</span><span class="s3">24</span><span class="s0">,</span><span class="s3">26</span><span class="s0">,</span><span class="s3">7</span><span class="s0">],</span><span class="s3">8</span><span class="s0">,</span><span class="s3">6</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">28</span><span class="s0">,</span><span class="s3">32</span><span class="s0">),</span><span class="s3">8</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">8</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">([</span><span class="s3">88</span><span class="s0">,</span><span class="s3">94</span><span class="s0">,</span><span class="s3">95</span><span class="s0">],</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">7</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s3">7</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">7</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">7</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">7</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">156</span><span class="s0">,</span><span class="s3">7</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">127</span><span class="s0">,</span><span class="s3">7</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">7</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">91</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s3">11</span><span class="s0">,</span><span class="s3">3</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">64</span><span class="s0">,</span><span class="s3">127</span><span class="s0">),</span><span class="s3">3</span><span class="s0">,</span><span class="s3">7</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">48</span><span class="s0">,</span><span class="s3">60</span><span class="s0">),</span><span class="s3">3</span><span class="s0">,</span><span class="s3">8</span><span class="s0">,</span><span class="s3">4</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">([</span><span class="s3">60</span><span class="s0">,</span><span class="s3">61</span><span class="s0">,</span><span class="s3">62</span><span class="s0">,</span><span class="s3">63</span><span class="s0">],</span><span class="s3">3</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">4</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">48</span><span class="s0">,</span><span class="s3">60</span><span class="s0">),</span><span class="s3">4</span><span class="s0">,</span><span class="s3">8</span><span class="s0">,</span><span class="s3">4</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">64</span><span class="s0">,</span><span class="s3">127</span><span class="s0">),</span><span class="s3">4</span><span class="s0">,</span><span class="s3">7</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">([</span><span class="s3">60</span><span class="s0">,</span><span class="s3">61</span><span class="s0">,</span><span class="s3">62</span><span class="s0">,</span><span class="s3">63</span><span class="s0">],</span><span class="s3">4</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">6</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">32</span><span class="s0">,</span><span class="s3">64</span><span class="s0">),</span><span class="s3">6</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">6</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">127</span><span class="s0">,</span><span class="s3">6</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">6</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">64</span><span class="s0">,</span><span class="s3">127</span><span class="s0">),</span><span class="s3">6</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">32</span><span class="s0">,</span><span class="s3">48</span><span class="s0">),</span><span class="s3">3</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">5</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">32</span><span class="s0">,</span><span class="s3">48</span><span class="s0">),</span><span class="s3">5</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">5</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">48</span><span class="s0">,</span><span class="s3">64</span><span class="s0">),</span><span class="s3">5</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">6</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">64</span><span class="s0">,</span><span class="s3">127</span><span class="s0">),</span><span class="s3">5</span><span class="s0">,</span><span class="s3">7</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">32</span><span class="s0">,</span><span class="s3">48</span><span class="s0">),</span><span class="s3">4</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">5</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">32</span><span class="s0">,</span><span class="s3">48</span><span class="s0">),</span><span class="s3">1</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">2</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">32</span><span class="s0">,</span><span class="s3">48</span><span class="s0">),</span><span class="s3">2</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">2</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">48</span><span class="s0">,</span><span class="s3">127</span><span class="s0">),</span><span class="s3">2</span><span class="s0">,</span><span class="s3">10</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">48</span><span class="s0">,</span><span class="s3">80</span><span class="s0">),</span><span class="s3">1</span><span class="s0">,</span><span class="s3">10</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">81</span><span class="s0">,</span><span class="s3">88</span><span class="s0">),</span><span class="s3">1</span><span class="s0">,</span><span class="s3">10</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">([</span><span class="s3">89</span><span class="s0">,</span><span class="s3">90</span><span class="s0">,</span><span class="s3">92</span><span class="s0">],</span><span class="s3">1</span><span class="s0">,</span><span class="s3">10</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">96</span><span class="s0">,</span><span class="s3">127</span><span class="s0">),</span><span class="s3">1</span><span class="s0">,</span><span class="s3">10</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">80</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s3">11</span><span class="s0">,</span><span class="s3">9</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">9</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">127</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">9</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">28</span><span class="s0">,</span><span class="s3">32</span><span class="s0">),</span><span class="s3">9</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">9</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">32</span><span class="s0">,</span><span class="s3">48</span><span class="s0">),</span><span class="s3">9</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">12</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">48</span><span class="s0">,</span><span class="s3">60</span><span class="s0">),</span><span class="s3">9</span><span class="s0">,</span><span class="s3">8</span><span class="s0">,</span><span class="s3">10</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">([</span><span class="s3">60</span><span class="s0">,</span><span class="s3">61</span><span class="s0">,</span><span class="s3">62</span><span class="s0">,</span><span class="s3">63</span><span class="s0">],</span><span class="s3">9</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">10</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">11</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">11</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">32</span><span class="s0">,</span><span class="s3">128</span><span class="s0">),</span><span class="s3">11</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">11</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">28</span><span class="s0">,</span><span class="s3">32</span><span class="s0">),</span><span class="s3">11</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">11</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">10</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">10</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">127</span><span class="s0">,</span><span class="s3">10</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">10</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">28</span><span class="s0">,</span><span class="s3">32</span><span class="s0">),</span><span class="s3">10</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">10</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">48</span><span class="s0">,</span><span class="s3">60</span><span class="s0">),</span><span class="s3">10</span><span class="s0">,</span><span class="s3">8</span><span class="s0">,</span><span class="s3">10</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">([</span><span class="s3">60</span><span class="s0">,</span><span class="s3">61</span><span class="s0">,</span><span class="s3">62</span><span class="s0">,</span><span class="s3">63</span><span class="s0">],</span><span class="s3">10</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">11</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">32</span><span class="s0">,</span><span class="s3">48</span><span class="s0">),</span><span class="s3">10</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">12</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">12</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">12</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">127</span><span class="s0">,</span><span class="s3">12</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">12</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">28</span><span class="s0">,</span><span class="s3">32</span><span class="s0">),</span><span class="s3">12</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">12</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">32</span><span class="s0">,</span><span class="s3">48</span><span class="s0">),</span><span class="s3">12</span><span class="s0">,</span><span class="s3">9</span><span class="s0">,</span><span class="s3">12</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">48</span><span class="s0">,</span><span class="s3">64</span><span class="s0">),</span><span class="s3">12</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">11</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">64</span><span class="s0">,</span><span class="s3">127</span><span class="s0">),</span><span class="s3">12</span><span class="s0">,</span><span class="s3">12</span><span class="s0">,</span><span class="s3">13</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">64</span><span class="s0">,</span><span class="s3">127</span><span class="s0">),</span><span class="s3">10</span><span class="s0">,</span><span class="s3">12</span><span class="s0">,</span><span class="s3">13</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">i</span><span class="s0">(</span><span class="s3">64</span><span class="s0">,</span><span class="s3">127</span><span class="s0">),</span><span class="s3">9</span><span class="s0">,</span><span class="s3">12</span><span class="s0">,</span><span class="s3">13</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s3">13</span><span class="s0">,</span><span class="s3">13</span><span class="s0">,</span><span class="s3">13</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s3">13</span><span class="s0">,</span><span class="s3">13</span><span class="s0">,</span><span class="s3">13</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s3">127</span><span class="s0">,</span><span class="s3">13</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">13</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addMany</span><span class="s0">([</span><span class="s3">27</span><span class="s0">,</span><span class="s3">156</span><span class="s0">,</span><span class="s3">24</span><span class="s0">,</span><span class="s3">26</span><span class="s0">],</span><span class="s3">13</span><span class="s0">,</span><span class="s3">14</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s1">h</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">2</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s1">h</span><span class="s0">,</span><span class="s3">8</span><span class="s0">,</span><span class="s3">5</span><span class="s0">,</span><span class="s3">8</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s1">h</span><span class="s0">,</span><span class="s3">6</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">6</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s1">h</span><span class="s0">,</span><span class="s3">11</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">11</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s1">h</span><span class="s0">,</span><span class="s3">13</span><span class="s0">,</span><span class="s3">13</span><span class="s0">,</span><span class="s3">13</span><span class="s0">),</span><span class="s1">e</span><span class="s0">}();</span><span class="s4">class </span><span class="s1">c </span><span class="s4">extends </span><span class="s1">s</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">VT500_TRANSITION_TABLE</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_transitions</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">={</span><span class="s1">state</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">handlers</span><span class="s0">:[],</span><span class="s1">handlerPos</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">transition</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">chunkPos</span><span class="s0">:</span><span class="s3">0</span><span class="s0">},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">initialState</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">currentState</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">initialState</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">=</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">Params</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">addParam</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">precedingJoinState</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_printHandlerFb</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_executeHandlerFb</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;{},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_csiHandlerFb</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_escHandlerFb</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;{},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_errorHandlerFb</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_printHandler</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_printHandlerFb</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_executeHandlers</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_csiHandlers</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_escHandlers</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_csiHandlers</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_executeHandlers</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_escHandlers</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">)}))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscParser</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">OscParser</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dcsParser</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">DcsParser</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_errorHandler</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_errorHandlerFb</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">({</span><span class="s1">final</span><span class="s0">:</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">&quot;</span><span class="s0">},(()=&gt;!</span><span class="s3">0</span><span class="s0">))}</span><span class="s1">_identifier</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=[</span><span class="s3">64</span><span class="s0">,</span><span class="s3">126</span><span class="s0">]){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">prefix</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">prefix</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;only one byte as prefix supported&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">prefix</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s3">60</span><span class="s0">&gt;</span><span class="s1">i</span><span class="s0">||</span><span class="s1">i</span><span class="s0">&gt;</span><span class="s3">63</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;prefix must be in range 0x3c .. 0x3f&quot;</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">intermediates</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">intermediates</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">2</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;only two bytes as intermediates are supported&quot;</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">intermediates</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">intermediates</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s3">32</span><span class="s0">&gt;</span><span class="s1">s</span><span class="s0">||</span><span class="s1">s</span><span class="s0">&gt;</span><span class="s3">47</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;intermediate must be in range 0x20 .. 0x2f&quot;</span><span class="s0">);</span><span class="s1">i</span><span class="s0">&lt;&lt;=</span><span class="s3">8</span><span class="s0">,</span><span class="s1">i</span><span class="s0">|=</span><span class="s1">s</span><span class="s0">}}</span><span class="s4">if</span><span class="s0">(</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">final</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;final must be a single byte&quot;</span><span class="s0">);</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">final</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&gt;</span><span class="s1">s</span><span class="s0">||</span><span class="s1">s</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">])</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`final must be in range </span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]} </span><span class="s2">.. </span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]}</span><span class="s2">`</span><span class="s0">);</span><span class="s4">return </span><span class="s1">i</span><span class="s0">&lt;&lt;=</span><span class="s3">8</span><span class="s0">,</span><span class="s1">i</span><span class="s0">|=</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">}</span><span class="s1">identToString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">e</span><span class="s0">;)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">(</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">)),</span><span class="s1">e</span><span class="s0">&gt;&gt;=</span><span class="s3">8</span><span class="s0">;</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">reverse</span><span class="s0">().</span><span class="s1">join</span><span class="s0">(</span><span class="s2">&quot;&quot;</span><span class="s0">)}</span><span class="s1">setPrintHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_printHandler</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">clearPrintHandler</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_printHandler</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_printHandlerFb</span><span class="s0">}</span><span class="s1">registerEscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_identifier</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,[</span><span class="s3">48</span><span class="s0">,</span><span class="s3">126</span><span class="s0">]);</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_escHandlers</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_escHandlers</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]=[]);</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_escHandlers</span><span class="s0">[</span><span class="s1">i</span><span class="s0">];</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),{</span><span class="s1">dispose</span><span class="s0">:()=&gt;{</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)}}}</span><span class="s1">clearEscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_escHandlers</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_identifier</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,[</span><span class="s3">48</span><span class="s0">,</span><span class="s3">126</span><span class="s0">])]&amp;&amp;</span><span class="s4">delete this</span><span class="s0">.</span><span class="s1">_escHandlers</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_identifier</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,[</span><span class="s3">48</span><span class="s0">,</span><span class="s3">126</span><span class="s0">])]}</span><span class="s1">setEscHandlerFallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_escHandlerFb</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">setExecuteHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_executeHandlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)]=</span><span class="s1">t</span><span class="s0">}</span><span class="s1">clearExecuteHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_executeHandlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)]&amp;&amp;</span><span class="s4">delete this</span><span class="s0">.</span><span class="s1">_executeHandlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)]}</span><span class="s1">setExecuteHandlerFallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_executeHandlerFb</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">registerCsiHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_identifier</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_csiHandlers</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_csiHandlers</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]=[]);</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_csiHandlers</span><span class="s0">[</span><span class="s1">i</span><span class="s0">];</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),{</span><span class="s1">dispose</span><span class="s0">:()=&gt;{</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)}}}</span><span class="s1">clearCsiHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_csiHandlers</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_identifier</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)]&amp;&amp;</span><span class="s4">delete this</span><span class="s0">.</span><span class="s1">_csiHandlers</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_identifier</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)]}</span><span class="s1">setCsiHandlerFallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_csiHandlerFb</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">registerDcsHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dcsParser</span><span class="s0">.</span><span class="s1">registerHandler</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_identifier</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">clearDcsHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dcsParser</span><span class="s0">.</span><span class="s1">clearHandler</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_identifier</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))}</span><span class="s1">setDcsHandlerFallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dcsParser</span><span class="s0">.</span><span class="s1">setHandlerFallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_oscParser</span><span class="s0">.</span><span class="s1">registerHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">clearOscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscParser</span><span class="s0">.</span><span class="s1">clearHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">setOscHandlerFallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscParser</span><span class="s0">.</span><span class="s1">setHandlerFallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">setErrorHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_errorHandler</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">clearErrorHandler</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_errorHandler</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_errorHandlerFb</span><span class="s0">}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">currentState</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">initialState</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscParser</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dcsParser</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">addParam</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">precedingJoinState</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">state</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s3">2</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">handlers</span><span class="s0">=[])}</span><span class="s1">_preserveStack</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">handlers</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">handlerPos</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">transition</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">=</span><span class="s1">r</span><span class="s0">}</span><span class="s1">parse</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">state</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s3">2</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">state</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;</span><span class="s4">else</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">i</span><span class="s0">||</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">state</span><span class="s0">)</span><span class="s4">throw this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s3">1</span><span class="s0">,</span><span class="s4">new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;improper continuation due to previous async handler, giving up parsing&quot;</span><span class="s0">);</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">handlers</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">handlerPos</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">switch</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">state</span><span class="s0">){</span><span class="s4">case </span><span class="s3">3</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(!</span><span class="s3">1</span><span class="s0">===</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">n</span><span class="s0">](</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">s</span><span class="s0">);</span><span class="s1">n</span><span class="s0">--)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s </span><span class="s4">instanceof </span><span class="s1">Promise</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">handlerPos</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">handlers</span><span class="s0">=[];</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">4</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(!</span><span class="s3">1</span><span class="s0">===</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">n</span><span class="s0">](),!</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">s</span><span class="s0">);</span><span class="s1">n</span><span class="s0">--)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s </span><span class="s4">instanceof </span><span class="s1">Promise</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">handlerPos</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">handlers</span><span class="s0">=[];</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">6</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">],</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dcsParser</span><span class="s0">.</span><span class="s1">unhook</span><span class="s0">(</span><span class="s3">24</span><span class="s0">!==</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s3">26</span><span class="s0">!==</span><span class="s1">r</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return </span><span class="s1">s</span><span class="s0">;</span><span class="s3">27</span><span class="s0">===</span><span class="s1">r</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">transition</span><span class="s0">|=</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">addParam</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">5</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">],</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscParser</span><span class="s0">.</span><span class="s1">end</span><span class="s0">(</span><span class="s3">24</span><span class="s0">!==</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s3">26</span><span class="s0">!==</span><span class="s1">r</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return </span><span class="s1">s</span><span class="s0">;</span><span class="s3">27</span><span class="s0">===</span><span class="s1">r</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">transition</span><span class="s0">|=</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">addParam</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">precedingJoinState</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">currentState</span><span class="s0">=</span><span class="s3">15</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parseStack</span><span class="s0">.</span><span class="s1">transition</span><span class="s0">}</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s1">o</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">;++</span><span class="s1">a</span><span class="s0">){</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">],</span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_transitions</span><span class="s0">.</span><span class="s1">table</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">currentState</span><span class="s0">&lt;&lt;</span><span class="s3">8</span><span class="s0">|(</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s3">160</span><span class="s0">?</span><span class="s1">r</span><span class="s0">:</span><span class="s1">h</span><span class="s0">)],</span><span class="s1">n</span><span class="s0">&gt;&gt;</span><span class="s3">4</span><span class="s0">){</span><span class="s4">case </span><span class="s3">2</span><span class="s0">:</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;;++</span><span class="s1">s</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s1">t</span><span class="s0">||(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">])&lt;</span><span class="s3">32</span><span class="s0">||</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s3">126</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">h</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_printHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">s</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(++</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s1">t</span><span class="s0">||(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">])&lt;</span><span class="s3">32</span><span class="s0">||</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s3">126</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">h</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_printHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">s</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(++</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s1">t</span><span class="s0">||(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">])&lt;</span><span class="s3">32</span><span class="s0">||</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s3">126</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">h</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_printHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">s</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(++</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s1">t</span><span class="s0">||(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">])&lt;</span><span class="s3">32</span><span class="s0">||</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s3">126</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">h</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_printHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">s</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">}}</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">3</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_executeHandlers</span><span class="s0">[</span><span class="s1">r</span><span class="s0">]?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_executeHandlers</span><span class="s0">[</span><span class="s1">r</span><span class="s0">]():</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_executeHandlerFb</span><span class="s0">(</span><span class="s1">r</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">precedingJoinState</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">0</span><span class="s0">:</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">1</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_errorHandler</span><span class="s0">({</span><span class="s1">position</span><span class="s0">:</span><span class="s1">a</span><span class="s0">,</span><span class="s1">code</span><span class="s0">:</span><span class="s1">r</span><span class="s0">,</span><span class="s1">currentState</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">currentState</span><span class="s0">,</span><span class="s1">collect</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">,</span><span class="s1">params</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">,</span><span class="s1">abort</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">}).</span><span class="s1">abort</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">7</span><span class="s0">:</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_csiHandlers</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s1">r</span><span class="s0">];</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">?</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">:-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">o</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">[</span><span class="s1">o</span><span class="s0">](</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">s</span><span class="s0">);</span><span class="s1">o</span><span class="s0">--)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s </span><span class="s4">instanceof </span><span class="s1">Promise</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_preserveStack</span><span class="s0">(</span><span class="s3">3</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">a</span><span class="s0">),</span><span class="s1">s</span><span class="s0">;</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_csiHandlerFb</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">precedingJoinState</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">8</span><span class="s0">:</span><span class="s4">do</span><span class="s0">{</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">r</span><span class="s0">){</span><span class="s4">case </span><span class="s3">59</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">addParam</span><span class="s0">(</span><span class="s3">0</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">58</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">addSubParam</span><span class="s0">(-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">default</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">addDigit</span><span class="s0">(</span><span class="s1">r</span><span class="s0">-</span><span class="s3">48</span><span class="s0">)}}</span><span class="s4">while</span><span class="s0">(++</span><span class="s1">a</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&gt;</span><span class="s3">47</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s3">60</span><span class="s0">);</span><span class="s1">a</span><span class="s0">--;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">9</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">&lt;&lt;=</span><span class="s3">8</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">|=</span><span class="s1">r</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">10</span><span class="s0">:</span><span class="s4">const </span><span class="s1">c</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_escHandlers</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s1">r</span><span class="s0">];</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">c</span><span class="s0">?</span><span class="s1">c</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">:-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">l</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">c</span><span class="s0">[</span><span class="s1">l</span><span class="s0">](),!</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">s</span><span class="s0">);</span><span class="s1">l</span><span class="s0">--)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s </span><span class="s4">instanceof </span><span class="s1">Promise</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_preserveStack</span><span class="s0">(</span><span class="s3">4</span><span class="s0">,</span><span class="s1">c</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">a</span><span class="s0">),</span><span class="s1">s</span><span class="s0">;</span><span class="s1">l</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_escHandlerFb</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s1">r</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">precedingJoinState</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">11</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">addParam</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">12</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dcsParser</span><span class="s0">.</span><span class="s1">hook</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">13</span><span class="s0">:</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;;++</span><span class="s1">s</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s1">t</span><span class="s0">||</span><span class="s3">24</span><span class="s0">===(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">])||</span><span class="s3">26</span><span class="s0">===</span><span class="s1">r</span><span class="s0">||</span><span class="s3">27</span><span class="s0">===</span><span class="s1">r</span><span class="s0">||</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s3">127</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">h</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dcsParser</span><span class="s0">.</span><span class="s1">put</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">s</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">}</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">14</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dcsParser</span><span class="s0">.</span><span class="s1">unhook</span><span class="s0">(</span><span class="s3">24</span><span class="s0">!==</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s3">26</span><span class="s0">!==</span><span class="s1">r</span><span class="s0">),</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_preserveStack</span><span class="s0">(</span><span class="s3">6</span><span class="s0">,[],</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">a</span><span class="s0">),</span><span class="s1">s</span><span class="s0">;</span><span class="s3">27</span><span class="s0">===</span><span class="s1">r</span><span class="s0">&amp;&amp;(</span><span class="s1">n</span><span class="s0">|=</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">addParam</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">precedingJoinState</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">4</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscParser</span><span class="s0">.</span><span class="s1">start</span><span class="s0">();</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">5</span><span class="s0">:</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">a</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;;</span><span class="s1">s</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s1">t</span><span class="s0">||(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">])&lt;</span><span class="s3">32</span><span class="s0">||</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s3">127</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">h</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscParser</span><span class="s0">.</span><span class="s1">put</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">s</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">}</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case </span><span class="s3">6</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_oscParser</span><span class="s0">.</span><span class="s1">end</span><span class="s0">(</span><span class="s3">24</span><span class="s0">!==</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s3">26</span><span class="s0">!==</span><span class="s1">r</span><span class="s0">),</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_preserveStack</span><span class="s0">(</span><span class="s3">5</span><span class="s0">,[],</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">a</span><span class="s0">),</span><span class="s1">s</span><span class="s0">;</span><span class="s3">27</span><span class="s0">===</span><span class="s1">r</span><span class="s0">&amp;&amp;(</span><span class="s1">n</span><span class="s0">|=</span><span class="s3">1</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_params</span><span class="s0">.</span><span class="s1">addParam</span><span class="s0">(</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_collect</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">precedingJoinState</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">currentState</span><span class="s0">=</span><span class="s3">15</span><span class="s0">&amp;</span><span class="s1">n</span><span class="s0">}}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">EscapeSequenceParser</span><span class="s0">=</span><span class="s1">c</span><span class="s0">},</span><span class="s3">6242</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OscParser</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">5770</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">482</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=[];</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OscParser</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlerFb</span><span class="s0">=()=&gt;{},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">={</span><span class="s1">paused</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">loopPosition</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">fallThrough</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">}}</span><span class="s1">registerHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=[]);</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">];</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),{</span><span class="s1">dispose</span><span class="s0">:()=&gt;{</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)}}}</span><span class="s1">clearHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]&amp;&amp;</span><span class="s4">delete this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]}</span><span class="s1">setHandlerFallback</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlerFb</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlerFb</span><span class="s0">=()=&gt;{},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s1">n</span><span class="s0">}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">2</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">loopPosition</span><span class="s0">-</span><span class="s3">1</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;--</span><span class="s1">e</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">end</span><span class="s0">(!</span><span class="s3">1</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">_start</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handlers</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">]||</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">--)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">start</span><span class="s0">();</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">_handlerFb</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">,</span><span class="s2">&quot;START&quot;</span><span class="s0">)}</span><span class="s1">_put</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">--)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">put</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">_handlerFb</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">,</span><span class="s2">&quot;PUT&quot;</span><span class="s0">,(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">utf32ToString</span><span class="s0">)(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))}</span><span class="s1">start</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">=</span><span class="s3">1</span><span class="s0">}</span><span class="s1">put</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">3</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">;){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">++];</span><span class="s4">if</span><span class="s0">(</span><span class="s3">59</span><span class="s0">===</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">=</span><span class="s3">2</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_start</span><span class="s0">();</span><span class="s4">break</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s3">48</span><span class="s0">||</span><span class="s3">57</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return void</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">=</span><span class="s3">3</span><span class="s0">);-</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">=</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">=</span><span class="s3">10</span><span class="s0">*</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">+</span><span class="s1">i</span><span class="s0">-</span><span class="s3">48</span><span class="s0">}</span><span class="s3">2</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">-</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_put</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}}</span><span class="s1">end</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">3</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s3">1</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_start</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">&amp;&amp;(</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">loopPosition</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">fallThrough</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">),!</span><span class="s1">r</span><span class="s0">&amp;&amp;!</span><span class="s3">1</span><span class="s0">===</span><span class="s1">i</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">end</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),!</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">i</span><span class="s0">);</span><span class="s1">s</span><span class="s0">--)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i </span><span class="s4">instanceof </span><span class="s1">Promise</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">loopPosition</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">fallThrough</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">;</span><span class="s1">s</span><span class="s0">--}</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">--)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">end</span><span class="s0">(!</span><span class="s3">1</span><span class="s0">),</span><span class="s1">i </span><span class="s4">instanceof </span><span class="s1">Promise</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">paused</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">loopPosition</span><span class="s0">=</span><span class="s1">s</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_stack</span><span class="s0">.</span><span class="s1">fallThrough</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">}</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">_handlerFb</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">,</span><span class="s2">&quot;END&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_id</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_state</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}}},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OscHandler</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handler</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">start</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">put</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">+=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">utf32ToString</span><span class="s0">)(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">PAYLOAD_LIMIT</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">))}</span><span class="s1">end</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">)</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_handler</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">),</span><span class="s1">t </span><span class="s4">instanceof </span><span class="s1">Promise</span><span class="s0">))</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">then</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)));</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_data</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_hitLimit</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">t</span><span class="s0">}}},</span><span class="s3">8742</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Params</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s3">2147483647</span><span class="s0">;</span><span class="s4">class </span><span class="s1">s</span><span class="s0">{</span><span class="s4">static </span><span class="s1">fromArray</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">new </span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return </span><span class="s1">t</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">Array</span><span class="s0">.</span><span class="s1">isArray</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">i</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">Array</span><span class="s0">.</span><span class="s1">isArray</span><span class="s0">(</span><span class="s1">s</span><span class="s0">))</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">e</span><span class="s0">)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">addSubParam</span><span class="s0">(</span><span class="s1">s</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]);</span><span class="s4">else </span><span class="s1">t</span><span class="s0">.</span><span class="s1">addParam</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)}</span><span class="s4">return </span><span class="s1">t</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">=</span><span class="s3">32</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=</span><span class="s3">32</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">maxSubParamsLength</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">256</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;maxSubParamsLength must not be greater than 256&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">params</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Int32Array</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParams</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Int32Array</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsLength</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint16Array</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rejectDigits</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rejectSubDigits</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_digitIsSub</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">clone</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">s</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">maxSubParamsLength</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">params</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">params</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_subParams</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParams</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_subParamsLength</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsLength</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_rejectDigits</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rejectDigits</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_rejectSubDigits</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rejectSubDigits</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">_digitIsSub</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_digitIsSub</span><span class="s0">,</span><span class="s1">e</span><span class="s0">}</span><span class="s1">toArray</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">t</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]);</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]&gt;&gt;</span><span class="s3">8</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">[</span><span class="s1">t</span><span class="s0">];</span><span class="s1">s</span><span class="s0">-</span><span class="s1">i</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">Array</span><span class="s0">.</span><span class="s1">prototype</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">.</span><span class="s1">call</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParams</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">))}</span><span class="s4">return </span><span class="s1">e</span><span class="s0">}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsLength</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rejectDigits</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rejectSubDigits</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_digitIsSub</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">addParam</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_digitIsSub</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">maxLength</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rejectDigits</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">else</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;values lesser than -1 are not allowed&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsLength</span><span class="s0">&lt;&lt;</span><span class="s3">8</span><span class="s0">|</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsLength</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">params</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">++]=</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s1">i</span><span class="s0">?</span><span class="s1">i</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}}</span><span class="s1">addSubParam</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_digitIsSub</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rejectDigits</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsLength</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">maxSubParamsLength</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rejectSubDigits</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">;</span><span class="s4">else</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;values lesser than -1 are not allowed&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParams</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsLength</span><span class="s0">++]=</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s1">i</span><span class="s0">?</span><span class="s1">i</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]++}}</span><span class="s1">hasSubParams</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s0">(</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">[</span><span class="s1">e</span><span class="s0">])-(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]&gt;&gt;</span><span class="s3">8</span><span class="s0">)&gt;</span><span class="s3">0</span><span class="s0">}</span><span class="s1">getSubParams</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]&gt;&gt;</span><span class="s3">8</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">[</span><span class="s1">e</span><span class="s0">];</span><span class="s4">return </span><span class="s1">i</span><span class="s0">-</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParams</span><span class="s0">.</span><span class="s1">subarray</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s4">null</span><span class="s0">}</span><span class="s1">getSubParamsAll</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">={};</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;++</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]&gt;&gt;</span><span class="s3">8</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s3">255</span><span class="s0">&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsIdx</span><span class="s0">[</span><span class="s1">t</span><span class="s0">];</span><span class="s1">s</span><span class="s0">-</span><span class="s1">i</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParams</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">))}</span><span class="s4">return </span><span class="s1">e</span><span class="s0">}</span><span class="s1">addDigit</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rejectDigits</span><span class="s0">||!(</span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_digitIsSub</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParamsLength</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_digitIsSub</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_rejectSubDigits</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_digitIsSub</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_subParams</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">params</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">s</span><span class="s0">[</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">];</span><span class="s1">s</span><span class="s0">[</span><span class="s1">t</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]=~</span><span class="s1">r</span><span class="s0">?</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s3">10</span><span class="s0">*</span><span class="s1">r</span><span class="s0">+</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">e</span><span class="s0">}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">Params</span><span class="s0">=</span><span class="s1">s</span><span class="s0">},</span><span class="s3">5741</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">AddonManager</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">AddonManager</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addons</span><span class="s0">=[]}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addons</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">--)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addons</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">instance</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">()}</span><span class="s1">loadAddon</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">={</span><span class="s1">instance</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">dispose</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">,</span><span class="s1">isDisposed</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">};</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addons</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">=()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_wrappedAddonDispose</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">activate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">_wrappedAddonDispose</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isDisposed</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addons</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addons</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]===</span><span class="s1">e</span><span class="s0">){</span><span class="s1">t</span><span class="s0">=</span><span class="s1">i</span><span class="s0">;</span><span class="s4">break</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(-</span><span class="s3">1</span><span class="s0">===</span><span class="s1">t</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;Could not dispose an addon that has not been loaded&quot;</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isDisposed</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">.</span><span class="s1">apply</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">instance</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addons</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)}}},</span><span class="s3">8771</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferApiView</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3785</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">511</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferApiView</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_buffer</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">type</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s1">init</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_buffer</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">}</span><span class="s1">get cursorY</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_buffer</span><span class="s0">.</span><span class="s1">y</span><span class="s0">}</span><span class="s1">get cursorX</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_buffer</span><span class="s0">.</span><span class="s1">x</span><span class="s0">}</span><span class="s1">get viewportY</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_buffer</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">}</span><span class="s1">get baseY</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_buffer</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">}</span><span class="s1">get length</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}</span><span class="s1">getLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_buffer</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">BufferLineApiView</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">getNullCell</span><span class="s0">(){</span><span class="s4">return new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">}}},</span><span class="s3">3785</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferLineApiView</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">511</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferLineApiView</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_line</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">get isWrapped</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_line</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">}</span><span class="s1">get length</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_line</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}</span><span class="s1">getCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!(</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_line</span><span class="s0">.</span><span class="s1">length</span><span class="s0">))</span><span class="s4">return </span><span class="s1">t</span><span class="s0">?(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_line</span><span class="s0">.</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">t</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_line</span><span class="s0">.</span><span class="s1">loadCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">CellData</span><span class="s0">)}</span><span class="s1">translateToString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_line</span><span class="s0">.</span><span class="s1">translateToString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}}},</span><span class="s3">8285</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferNamespaceApi</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8771</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">);</span><span class="s4">class </span><span class="s1">o </span><span class="s4">extends </span><span class="s1">n</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBufferChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onBufferChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBufferChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">=</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">BufferApiView</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">normal</span><span class="s0">,</span><span class="s2">&quot;normal&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_alternate</span><span class="s0">=</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">BufferApiView</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">alt</span><span class="s0">,</span><span class="s2">&quot;alternate&quot;</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">onBufferActivate</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBufferChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">)))}</span><span class="s1">get active</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">normal</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">normal</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">alt</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">alternate</span><span class="s0">;</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;Active buffer is neither normal nor alternate&quot;</span><span class="s0">)}</span><span class="s1">get normal</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_normal</span><span class="s0">.</span><span class="s1">init</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">normal</span><span class="s0">)}</span><span class="s1">get alternate</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_alternate</span><span class="s0">.</span><span class="s1">init</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">alt</span><span class="s0">)}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferNamespaceApi</span><span class="s0">=</span><span class="s1">o</span><span class="s0">},</span><span class="s3">7975</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ParserApi</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ParserApi</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">registerCsiHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toArray</span><span class="s0">())))}</span><span class="s1">addCsiHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">registerCsiHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">registerDcsHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">registerDcsHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;</span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">toArray</span><span class="s0">())))}</span><span class="s1">addDcsHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">registerDcsHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">registerEscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">addEscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">registerEscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">addOscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">registerOscHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}}},</span><span class="s3">7090</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">UnicodeApi</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">UnicodeApi</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">register</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">unicodeService</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">get versions</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">unicodeService</span><span class="s0">.</span><span class="s1">versions</span><span class="s0">}</span><span class="s1">get activeVersion</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">unicodeService</span><span class="s0">.</span><span class="s1">activeVersion</span><span class="s0">}</span><span class="s1">set activeVersion</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">unicodeService</span><span class="s0">.</span><span class="s1">activeVersion</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}}},</span><span class="s3">744</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MINIMUM_ROWS</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MINIMUM_COLS</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">5295</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MINIMUM_COLS</span><span class="s0">=</span><span class="s3">2</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MINIMUM_ROWS</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s4">let </span><span class="s1">c</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferService</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">o</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">get buffer</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">active</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isUserScrolling</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onResize</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onResize</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onResize</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">n</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onScroll</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">||</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MINIMUM_COLS</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">||</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">MINIMUM_ROWS</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">a</span><span class="s0">.</span><span class="s1">BufferSet</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">))}</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onResize</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">({</span><span class="s1">cols</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">rows</span><span class="s0">:</span><span class="s1">t</span><span class="s0">})}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffers</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isUserScrolling</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">}</span><span class="s1">scroll</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">;</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedBlankLine</span><span class="s0">,</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">getFg</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">fg</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">getBg</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bg</span><span class="s0">||(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">getBlankLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedBlankLine</span><span class="s0">=</span><span class="s1">s</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">isWrapped</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">i</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">i</span><span class="s0">.</span><span class="s1">scrollBottom</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">i</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">isFull</span><span class="s0">;</span><span class="s1">n</span><span class="s0">===</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">?</span><span class="s1">e</span><span class="s0">?</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">recycle</span><span class="s0">().</span><span class="s1">copyFrom</span><span class="s0">(</span><span class="s1">s</span><span class="s0">):</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">()):</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">()),</span><span class="s1">e</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isUserScrolling</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)):(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">++,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isUserScrolling</span><span class="s0">||</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">++)}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">n</span><span class="s0">-</span><span class="s1">r</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">shiftElements</span><span class="s0">(</span><span class="s1">r</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">())}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isUserScrolling</span><span class="s0">||(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">)}</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">0</span><span class="s0">===</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isUserScrolling</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">}</span><span class="s4">else </span><span class="s1">e</span><span class="s0">+</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">&gt;=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isUserScrolling</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">);</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">+</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">),</span><span class="s3">0</span><span class="s0">),</span><span class="s1">r</span><span class="s0">!==</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onScroll</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">))}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">BufferService</span><span class="s0">=</span><span class="s1">c</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">)],</span><span class="s1">c</span><span class="s0">)},</span><span class="s3">7994</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CharsetService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CharsetService</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">glevel</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsets</span><span class="s0">=[]}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">charset</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsets</span><span class="s0">=[],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">glevel</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">setgLevel</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">glevel</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">charset</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsets</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]}</span><span class="s1">setgCharset</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_charsets</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">glevel</span><span class="s0">===</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">charset</span><span class="s0">=</span><span class="s1">t</span><span class="s0">)}}},</span><span class="s3">1753</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CoreMouseService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">h</span><span class="s0">={</span><span class="s1">NONE</span><span class="s0">:{</span><span class="s1">events</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">restrict</span><span class="s0">:()=&gt;!</span><span class="s3">1</span><span class="s0">},</span><span class="s1">X10</span><span class="s0">:{</span><span class="s1">events</span><span class="s0">:</span><span class="s3">1</span><span class="s0">,</span><span class="s1">restrict</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s3">4</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&amp;&amp;</span><span class="s3">1</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrl</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">alt</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)},</span><span class="s1">VT200</span><span class="s0">:{</span><span class="s1">events</span><span class="s0">:</span><span class="s3">19</span><span class="s0">,</span><span class="s1">restrict</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s3">32</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">},</span><span class="s1">DRAG</span><span class="s0">:{</span><span class="s1">events</span><span class="s0">:</span><span class="s3">23</span><span class="s0">,</span><span class="s1">restrict</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s3">32</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">||</span><span class="s3">3</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">},</span><span class="s1">ANY</span><span class="s0">:{</span><span class="s1">events</span><span class="s0">:</span><span class="s3">31</span><span class="s0">,</span><span class="s1">restrict</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;!</span><span class="s3">0</span><span class="s0">}};</span><span class="s4">function </span><span class="s1">c</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrl</span><span class="s0">?</span><span class="s3">16</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)|(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">?</span><span class="s3">4</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)|(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">alt</span><span class="s0">?</span><span class="s3">8</span><span class="s0">:</span><span class="s3">0</span><span class="s0">);</span><span class="s4">return </span><span class="s3">4</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">?(</span><span class="s1">i</span><span class="s0">|=</span><span class="s3">64</span><span class="s0">,</span><span class="s1">i</span><span class="s0">|=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">):(</span><span class="s1">i</span><span class="s0">|=</span><span class="s3">3</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">,</span><span class="s3">4</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">|=</span><span class="s3">64</span><span class="s0">),</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">|=</span><span class="s3">128</span><span class="s0">),</span><span class="s3">32</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">?</span><span class="s1">i</span><span class="s0">|=</span><span class="s3">32</span><span class="s0">:</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">||</span><span class="s1">t</span><span class="s0">||(</span><span class="s1">i</span><span class="s0">|=</span><span class="s3">3</span><span class="s0">)),</span><span class="s1">i</span><span class="s0">}</span><span class="s4">const </span><span class="s1">l</span><span class="s0">=</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCharCode</span><span class="s0">,</span><span class="s1">d</span><span class="s0">={</span><span class="s1">DEFAULT</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=[</span><span class="s1">c</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">1</span><span class="s0">)+</span><span class="s3">32</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">col</span><span class="s0">+</span><span class="s3">32</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">row</span><span class="s0">+</span><span class="s3">32</span><span class="s0">];</span><span class="s4">return </span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&gt;</span><span class="s3">255</span><span class="s0">||</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&gt;</span><span class="s3">255</span><span class="s0">||</span><span class="s1">t</span><span class="s0">[</span><span class="s3">2</span><span class="s0">]&gt;</span><span class="s3">255</span><span class="s0">?</span><span class="s2">&quot;&quot;</span><span class="s0">:</span><span class="s2">`[M</span><span class="s1">$</span><span class="s0">{</span><span class="s1">l</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">l</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">])}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">l</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s3">2</span><span class="s0">])}</span><span class="s2">`</span><span class="s0">},</span><span class="s1">SGR</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">&amp;&amp;</span><span class="s3">4</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">?</span><span class="s2">&quot;m&quot;</span><span class="s0">:</span><span class="s2">&quot;M&quot;</span><span class="s0">;</span><span class="s4">return</span><span class="s2">`[&lt;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">c</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)}</span><span class="s2">;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">col</span><span class="s0">}</span><span class="s2">;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">row</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">}</span><span class="s2">`</span><span class="s0">},</span><span class="s1">SGR_PIXELS</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">&amp;&amp;</span><span class="s3">4</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">?</span><span class="s2">&quot;m&quot;</span><span class="s0">:</span><span class="s2">&quot;M&quot;</span><span class="s0">;</span><span class="s4">return</span><span class="s2">`[&lt;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">c</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)}</span><span class="s2">;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">x</span><span class="s0">}</span><span class="s2">;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">y</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">}</span><span class="s2">`</span><span class="s0">}};</span><span class="s4">let </span><span class="s1">_</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CoreMouseService</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">a</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_protocols</span><span class="s0">={},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_encodings</span><span class="s0">={},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProtocol</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeEncoding</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastEvent</span><span class="s0">=</span><span class="s4">null</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onProtocolChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onProtocolChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onProtocolChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">i of Object</span><span class="s0">.</span><span class="s1">keys</span><span class="s0">(</span><span class="s1">h</span><span class="s0">))</span><span class="s4">this</span><span class="s0">.</span><span class="s1">addProtocol</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">h</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">i of Object</span><span class="s0">.</span><span class="s1">keys</span><span class="s0">(</span><span class="s1">d</span><span class="s0">))</span><span class="s4">this</span><span class="s0">.</span><span class="s1">addEncoding</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">d</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">()}</span><span class="s1">addProtocol</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_protocols</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">}</span><span class="s1">addEncoding</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_encodings</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">}</span><span class="s1">get activeProtocol</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_activeProtocol</span><span class="s0">}</span><span class="s1">get areMouseEventsActive</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">0</span><span class="s0">!==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_protocols</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProtocol</span><span class="s0">].</span><span class="s1">events</span><span class="s0">}</span><span class="s1">set activeProtocol</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_protocols</span><span class="s0">[</span><span class="s1">e</span><span class="s0">])</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`unknown protocol &quot;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">&quot;`</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProtocol</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onProtocolChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_protocols</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">events</span><span class="s0">)}</span><span class="s1">get activeEncoding</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_activeEncoding</span><span class="s0">}</span><span class="s1">set activeEncoding</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_encodings</span><span class="s0">[</span><span class="s1">e</span><span class="s0">])</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`unknown encoding &quot;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">&quot;`</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeEncoding</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">activeProtocol</span><span class="s0">=</span><span class="s2">&quot;NONE&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">activeEncoding</span><span class="s0">=</span><span class="s2">&quot;DEFAULT&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastEvent</span><span class="s0">=</span><span class="s4">null</span><span class="s0">}</span><span class="s1">triggerMouseEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">col</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">col</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">row</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">row</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s3">4</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&amp;&amp;</span><span class="s3">32</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s3">3</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&amp;&amp;</span><span class="s3">32</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s3">4</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&amp;&amp;(</span><span class="s3">2</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">||</span><span class="s3">3</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">))</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">col</span><span class="s0">++,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">row</span><span class="s0">++,</span><span class="s3">32</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastEvent</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_equalEvents</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastEvent</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s2">&quot;SGR_PIXELS&quot;</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeEncoding</span><span class="s0">))</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_protocols</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProtocol</span><span class="s0">].</span><span class="s1">restrict</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_encodings</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeEncoding</span><span class="s0">](</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return </span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s2">&quot;DEFAULT&quot;</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeEncoding</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerBinaryEvent</span><span class="s0">(</span><span class="s1">t</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_coreService</span><span class="s0">.</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_lastEvent</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,!</span><span class="s3">0</span><span class="s0">}</span><span class="s1">explainEvents</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s0">{</span><span class="s1">down</span><span class="s0">:!!(</span><span class="s3">1</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">),</span><span class="s1">up</span><span class="s0">:!!(</span><span class="s3">2</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">),</span><span class="s1">drag</span><span class="s0">:!!(</span><span class="s3">4</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">),</span><span class="s1">move</span><span class="s0">:!!(</span><span class="s3">8</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">),</span><span class="s1">wheel</span><span class="s0">:!!(</span><span class="s3">16</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">)}}</span><span class="s1">_equalEvents</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">x</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">x</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">y</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">y</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">col</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">col</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">row</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">row</span><span class="s0">)</span><span class="s4">return</span><span class="s0">!</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">button</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">button</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">action</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">action</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ctrl</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ctrl</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">alt</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">alt</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">===</span><span class="s1">t</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CoreMouseService</span><span class="s0">=</span><span class="s1">_</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">ICoreService</span><span class="s0">)],</span><span class="s1">_</span><span class="s0">)},</span><span class="s3">6975</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CoreService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">1439</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">freeze</span><span class="s0">({</span><span class="s1">insertMode</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">}),</span><span class="s1">l</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">freeze</span><span class="s0">({</span><span class="s1">applicationCursorKeys</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">applicationKeypad</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">bracketedPasteMode</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">origin</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">reverseWraparound</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">sendFocus</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">wraparound</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">});</span><span class="s4">let </span><span class="s1">d</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CoreService</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">a</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isCursorInitialized</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">isCursorHidden</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onData</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onData</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onData</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onUserInput</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onUserInput</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onUserInput</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBinary</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onBinary</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBinary</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestScrollToBottom</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRequestScrollToBottom</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestScrollToBottom</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">modes</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">)(</span><span class="s1">c</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">)(</span><span class="s1">l</span><span class="s0">)}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">modes</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">)(</span><span class="s1">c</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">clone</span><span class="s0">)(</span><span class="s1">l</span><span class="s0">)}</span><span class="s1">triggerDataEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">disableStdin</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">scrollOnUserInput</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">!==</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ydisp</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onRequestScrollToBottom</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(),</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onUserInput</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">`sending data &quot;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">&quot;`</span><span class="s0">,(()=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s2">&quot;&quot;</span><span class="s0">).</span><span class="s1">map</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">))))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onData</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">triggerBinaryEvent</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">disableStdin</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logService</span><span class="s0">.</span><span class="s1">debug</span><span class="s0">(</span><span class="s2">`sending binary &quot;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">&quot;`</span><span class="s0">,(()=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s2">&quot;&quot;</span><span class="s0">).</span><span class="s1">map</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">))))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onBinary</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">CoreService</span><span class="s0">=</span><span class="s1">d</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">ILogService</span><span class="s0">),</span><span class="s1">r</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">)],</span><span class="s1">d</span><span class="s0">)},</span><span class="s3">9074</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DecorationService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8055</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6106</span><span class="s0">);</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">class </span><span class="s1">c </span><span class="s4">extends </span><span class="s1">n</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">get decorations</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_decorations</span><span class="s0">.</span><span class="s1">values</span><span class="s0">()}</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorations</span><span class="s0">=</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">SortedList</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">?.</span><span class="s1">marker</span><span class="s0">.</span><span class="s1">line</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDecorationRegistered</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onDecorationRegistered</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDecorationRegistered</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDecorationRemoved</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onDecorationRemoved</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDecorationRemoved</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">())))}</span><span class="s1">registerDecoration</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">.</span><span class="s1">isDisposed</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">new </span><span class="s1">l</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">.</span><span class="s1">onDispose</span><span class="s0">((()=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">()));</span><span class="s1">t</span><span class="s0">.</span><span class="s1">onDispose</span><span class="s0">((()=&gt;{</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorations</span><span class="s0">.</span><span class="s1">delete</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDecorationRemoved</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">())})),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorations</span><span class="s0">.</span><span class="s1">insert</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDecorationRegistered</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">return </span><span class="s1">t</span><span class="s0">}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">e of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorations</span><span class="s0">.</span><span class="s1">values</span><span class="s0">())</span><span class="s1">e</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorations</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">()}*</span><span class="s1">getDecorationsAtCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">n of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorations</span><span class="s0">.</span><span class="s1">getKeyIterator</span><span class="s0">(</span><span class="s1">t</span><span class="s0">))</span><span class="s1">s</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">x</span><span class="s0">??</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">s</span><span class="s0">+(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">width</span><span class="s0">??</span><span class="s3">1</span><span class="s0">),</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">r</span><span class="s0">&amp;&amp;(!</span><span class="s1">i</span><span class="s0">||(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">layer</span><span class="s0">??</span><span class="s2">&quot;bottom&quot;</span><span class="s0">)===</span><span class="s1">i</span><span class="s0">)&amp;&amp;(</span><span class="s4">yield </span><span class="s1">n</span><span class="s0">)}</span><span class="s1">forEachDecorationAtCell</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_decorations</span><span class="s0">.</span><span class="s1">forEachByKey</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,(</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s1">a</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">x</span><span class="s0">??</span><span class="s3">0</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s1">a</span><span class="s0">+(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">width</span><span class="s0">??</span><span class="s3">1</span><span class="s0">),</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s1">a</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">h</span><span class="s0">&amp;&amp;(!</span><span class="s1">i</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">layer</span><span class="s0">??</span><span class="s2">&quot;bottom&quot;</span><span class="s0">)===</span><span class="s1">i</span><span class="s0">)&amp;&amp;</span><span class="s1">s</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}))}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DecorationService</span><span class="s0">=</span><span class="s1">c</span><span class="s0">;</span><span class="s4">class </span><span class="s1">l </span><span class="s4">extends </span><span class="s1">n</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">get isDisposed</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_isDisposed</span><span class="s0">}</span><span class="s1">get backgroundColorRGB</span><span class="s0">(){</span><span class="s4">return null</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedBg</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">backgroundColor</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedBg</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">backgroundColor</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedBg</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedBg</span><span class="s0">}</span><span class="s1">get foregroundColorRGB</span><span class="s0">(){</span><span class="s4">return null</span><span class="s0">===</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedFg</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">foregroundColor</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedFg</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">css</span><span class="s0">.</span><span class="s1">toColor</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">foregroundColor</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedFg</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedFg</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRenderEmitter</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRender</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onRenderEmitter</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDispose</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onDispose</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDispose</span><span class="s0">.</span><span class="s1">event</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedBg</span><span class="s0">=</span><span class="s4">null</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_cachedFg</span><span class="s0">=</span><span class="s4">null</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">marker</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerOptions</span><span class="s0">&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerOptions</span><span class="s0">.</span><span class="s1">position</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">overviewRulerOptions</span><span class="s0">.</span><span class="s1">position</span><span class="s0">=</span><span class="s2">&quot;full&quot;</span><span class="s0">)}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onDispose</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(),</span><span class="s4">super</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">()}}},</span><span class="s3">4348</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">InstantiationService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ServiceCollection</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8343</span><span class="s0">);</span><span class="s4">class </span><span class="s1">n</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">...e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_entries</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Map</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const</span><span class="s0">[</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">]</span><span class="s1">of e</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_entries</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_entries</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">i</span><span class="s0">}</span><span class="s1">forEach</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const</span><span class="s0">[</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">]</span><span class="s1">of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">_entries</span><span class="s0">.</span><span class="s1">entries</span><span class="s0">())</span><span class="s1">e</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">has</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_entries</span><span class="s0">.</span><span class="s1">has</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_entries</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ServiceCollection</span><span class="s0">=</span><span class="s1">n</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">InstantiationService</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_services</span><span class="s0">=</span><span class="s4">new </span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_services</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">IInstantiationService</span><span class="s0">,</span><span class="s4">this</span><span class="s0">)}</span><span class="s1">setService</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_services</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">getService</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_services</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">createInstance</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">...t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">getServiceDependencies</span><span class="s0">)(</span><span class="s1">e</span><span class="s0">).</span><span class="s1">sort</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">index</span><span class="s0">-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">index</span><span class="s0">)),</span><span class="s1">s</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">r of i</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_services</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">id</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`[createInstance] </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">name</span><span class="s0">} </span><span class="s2">depends on UNKNOWN service </span><span class="s1">$</span><span class="s0">{</span><span class="s1">r</span><span class="s0">.</span><span class="s1">id</span><span class="s0">}</span><span class="s2">.`</span><span class="s0">);</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">?</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">index</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">!==</span><span class="s1">n</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`[createInstance] First service dependency of </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">name</span><span class="s0">} </span><span class="s2">at position </span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">} </span><span class="s2">conflicts with </span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">} </span><span class="s2">static arguments`</span><span class="s0">);</span><span class="s4">return new </span><span class="s1">e</span><span class="s0">(</span><span class="s1">...</span><span class="s0">[</span><span class="s1">...t</span><span class="s0">,</span><span class="s1">...s</span><span class="s0">])}}},</span><span class="s3">7866</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">traceCall</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">setTraceLogger</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">LogService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">),</span><span class="s1">a</span><span class="s0">={</span><span class="s1">trace</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">TRACE</span><span class="s0">,</span><span class="s1">debug</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">DEBUG</span><span class="s0">,</span><span class="s1">info</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">INFO</span><span class="s0">,</span><span class="s1">warn</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">WARN</span><span class="s0">,</span><span class="s1">error</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">ERROR</span><span class="s0">,</span><span class="s1">off</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">OFF</span><span class="s0">};</span><span class="s4">let </span><span class="s1">h</span><span class="s0">,</span><span class="s1">c</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">LogService</span><span class="s0">=</span><span class="s4">class extends </span><span class="s1">n</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">get logLevel</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_logLevel</span><span class="s0">}</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logLevel</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">OFF</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateLogLevel</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">onSpecificOptionChange</span><span class="s0">(</span><span class="s2">&quot;logLevel&quot;</span><span class="s0">,(()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_updateLogLevel</span><span class="s0">()))),</span><span class="s1">h</span><span class="s0">=</span><span class="s4">this</span><span class="s0">}</span><span class="s1">_updateLogLevel</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logLevel</span><span class="s0">=</span><span class="s1">a</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">logLevel</span><span class="s0">]}</span><span class="s1">_evalLazyOptionalParams</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]&amp;&amp;(</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]())}</span><span class="s1">_log</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_evalLazyOptionalParams</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">call</span><span class="s0">(</span><span class="s1">console</span><span class="s0">,(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">logger</span><span class="s0">?</span><span class="s2">&quot;&quot;</span><span class="s0">:</span><span class="s2">&quot;xterm.js: &quot;</span><span class="s0">)+</span><span class="s1">t</span><span class="s0">,</span><span class="s1">...i</span><span class="s0">)}</span><span class="s1">trace</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">...t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logLevel</span><span class="s0">&lt;=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">TRACE</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_log</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">logger</span><span class="s0">?.</span><span class="s1">trace</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">logger</span><span class="s0">)??</span><span class="s1">console</span><span class="s0">.</span><span class="s1">log</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">debug</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">...t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logLevel</span><span class="s0">&lt;=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">DEBUG</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_log</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">logger</span><span class="s0">?.</span><span class="s1">debug</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">logger</span><span class="s0">)??</span><span class="s1">console</span><span class="s0">.</span><span class="s1">log</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">info</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">...t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logLevel</span><span class="s0">&lt;=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">INFO</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_log</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">logger</span><span class="s0">?.</span><span class="s1">info</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">logger</span><span class="s0">)??</span><span class="s1">console</span><span class="s0">.</span><span class="s1">info</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">warn</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">...t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logLevel</span><span class="s0">&lt;=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">WARN</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_log</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">logger</span><span class="s0">?.</span><span class="s1">warn</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">logger</span><span class="s0">)??</span><span class="s1">console</span><span class="s0">.</span><span class="s1">warn</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">error</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">...t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_logLevel</span><span class="s0">&lt;=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">ERROR</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_log</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">logger</span><span class="s0">?.</span><span class="s1">error</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_optionsService</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">logger</span><span class="s0">)??</span><span class="s1">console</span><span class="s0">.</span><span class="s1">error</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">LogService</span><span class="s0">=</span><span class="s1">c</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">)],</span><span class="s1">c</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">setTraceLogger</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">h</span><span class="s0">=</span><span class="s1">e</span><span class="s0">},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">traceCall</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;function&quot;</span><span class="s0">!=</span><span class="s4">typeof </span><span class="s1">i</span><span class="s0">.</span><span class="s1">value</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;not supported&quot;</span><span class="s0">);</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">value</span><span class="s0">;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">...e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">.</span><span class="s1">logLevel</span><span class="s0">!==</span><span class="s1">o</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">.</span><span class="s1">TRACE</span><span class="s0">)</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">apply</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s1">h</span><span class="s0">.</span><span class="s1">trace</span><span class="s0">(</span><span class="s2">`GlyphRenderer#</span><span class="s1">$</span><span class="s0">{</span><span class="s1">s</span><span class="s0">.</span><span class="s1">name</span><span class="s0">}</span><span class="s2">(</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">JSON</span><span class="s0">.</span><span class="s1">stringify</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))).</span><span class="s1">join</span><span class="s0">(</span><span class="s2">&quot;, &quot;</span><span class="s0">)}</span><span class="s2">)`</span><span class="s0">);</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">apply</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return </span><span class="s1">h</span><span class="s0">.</span><span class="s1">trace</span><span class="s0">(</span><span class="s2">`GlyphRenderer#</span><span class="s1">$</span><span class="s0">{</span><span class="s1">s</span><span class="s0">.</span><span class="s1">name</span><span class="s0">} </span><span class="s2">return`</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">t</span><span class="s0">}}},</span><span class="s3">7302</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OptionsService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_OPTIONS</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">6114</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_OPTIONS</span><span class="s0">={</span><span class="s1">cols</span><span class="s0">:</span><span class="s3">80</span><span class="s0">,</span><span class="s1">rows</span><span class="s0">:</span><span class="s3">24</span><span class="s0">,</span><span class="s1">cursorBlink</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">cursorStyle</span><span class="s0">:</span><span class="s2">&quot;block&quot;</span><span class="s0">,</span><span class="s1">cursorWidth</span><span class="s0">:</span><span class="s3">1</span><span class="s0">,</span><span class="s1">cursorInactiveStyle</span><span class="s0">:</span><span class="s2">&quot;outline&quot;</span><span class="s0">,</span><span class="s1">customGlyphs</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">drawBoldTextInBrightColors</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">documentOverride</span><span class="s0">:</span><span class="s4">null</span><span class="s0">,</span><span class="s1">fastScrollModifier</span><span class="s0">:</span><span class="s2">&quot;alt&quot;</span><span class="s0">,</span><span class="s1">fastScrollSensitivity</span><span class="s0">:</span><span class="s3">5</span><span class="s0">,</span><span class="s1">fontFamily</span><span class="s0">:</span><span class="s2">&quot;courier-new, courier, monospace&quot;</span><span class="s0">,</span><span class="s1">fontSize</span><span class="s0">:</span><span class="s3">15</span><span class="s0">,</span><span class="s1">fontWeight</span><span class="s0">:</span><span class="s2">&quot;normal&quot;</span><span class="s0">,</span><span class="s1">fontWeightBold</span><span class="s0">:</span><span class="s2">&quot;bold&quot;</span><span class="s0">,</span><span class="s1">ignoreBracketedPasteMode</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">lineHeight</span><span class="s0">:</span><span class="s3">1</span><span class="s0">,</span><span class="s1">letterSpacing</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">linkHandler</span><span class="s0">:</span><span class="s4">null</span><span class="s0">,</span><span class="s1">logLevel</span><span class="s0">:</span><span class="s2">&quot;info&quot;</span><span class="s0">,</span><span class="s1">logger</span><span class="s0">:</span><span class="s4">null</span><span class="s0">,</span><span class="s1">scrollback</span><span class="s0">:</span><span class="s3">1e3</span><span class="s0">,</span><span class="s1">scrollOnUserInput</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">scrollSensitivity</span><span class="s0">:</span><span class="s3">1</span><span class="s0">,</span><span class="s1">screenReaderMode</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">smoothScrollDuration</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">macOptionIsMeta</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">macOptionClickForcesSelection</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">minimumContrastRatio</span><span class="s0">:</span><span class="s3">1</span><span class="s0">,</span><span class="s1">disableStdin</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">allowProposedApi</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">allowTransparency</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">tabStopWidth</span><span class="s0">:</span><span class="s3">8</span><span class="s0">,</span><span class="s1">theme</span><span class="s0">:{},</span><span class="s1">rescaleOverlappingGlyphs</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">rightClickSelectsWord</span><span class="s0">:</span><span class="s1">n</span><span class="s0">.</span><span class="s1">isMac</span><span class="s0">,</span><span class="s1">windowOptions</span><span class="s0">:{},</span><span class="s1">windowsMode</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">windowsPty</span><span class="s0">:{},</span><span class="s1">wordSeparator</span><span class="s0">:</span><span class="s2">&quot; ()[]{}',</span><span class="s4">\&quot;</span><span class="s2">`&quot;</span><span class="s0">,</span><span class="s1">altClickMovesCursor</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">,</span><span class="s1">convertEol</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">termName</span><span class="s0">:</span><span class="s2">&quot;xterm&quot;</span><span class="s0">,</span><span class="s1">cancelEvents</span><span class="s0">:!</span><span class="s3">1</span><span class="s0">,</span><span class="s1">overviewRulerWidth</span><span class="s0">:</span><span class="s3">0</span><span class="s0">};</span><span class="s4">const </span><span class="s1">o</span><span class="s0">=[</span><span class="s2">&quot;normal&quot;</span><span class="s0">,</span><span class="s2">&quot;bold&quot;</span><span class="s0">,</span><span class="s2">&quot;100&quot;</span><span class="s0">,</span><span class="s2">&quot;200&quot;</span><span class="s0">,</span><span class="s2">&quot;300&quot;</span><span class="s0">,</span><span class="s2">&quot;400&quot;</span><span class="s0">,</span><span class="s2">&quot;500&quot;</span><span class="s0">,</span><span class="s2">&quot;600&quot;</span><span class="s0">,</span><span class="s2">&quot;700&quot;</span><span class="s0">,</span><span class="s2">&quot;800&quot;</span><span class="s0">,</span><span class="s2">&quot;900&quot;</span><span class="s0">];</span><span class="s4">class </span><span class="s1">a </span><span class="s4">extends </span><span class="s1">r</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onOptionChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onOptionChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onOptionChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">={</span><span class="s1">...t</span><span class="s0">.</span><span class="s1">DEFAULT_OPTIONS</span><span class="s0">};</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t </span><span class="s4">in </span><span class="s1">e</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t </span><span class="s4">in </span><span class="s1">i</span><span class="s0">)</span><span class="s4">try</span><span class="s0">{</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">];</span><span class="s1">i</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_sanitizeAndValidateOption</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">console</span><span class="s0">.</span><span class="s1">error</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">={</span><span class="s1">...i</span><span class="s0">},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_setupOptions</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">toDisposable</span><span class="s0">)((()=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">linkHandler</span><span class="s0">=</span><span class="s4">null</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">documentOverride</span><span class="s0">=</span><span class="s4">null</span><span class="s0">})))}</span><span class="s1">onSpecificOptionChange</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">onOptionChange</span><span class="s0">((</span><span class="s1">i</span><span class="s0">=&gt;{</span><span class="s1">i</span><span class="s0">===</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">[</span><span class="s1">e</span><span class="s0">])}))}</span><span class="s1">onMultipleOptionChange</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">onOptionChange</span><span class="s0">((</span><span class="s1">i</span><span class="s0">=&gt;{-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)&amp;&amp;</span><span class="s1">t</span><span class="s0">()}))}</span><span class="s1">_setupOptions</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(!(</span><span class="s1">e </span><span class="s4">in </span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_OPTIONS</span><span class="s0">))</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`No option with key &quot;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">&quot;`</span><span class="s0">);</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]},</span><span class="s1">i</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s4">if</span><span class="s0">(!(</span><span class="s1">e </span><span class="s4">in </span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_OPTIONS</span><span class="s0">))</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`No option with key &quot;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">&quot;`</span><span class="s0">);</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_sanitizeAndValidateOption</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]!==</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onOptionChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))};</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t </span><span class="s4">in this</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">={</span><span class="s1">get</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">set</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)}}</span><span class="s1">_sanitizeAndValidateOption</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">switch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">case</span><span class="s2">&quot;cursorStyle&quot;</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">||(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_OPTIONS</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]),!</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s2">&quot;block&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">||</span><span class="s2">&quot;underline&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">||</span><span class="s2">&quot;bar&quot;</span><span class="s0">===</span><span class="s1">e</span><span class="s0">}(</span><span class="s1">i</span><span class="s0">))</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`&quot;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">}</span><span class="s2">&quot; is not a valid value for </span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;wordSeparator&quot;</span><span class="s0">:</span><span class="s1">i</span><span class="s0">||(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_OPTIONS</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;fontWeight&quot;</span><span class="s0">:</span><span class="s4">case</span><span class="s2">&quot;fontWeightBold&quot;</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;number&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s3">1</span><span class="s0">&lt;=</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s3">1e3</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s1">i</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">includes</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)?</span><span class="s1">i</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">DEFAULT_OPTIONS</span><span class="s0">[</span><span class="s1">e</span><span class="s0">];</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;cursorWidth&quot;</span><span class="s0">:</span><span class="s1">i</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s4">case</span><span class="s2">&quot;lineHeight&quot;</span><span class="s0">:</span><span class="s4">case</span><span class="s2">&quot;tabStopWidth&quot;</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s3">1</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">} </span><span class="s2">cannot be less than 1, value: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">}</span><span class="s2">`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;minimumContrastRatio&quot;</span><span class="s0">:</span><span class="s1">i</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s3">21</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">round</span><span class="s0">(</span><span class="s3">10</span><span class="s0">*</span><span class="s1">i</span><span class="s0">)/</span><span class="s3">10</span><span class="s0">));</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;scrollback&quot;</span><span class="s0">:</span><span class="s4">if</span><span class="s0">((</span><span class="s1">i</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s3">4294967295</span><span class="s0">))&lt;</span><span class="s3">0</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">} </span><span class="s2">cannot be less than 0, value: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">}</span><span class="s2">`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;fastScrollSensitivity&quot;</span><span class="s0">:</span><span class="s4">case</span><span class="s2">&quot;scrollSensitivity&quot;</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s3">0</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">} </span><span class="s2">cannot be less than or equal to 0, value: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">}</span><span class="s2">`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;rows&quot;</span><span class="s0">:</span><span class="s4">case</span><span class="s2">&quot;cols&quot;</span><span class="s0">:</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s3">0</span><span class="s0">!==</span><span class="s1">i</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">} </span><span class="s2">must be numeric, value: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">}</span><span class="s2">`</span><span class="s0">);</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;windowsPty&quot;</span><span class="s0">:</span><span class="s1">i</span><span class="s0">=</span><span class="s1">i</span><span class="s0">??{}}</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OptionsService</span><span class="s0">=</span><span class="s1">a</span><span class="s0">},</span><span class="s3">2660</span><span class="s0">:</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__decorate</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">===</span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">):</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;object&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">&amp;&amp;</span><span class="s2">&quot;function&quot;</span><span class="s0">==</span><span class="s4">typeof </span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">Reflect</span><span class="s0">.</span><span class="s1">decorate</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">else for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">--)(</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">a</span><span class="s0">])&amp;&amp;(</span><span class="s1">o</span><span class="s0">=(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">o</span><span class="s0">):</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">?</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">):</span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))||</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">3</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">},</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">__param</span><span class="s0">||</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return function</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">t</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OscLinkService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">2585</span><span class="s0">);</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OscLinkService</span><span class="s0">=</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nextId</span><span class="s0">=</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_entriesWithId</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Map</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dataByLinkId</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Map</span><span class="s0">}</span><span class="s1">registerLink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">id</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">addMarker</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),</span><span class="s1">s</span><span class="s0">={</span><span class="s1">data</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">id</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nextId</span><span class="s0">++,</span><span class="s1">lines</span><span class="s0">:[</span><span class="s1">i</span><span class="s0">]};</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">onDispose</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_removeMarkerFromLink</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dataByLinkId</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">id</span><span class="s0">,</span><span class="s1">s</span><span class="s0">),</span><span class="s1">s</span><span class="s0">.</span><span class="s1">id</span><span class="s0">}</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getEntryIdKey</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_entriesWithId</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">addLineToLink</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">id</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),</span><span class="s1">r</span><span class="s0">.</span><span class="s1">id</span><span class="s0">;</span><span class="s4">const </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">addMarker</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ybase</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">y</span><span class="s0">),</span><span class="s1">o</span><span class="s0">={</span><span class="s1">id</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_nextId</span><span class="s0">++,</span><span class="s1">key</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_getEntryIdKey</span><span class="s0">(</span><span class="s1">i</span><span class="s0">),</span><span class="s1">data</span><span class="s0">:</span><span class="s1">i</span><span class="s0">,</span><span class="s1">lines</span><span class="s0">:[</span><span class="s1">n</span><span class="s0">]};</span><span class="s4">return </span><span class="s1">n</span><span class="s0">.</span><span class="s1">onDispose</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_removeMarkerFromLink</span><span class="s0">(</span><span class="s1">o</span><span class="s0">,</span><span class="s1">n</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_entriesWithId</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">key</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dataByLinkId</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">id</span><span class="s0">,</span><span class="s1">o</span><span class="s0">),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">id</span><span class="s0">}</span><span class="s1">addLineToLink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dataByLinkId</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">every</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">line</span><span class="s0">!==</span><span class="s1">t</span><span class="s0">))){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_bufferService</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">addMarker</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s1">i</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">onDispose</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_removeMarkerFromLink</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)))}}</span><span class="s1">getLinkData</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_dataByLinkId</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)?.</span><span class="s1">data</span><span class="s0">}</span><span class="s1">_getEntryIdKey</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">id</span><span class="s0">}</span><span class="s2">;;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">uri</span><span class="s0">}</span><span class="s2">`</span><span class="s0">}</span><span class="s1">_removeMarkerFromLink</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);-</span><span class="s3">1</span><span class="s0">!==</span><span class="s1">i</span><span class="s0">&amp;&amp;(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s3">1</span><span class="s0">),</span><span class="s3">0</span><span class="s0">===</span><span class="s1">e</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">data</span><span class="s0">.</span><span class="s1">id</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_entriesWithId</span><span class="s0">.</span><span class="s1">delete</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">key</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_dataByLinkId</span><span class="s0">.</span><span class="s1">delete</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">id</span><span class="s0">)))}};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">OscLinkService</span><span class="s0">=</span><span class="s1">o</span><span class="s0">=</span><span class="s1">s</span><span class="s0">([</span><span class="s1">r</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">)],</span><span class="s1">o</span><span class="s0">)},</span><span class="s3">8343</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getServiceDependencies</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">serviceRegistry</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s2">&quot;di$target&quot;</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s2">&quot;di$dependencies&quot;</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">serviceRegistry</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Map</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getServiceDependencies</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]||[]},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">serviceRegistry</span><span class="s0">.</span><span class="s1">has</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">serviceRegistry</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">const </span><span class="s1">r</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s3">3</span><span class="s0">!==</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;@IServiceName-decorator can only be used to decorate a parameter&quot;</span><span class="s0">);!</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">r</span><span class="s0">){</span><span class="s1">t</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]===</span><span class="s1">t</span><span class="s0">?</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">push</span><span class="s0">({</span><span class="s1">id</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">index</span><span class="s0">:</span><span class="s1">r</span><span class="s0">}):(</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]=[{</span><span class="s1">id</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">index</span><span class="s0">:</span><span class="s1">r</span><span class="s0">}],</span><span class="s1">t</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">)}(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)};</span><span class="s4">return </span><span class="s1">r</span><span class="s0">.</span><span class="s1">toString</span><span class="s0">=()=&gt;</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">serviceRegistry</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">r</span><span class="s0">),</span><span class="s1">r</span><span class="s0">}},</span><span class="s3">2585</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IDecorationService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IUnicodeService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IOscLinkService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ILogService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IInstantiationService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ICharsetService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ICoreService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ICoreMouseService</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8343</span><span class="s0">);</span><span class="s4">var </span><span class="s1">r</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IBufferService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;BufferService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ICoreMouseService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;CoreMouseService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ICoreService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;CoreService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ICharsetService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;CharsetService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IInstantiationService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;InstantiationService&quot;</span><span class="s0">),</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">e</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">TRACE</span><span class="s0">=</span><span class="s3">0</span><span class="s0">]=</span><span class="s2">&quot;TRACE&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">DEBUG</span><span class="s0">=</span><span class="s3">1</span><span class="s0">]=</span><span class="s2">&quot;DEBUG&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">INFO</span><span class="s0">=</span><span class="s3">2</span><span class="s0">]=</span><span class="s2">&quot;INFO&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">WARN</span><span class="s0">=</span><span class="s3">3</span><span class="s0">]=</span><span class="s2">&quot;WARN&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ERROR</span><span class="s0">=</span><span class="s3">4</span><span class="s0">]=</span><span class="s2">&quot;ERROR&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">OFF</span><span class="s0">=</span><span class="s3">5</span><span class="s0">]=</span><span class="s2">&quot;OFF&quot;</span><span class="s0">}(</span><span class="s1">r</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">LogLevelEnum</span><span class="s0">=</span><span class="s1">r</span><span class="s0">={})),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ILogService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;LogService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IOptionsService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;OptionsService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IOscLinkService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;OscLinkService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IUnicodeService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;UnicodeService&quot;</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">IDecorationService</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">createDecorator</span><span class="s0">)(</span><span class="s2">&quot;DecorationService&quot;</span><span class="s0">)},</span><span class="s3">1480</span><span class="s0">:(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">UnicodeService</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8460</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">225</span><span class="s0">);</span><span class="s4">class </span><span class="s1">n</span><span class="s0">{</span><span class="s4">static </span><span class="s1">extractShouldJoin</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s3">0</span><span class="s0">!=(</span><span class="s3">1</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">static </span><span class="s1">extractWidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">1</span><span class="s0">&amp;</span><span class="s3">3</span><span class="s0">}</span><span class="s4">static </span><span class="s1">extractCharKind</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">3</span><span class="s0">}</span><span class="s4">static </span><span class="s1">createPropertyValue</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=!</span><span class="s3">1</span><span class="s0">){</span><span class="s4">return</span><span class="s0">(</span><span class="s3">16777215</span><span class="s0">&amp;</span><span class="s1">e</span><span class="s0">)&lt;&lt;</span><span class="s3">3</span><span class="s0">|(</span><span class="s3">3</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">)&lt;&lt;</span><span class="s3">1</span><span class="s0">|(</span><span class="s1">i</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_providers</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onChange</span><span class="s0">=</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">EventEmitter</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">onChange</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onChange</span><span class="s0">.</span><span class="s1">event</span><span class="s0">;</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">r</span><span class="s0">.</span><span class="s1">UnicodeV6</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">version</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProvider</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onChange</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">()}</span><span class="s1">get versions</span><span class="s0">(){</span><span class="s4">return </span><span class="s1">Object</span><span class="s0">.</span><span class="s1">keys</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_providers</span><span class="s0">)}</span><span class="s1">get activeVersion</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">}</span><span class="s1">set activeVersion</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_providers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">])</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`unknown Unicode version &quot;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">&quot;`</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_active</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_activeProvider</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_providers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_onChange</span><span class="s0">.</span><span class="s1">fire</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">register</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_providers</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">version</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">wcwidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_activeProvider</span><span class="s0">.</span><span class="s1">wcwidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">getStringCellWidth</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">;++</span><span class="s1">r</span><span class="s0">){</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s1">r</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s3">55296</span><span class="s0">&lt;=</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">&lt;=</span><span class="s3">56319</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(++</span><span class="s1">r</span><span class="s0">&gt;=</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return </span><span class="s1">t</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">wcwidth</span><span class="s0">(</span><span class="s1">o</span><span class="s0">);</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s1">r</span><span class="s0">);</span><span class="s3">56320</span><span class="s0">&lt;=</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">&lt;=</span><span class="s3">57343</span><span class="s0">?</span><span class="s1">o</span><span class="s0">=</span><span class="s3">1024</span><span class="s0">*(</span><span class="s1">o</span><span class="s0">-</span><span class="s3">55296</span><span class="s0">)+</span><span class="s1">i</span><span class="s0">-</span><span class="s3">56320</span><span class="s0">+</span><span class="s3">65536</span><span class="s0">:</span><span class="s1">t</span><span class="s0">+=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">wcwidth</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)}</span><span class="s4">const </span><span class="s1">a</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">charProperties</span><span class="s0">(</span><span class="s1">o</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">extractWidth</span><span class="s0">(</span><span class="s1">a</span><span class="s0">);</span><span class="s1">n</span><span class="s0">.</span><span class="s1">extractShouldJoin</span><span class="s0">(</span><span class="s1">a</span><span class="s0">)&amp;&amp;(</span><span class="s1">h</span><span class="s0">-=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">extractWidth</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)),</span><span class="s1">t</span><span class="s0">+=</span><span class="s1">h</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s1">a</span><span class="s0">}</span><span class="s4">return </span><span class="s1">t</span><span class="s0">}</span><span class="s1">charProperties</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_activeProvider</span><span class="s0">.</span><span class="s1">charProperties</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">UnicodeService</span><span class="s0">=</span><span class="s1">n</span><span class="s0">}},</span><span class="s1">t</span><span class="s0">={};</span><span class="s4">function </span><span class="s1">i</span><span class="s0">(</span><span class="s1">s</span><span class="s0">){</span><span class="s4">var </span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s4">void </span><span class="s3">0</span><span class="s0">!==</span><span class="s1">r</span><span class="s0">)</span><span class="s4">return </span><span class="s1">r</span><span class="s0">.</span><span class="s1">exports</span><span class="s0">;</span><span class="s4">var </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]={</span><span class="s1">exports</span><span class="s0">:{}};</span><span class="s4">return </span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">call</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">exports</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">exports</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s1">n</span><span class="s0">.</span><span class="s1">exports</span><span class="s0">}</span><span class="s4">var </span><span class="s1">r</span><span class="s0">={};</span><span class="s4">return</span><span class="s0">(()=&gt;{</span><span class="s4">var </span><span class="s1">e</span><span class="s0">=</span><span class="s1">r</span><span class="s0">;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s2">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s1">value</span><span class="s0">:!</span><span class="s3">0</span><span class="s0">}),</span><span class="s1">e</span><span class="s0">.</span><span class="s1">Terminal</span><span class="s0">=</span><span class="s4">void </span><span class="s3">0</span><span class="s0">;</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">9042</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">3236</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">844</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">5741</span><span class="s0">),</span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">8285</span><span class="s0">),</span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">7975</span><span class="s0">),</span><span class="s1">c</span><span class="s0">=</span><span class="s1">i</span><span class="s0">(</span><span class="s3">7090</span><span class="s0">),</span><span class="s1">l</span><span class="s0">=[</span><span class="s2">&quot;cols&quot;</span><span class="s0">,</span><span class="s2">&quot;rows&quot;</span><span class="s0">];</span><span class="s4">class </span><span class="s1">d </span><span class="s4">extends </span><span class="s1">n</span><span class="s0">.</span><span class="s1">Disposable</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">s</span><span class="s0">.</span><span class="s1">Terminal</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addonManager</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">o</span><span class="s0">.</span><span class="s1">AddonManager</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_publicOptions</span><span class="s0">={</span><span class="s1">...</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">options</span><span class="s0">};</span><span class="s4">const </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">options</span><span class="s0">[</span><span class="s1">e</span><span class="s0">],</span><span class="s1">i</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_checkReadonlyOptions</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">options</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">};</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">s </span><span class="s4">in this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">options</span><span class="s0">){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">={</span><span class="s1">get</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">s</span><span class="s0">),</span><span class="s1">set</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">bind</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)};</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">defineProperty</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_publicOptions</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}}</span><span class="s1">_checkReadonlyOptions</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">includes</span><span class="s0">(</span><span class="s1">e</span><span class="s0">))</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">`Option &quot;</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">&quot; can only be set in the constructor`</span><span class="s0">)}</span><span class="s1">_checkProposedApi</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">optionsService</span><span class="s0">.</span><span class="s1">rawOptions</span><span class="s0">.</span><span class="s1">allowProposedApi</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;You must set the allowProposedApi option to true to use proposed API&quot;</span><span class="s0">)}</span><span class="s1">get onBell</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">onBell</span><span class="s0">}</span><span class="s1">get onBinary</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">onBinary</span><span class="s0">}</span><span class="s1">get onCursorMove</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">onCursorMove</span><span class="s0">}</span><span class="s1">get onData</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">onData</span><span class="s0">}</span><span class="s1">get onKey</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">onKey</span><span class="s0">}</span><span class="s1">get onLineFeed</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">onLineFeed</span><span class="s0">}</span><span class="s1">get onRender</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">onRender</span><span class="s0">}</span><span class="s1">get onResize</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">onResize</span><span class="s0">}</span><span class="s1">get onScroll</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">onScroll</span><span class="s0">}</span><span class="s1">get onSelectionChange</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">onSelectionChange</span><span class="s0">}</span><span class="s1">get onTitleChange</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">onTitleChange</span><span class="s0">}</span><span class="s1">get onWriteParsed</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">onWriteParsed</span><span class="s0">}</span><span class="s1">get element</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">element</span><span class="s0">}</span><span class="s1">get parser</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">=</span><span class="s4">new </span><span class="s1">h</span><span class="s0">.</span><span class="s1">ParserApi</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">)),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_parser</span><span class="s0">}</span><span class="s1">get unicode</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_checkProposedApi</span><span class="s0">(),</span><span class="s4">new </span><span class="s1">c</span><span class="s0">.</span><span class="s1">UnicodeApi</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">)}</span><span class="s1">get textarea</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">textarea</span><span class="s0">}</span><span class="s1">get rows</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">rows</span><span class="s0">}</span><span class="s1">get cols</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">cols</span><span class="s0">}</span><span class="s1">get buffer</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_buffer</span><span class="s0">||(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_buffer</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">register</span><span class="s0">(</span><span class="s4">new </span><span class="s1">a</span><span class="s0">.</span><span class="s1">BufferNamespaceApi</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">))),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_buffer</span><span class="s0">}</span><span class="s1">get markers</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_checkProposedApi</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">markers</span><span class="s0">}</span><span class="s1">get modes</span><span class="s0">(){</span><span class="s4">const </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">decPrivateModes</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s2">&quot;none&quot;</span><span class="s0">;</span><span class="s4">switch</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">coreMouseService</span><span class="s0">.</span><span class="s1">activeProtocol</span><span class="s0">){</span><span class="s4">case</span><span class="s2">&quot;X10&quot;</span><span class="s0">:</span><span class="s1">t</span><span class="s0">=</span><span class="s2">&quot;x10&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;VT200&quot;</span><span class="s0">:</span><span class="s1">t</span><span class="s0">=</span><span class="s2">&quot;vt200&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;DRAG&quot;</span><span class="s0">:</span><span class="s1">t</span><span class="s0">=</span><span class="s2">&quot;drag&quot;</span><span class="s0">;</span><span class="s4">break</span><span class="s0">;</span><span class="s4">case</span><span class="s2">&quot;ANY&quot;</span><span class="s0">:</span><span class="s1">t</span><span class="s0">=</span><span class="s2">&quot;any&quot;</span><span class="s0">}</span><span class="s4">return</span><span class="s0">{</span><span class="s1">applicationCursorKeysMode</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">applicationCursorKeys</span><span class="s0">,</span><span class="s1">applicationKeypadMode</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">applicationKeypad</span><span class="s0">,</span><span class="s1">bracketedPasteMode</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bracketedPasteMode</span><span class="s0">,</span><span class="s1">insertMode</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">coreService</span><span class="s0">.</span><span class="s1">modes</span><span class="s0">.</span><span class="s1">insertMode</span><span class="s0">,</span><span class="s1">mouseTrackingMode</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">originMode</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">origin</span><span class="s0">,</span><span class="s1">reverseWraparoundMode</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">reverseWraparound</span><span class="s0">,</span><span class="s1">sendFocusMode</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">sendFocus</span><span class="s0">,</span><span class="s1">wraparoundMode</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">wraparound</span><span class="s0">}}</span><span class="s1">get options</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_publicOptions</span><span class="s0">}</span><span class="s1">set options</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t </span><span class="s4">in </span><span class="s1">e</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_publicOptions</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]}</span><span class="s1">blur</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">blur</span><span class="s0">()}</span><span class="s1">focus</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">focus</span><span class="s0">()}</span><span class="s1">input</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">=!</span><span class="s3">0</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">input</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_verifyIntegers</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">resize</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">open</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">open</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">attachCustomKeyEventHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">attachCustomKeyEventHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">attachCustomWheelEventHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">attachCustomWheelEventHandler</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">registerLinkProvider</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">registerLinkProvider</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">registerCharacterJoiner</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_checkProposedApi</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">registerCharacterJoiner</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">deregisterCharacterJoiner</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_checkProposedApi</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">deregisterCharacterJoiner</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">registerMarker</span><span class="s0">(</span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_verifyIntegers</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">registerMarker</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">registerDecoration</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_checkProposedApi</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_verifyPositiveIntegers</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">x</span><span class="s0">??</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">width</span><span class="s0">??</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">height</span><span class="s0">??</span><span class="s3">0</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">registerDecoration</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">hasSelection</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">hasSelection</span><span class="s0">()}</span><span class="s1">select</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_verifyIntegers</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">select</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">getSelection</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">getSelection</span><span class="s0">()}</span><span class="s1">getSelectionPosition</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">getSelectionPosition</span><span class="s0">()}</span><span class="s1">clearSelection</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">clearSelection</span><span class="s0">()}</span><span class="s1">selectAll</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">selectAll</span><span class="s0">()}</span><span class="s1">selectLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_verifyIntegers</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">selectLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">dispose</span><span class="s0">(){</span><span class="s4">super</span><span class="s0">.</span><span class="s1">dispose</span><span class="s0">()}</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_verifyIntegers</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">scrollLines</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">scrollPages</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_verifyIntegers</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">scrollPages</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">scrollToTop</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">scrollToTop</span><span class="s0">()}</span><span class="s1">scrollToBottom</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">scrollToBottom</span><span class="s0">()}</span><span class="s1">scrollToLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_verifyIntegers</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">scrollToLine</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">clear</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">clear</span><span class="s0">()}</span><span class="s1">write</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">write</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">writeln</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">write</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">write</span><span class="s0">(</span><span class="s2">&quot;</span><span class="s4">\r\n</span><span class="s2">&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">paste</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">paste</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">refresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_verifyIntegers</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">refresh</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">reset</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">()}</span><span class="s1">clearTextureAtlas</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_core</span><span class="s0">.</span><span class="s1">clearTextureAtlas</span><span class="s0">()}</span><span class="s1">loadAddon</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">_addonManager</span><span class="s0">.</span><span class="s1">loadAddon</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">static </span><span class="s1">get strings</span><span class="s0">(){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">}</span><span class="s1">_verifyIntegers</span><span class="s0">(</span><span class="s1">...e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t of e</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">===</span><span class="s3">1</span><span class="s0">/</span><span class="s3">0</span><span class="s0">||</span><span class="s1">isNaN</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)||</span><span class="s1">t</span><span class="s0">%</span><span class="s3">1</span><span class="s0">!=</span><span class="s3">0</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;This API only accepts integers&quot;</span><span class="s0">)}</span><span class="s1">_verifyPositiveIntegers</span><span class="s0">(</span><span class="s1">...e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">const </span><span class="s1">t of e</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">===</span><span class="s3">1</span><span class="s0">/</span><span class="s3">0</span><span class="s0">||</span><span class="s1">isNaN</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)||</span><span class="s1">t</span><span class="s0">%</span><span class="s3">1</span><span class="s0">!=</span><span class="s3">0</span><span class="s0">||</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">))</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;This API only accepts positive integers&quot;</span><span class="s0">)}}</span><span class="s1">e</span><span class="s0">.</span><span class="s1">Terminal</span><span class="s0">=</span><span class="s1">d</span><span class="s0">})(),</span><span class="s1">r</span><span class="s0">})()))},</span><span class="s3">65606</span><span class="s0">:</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">var </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">exports</span><span class="s0">={};</span><span class="s4">var </span><span class="s1">i</span><span class="s0">;</span><span class="s4">var </span><span class="s1">s</span><span class="s0">;</span><span class="s4">function </span><span class="s1">r</span><span class="s0">(){</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;setTimeout has not been defined&quot;</span><span class="s0">)}</span><span class="s4">function </span><span class="s1">n</span><span class="s0">(){</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;clearTimeout has not been defined&quot;</span><span class="s0">)}(</span><span class="s4">function</span><span class="s0">(){</span><span class="s4">try</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s4">typeof </span><span class="s1">setTimeout</span><span class="s0">===</span><span class="s2">&quot;function&quot;</span><span class="s0">){</span><span class="s1">i</span><span class="s0">=</span><span class="s1">setTimeout</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">i</span><span class="s0">=</span><span class="s1">r</span><span class="s0">}}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">i</span><span class="s0">=</span><span class="s1">r</span><span class="s0">}</span><span class="s4">try</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s4">typeof </span><span class="s1">clearTimeout</span><span class="s0">===</span><span class="s2">&quot;function&quot;</span><span class="s0">){</span><span class="s1">s</span><span class="s0">=</span><span class="s1">clearTimeout</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">s</span><span class="s0">=</span><span class="s1">n</span><span class="s0">}}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">s</span><span class="s0">=</span><span class="s1">n</span><span class="s0">}})();</span><span class="s4">function </span><span class="s1">o</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">===</span><span class="s1">setTimeout</span><span class="s0">){</span><span class="s4">return </span><span class="s1">setTimeout</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">((</span><span class="s1">i</span><span class="s0">===</span><span class="s1">r</span><span class="s0">||!</span><span class="s1">i</span><span class="s0">)&amp;&amp;</span><span class="s1">setTimeout</span><span class="s0">){</span><span class="s1">i</span><span class="s0">=</span><span class="s1">setTimeout</span><span class="s0">;</span><span class="s4">return </span><span class="s1">setTimeout</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">try</span><span class="s0">{</span><span class="s4">return </span><span class="s1">i</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">try</span><span class="s0">{</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">call</span><span class="s0">(</span><span class="s4">null</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">call</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}}}</span><span class="s4">function </span><span class="s1">a</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">===</span><span class="s1">clearTimeout</span><span class="s0">){</span><span class="s4">return </span><span class="s1">clearTimeout</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">((</span><span class="s1">s</span><span class="s0">===</span><span class="s1">n</span><span class="s0">||!</span><span class="s1">s</span><span class="s0">)&amp;&amp;</span><span class="s1">clearTimeout</span><span class="s0">){</span><span class="s1">s</span><span class="s0">=</span><span class="s1">clearTimeout</span><span class="s0">;</span><span class="s4">return </span><span class="s1">clearTimeout</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">try</span><span class="s0">{</span><span class="s4">return </span><span class="s1">s</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">try</span><span class="s0">{</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">call</span><span class="s0">(</span><span class="s4">null</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">call</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}}}</span><span class="s4">var </span><span class="s1">h</span><span class="s0">=[];</span><span class="s4">var </span><span class="s1">c</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">var </span><span class="s1">l</span><span class="s0">;</span><span class="s4">var </span><span class="s1">d</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">function </span><span class="s1">_</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">c</span><span class="s0">||!</span><span class="s1">l</span><span class="s0">){</span><span class="s4">return</span><span class="s0">}</span><span class="s1">c</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s1">h</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">concat</span><span class="s0">(</span><span class="s1">h</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">d</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s1">u</span><span class="s0">()}}</span><span class="s4">function </span><span class="s1">u</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">c</span><span class="s0">){</span><span class="s4">return</span><span class="s0">}</span><span class="s4">var </span><span class="s1">e</span><span class="s0">=</span><span class="s1">o</span><span class="s0">(</span><span class="s1">_</span><span class="s0">);</span><span class="s1">c</span><span class="s0">=</span><span class="s4">true</span><span class="s0">;</span><span class="s4">var </span><span class="s1">t</span><span class="s0">=</span><span class="s1">h</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s1">l</span><span class="s0">=</span><span class="s1">h</span><span class="s0">;</span><span class="s1">h</span><span class="s0">=[];</span><span class="s4">while</span><span class="s0">(++</span><span class="s1">d</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">){</span><span class="s1">l</span><span class="s0">[</span><span class="s1">d</span><span class="s0">].</span><span class="s1">run</span><span class="s0">()}}</span><span class="s1">d</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">t</span><span class="s0">=</span><span class="s1">h</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}</span><span class="s1">l</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s1">c</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s1">a</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">nextTick</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">var </span><span class="s1">t</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Array</span><span class="s0">(</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">i</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++){</span><span class="s1">t</span><span class="s0">[</span><span class="s1">i</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">arguments</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]}}</span><span class="s1">h</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">new </span><span class="s1">f</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">.</span><span class="s1">length</span><span class="s0">===</span><span class="s3">1</span><span class="s0">&amp;&amp;!</span><span class="s1">c</span><span class="s0">){</span><span class="s1">o</span><span class="s0">(</span><span class="s1">u</span><span class="s0">)}};</span><span class="s4">function </span><span class="s1">f</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fun</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">array</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s1">f</span><span class="s0">.</span><span class="s1">prototype</span><span class="s0">.</span><span class="s1">run</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fun</span><span class="s0">.</span><span class="s1">apply</span><span class="s0">(</span><span class="s4">null</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">array</span><span class="s0">)};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">title</span><span class="s0">=</span><span class="s2">&quot;browser&quot;</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">browser</span><span class="s0">=</span><span class="s4">true</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">env</span><span class="s0">={};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">argv</span><span class="s0">=[];</span><span class="s1">t</span><span class="s0">.</span><span class="s1">version</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">versions</span><span class="s0">={};</span><span class="s4">function </span><span class="s1">v</span><span class="s0">(){}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">on</span><span class="s0">=</span><span class="s1">v</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">addListener</span><span class="s0">=</span><span class="s1">v</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">once</span><span class="s0">=</span><span class="s1">v</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">off</span><span class="s0">=</span><span class="s1">v</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">removeListener</span><span class="s0">=</span><span class="s1">v</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">removeAllListeners</span><span class="s0">=</span><span class="s1">v</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">emit</span><span class="s0">=</span><span class="s1">v</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">prependListener</span><span class="s0">=</span><span class="s1">v</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">prependOnceListener</span><span class="s0">=</span><span class="s1">v</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">listeners</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s0">[]};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">binding</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;process.binding is not supported&quot;</span><span class="s0">)};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">cwd</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(){</span><span class="s4">return</span><span class="s2">&quot;/&quot;</span><span class="s0">};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">chdir</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;process.chdir is not supported&quot;</span><span class="s0">)};</span><span class="s1">t</span><span class="s0">.</span><span class="s1">umask</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">0</span><span class="s0">}}}]);</span></pre>
</body>
</html>