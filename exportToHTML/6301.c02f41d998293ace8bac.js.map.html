<html>
<head>
<title>6301.c02f41d998293ace8bac.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #6aab73;}
.s2 { color: #2aacb8;}
.s3 { color: #cf8e6d;}
.ln { color: #4b5059; font-weight: normal; font-style: normal; }
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
6301.c02f41d998293ace8bac.js.map</font>
</center></td></tr></table>
<pre><a name="l1"><span class="ln">1    </span></a><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;file&quot;</span><span class="s0">:</span><span class="s1">&quot;6301.c02f41d998293ace8bac.js?v=c02f41d998293ace8bac&quot;</span><span class="s0">,</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;;;;;;;;;;;;;;;;;AAI8B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAOA;;AAE9B;AAC4B;AAC2C;AACT;;AAE9D;AACsC;;AAEtC;AACA;AACA,0BAA0B,sEAAM;AAChC;AACA,CAAC;AACD,0BAA0B,sEAAM;AAChC,2BAA2B,sEAAM;AACjC,2BAA2B,sEAAM;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qCAAqC,sEAAM,kEAAkE,0EAAS,8BAA8B,0EAAS,mBAAmB,0EAAS,8BAA8B,0EAAS,mBAAmB,0EAAS;AAC5P,kCAAkC,sEAAM,2FAA2F,0EAAS,yDAAyD,0EAAS;AAC9M,sCAAsC,sEAAM;AAC5C,+CAA+C,0EAAS,4BAA4B,0EAAS,0BAA0B,0EAAS,oCAAoC,0EAAS;AAC7K;AACA,6CAA6C,0EAAS,4BAA4B,0EAAS,qDAAqD,0EAAS,uDAAuD,0EAAS,6BAA6B,0EAAS;AAC/P;AACA,CAAC;AACD,qCAAqC,sEAAM;AAC3C,mCAAmC,sEAAM;AACzC,uDAAuD,0EAAS;AAChE;AACA,uBAAuB,0EAAS;AAChC;AACA,GAAG;AACH,+CAA+C,0EAAS,4BAA4B,0EAAS,4BAA4B,0EAAS,oCAAoC,0EAAS;AAC/K;AACA;AACA,iDAAiD,0EAAS;AAC1D;AACA,kBAAkB,0EAAS,yBAAyB,0EAAS,yBAAyB,0EAAS;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,gDAAgD,0EAAS,6BAA6B,0EAAS,iCAAiC,0EAAS,uCAAuC,0EAAS,iCAAiC,0EAAS;AACnO;AACA;AACA,mCAAmC,0EAAS;AAC5C,6CAA6C,0EAAS,4BAA4B,0EAAS,4CAA4C,0EAAS,qEAAqE,0EAAS,6BAA6B,0EAAS;AACpQ;AACA,CAAC;AACD,qCAAqC,sEAAM;AAC3C,cAAc,0EAAS;AACvB,qBAAqB,0EAAS;AAC9B;AACA;AACA;AACA,wDAAwD,0EAAS,uCAAuC,0EAAS;AACjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,0EAAS;AAC7B;AACA;AACA,sBAAsB,0EAAS,sBAAsB,0EAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,0EAAS,sBAAsB,0EAAS,sBAAsB,0EAAS;AAC3E,wCAAwC,0EAAS,oCAAoC,0EAAS;AAC9F;AACA;AACA,IAAI,0EAAS,sBAAsB,0EAAS,sBAAsB,0EAAS;AAC3E,kEAAkE,0EAAS,gCAAgC,0EAAS;AACpH;AACA,CAAC;AACD,mCAAmC,sEAAM;AACzC,gEAAgE,0EAAS,oBAAoB,0EAAS;AACtG;AACA,IAAI,0EAAS,mBAAmB,0EAAS,oBAAoB,0EAAS;AACtE;AACA;AACA,IAAI,0EAAS,mBAAmB,0EAAS,oBAAoB,0EAAS;AACtE;AACA,uEAAuE,0EAAS,8BAA8B,0EAAS,mBAAmB,0EAAS,kCAAkC,0EAAS,mBAAmB,0EAAS;AAC1N,CAAC;AACD,wCAAwC,sEAAM;AAC9C,cAAc,0EAAS;AACvB,eAAe,0EAAS;AACxB;AACA;AACA;AACA;AACA;AACA,gIAAgI,0EAAS,4BAA4B,0EAAS;AAC9K,CAAC;AACD,oCAAoC,sEAAM;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0EAAc;AACzC,uBAAuB,0EAAS;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0EAAS;AAClC,6CAA6C,0EAAS;AACtD;AACA;AACA,WAAW;AACX,CAAC;AACD,+BAA+B,sEAAM;AACrC;AACA,uDAAuD,0EAAS;AAChE;AACA,UAAU,wBAAwB;AAClC,uCAAuC,0EAAS;AAChD,iCAAiC,0EAAS;AAC1C;AACA,CAAC;AACD,gCAAgC,sEAAM;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,0EAAS;AAClD,2CAA2C,0EAAS;AACpD;AACA;AACA,CAAC;AACD;AACA,+BAA+B,sEAAM;AACrC,0CAA0C,sEAAM;AAChD;AACA,WAAW,kEAAO;AAClB;AACA,WAAW,kEAAO;AAClB;AACA,WAAW,kEAAO;AAClB;AACA,WAAW,kEAAO;AAClB;AACA;AACA,GAAG;AACH;AACA;AACA,uBAAuB,oDAAI;AAC3B;AACA,GAAG;AACH;AACA,GAAG,QAAQ,sDAAU;AACrB;AACA;AACA,MAAM,0EAAS;AACf;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,kEAAO;AAChD;AACA;AACA;AACA,YAAY,OAAO,EAAE,wEAAa;AAClC,iBAAiB,0EAAc;AAC/B;AACA;AACA;AACA;AACA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;AACA,MAAM,+DAAG;AACT;AACA;AACA;AACA,QAAQ,+DAAG;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2FAA2F,0EAAS,oDAAoD,0EAAS,qDAAqD,0EAAS,6CAA6C,0EAAS;AACrR,IAAI,+DAAG;AACP;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,8BAA8B,sEAAM;AACpC,CAAC;AACD,oCAAoC,sEAAM;AAC1C;AACA,CAAC;AACD,2BAA2B,sEAAM;AACjC,SAAS,0EAAS;AAClB,wBAAwB,0EAAS;AACjC;AACA;AACA,qBAAqB,qDAAM;AAC3B;AACA,6CAA6C,qDAAM,mDAAmD,qDAAM;AAC5G;AACA,EAAE,+DAAG;AACL,uCAAuC,GAAG;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,gFAAgB;AAClB;AACA;AACA,OAAO,0BAA0B,EAAE,yBAAyB;AAC5D;AACA,CAAC;AACD,oCAAoC,sEAAM;AAC1C;AACA,CAAC;AACD,gCAAgC,sEAAM;AACtC,oBAAoB,8EAAc;AAClC;AACA;AACA,GAAG;AACH;AACA;AACA,cAAc,gBAAgB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C,QAAQ;AACR;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,EAAE,+DAAG;AACL;AACA;AACA;AACA,IAAI,+DAAG;AACP;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0EAAc;AACjD;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH,EAAE,iFAAW;AACb,EAAE,+DAAG;AACL;AACA;AACA;AACA,MAAM,+DAAG;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN,MAAM,+DAAG;AACT;AACA,GAAG;AACH;AACA;AACA;AACA,MAAM,+DAAG;AACT;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,+DAAG;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU,+EAAoB;AAC9B;AACA,eAAe,kEAAO;AACtB,GAAG;AACH;AACA,UAAU,yEAAc;AACxB,wBAAwB,sEAAM;AAC9B;AACA;AACA;AACA;AACA,GAAG;AACH;AAGE&quot;</span><span class="s0">,</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/mermaid/dist/chunks/mermaid.core/stateDiagram-DGXRK772.mjs&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">StateDB,</span><span class="s3">\n  </span><span class="s1">stateDiagram_default,</span><span class="s3">\n  </span><span class="s1">styles_default</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./chunk-AEK57VVT.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import </span><span class="s3">\&quot;</span><span class="s1">./chunk-RZ5BOZE2.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import </span><span class="s3">\&quot;</span><span class="s1">./chunk-TYCBKAJE.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import </span><span class="s3">\&quot;</span><span class="s1">./chunk-IIMUDSI4.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import </span><span class="s3">\&quot;</span><span class="s1">./chunk-VV3M67IP.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import </span><span class="s3">\&quot;</span><span class="s1">./chunk-HRU6DDCH.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import </span><span class="s3">\&quot;</span><span class="s1">./chunk-K557N5IZ.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import </span><span class="s3">\&quot;</span><span class="s1">./chunk-H2D2JQ3I.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import </span><span class="s3">\&quot;</span><span class="s1">./chunk-C3MQ5ANM.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">utils_default</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./chunk-O4NI6UNU.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">__name,</span><span class="s3">\n  </span><span class="s1">common_default,</span><span class="s3">\n  </span><span class="s1">configureSvgSize,</span><span class="s3">\n  </span><span class="s1">getConfig2 as getConfig,</span><span class="s3">\n  </span><span class="s1">log</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./chunk-YTJNT7DU.mjs</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/state/stateRenderer.js</span><span class="s3">\n</span><span class="s1">import { select } from </span><span class="s3">\&quot;</span><span class="s1">d3</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import { layout as dagreLayout } from </span><span class="s3">\&quot;</span><span class="s1">dagre-d3-es/src/dagre/index.js</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import * as graphlib from </span><span class="s3">\&quot;</span><span class="s1">dagre-d3-es/src/graphlib/index.js</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/state/shapes.js</span><span class="s3">\n</span><span class="s1">import { line, curveBasis } from </span><span class="s3">\&quot;</span><span class="s1">d3</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/state/id-cache.js</span><span class="s3">\n</span><span class="s1">var idCache = {};</span><span class="s3">\n</span><span class="s1">var set = /* @__PURE__ */ __name((key, val) =&gt; {</span><span class="s3">\n  </span><span class="s1">idCache[key] = val;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">set</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var get = /* @__PURE__ */ __name((k) =&gt; idCache[k], </span><span class="s3">\&quot;</span><span class="s1">get</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var keys = /* @__PURE__ */ __name(() =&gt; Object.keys(idCache), </span><span class="s3">\&quot;</span><span class="s1">keys</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var size = /* @__PURE__ */ __name(() =&gt; keys().length, </span><span class="s3">\&quot;</span><span class="s1">size</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var id_cache_default = {</span><span class="s3">\n  </span><span class="s1">get,</span><span class="s3">\n  </span><span class="s1">set,</span><span class="s3">\n  </span><span class="s1">keys,</span><span class="s3">\n  </span><span class="s1">size</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/state/shapes.js</span><span class="s3">\n</span><span class="s1">var drawStartState = /* @__PURE__ */ __name((g) =&gt; g.append(</span><span class="s3">\&quot;</span><span class="s1">circle</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">start-state</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">r</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.sizeUnit).attr(</span><span class="s3">\&quot;</span><span class="s1">cx</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding + getConfig().state.sizeUnit).attr(</span><span class="s3">\&quot;</span><span class="s1">cy</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding + getConfig().state.sizeUnit), </span><span class="s3">\&quot;</span><span class="s1">drawStartState</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawDivider = /* @__PURE__ */ __name((g) =&gt; g.append(</span><span class="s3">\&quot;</span><span class="s1">line</span><span class="s3">\&quot;</span><span class="s1">).style(</span><span class="s3">\&quot;</span><span class="s1">stroke</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">grey</span><span class="s3">\&quot;</span><span class="s1">).style(</span><span class="s3">\&quot;</span><span class="s1">stroke-dasharray</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">3</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x1</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.textHeight).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">divider</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x2</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.textHeight * 2).attr(</span><span class="s3">\&quot;</span><span class="s1">y1</span><span class="s3">\&quot;</span><span class="s1">, 0).attr(</span><span class="s3">\&quot;</span><span class="s1">y2</span><span class="s3">\&quot;</span><span class="s1">, 0), </span><span class="s3">\&quot;</span><span class="s1">drawDivider</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawSimpleState = /* @__PURE__ */ __name((g, stateDef) =&gt; {</span><span class="s3">\n  </span><span class="s1">const state = g.append(</span><span class="s3">\&quot;</span><span class="s1">text</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, 2 * getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.textHeight + 2 * getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">font-size</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.fontSize).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">state-title</span><span class="s3">\&quot;</span><span class="s1">).text(stateDef.id);</span><span class="s3">\n  </span><span class="s1">const classBox = state.node().getBBox();</span><span class="s3">\n  </span><span class="s1">g.insert(</span><span class="s3">\&quot;</span><span class="s1">rect</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">:first-child</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">width</span><span class="s3">\&quot;</span><span class="s1">, classBox.width + 2 * getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">height</span><span class="s3">\&quot;</span><span class="s1">, classBox.height + 2 * getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">rx</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.radius);</span><span class="s3">\n  </span><span class="s1">return state;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawSimpleState</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawDescrState = /* @__PURE__ */ __name((g, stateDef) =&gt; {</span><span class="s3">\n  </span><span class="s1">const addTspan = /* @__PURE__ */ __name(function(textEl, txt, isFirst2) {</span><span class="s3">\n    </span><span class="s1">const tSpan = textEl.append(</span><span class="s3">\&quot;</span><span class="s1">tspan</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, 2 * getConfig().state.padding).text(txt);</span><span class="s3">\n    </span><span class="s1">if (!isFirst2) {</span><span class="s3">\n      </span><span class="s1">tSpan.attr(</span><span class="s3">\&quot;</span><span class="s1">dy</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.textHeight);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">addTspan</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">const title = g.append(</span><span class="s3">\&quot;</span><span class="s1">text</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, 2 * getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.textHeight + 1.3 * getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">font-size</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.fontSize).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">state-title</span><span class="s3">\&quot;</span><span class="s1">).text(stateDef.descriptions[0]);</span><span class="s3">\n  </span><span class="s1">const titleBox = title.node().getBBox();</span><span class="s3">\n  </span><span class="s1">const titleHeight = titleBox.height;</span><span class="s3">\n  </span><span class="s1">const description = g.append(</span><span class="s3">\&quot;</span><span class="s1">text</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding).attr(</span><span class="s3">\n    \&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">titleHeight + getConfig().state.padding * 0.4 + getConfig().state.dividerMargin + getConfig().state.textHeight</span><span class="s3">\n  </span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">state-description</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">let isFirst = true;</span><span class="s3">\n  </span><span class="s1">let isSecond = true;</span><span class="s3">\n  </span><span class="s1">stateDef.descriptions.forEach(function(descr) {</span><span class="s3">\n    </span><span class="s1">if (!isFirst) {</span><span class="s3">\n      </span><span class="s1">addTspan(description, descr, isSecond);</span><span class="s3">\n      </span><span class="s1">isSecond = false;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">isFirst = false;</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">const descrLine = g.append(</span><span class="s3">\&quot;</span><span class="s1">line</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x1</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">y1</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding + titleHeight + getConfig().state.dividerMargin / 2).attr(</span><span class="s3">\&quot;</span><span class="s1">y2</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding + titleHeight + getConfig().state.dividerMargin / 2).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">descr-divider</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">const descrBox = description.node().getBBox();</span><span class="s3">\n  </span><span class="s1">const width = Math.max(descrBox.width, titleBox.width);</span><span class="s3">\n  </span><span class="s1">descrLine.attr(</span><span class="s3">\&quot;</span><span class="s1">x2</span><span class="s3">\&quot;</span><span class="s1">, width + 3 * getConfig().state.padding);</span><span class="s3">\n  </span><span class="s1">g.insert(</span><span class="s3">\&quot;</span><span class="s1">rect</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">:first-child</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">width</span><span class="s3">\&quot;</span><span class="s1">, width + 2 * getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">height</span><span class="s3">\&quot;</span><span class="s1">, descrBox.height + titleHeight + 2 * getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">rx</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.radius);</span><span class="s3">\n  </span><span class="s1">return g;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawDescrState</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var addTitleAndBox = /* @__PURE__ */ __name((g, stateDef, altBkg) =&gt; {</span><span class="s3">\n  </span><span class="s1">const pad = getConfig().state.padding;</span><span class="s3">\n  </span><span class="s1">const dblPad = 2 * getConfig().state.padding;</span><span class="s3">\n  </span><span class="s1">const orgBox = g.node().getBBox();</span><span class="s3">\n  </span><span class="s1">const orgWidth = orgBox.width;</span><span class="s3">\n  </span><span class="s1">const orgX = orgBox.x;</span><span class="s3">\n  </span><span class="s1">const title = g.append(</span><span class="s3">\&quot;</span><span class="s1">text</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, 0).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.titleShift).attr(</span><span class="s3">\&quot;</span><span class="s1">font-size</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.fontSize).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">state-title</span><span class="s3">\&quot;</span><span class="s1">).text(stateDef.id);</span><span class="s3">\n  </span><span class="s1">const titleBox = title.node().getBBox();</span><span class="s3">\n  </span><span class="s1">const titleWidth = titleBox.width + dblPad;</span><span class="s3">\n  </span><span class="s1">let width = Math.max(titleWidth, orgWidth);</span><span class="s3">\n  </span><span class="s1">if (width === orgWidth) {</span><span class="s3">\n    </span><span class="s1">width = width + dblPad;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">let startX;</span><span class="s3">\n  </span><span class="s1">const graphBox = g.node().getBBox();</span><span class="s3">\n  </span><span class="s1">if (stateDef.doc) {</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">startX = orgX - pad;</span><span class="s3">\n  </span><span class="s1">if (titleWidth &gt; orgWidth) {</span><span class="s3">\n    </span><span class="s1">startX = (orgWidth - width) / 2 + pad;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (Math.abs(orgX - graphBox.x) &lt; pad &amp;&amp; titleWidth &gt; orgWidth) {</span><span class="s3">\n    </span><span class="s1">startX = orgX - (titleWidth - orgWidth) / 2;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const lineY = 1 - getConfig().state.textHeight;</span><span class="s3">\n  </span><span class="s1">g.insert(</span><span class="s3">\&quot;</span><span class="s1">rect</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">:first-child</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, startX).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, lineY).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, altBkg ? </span><span class="s3">\&quot;</span><span class="s1">alt-composit</span><span class="s3">\&quot; </span><span class="s1">: </span><span class="s3">\&quot;</span><span class="s1">composit</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">width</span><span class="s3">\&quot;</span><span class="s1">, width).attr(</span><span class="s3">\n    \&quot;</span><span class="s1">height</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">graphBox.height + getConfig().state.textHeight + getConfig().state.titleShift + 1</span><span class="s3">\n  </span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">rx</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">0</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">title.attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, startX + pad);</span><span class="s3">\n  </span><span class="s1">if (titleWidth &lt;= orgWidth) {</span><span class="s3">\n    </span><span class="s1">title.attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, orgX + (width - dblPad) / 2 - titleWidth / 2 + pad);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">g.insert(</span><span class="s3">\&quot;</span><span class="s1">rect</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">:first-child</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, startX).attr(</span><span class="s3">\n    \&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">getConfig().state.titleShift - getConfig().state.textHeight - getConfig().state.padding</span><span class="s3">\n  </span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">width</span><span class="s3">\&quot;</span><span class="s1">, width).attr(</span><span class="s3">\&quot;</span><span class="s1">height</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.textHeight * 3).attr(</span><span class="s3">\&quot;</span><span class="s1">rx</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.radius);</span><span class="s3">\n  </span><span class="s1">g.insert(</span><span class="s3">\&quot;</span><span class="s1">rect</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">:first-child</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, startX).attr(</span><span class="s3">\n    \&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">getConfig().state.titleShift - getConfig().state.textHeight - getConfig().state.padding</span><span class="s3">\n  </span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">width</span><span class="s3">\&quot;</span><span class="s1">, width).attr(</span><span class="s3">\&quot;</span><span class="s1">height</span><span class="s3">\&quot;</span><span class="s1">, graphBox.height + 3 + 2 * getConfig().state.textHeight).attr(</span><span class="s3">\&quot;</span><span class="s1">rx</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.radius);</span><span class="s3">\n  </span><span class="s1">return g;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">addTitleAndBox</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawEndState = /* @__PURE__ */ __name((g) =&gt; {</span><span class="s3">\n  </span><span class="s1">g.append(</span><span class="s3">\&quot;</span><span class="s1">circle</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">end-state-outer</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">r</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.sizeUnit + getConfig().state.miniPadding).attr(</span><span class="s3">\n    \&quot;</span><span class="s1">cx</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">getConfig().state.padding + getConfig().state.sizeUnit + getConfig().state.miniPadding</span><span class="s3">\n  </span><span class="s1">).attr(</span><span class="s3">\n    \&quot;</span><span class="s1">cy</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">getConfig().state.padding + getConfig().state.sizeUnit + getConfig().state.miniPadding</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">return g.append(</span><span class="s3">\&quot;</span><span class="s1">circle</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">end-state-inner</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">r</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.sizeUnit).attr(</span><span class="s3">\&quot;</span><span class="s1">cx</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding + getConfig().state.sizeUnit + 2).attr(</span><span class="s3">\&quot;</span><span class="s1">cy</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding + getConfig().state.sizeUnit + 2);</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawEndState</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawForkJoinState = /* @__PURE__ */ __name((g, stateDef) =&gt; {</span><span class="s3">\n  </span><span class="s1">let width = getConfig().state.forkWidth;</span><span class="s3">\n  </span><span class="s1">let height = getConfig().state.forkHeight;</span><span class="s3">\n  </span><span class="s1">if (stateDef.parentId) {</span><span class="s3">\n    </span><span class="s1">let tmp = width;</span><span class="s3">\n    </span><span class="s1">width = height;</span><span class="s3">\n    </span><span class="s1">height = tmp;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return g.append(</span><span class="s3">\&quot;</span><span class="s1">rect</span><span class="s3">\&quot;</span><span class="s1">).style(</span><span class="s3">\&quot;</span><span class="s1">stroke</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">black</span><span class="s3">\&quot;</span><span class="s1">).style(</span><span class="s3">\&quot;</span><span class="s1">fill</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">black</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">width</span><span class="s3">\&quot;</span><span class="s1">, width).attr(</span><span class="s3">\&quot;</span><span class="s1">height</span><span class="s3">\&quot;</span><span class="s1">, height).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding);</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawForkJoinState</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var _drawLongText = /* @__PURE__ */ __name((_text, x, y, g) =&gt; {</span><span class="s3">\n  </span><span class="s1">let textHeight = 0;</span><span class="s3">\n  </span><span class="s1">const textElem = g.append(</span><span class="s3">\&quot;</span><span class="s1">text</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">textElem.style(</span><span class="s3">\&quot;</span><span class="s1">text-anchor</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">start</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">textElem.attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">noteText</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">let text = _text.replace(/</span><span class="s3">\\</span><span class="s1">r</span><span class="s3">\\</span><span class="s1">n/g, </span><span class="s3">\&quot;</span><span class="s1">&lt;br/&gt;</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">text = text.replace(/</span><span class="s3">\\</span><span class="s1">n/g, </span><span class="s3">\&quot;</span><span class="s1">&lt;br/&gt;</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">const lines = text.split(common_default.lineBreakRegex);</span><span class="s3">\n  </span><span class="s1">let tHeight = 1.25 * getConfig().state.noteMargin;</span><span class="s3">\n  </span><span class="s1">for (const line2 of lines) {</span><span class="s3">\n    </span><span class="s1">const txt = line2.trim();</span><span class="s3">\n    </span><span class="s1">if (txt.length &gt; 0) {</span><span class="s3">\n      </span><span class="s1">const span = textElem.append(</span><span class="s3">\&quot;</span><span class="s1">tspan</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">span.text(txt);</span><span class="s3">\n      </span><span class="s1">if (tHeight === 0) {</span><span class="s3">\n        </span><span class="s1">const textBounds = span.node().getBBox();</span><span class="s3">\n        </span><span class="s1">tHeight += textBounds.height;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">textHeight += tHeight;</span><span class="s3">\n      </span><span class="s1">span.attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, x + getConfig().state.noteMargin);</span><span class="s3">\n      </span><span class="s1">span.attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, y + textHeight + 1.25 * getConfig().state.noteMargin);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return { textWidth: textElem.node().getBBox().width, textHeight };</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">_drawLongText</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawNote = /* @__PURE__ */ __name((text, g) =&gt; {</span><span class="s3">\n  </span><span class="s1">g.attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">state-note</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">const note = g.append(</span><span class="s3">\&quot;</span><span class="s1">rect</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, 0).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, getConfig().state.padding);</span><span class="s3">\n  </span><span class="s1">const rectElem = g.append(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">const { textWidth, textHeight } = _drawLongText(text, 0, 0, rectElem);</span><span class="s3">\n  </span><span class="s1">note.attr(</span><span class="s3">\&quot;</span><span class="s1">height</span><span class="s3">\&quot;</span><span class="s1">, textHeight + 2 * getConfig().state.noteMargin);</span><span class="s3">\n  </span><span class="s1">note.attr(</span><span class="s3">\&quot;</span><span class="s1">width</span><span class="s3">\&quot;</span><span class="s1">, textWidth + getConfig().state.noteMargin * 2);</span><span class="s3">\n  </span><span class="s1">return note;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawNote</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var drawState = /* @__PURE__ */ __name(function(elem, stateDef) {</span><span class="s3">\n  </span><span class="s1">const id = stateDef.id;</span><span class="s3">\n  </span><span class="s1">const stateInfo = {</span><span class="s3">\n    </span><span class="s1">id,</span><span class="s3">\n    </span><span class="s1">label: stateDef.id,</span><span class="s3">\n    </span><span class="s1">width: 0,</span><span class="s3">\n    </span><span class="s1">height: 0</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">const g = elem.append(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">id</span><span class="s3">\&quot;</span><span class="s1">, id).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">stateGroup</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">if (stateDef.type === </span><span class="s3">\&quot;</span><span class="s1">start</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">drawStartState(g);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (stateDef.type === </span><span class="s3">\&quot;</span><span class="s1">end</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">drawEndState(g);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (stateDef.type === </span><span class="s3">\&quot;</span><span class="s1">fork</span><span class="s3">\&quot; </span><span class="s1">|| stateDef.type === </span><span class="s3">\&quot;</span><span class="s1">join</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">drawForkJoinState(g, stateDef);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (stateDef.type === </span><span class="s3">\&quot;</span><span class="s1">note</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">drawNote(stateDef.note.text, g);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (stateDef.type === </span><span class="s3">\&quot;</span><span class="s1">divider</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">drawDivider(g);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (stateDef.type === </span><span class="s3">\&quot;</span><span class="s1">default</span><span class="s3">\&quot; </span><span class="s1">&amp;&amp; stateDef.descriptions.length === 0) {</span><span class="s3">\n    </span><span class="s1">drawSimpleState(g, stateDef);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (stateDef.type === </span><span class="s3">\&quot;</span><span class="s1">default</span><span class="s3">\&quot; </span><span class="s1">&amp;&amp; stateDef.descriptions.length &gt; 0) {</span><span class="s3">\n    </span><span class="s1">drawDescrState(g, stateDef);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const stateBox = g.node().getBBox();</span><span class="s3">\n  </span><span class="s1">stateInfo.width = stateBox.width + 2 * getConfig().state.padding;</span><span class="s3">\n  </span><span class="s1">stateInfo.height = stateBox.height + 2 * getConfig().state.padding;</span><span class="s3">\n  </span><span class="s1">id_cache_default.set(id, stateInfo);</span><span class="s3">\n  </span><span class="s1">return stateInfo;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawState</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var edgeCount = 0;</span><span class="s3">\n</span><span class="s1">var drawEdge = /* @__PURE__ */ __name(function(elem, path, relation) {</span><span class="s3">\n  </span><span class="s1">const getRelationType = /* @__PURE__ */ __name(function(type) {</span><span class="s3">\n    </span><span class="s1">switch (type) {</span><span class="s3">\n      </span><span class="s1">case StateDB.relationType.AGGREGATION:</span><span class="s3">\n        </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">aggregation</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">case StateDB.relationType.EXTENSION:</span><span class="s3">\n        </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">extension</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">case StateDB.relationType.COMPOSITION:</span><span class="s3">\n        </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">composition</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n      </span><span class="s1">case StateDB.relationType.DEPENDENCY:</span><span class="s3">\n        </span><span class="s1">return </span><span class="s3">\&quot;</span><span class="s1">dependency</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getRelationType</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">path.points = path.points.filter((p) =&gt; !Number.isNaN(p.y));</span><span class="s3">\n  </span><span class="s1">const lineData = path.points;</span><span class="s3">\n  </span><span class="s1">const lineFunction = line().x(function(d) {</span><span class="s3">\n    </span><span class="s1">return d.x;</span><span class="s3">\n  </span><span class="s1">}).y(function(d) {</span><span class="s3">\n    </span><span class="s1">return d.y;</span><span class="s3">\n  </span><span class="s1">}).curve(curveBasis);</span><span class="s3">\n  </span><span class="s1">const svgPath = elem.append(</span><span class="s3">\&quot;</span><span class="s1">path</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">d</span><span class="s3">\&quot;</span><span class="s1">, lineFunction(lineData)).attr(</span><span class="s3">\&quot;</span><span class="s1">id</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">edge</span><span class="s3">\&quot; </span><span class="s1">+ edgeCount).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">transition</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">let url = </span><span class="s3">\&quot;\&quot;</span><span class="s1">;</span><span class="s3">\n  </span><span class="s1">if (getConfig().state.arrowMarkerAbsolute) {</span><span class="s3">\n    </span><span class="s1">url = window.location.protocol + </span><span class="s3">\&quot;</span><span class="s1">//</span><span class="s3">\&quot; </span><span class="s1">+ window.location.host + window.location.pathname + window.location.search;</span><span class="s3">\n    </span><span class="s1">url = url.replace(/</span><span class="s3">\\</span><span class="s1">(/g, </span><span class="s3">\&quot;\\\\</span><span class="s1">(</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">url = url.replace(/</span><span class="s3">\\</span><span class="s1">)/g, </span><span class="s3">\&quot;\\\\</span><span class="s1">)</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">svgPath.attr(</span><span class="s3">\n    \&quot;</span><span class="s1">marker-end</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    \&quot;</span><span class="s1">url(</span><span class="s3">\&quot; </span><span class="s1">+ url + </span><span class="s3">\&quot;</span><span class="s1">#</span><span class="s3">\&quot; </span><span class="s1">+ getRelationType(StateDB.relationType.DEPENDENCY) + </span><span class="s3">\&quot;</span><span class="s1">End)</span><span class="s3">\&quot;\n  </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">if (relation.title !== void 0) {</span><span class="s3">\n    </span><span class="s1">const label = elem.append(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">stateLabel</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">const { x, y } = utils_default.calcLabelPosition(path.points);</span><span class="s3">\n    </span><span class="s1">const rows = common_default.getRows(relation.title);</span><span class="s3">\n    </span><span class="s1">let titleHeight = 0;</span><span class="s3">\n    </span><span class="s1">const titleRows = [];</span><span class="s3">\n    </span><span class="s1">let maxWidth = 0;</span><span class="s3">\n    </span><span class="s1">let minX = 0;</span><span class="s3">\n    </span><span class="s1">for (let i = 0; i &lt;= rows.length; i++) {</span><span class="s3">\n      </span><span class="s1">const title = label.append(</span><span class="s3">\&quot;</span><span class="s1">text</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">text-anchor</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">middle</span><span class="s3">\&quot;</span><span class="s1">).text(rows[i]).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, x).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, y + titleHeight);</span><span class="s3">\n      </span><span class="s1">const boundsTmp = title.node().getBBox();</span><span class="s3">\n      </span><span class="s1">maxWidth = Math.max(maxWidth, boundsTmp.width);</span><span class="s3">\n      </span><span class="s1">minX = Math.min(minX, boundsTmp.x);</span><span class="s3">\n      </span><span class="s1">log.info(boundsTmp.x, x, y + titleHeight);</span><span class="s3">\n      </span><span class="s1">if (titleHeight === 0) {</span><span class="s3">\n        </span><span class="s1">const titleBox = title.node().getBBox();</span><span class="s3">\n        </span><span class="s1">titleHeight = titleBox.height;</span><span class="s3">\n        </span><span class="s1">log.info(</span><span class="s3">\&quot;</span><span class="s1">Title height</span><span class="s3">\&quot;</span><span class="s1">, titleHeight, y);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">titleRows.push(title);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">let boxHeight = titleHeight * rows.length;</span><span class="s3">\n    </span><span class="s1">if (rows.length &gt; 1) {</span><span class="s3">\n      </span><span class="s1">const heightAdj = (rows.length - 1) * titleHeight * 0.5;</span><span class="s3">\n      </span><span class="s1">titleRows.forEach((title, i) =&gt; title.attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, y + i * titleHeight - heightAdj));</span><span class="s3">\n      </span><span class="s1">boxHeight = titleHeight * rows.length;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">const bounds = label.node().getBBox();</span><span class="s3">\n    </span><span class="s1">label.insert(</span><span class="s3">\&quot;</span><span class="s1">rect</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">:first-child</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">box</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">x</span><span class="s3">\&quot;</span><span class="s1">, x - maxWidth / 2 - getConfig().state.padding / 2).attr(</span><span class="s3">\&quot;</span><span class="s1">y</span><span class="s3">\&quot;</span><span class="s1">, y - boxHeight / 2 - getConfig().state.padding / 2 - 3.5).attr(</span><span class="s3">\&quot;</span><span class="s1">width</span><span class="s3">\&quot;</span><span class="s1">, maxWidth + getConfig().state.padding).attr(</span><span class="s3">\&quot;</span><span class="s1">height</span><span class="s3">\&quot;</span><span class="s1">, boxHeight + getConfig().state.padding);</span><span class="s3">\n    </span><span class="s1">log.info(bounds);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">edgeCount++;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">drawEdge</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/state/stateRenderer.js</span><span class="s3">\n</span><span class="s1">var conf;</span><span class="s3">\n</span><span class="s1">var transformationLog = {};</span><span class="s3">\n</span><span class="s1">var setConf = /* @__PURE__ */ __name(function() {</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">setConf</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var insertMarkers = /* @__PURE__ */ __name(function(elem) {</span><span class="s3">\n  </span><span class="s1">elem.append(</span><span class="s3">\&quot;</span><span class="s1">defs</span><span class="s3">\&quot;</span><span class="s1">).append(</span><span class="s3">\&quot;</span><span class="s1">marker</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">id</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">dependencyEnd</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">refX</span><span class="s3">\&quot;</span><span class="s1">, 19).attr(</span><span class="s3">\&quot;</span><span class="s1">refY</span><span class="s3">\&quot;</span><span class="s1">, 7).attr(</span><span class="s3">\&quot;</span><span class="s1">markerWidth</span><span class="s3">\&quot;</span><span class="s1">, 20).attr(</span><span class="s3">\&quot;</span><span class="s1">markerHeight</span><span class="s3">\&quot;</span><span class="s1">, 28).attr(</span><span class="s3">\&quot;</span><span class="s1">orient</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">auto</span><span class="s3">\&quot;</span><span class="s1">).append(</span><span class="s3">\&quot;</span><span class="s1">path</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">d</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">M 19,7 L9,13 L14,7 L9,1 Z</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">insertMarkers</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var draw = /* @__PURE__ */ __name(function(text, id, _version, diagObj) {</span><span class="s3">\n  </span><span class="s1">conf = getConfig().state;</span><span class="s3">\n  </span><span class="s1">const securityLevel = getConfig().securityLevel;</span><span class="s3">\n  </span><span class="s1">let sandboxElement;</span><span class="s3">\n  </span><span class="s1">if (securityLevel === </span><span class="s3">\&quot;</span><span class="s1">sandbox</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">sandboxElement = select(</span><span class="s3">\&quot;</span><span class="s1">#i</span><span class="s3">\&quot; </span><span class="s1">+ id);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">const root = securityLevel === </span><span class="s3">\&quot;</span><span class="s1">sandbox</span><span class="s3">\&quot; </span><span class="s1">? select(sandboxElement.nodes()[0].contentDocument.body) : select(</span><span class="s3">\&quot;</span><span class="s1">body</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">const doc = securityLevel === </span><span class="s3">\&quot;</span><span class="s1">sandbox</span><span class="s3">\&quot; </span><span class="s1">? sandboxElement.nodes()[0].contentDocument : document;</span><span class="s3">\n  </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">Rendering diagram </span><span class="s3">\&quot; </span><span class="s1">+ text);</span><span class="s3">\n  </span><span class="s1">const diagram2 = root.select(`[id='${id}']`);</span><span class="s3">\n  </span><span class="s1">insertMarkers(diagram2);</span><span class="s3">\n  </span><span class="s1">const rootDoc = diagObj.db.getRootDoc();</span><span class="s3">\n  </span><span class="s1">renderDoc(rootDoc, diagram2, void 0, false, root, doc, diagObj);</span><span class="s3">\n  </span><span class="s1">const padding = conf.padding;</span><span class="s3">\n  </span><span class="s1">const bounds = diagram2.node().getBBox();</span><span class="s3">\n  </span><span class="s1">const width = bounds.width + padding * 2;</span><span class="s3">\n  </span><span class="s1">const height = bounds.height + padding * 2;</span><span class="s3">\n  </span><span class="s1">const svgWidth = width * 1.75;</span><span class="s3">\n  </span><span class="s1">configureSvgSize(diagram2, height, svgWidth, conf.useMaxWidth);</span><span class="s3">\n  </span><span class="s1">diagram2.attr(</span><span class="s3">\n    \&quot;</span><span class="s1">viewBox</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">`${bounds.x - conf.padding}  ${bounds.y - conf.padding} ` + width + </span><span class="s3">\&quot; \&quot; </span><span class="s1">+ height</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">draw</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var getLabelWidth = /* @__PURE__ */ __name((text) =&gt; {</span><span class="s3">\n  </span><span class="s1">return text ? text.length * conf.fontSizeFactor : 1;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">getLabelWidth</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var renderDoc = /* @__PURE__ */ __name((doc, diagram2, parentId, altBkg, root, domDocument, diagObj) =&gt; {</span><span class="s3">\n  </span><span class="s1">const graph = new graphlib.Graph({</span><span class="s3">\n    </span><span class="s1">compound: true,</span><span class="s3">\n    </span><span class="s1">multigraph: true</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">let i;</span><span class="s3">\n  </span><span class="s1">let edgeFreeDoc = true;</span><span class="s3">\n  </span><span class="s1">for (i = 0; i &lt; doc.length; i++) {</span><span class="s3">\n    </span><span class="s1">if (doc[i].stmt === </span><span class="s3">\&quot;</span><span class="s1">relation</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">edgeFreeDoc = false;</span><span class="s3">\n      </span><span class="s1">break;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">if (parentId) {</span><span class="s3">\n    </span><span class="s1">graph.setGraph({</span><span class="s3">\n      </span><span class="s1">rankdir: </span><span class="s3">\&quot;</span><span class="s1">LR</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n      </span><span class="s1">multigraph: true,</span><span class="s3">\n      </span><span class="s1">compound: true,</span><span class="s3">\n      </span><span class="s1">// acyclicer: 'greedy',</span><span class="s3">\n      </span><span class="s1">ranker: </span><span class="s3">\&quot;</span><span class="s1">tight-tree</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n      </span><span class="s1">ranksep: edgeFreeDoc ? 1 : conf.edgeLengthFactor,</span><span class="s3">\n      </span><span class="s1">nodeSep: edgeFreeDoc ? 1 : 50,</span><span class="s3">\n      </span><span class="s1">isMultiGraph: true</span><span class="s3">\n      </span><span class="s1">// ranksep: 5,</span><span class="s3">\n      </span><span class="s1">// nodesep: 1</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">graph.setGraph({</span><span class="s3">\n      </span><span class="s1">rankdir: </span><span class="s3">\&quot;</span><span class="s1">TB</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n      </span><span class="s1">multigraph: true,</span><span class="s3">\n      </span><span class="s1">compound: true,</span><span class="s3">\n      </span><span class="s1">// isCompound: true,</span><span class="s3">\n      </span><span class="s1">// acyclicer: 'greedy',</span><span class="s3">\n      </span><span class="s1">// ranker: 'longest-path'</span><span class="s3">\n      </span><span class="s1">ranksep: edgeFreeDoc ? 1 : conf.edgeLengthFactor,</span><span class="s3">\n      </span><span class="s1">nodeSep: edgeFreeDoc ? 1 : 50,</span><span class="s3">\n      </span><span class="s1">ranker: </span><span class="s3">\&quot;</span><span class="s1">tight-tree</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n      </span><span class="s1">// ranker: 'network-simplex'</span><span class="s3">\n      </span><span class="s1">isMultiGraph: true</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">graph.setDefaultEdgeLabel(function() {</span><span class="s3">\n    </span><span class="s1">return {};</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">const states = diagObj.db.getStates();</span><span class="s3">\n  </span><span class="s1">const relations = diagObj.db.getRelations();</span><span class="s3">\n  </span><span class="s1">const keys2 = Object.keys(states);</span><span class="s3">\n  </span><span class="s1">let first = true;</span><span class="s3">\n  </span><span class="s1">for (const key of keys2) {</span><span class="s3">\n    </span><span class="s1">const stateDef = states[key];</span><span class="s3">\n    </span><span class="s1">if (parentId) {</span><span class="s3">\n      </span><span class="s1">stateDef.parentId = parentId;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">let node;</span><span class="s3">\n    </span><span class="s1">if (stateDef.doc) {</span><span class="s3">\n      </span><span class="s1">let sub = diagram2.append(</span><span class="s3">\&quot;</span><span class="s1">g</span><span class="s3">\&quot;</span><span class="s1">).attr(</span><span class="s3">\&quot;</span><span class="s1">id</span><span class="s3">\&quot;</span><span class="s1">, stateDef.id).attr(</span><span class="s3">\&quot;</span><span class="s1">class</span><span class="s3">\&quot;</span><span class="s1">, </span><span class="s3">\&quot;</span><span class="s1">stateGroup</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">node = renderDoc(stateDef.doc, sub, stateDef.id, !altBkg, root, domDocument, diagObj);</span><span class="s3">\n      </span><span class="s1">if (first) {</span><span class="s3">\n        </span><span class="s1">sub = addTitleAndBox(sub, stateDef, altBkg);</span><span class="s3">\n        </span><span class="s1">let boxBounds = sub.node().getBBox();</span><span class="s3">\n        </span><span class="s1">node.width = boxBounds.width;</span><span class="s3">\n        </span><span class="s1">node.height = boxBounds.height + conf.padding / 2;</span><span class="s3">\n        </span><span class="s1">transformationLog[stateDef.id] = { y: conf.compositTitleSize };</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">let boxBounds = sub.node().getBBox();</span><span class="s3">\n        </span><span class="s1">node.width = boxBounds.width;</span><span class="s3">\n        </span><span class="s1">node.height = boxBounds.height;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">node = drawState(diagram2, stateDef, graph);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">if (stateDef.note) {</span><span class="s3">\n      </span><span class="s1">const noteDef = {</span><span class="s3">\n        </span><span class="s1">descriptions: [],</span><span class="s3">\n        </span><span class="s1">id: stateDef.id + </span><span class="s3">\&quot;</span><span class="s1">-note</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        </span><span class="s1">note: stateDef.note,</span><span class="s3">\n        </span><span class="s1">type: </span><span class="s3">\&quot;</span><span class="s1">note</span><span class="s3">\&quot;\n      </span><span class="s1">};</span><span class="s3">\n      </span><span class="s1">const note = drawState(diagram2, noteDef, graph);</span><span class="s3">\n      </span><span class="s1">if (stateDef.note.position === </span><span class="s3">\&quot;</span><span class="s1">left of</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">graph.setNode(node.id + </span><span class="s3">\&quot;</span><span class="s1">-note</span><span class="s3">\&quot;</span><span class="s1">, note);</span><span class="s3">\n        </span><span class="s1">graph.setNode(node.id, node);</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">graph.setNode(node.id, node);</span><span class="s3">\n        </span><span class="s1">graph.setNode(node.id + </span><span class="s3">\&quot;</span><span class="s1">-note</span><span class="s3">\&quot;</span><span class="s1">, note);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">graph.setParent(node.id, node.id + </span><span class="s3">\&quot;</span><span class="s1">-group</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">graph.setParent(node.id + </span><span class="s3">\&quot;</span><span class="s1">-note</span><span class="s3">\&quot;</span><span class="s1">, node.id + </span><span class="s3">\&quot;</span><span class="s1">-group</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">graph.setNode(node.id, node);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">Count=</span><span class="s3">\&quot;</span><span class="s1">, graph.nodeCount(), graph);</span><span class="s3">\n  </span><span class="s1">let cnt = 0;</span><span class="s3">\n  </span><span class="s1">relations.forEach(function(relation) {</span><span class="s3">\n    </span><span class="s1">cnt++;</span><span class="s3">\n    </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">Setting edge</span><span class="s3">\&quot;</span><span class="s1">, relation);</span><span class="s3">\n    </span><span class="s1">graph.setEdge(</span><span class="s3">\n      </span><span class="s1">relation.id1,</span><span class="s3">\n      </span><span class="s1">relation.id2,</span><span class="s3">\n      </span><span class="s1">{</span><span class="s3">\n        </span><span class="s1">relation,</span><span class="s3">\n        </span><span class="s1">width: getLabelWidth(relation.title),</span><span class="s3">\n        </span><span class="s1">height: conf.labelHeight * common_default.getRows(relation.title).length,</span><span class="s3">\n        </span><span class="s1">labelpos: </span><span class="s3">\&quot;</span><span class="s1">c</span><span class="s3">\&quot;\n      </span><span class="s1">},</span><span class="s3">\n      \&quot;</span><span class="s1">id</span><span class="s3">\&quot; </span><span class="s1">+ cnt</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">dagreLayout(graph);</span><span class="s3">\n  </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">Graph after layout</span><span class="s3">\&quot;</span><span class="s1">, graph.nodes());</span><span class="s3">\n  </span><span class="s1">const svgElem = diagram2.node();</span><span class="s3">\n  </span><span class="s1">graph.nodes().forEach(function(v) {</span><span class="s3">\n    </span><span class="s1">if (v !== void 0 &amp;&amp; graph.node(v) !== void 0) {</span><span class="s3">\n      </span><span class="s1">log.warn(</span><span class="s3">\&quot;</span><span class="s1">Node </span><span class="s3">\&quot; </span><span class="s1">+ v + </span><span class="s3">\&quot;</span><span class="s1">: </span><span class="s3">\&quot; </span><span class="s1">+ JSON.stringify(graph.node(v)));</span><span class="s3">\n      </span><span class="s1">root.select(</span><span class="s3">\&quot;</span><span class="s1">#</span><span class="s3">\&quot; </span><span class="s1">+ svgElem.id + </span><span class="s3">\&quot; </span><span class="s1">#</span><span class="s3">\&quot; </span><span class="s1">+ v).attr(</span><span class="s3">\n        \&quot;</span><span class="s1">transform</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n        \&quot;</span><span class="s1">translate(</span><span class="s3">\&quot; </span><span class="s1">+ (graph.node(v).x - graph.node(v).width / 2) + </span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\&quot; </span><span class="s1">+ (graph.node(v).y + (transformationLog[v] ? transformationLog[v].y : 0) - graph.node(v).height / 2) + </span><span class="s3">\&quot; </span><span class="s1">)</span><span class="s3">\&quot;\n      </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">root.select(</span><span class="s3">\&quot;</span><span class="s1">#</span><span class="s3">\&quot; </span><span class="s1">+ svgElem.id + </span><span class="s3">\&quot; </span><span class="s1">#</span><span class="s3">\&quot; </span><span class="s1">+ v).attr(</span><span class="s3">\&quot;</span><span class="s1">data-x-shift</span><span class="s3">\&quot;</span><span class="s1">, graph.node(v).x - graph.node(v).width / 2);</span><span class="s3">\n      </span><span class="s1">const dividers = domDocument.querySelectorAll(</span><span class="s3">\&quot;</span><span class="s1">#</span><span class="s3">\&quot; </span><span class="s1">+ svgElem.id + </span><span class="s3">\&quot; </span><span class="s1">#</span><span class="s3">\&quot; </span><span class="s1">+ v + </span><span class="s3">\&quot; </span><span class="s1">.divider</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">dividers.forEach((divider) =&gt; {</span><span class="s3">\n        </span><span class="s1">const parent = divider.parentElement;</span><span class="s3">\n        </span><span class="s1">let pWidth = 0;</span><span class="s3">\n        </span><span class="s1">let pShift = 0;</span><span class="s3">\n        </span><span class="s1">if (parent) {</span><span class="s3">\n          </span><span class="s1">if (parent.parentElement) {</span><span class="s3">\n            </span><span class="s1">pWidth = parent.parentElement.getBBox().width;</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">pShift = parseInt(parent.getAttribute(</span><span class="s3">\&quot;</span><span class="s1">data-x-shift</span><span class="s3">\&quot;</span><span class="s1">), 10);</span><span class="s3">\n          </span><span class="s1">if (Number.isNaN(pShift)) {</span><span class="s3">\n            </span><span class="s1">pShift = 0;</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">divider.setAttribute(</span><span class="s3">\&quot;</span><span class="s1">x1</span><span class="s3">\&quot;</span><span class="s1">, 0 - pShift + 8);</span><span class="s3">\n        </span><span class="s1">divider.setAttribute(</span><span class="s3">\&quot;</span><span class="s1">x2</span><span class="s3">\&quot;</span><span class="s1">, pWidth - pShift - 8);</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">No Node </span><span class="s3">\&quot; </span><span class="s1">+ v + </span><span class="s3">\&quot;</span><span class="s1">: </span><span class="s3">\&quot; </span><span class="s1">+ JSON.stringify(graph.node(v)));</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">let stateBox = svgElem.getBBox();</span><span class="s3">\n  </span><span class="s1">graph.edges().forEach(function(e) {</span><span class="s3">\n    </span><span class="s1">if (e !== void 0 &amp;&amp; graph.edge(e) !== void 0) {</span><span class="s3">\n      </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">Edge </span><span class="s3">\&quot; </span><span class="s1">+ e.v + </span><span class="s3">\&quot; </span><span class="s1">-&gt; </span><span class="s3">\&quot; </span><span class="s1">+ e.w + </span><span class="s3">\&quot;</span><span class="s1">: </span><span class="s3">\&quot; </span><span class="s1">+ JSON.stringify(graph.edge(e)));</span><span class="s3">\n      </span><span class="s1">drawEdge(diagram2, graph.edge(e), graph.edge(e).relation);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">stateBox = svgElem.getBBox();</span><span class="s3">\n  </span><span class="s1">const stateInfo = {</span><span class="s3">\n    </span><span class="s1">id: parentId ? parentId : </span><span class="s3">\&quot;</span><span class="s1">root</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">label: parentId ? parentId : </span><span class="s3">\&quot;</span><span class="s1">root</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">width: 0,</span><span class="s3">\n    </span><span class="s1">height: 0</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">stateInfo.width = stateBox.width + 2 * conf.padding;</span><span class="s3">\n  </span><span class="s1">stateInfo.height = stateBox.height + 2 * conf.padding;</span><span class="s3">\n  </span><span class="s1">log.debug(</span><span class="s3">\&quot;</span><span class="s1">Doc rendered</span><span class="s3">\&quot;</span><span class="s1">, stateInfo, graph);</span><span class="s3">\n  </span><span class="s1">return stateInfo;</span><span class="s3">\n</span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">renderDoc</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">var stateRenderer_default = {</span><span class="s3">\n  </span><span class="s1">setConf,</span><span class="s3">\n  </span><span class="s1">draw</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">// src/diagrams/state/stateDiagram.ts</span><span class="s3">\n</span><span class="s1">var diagram = {</span><span class="s3">\n  </span><span class="s1">parser: stateDiagram_default,</span><span class="s3">\n  </span><span class="s1">get db() {</span><span class="s3">\n    </span><span class="s1">return new StateDB(1);</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">renderer: stateRenderer_default,</span><span class="s3">\n  </span><span class="s1">styles: styles_default,</span><span class="s3">\n  </span><span class="s1">init: /* @__PURE__ */ __name((cnf) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (!cnf.state) {</span><span class="s3">\n      </span><span class="s1">cnf.state = {};</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">cnf.state.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;</span><span class="s3">\n  </span><span class="s1">}, </span><span class="s3">\&quot;</span><span class="s1">init</span><span class="s3">\&quot;</span><span class="s1">)</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">export {</span><span class="s3">\n  </span><span class="s1">diagram</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;names&quot;</span><span class="s0">:[],</span><span class="s1">&quot;sourceRoot&quot;</span><span class="s0">:</span><span class="s1">&quot;&quot;</span><span class="s0">}</span></pre>
</body>
</html>