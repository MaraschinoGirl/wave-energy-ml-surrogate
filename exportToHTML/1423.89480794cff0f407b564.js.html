<html>
<head>
<title>1423.89480794cff0f407b564.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #bcbec4;}
.s2 { color: #6aab73;}
.s3 { color: #2aacb8;}
.s4 { color: #cf8e6d;}
.s5 { color: #42c3d4;}
.ln { color: #4b5059; font-weight: normal; font-style: normal; }
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
1423.89480794cff0f407b564.js</font>
</center></td></tr></table>
<pre><a name="l1"><span class="ln">1    </span></a><span class="s0">(</span><span class="s1">self</span><span class="s0">[</span><span class="s2">&quot;webpackChunk_jupyterlab_application_top&quot;</span><span class="s0">]=</span><span class="s1">self</span><span class="s0">[</span><span class="s2">&quot;webpackChunk_jupyterlab_application_top&quot;</span><span class="s0">]||[]).</span><span class="s1">push</span><span class="s0">([[</span><span class="s3">1423</span><span class="s0">,</span><span class="s3">5606</span><span class="s0">],{</span><span class="s3">75128</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)=&gt;{</span><span class="s2">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">d</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,{</span><span class="s1">Ar</span><span class="s0">:()=&gt;</span><span class="s1">d</span><span class="s0">,</span><span class="s1">Bc</span><span class="s0">:()=&gt;</span><span class="s1">Qt</span><span class="s0">,</span><span class="s1">Gw</span><span class="s0">:()=&gt;</span><span class="s1">Ot</span><span class="s0">,</span><span class="s1">_5</span><span class="s0">:()=&gt;</span><span class="s1">h</span><span class="s0">,</span><span class="s1">et</span><span class="s0">:()=&gt;</span><span class="s1">u</span><span class="s0">,</span><span class="s1">wm</span><span class="s0">:()=&gt;</span><span class="s1">Wt</span><span class="s0">});</span><span class="s4">var </span><span class="s1">i</span><span class="s0">=</span><span class="s1">s</span><span class="s0">(</span><span class="s3">71674</span><span class="s0">);</span><span class="s4">var </span><span class="s1">n</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">n</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s4">var </span><span class="s1">o</span><span class="s0">=</span><span class="s1">s</span><span class="s0">(</span><span class="s3">22819</span><span class="s0">);</span><span class="s4">var </span><span class="s1">r</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">n</span><span class="s0">(</span><span class="s1">o</span><span class="s0">);</span><span class="s4">var </span><span class="s1">l</span><span class="s0">=</span><span class="s1">s</span><span class="s0">(</span><span class="s3">4452</span><span class="s0">);</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">n</span><span class="s0">(</span><span class="s1">l</span><span class="s0">);</span><span class="s4">class </span><span class="s1">h</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">explicit</span><span class="s0">=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">=</span><span class="s1">i</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">abortListeners</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">abortOnDocChange</span><span class="s0">=</span><span class="s4">false</span><span class="s0">}</span><span class="s1">tokenBefore</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">syntaxTree</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">).</span><span class="s1">resolveInner</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">while</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">name</span><span class="s0">)&lt;</span><span class="s3">0</span><span class="s0">)</span><span class="s1">e</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">parent</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">?{</span><span class="s1">from</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s1">to</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s1">text</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">sliceDoc</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">),</span><span class="s1">type</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">type</span><span class="s0">}:</span><span class="s4">null</span><span class="s0">}</span><span class="s1">matchBefore</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">doc</span><span class="s0">.</span><span class="s1">lineAt</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">);</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">-</span><span class="s3">250</span><span class="s0">);</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">text</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">s</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">from</span><span class="s0">);</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">search</span><span class="s0">(</span><span class="s1">k</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s4">false</span><span class="s0">));</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s4">null</span><span class="s0">:{</span><span class="s1">from</span><span class="s0">:</span><span class="s1">s</span><span class="s0">+</span><span class="s1">n</span><span class="s0">,</span><span class="s1">to</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s1">text</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">n</span><span class="s0">)}}</span><span class="s1">get aborted</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">abortListeners</span><span class="s0">==</span><span class="s4">null</span><span class="s0">}</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">==</span><span class="s2">&quot;abort&quot;</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">abortListeners</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">abortListeners</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">onDocChange</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">abortOnDocChange</span><span class="s0">=</span><span class="s4">true</span><span class="s0">}}}</span><span class="s4">function </span><span class="s1">c</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">keys</span><span class="s0">(</span><span class="s1">t</span><span class="s0">).</span><span class="s1">join</span><span class="s0">(</span><span class="s2">&quot;&quot;</span><span class="s0">);</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s5">/\w/</span><span class="s0">.</span><span class="s1">test</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)</span><span class="s1">e</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">replace</span><span class="s0">(</span><span class="s5">/\w/g</span><span class="s0">,</span><span class="s2">&quot;&quot;</span><span class="s0">);</span><span class="s4">return</span><span class="s2">`[</span><span class="s1">$</span><span class="s0">{</span><span class="s1">s</span><span class="s0">?</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">w&quot;</span><span class="s0">:</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">replace</span><span class="s0">(</span><span class="s5">/[^\w\s]/g</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">$&amp;&quot;</span><span class="s0">)}</span><span class="s2">]`</span><span class="s0">}</span><span class="s4">function </span><span class="s1">f</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let</span><span class="s0">{</span><span class="s1">label</span><span class="s0">:</span><span class="s1">n</span><span class="s0">}</span><span class="s1">of t</span><span class="s0">){</span><span class="s1">e</span><span class="s0">[</span><span class="s1">n</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]]=</span><span class="s4">true</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++)</span><span class="s1">s</span><span class="s0">[</span><span class="s1">n</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]]=</span><span class="s4">true</span><span class="s0">}</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">c</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)+</span><span class="s1">c</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)+</span><span class="s2">&quot;*$&quot;</span><span class="s0">;</span><span class="s4">return</span><span class="s0">[</span><span class="s4">new </span><span class="s1">RegExp</span><span class="s0">(</span><span class="s2">&quot;^&quot;</span><span class="s0">+</span><span class="s1">i</span><span class="s0">),</span><span class="s4">new </span><span class="s1">RegExp</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)]}</span><span class="s4">function </span><span class="s1">u</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s4">typeof </span><span class="s1">t</span><span class="s0">==</span><span class="s2">&quot;string&quot;</span><span class="s0">?{</span><span class="s1">label</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}:</span><span class="s1">t</span><span class="s0">));</span><span class="s4">let</span><span class="s0">[</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">every</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s5">/^\w+$/</span><span class="s0">.</span><span class="s1">test</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">label</span><span class="s0">)))?[</span><span class="s5">/\w*$/</span><span class="s0">,</span><span class="s5">/\w+$/</span><span class="s0">]:</span><span class="s1">f</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return </span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">matchBefore</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">||</span><span class="s1">t</span><span class="s0">.</span><span class="s1">explicit</span><span class="s0">?{</span><span class="s1">from</span><span class="s0">:</span><span class="s1">n</span><span class="s0">?</span><span class="s1">n</span><span class="s0">.</span><span class="s1">from</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s1">options</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">validFor</span><span class="s0">:</span><span class="s1">s</span><span class="s0">}:</span><span class="s4">null</span><span class="s0">}}</span><span class="s4">function </span><span class="s1">p</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">s</span><span class="s0">=&gt;{</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">syntaxTree</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">state</span><span class="s0">).</span><span class="s1">resolveInner</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">);</span><span class="s1">i</span><span class="s0">;</span><span class="s1">i</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">parent</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">name</span><span class="s0">)&gt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s4">return </span><span class="s1">e</span><span class="s0">(</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">type</span><span class="s0">.</span><span class="s1">isTop</span><span class="s0">)</span><span class="s4">break</span><span class="s0">}</span><span class="s4">return null</span><span class="s0">}}</span><span class="s4">function </span><span class="s1">d</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">s</span><span class="s0">=&gt;{</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">syntaxTree</span><span class="s0">)(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">state</span><span class="s0">).</span><span class="s1">resolveInner</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">);</span><span class="s1">e</span><span class="s0">;</span><span class="s1">e</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">parent</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">name</span><span class="s0">)&gt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">type</span><span class="s0">.</span><span class="s1">isTop</span><span class="s0">)</span><span class="s4">break</span><span class="s0">}</span><span class="s4">return </span><span class="s1">e</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)}}</span><span class="s4">class </span><span class="s1">m</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">source</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">match</span><span class="s0">=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">score</span><span class="s0">=</span><span class="s1">i</span><span class="s0">}}</span><span class="s4">function </span><span class="s1">g</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">.</span><span class="s1">main</span><span class="s0">.</span><span class="s1">from</span><span class="s0">}</span><span class="s4">function </span><span class="s1">k</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">;</span><span class="s4">let</span><span class="s0">{</span><span class="s1">source</span><span class="s0">:</span><span class="s1">i</span><span class="s0">}=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]!=</span><span class="s2">&quot;^&quot;</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">[</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]!=</span><span class="s2">&quot;$&quot;</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">n</span><span class="s0">&amp;&amp;!</span><span class="s1">o</span><span class="s0">)</span><span class="s4">return </span><span class="s1">t</span><span class="s0">;</span><span class="s4">return new </span><span class="s1">RegExp</span><span class="s0">(</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">?</span><span class="s2">&quot;^&quot;</span><span class="s0">:</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s2">(?:</span><span class="s1">$</span><span class="s0">{</span><span class="s1">i</span><span class="s0">}</span><span class="s2">)</span><span class="s1">$</span><span class="s0">{</span><span class="s1">o</span><span class="s0">?</span><span class="s2">&quot;$&quot;</span><span class="s0">:</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s2">`</span><span class="s0">,(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">flags</span><span class="s0">)!==</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">!==</span><span class="s4">void </span><span class="s3">0</span><span class="s0">?</span><span class="s1">s</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ignoreCase</span><span class="s0">?</span><span class="s2">&quot;i&quot;</span><span class="s0">:</span><span class="s2">&quot;&quot;</span><span class="s0">)}</span><span class="s4">const </span><span class="s1">b</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">Annotation</span><span class="s0">.</span><span class="s1">define</span><span class="s0">();</span><span class="s4">function </span><span class="s1">x</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">main</span><span class="s0">:</span><span class="s1">o</span><span class="s0">}=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">s</span><span class="s0">-</span><span class="s1">o</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s1">l</span><span class="s0">=</span><span class="s1">n</span><span class="s0">-</span><span class="s1">o</span><span class="s0">.</span><span class="s1">from</span><span class="s0">;</span><span class="s4">return </span><span class="s1">Object</span><span class="s0">.</span><span class="s1">assign</span><span class="s0">(</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">assign</span><span class="s0">({},</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changeByRange</span><span class="s0">((</span><span class="s1">a</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">!=</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">!=</span><span class="s1">n</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">sliceDoc</span><span class="s0">(</span><span class="s1">a</span><span class="s0">.</span><span class="s1">from</span><span class="s0">+</span><span class="s1">r</span><span class="s0">,</span><span class="s1">a</span><span class="s0">.</span><span class="s1">from</span><span class="s0">+</span><span class="s1">l</span><span class="s0">)!=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">sliceDoc</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">))</span><span class="s4">return</span><span class="s0">{</span><span class="s1">range</span><span class="s0">:</span><span class="s1">a</span><span class="s0">};</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">toText</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return</span><span class="s0">{</span><span class="s1">changes</span><span class="s0">:{</span><span class="s1">from</span><span class="s0">:</span><span class="s1">a</span><span class="s0">.</span><span class="s1">from</span><span class="s0">+</span><span class="s1">r</span><span class="s0">,</span><span class="s1">to</span><span class="s0">:</span><span class="s1">n</span><span class="s0">==</span><span class="s1">o</span><span class="s0">.</span><span class="s1">from</span><span class="s0">?</span><span class="s1">a</span><span class="s0">.</span><span class="s1">to</span><span class="s0">:</span><span class="s1">a</span><span class="s0">.</span><span class="s1">from</span><span class="s0">+</span><span class="s1">l</span><span class="s0">,</span><span class="s1">insert</span><span class="s0">:</span><span class="s1">h</span><span class="s0">},</span><span class="s1">range</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">EditorSelection</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">(</span><span class="s1">a</span><span class="s0">.</span><span class="s1">from</span><span class="s0">+</span><span class="s1">r</span><span class="s0">+</span><span class="s1">h</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)}}))),{</span><span class="s1">scrollIntoView</span><span class="s0">:</span><span class="s4">true</span><span class="s0">,</span><span class="s1">userEvent</span><span class="s0">:</span><span class="s2">&quot;input.complete&quot;</span><span class="s0">})}</span><span class="s4">const </span><span class="s1">v</span><span class="s0">=</span><span class="s4">new </span><span class="s1">WeakMap</span><span class="s0">;</span><span class="s4">function </span><span class="s1">w</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">Array</span><span class="s0">.</span><span class="s1">isArray</span><span class="s0">(</span><span class="s1">t</span><span class="s0">))</span><span class="s4">return </span><span class="s1">t</span><span class="s0">;</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">v</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">)</span><span class="s1">v</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s1">u</span><span class="s0">(</span><span class="s1">t</span><span class="s0">));</span><span class="s4">return </span><span class="s1">e</span><span class="s0">}</span><span class="s4">const </span><span class="s1">y</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">StateEffect</span><span class="s0">.</span><span class="s1">define</span><span class="s0">();</span><span class="s4">const </span><span class="s1">S</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">StateEffect</span><span class="s0">.</span><span class="s1">define</span><span class="s0">();</span><span class="s4">class </span><span class="s1">C</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pattern</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chars</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">folded</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">any</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">precise</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">byWord</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">score</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">matched</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointAt</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">),</span><span class="s1">n</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointSize</span><span class="s0">)(</span><span class="s1">s</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chars</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">s</span><span class="s0">);</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">e</span><span class="s0">+</span><span class="s1">n</span><span class="s0">),</span><span class="s1">r</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toUpperCase</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">folded</span><span class="s0">.</span><span class="s1">push</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointAt</span><span class="s0">)(</span><span class="s1">r</span><span class="s0">==</span><span class="s1">o</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">toLowerCase</span><span class="s0">():</span><span class="s1">r</span><span class="s0">,</span><span class="s3">0</span><span class="s0">));</span><span class="s1">e</span><span class="s0">+=</span><span class="s1">n</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">astral</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">!=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chars</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}</span><span class="s1">ret</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">score</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">matched</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">}</span><span class="s1">match</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pattern</span><span class="s0">.</span><span class="s1">length</span><span class="s0">==</span><span class="s3">0</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">ret</span><span class="s0">(-</span><span class="s3">100</span><span class="s0">,[]);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pattern</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">let</span><span class="s0">{</span><span class="s1">chars</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">folded</span><span class="s0">:</span><span class="s1">s</span><span class="s0">,</span><span class="s1">any</span><span class="s0">:</span><span class="s1">n</span><span class="s0">,</span><span class="s1">precise</span><span class="s0">:</span><span class="s1">o</span><span class="s0">,</span><span class="s1">byWord</span><span class="s0">:</span><span class="s1">r</span><span class="s0">}=</span><span class="s4">this</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">==</span><span class="s3">1</span><span class="s0">){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointAt</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">0</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointSize</span><span class="s0">)(</span><span class="s1">n</span><span class="s0">);</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">o</span><span class="s0">==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:-</span><span class="s3">100</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">==</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]);</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">==</span><span class="s1">s</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])</span><span class="s1">r</span><span class="s0">+=-</span><span class="s3">200</span><span class="s0">;</span><span class="s4">else return null</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">ret</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,[</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">])}</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pattern</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">==</span><span class="s3">0</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">ret</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pattern</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:-</span><span class="s3">100</span><span class="s0">,[</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pattern</span><span class="s0">.</span><span class="s1">length</span><span class="s0">]);</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s3">200</span><span class="s0">);</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s1">a</span><span class="s0">;){</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointAt</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">o</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">==</span><span class="s1">e</span><span class="s0">[</span><span class="s1">h</span><span class="s0">]||</span><span class="s1">r</span><span class="s0">==</span><span class="s1">s</span><span class="s0">[</span><span class="s1">h</span><span class="s0">])</span><span class="s1">n</span><span class="s0">[</span><span class="s1">h</span><span class="s0">++]=</span><span class="s1">o</span><span class="s0">;</span><span class="s1">o</span><span class="s0">+=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointSize</span><span class="s0">)(</span><span class="s1">r</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s1">a</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">}</span><span class="s4">let </span><span class="s1">c</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">f</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">u</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">let </span><span class="s1">p</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">d</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">m</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">let </span><span class="s1">g</span><span class="s0">=</span><span class="s5">/[a-z]/</span><span class="s0">.</span><span class="s1">test</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">k</span><span class="s0">=</span><span class="s4">true</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">b</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">x</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s3">200</span><span class="s0">),</span><span class="s1">v</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">b</span><span class="s0">&lt;</span><span class="s1">x</span><span class="s0">&amp;&amp;</span><span class="s1">f</span><span class="s0">&lt;</span><span class="s1">a</span><span class="s0">;){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointAt</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">b</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">c</span><span class="s0">&lt;</span><span class="s1">a</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">==</span><span class="s1">e</span><span class="s0">[</span><span class="s1">c</span><span class="s0">])</span><span class="s1">o</span><span class="s0">[</span><span class="s1">c</span><span class="s0">++]=</span><span class="s1">b</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">p</span><span class="s0">&lt;</span><span class="s1">a</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">==</span><span class="s1">e</span><span class="s0">[</span><span class="s1">p</span><span class="s0">]||</span><span class="s1">n</span><span class="s0">==</span><span class="s1">s</span><span class="s0">[</span><span class="s1">p</span><span class="s0">]){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">p</span><span class="s0">==</span><span class="s3">0</span><span class="s0">)</span><span class="s1">d</span><span class="s0">=</span><span class="s1">b</span><span class="s0">;</span><span class="s1">m</span><span class="s0">=</span><span class="s1">b</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;</span><span class="s1">p</span><span class="s0">++}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">p</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}}}</span><span class="s4">let </span><span class="s1">h</span><span class="s0">,</span><span class="s1">x</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">255</span><span class="s0">?</span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s3">48</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">&lt;=</span><span class="s3">57</span><span class="s0">||</span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s3">97</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">&lt;=</span><span class="s3">122</span><span class="s0">?</span><span class="s3">2</span><span class="s0">:</span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s3">65</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">&lt;=</span><span class="s3">90</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">:(</span><span class="s1">h</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">fromCodePoint</span><span class="s0">)(</span><span class="s1">n</span><span class="s0">))!=</span><span class="s1">h</span><span class="s0">.</span><span class="s1">toLowerCase</span><span class="s0">()?</span><span class="s3">1</span><span class="s0">:</span><span class="s1">h</span><span class="s0">!=</span><span class="s1">h</span><span class="s0">.</span><span class="s1">toUpperCase</span><span class="s0">()?</span><span class="s3">2</span><span class="s0">:</span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">b</span><span class="s0">||</span><span class="s1">x</span><span class="s0">==</span><span class="s3">1</span><span class="s0">&amp;&amp;</span><span class="s1">g</span><span class="s0">||</span><span class="s1">v</span><span class="s0">==</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">x</span><span class="s0">!=</span><span class="s3">0</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s1">f</span><span class="s0">]==</span><span class="s1">n</span><span class="s0">||</span><span class="s1">s</span><span class="s0">[</span><span class="s1">f</span><span class="s0">]==</span><span class="s1">n</span><span class="s0">&amp;&amp;(</span><span class="s1">u</span><span class="s0">=</span><span class="s4">true</span><span class="s0">))</span><span class="s1">r</span><span class="s0">[</span><span class="s1">f</span><span class="s0">++]=</span><span class="s1">b</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s1">k</span><span class="s0">=</span><span class="s4">false</span><span class="s0">}</span><span class="s1">v</span><span class="s0">=</span><span class="s1">x</span><span class="s0">;</span><span class="s1">b</span><span class="s0">+=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointSize</span><span class="s0">)(</span><span class="s1">n</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">f</span><span class="s0">==</span><span class="s1">a</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]==</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">k</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">result</span><span class="s0">(-</span><span class="s3">100</span><span class="s0">+(</span><span class="s1">u</span><span class="s0">?-</span><span class="s3">200</span><span class="s0">:</span><span class="s3">0</span><span class="s0">),</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">p</span><span class="s0">==</span><span class="s1">a</span><span class="s0">&amp;&amp;</span><span class="s1">d</span><span class="s0">==</span><span class="s3">0</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">ret</span><span class="s0">(-</span><span class="s3">200</span><span class="s0">-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">+(</span><span class="s1">m</span><span class="s0">==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:-</span><span class="s3">100</span><span class="s0">),[</span><span class="s3">0</span><span class="s0">,</span><span class="s1">m</span><span class="s0">]);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">ret</span><span class="s0">(-</span><span class="s3">700</span><span class="s0">-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,[</span><span class="s1">l</span><span class="s0">,</span><span class="s1">l</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pattern</span><span class="s0">.</span><span class="s1">length</span><span class="s0">]);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">p</span><span class="s0">==</span><span class="s1">a</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">ret</span><span class="s0">(-</span><span class="s3">200</span><span class="s0">+-</span><span class="s3">700</span><span class="s0">-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,[</span><span class="s1">d</span><span class="s0">,</span><span class="s1">m</span><span class="s0">]);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">f</span><span class="s0">==</span><span class="s1">a</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">result</span><span class="s0">(-</span><span class="s3">100</span><span class="s0">+(</span><span class="s1">u</span><span class="s0">?-</span><span class="s3">200</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)+-</span><span class="s3">700</span><span class="s0">+(</span><span class="s1">k</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:-</span><span class="s3">1100</span><span class="s0">),</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">==</span><span class="s3">2</span><span class="s0">?</span><span class="s4">null</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">result</span><span class="s0">((</span><span class="s1">n</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]?-</span><span class="s3">700</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)+-</span><span class="s3">200</span><span class="s0">+-</span><span class="s3">1100</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">result</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=[],</span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r of e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">r</span><span class="s0">+(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">astral</span><span class="s0">?(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointSize</span><span class="s0">)((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointAt</span><span class="s0">)(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">)):</span><span class="s3">1</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">[</span><span class="s1">o</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]==</span><span class="s1">r</span><span class="s0">)</span><span class="s1">n</span><span class="s0">[</span><span class="s1">o</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">else</span><span class="s0">{</span><span class="s1">n</span><span class="s0">[</span><span class="s1">o</span><span class="s0">++]=</span><span class="s1">r</span><span class="s0">;</span><span class="s1">n</span><span class="s0">[</span><span class="s1">o</span><span class="s0">++]=</span><span class="s1">t</span><span class="s0">}}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">ret</span><span class="s0">(</span><span class="s1">t</span><span class="s0">-</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)}}</span><span class="s4">class </span><span class="s1">P</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pattern</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">matched</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">score</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">folded</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">toLowerCase</span><span class="s0">()}</span><span class="s1">match</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pattern</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pattern</span><span class="s0">.</span><span class="s1">length</span><span class="s0">);</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pattern</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">toLowerCase</span><span class="s0">()==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">folded</span><span class="s0">?-</span><span class="s3">200</span><span class="s0">:</span><span class="s4">null</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">==</span><span class="s4">null</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">matched</span><span class="s0">=[</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">score</span><span class="s0">=</span><span class="s1">s</span><span class="s0">+(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pattern</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:-</span><span class="s3">100</span><span class="s0">);</span><span class="s4">return this</span><span class="s0">}}</span><span class="s4">const </span><span class="s1">T</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">Facet</span><span class="s0">.</span><span class="s1">define</span><span class="s0">({</span><span class="s1">combine</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">combineConfig</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">,{</span><span class="s1">activateOnTyping</span><span class="s0">:</span><span class="s4">true</span><span class="s0">,</span><span class="s1">activateOnCompletion</span><span class="s0">:()=&gt;</span><span class="s4">false</span><span class="s0">,</span><span class="s1">activateOnTypingDelay</span><span class="s0">:</span><span class="s3">100</span><span class="s0">,</span><span class="s1">selectOnOpen</span><span class="s0">:</span><span class="s4">true</span><span class="s0">,</span><span class="s1">override</span><span class="s0">:</span><span class="s4">null</span><span class="s0">,</span><span class="s1">closeOnBlur</span><span class="s0">:</span><span class="s4">true</span><span class="s0">,</span><span class="s1">maxRenderedOptions</span><span class="s0">:</span><span class="s3">100</span><span class="s0">,</span><span class="s1">defaultKeymap</span><span class="s0">:</span><span class="s4">true</span><span class="s0">,</span><span class="s1">tooltipClass</span><span class="s0">:()=&gt;</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">optionClass</span><span class="s0">:()=&gt;</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">aboveCursor</span><span class="s0">:</span><span class="s4">false</span><span class="s0">,</span><span class="s1">icons</span><span class="s0">:</span><span class="s4">true</span><span class="s0">,</span><span class="s1">addToOptions</span><span class="s0">:[],</span><span class="s1">positionInfo</span><span class="s0">:</span><span class="s1">I</span><span class="s0">,</span><span class="s1">filterStrict</span><span class="s0">:</span><span class="s4">false</span><span class="s0">,</span><span class="s1">compareCompletions</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">label</span><span class="s0">.</span><span class="s1">localeCompare</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">label</span><span class="s0">),</span><span class="s1">interactionDelay</span><span class="s0">:</span><span class="s3">75</span><span class="s0">,</span><span class="s1">updateSyncTime</span><span class="s0">:</span><span class="s3">100</span><span class="s0">},{</span><span class="s1">defaultKeymap</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">,</span><span class="s1">closeOnBlur</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">,</span><span class="s1">icons</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">,</span><span class="s1">tooltipClass</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">s</span><span class="s0">=&gt;</span><span class="s1">A</span><span class="s0">(</span><span class="s1">t</span><span class="s0">(</span><span class="s1">s</span><span class="s0">),</span><span class="s1">e</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)),</span><span class="s1">optionClass</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">s</span><span class="s0">=&gt;</span><span class="s1">A</span><span class="s0">(</span><span class="s1">t</span><span class="s0">(</span><span class="s1">s</span><span class="s0">),</span><span class="s1">e</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)),</span><span class="s1">addToOptions</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">concat</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">filterStrict</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">t</span><span class="s0">||</span><span class="s1">e</span><span class="s0">})}});</span><span class="s4">function </span><span class="s1">A</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">?</span><span class="s1">e</span><span class="s0">?</span><span class="s1">t</span><span class="s0">+</span><span class="s2">&quot; &quot;</span><span class="s0">+</span><span class="s1">e</span><span class="s0">:</span><span class="s1">t</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}</span><span class="s4">function </span><span class="s1">I</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">r</span><span class="s0">){</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">textDirection</span><span class="s0">==</span><span class="s1">o</span><span class="s0">.</span><span class="s1">Direction</span><span class="s0">.</span><span class="s1">RTL</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">l</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">let </span><span class="s1">c</span><span class="s0">=</span><span class="s2">&quot;top&quot;</span><span class="s0">,</span><span class="s1">f</span><span class="s0">,</span><span class="s1">u</span><span class="s0">;</span><span class="s4">let </span><span class="s1">p</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">left</span><span class="s0">-</span><span class="s1">n</span><span class="s0">.</span><span class="s1">left</span><span class="s0">,</span><span class="s1">d</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">right</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">right</span><span class="s0">;</span><span class="s4">let </span><span class="s1">m</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">right</span><span class="s0">-</span><span class="s1">i</span><span class="s0">.</span><span class="s1">left</span><span class="s0">,</span><span class="s1">g</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">-</span><span class="s1">i</span><span class="s0">.</span><span class="s1">top</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">&amp;&amp;</span><span class="s1">p</span><span class="s0">&lt;</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">m</span><span class="s0">,</span><span class="s1">d</span><span class="s0">))</span><span class="s1">a</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(!</span><span class="s1">a</span><span class="s0">&amp;&amp;</span><span class="s1">d</span><span class="s0">&lt;</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">m</span><span class="s0">,</span><span class="s1">p</span><span class="s0">))</span><span class="s1">a</span><span class="s0">=</span><span class="s4">true</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">m</span><span class="s0">&lt;=(</span><span class="s1">a</span><span class="s0">?</span><span class="s1">p</span><span class="s0">:</span><span class="s1">d</span><span class="s0">)){</span><span class="s1">f</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">top</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">top</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">-</span><span class="s1">g</span><span class="s0">))-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">top</span><span class="s0">;</span><span class="s1">u</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s3">400</span><span class="s0">,</span><span class="s1">a</span><span class="s0">?</span><span class="s1">p</span><span class="s0">:</span><span class="s1">d</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">h</span><span class="s0">=</span><span class="s4">true</span><span class="s0">;</span><span class="s1">u</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s3">400</span><span class="s0">,(</span><span class="s1">l</span><span class="s0">?</span><span class="s1">e</span><span class="s0">.</span><span class="s1">right</span><span class="s0">:</span><span class="s1">n</span><span class="s0">.</span><span class="s1">right</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">left</span><span class="s0">)-</span><span class="s3">30</span><span class="s0">);</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s1">g</span><span class="s0">||</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">top</span><span class="s0">){</span><span class="s1">f</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">top</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">c</span><span class="s0">=</span><span class="s2">&quot;bottom&quot;</span><span class="s0">;</span><span class="s1">f</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">-</span><span class="s1">s</span><span class="s0">.</span><span class="s1">top</span><span class="s0">}}</span><span class="s4">let </span><span class="s1">k</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">top</span><span class="s0">)/</span><span class="s1">r</span><span class="s0">.</span><span class="s1">offsetHeight</span><span class="s0">;</span><span class="s4">let </span><span class="s1">b</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">right</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">left</span><span class="s0">)/</span><span class="s1">r</span><span class="s0">.</span><span class="s1">offsetWidth</span><span class="s0">;</span><span class="s4">return</span><span class="s0">{</span><span class="s1">style</span><span class="s0">:</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s1">c</span><span class="s0">}</span><span class="s2">: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">f</span><span class="s0">/</span><span class="s1">k</span><span class="s0">}</span><span class="s2">px; max-width: </span><span class="s1">$</span><span class="s0">{</span><span class="s1">u</span><span class="s0">/</span><span class="s1">b</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s4">class</span><span class="s0">:</span><span class="s2">&quot;cm-completionInfo-&quot;</span><span class="s0">+(</span><span class="s1">h</span><span class="s0">?</span><span class="s1">l</span><span class="s0">?</span><span class="s2">&quot;left-narrow&quot;</span><span class="s0">:</span><span class="s2">&quot;right-narrow&quot;</span><span class="s0">:</span><span class="s1">a</span><span class="s0">?</span><span class="s2">&quot;left&quot;</span><span class="s0">:</span><span class="s2">&quot;right&quot;</span><span class="s0">)}}</span><span class="s4">function </span><span class="s1">O</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">addToOptions</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">icons</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">({</span><span class="s1">render</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;cm-completionIcon&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">type</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s1">...t</span><span class="s0">.</span><span class="s1">type</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s5">/\s+/g</span><span class="s0">).</span><span class="s1">map</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s2">&quot;cm-completionIcon-&quot;</span><span class="s0">+</span><span class="s1">t</span><span class="s0">)));</span><span class="s1">e</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-hidden&quot;</span><span class="s0">,</span><span class="s2">&quot;true&quot;</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">},</span><span class="s1">position</span><span class="s0">:</span><span class="s3">20</span><span class="s0">});</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">({</span><span class="s1">render</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;span&quot;</span><span class="s0">);</span><span class="s1">n</span><span class="s0">.</span><span class="s1">className</span><span class="s0">=</span><span class="s2">&quot;cm-completionLabel&quot;</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">displayLabel</span><span class="s0">||</span><span class="s1">t</span><span class="s0">.</span><span class="s1">label</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">l</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">i</span><span class="s0">[</span><span class="s1">l</span><span class="s0">++],</span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">[</span><span class="s1">l</span><span class="s0">++];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s1">r</span><span class="s0">)</span><span class="s1">n</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createTextNode</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)));</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;span&quot;</span><span class="s0">));</span><span class="s1">s</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createTextNode</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)));</span><span class="s1">s</span><span class="s0">.</span><span class="s1">className</span><span class="s0">=</span><span class="s2">&quot;cm-completionMatchedText&quot;</span><span class="s0">;</span><span class="s1">r</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s1">n</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createTextNode</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)));</span><span class="s4">return </span><span class="s1">n</span><span class="s0">},</span><span class="s1">position</span><span class="s0">:</span><span class="s3">50</span><span class="s0">},{</span><span class="s1">render</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">detail</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;span&quot;</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">className</span><span class="s0">=</span><span class="s2">&quot;cm-completionDetail&quot;</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">detail</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">},</span><span class="s1">position</span><span class="s0">:</span><span class="s3">80</span><span class="s0">});</span><span class="s4">return </span><span class="s1">e</span><span class="s0">.</span><span class="s1">sort</span><span class="s0">(((</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">position</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">position</span><span class="s0">)).</span><span class="s1">map</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">render</span><span class="s0">))}</span><span class="s4">function </span><span class="s1">R</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&lt;=</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return</span><span class="s0">{</span><span class="s1">from</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">to</span><span class="s0">:</span><span class="s1">t</span><span class="s0">};</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">)</span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">1</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">/</span><span class="s1">s</span><span class="s0">);</span><span class="s4">return</span><span class="s0">{</span><span class="s1">from</span><span class="s0">:</span><span class="s1">t</span><span class="s0">*</span><span class="s1">s</span><span class="s0">,</span><span class="s1">to</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)*</span><span class="s1">s</span><span class="s0">}}</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">((</span><span class="s1">t</span><span class="s0">-</span><span class="s1">e</span><span class="s0">)/</span><span class="s1">s</span><span class="s0">);</span><span class="s4">return</span><span class="s0">{</span><span class="s1">from</span><span class="s0">:</span><span class="s1">t</span><span class="s0">-(</span><span class="s1">i</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)*</span><span class="s1">s</span><span class="s0">,</span><span class="s1">to</span><span class="s0">:</span><span class="s1">t</span><span class="s0">-</span><span class="s1">i</span><span class="s0">*</span><span class="s1">s</span><span class="s0">}}</span><span class="s4">class </span><span class="s1">D</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stateField</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">applyCompletion</span><span class="s0">=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">infoDestroy</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">placeInfoReq</span><span class="s0">={</span><span class="s1">read</span><span class="s0">:()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">measureInfo</span><span class="s0">(),</span><span class="s1">write</span><span class="s0">:</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">placeInfo</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">key</span><span class="s0">:</span><span class="s4">this</span><span class="s0">};</span><span class="s4">this</span><span class="s0">.</span><span class="s1">space</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">currentClass</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">let</span><span class="s0">{</span><span class="s1">options</span><span class="s0">:</span><span class="s1">n</span><span class="s0">,</span><span class="s1">selected</span><span class="s0">:</span><span class="s1">o</span><span class="s0">}=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">;</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionContent</span><span class="s0">=</span><span class="s1">O</span><span class="s0">(</span><span class="s1">r</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionClass</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">optionClass</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tooltipClass</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">tooltipClass</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">=</span><span class="s1">R</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">maxRenderedOptions</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">=</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">className</span><span class="s0">=</span><span class="s2">&quot;cm-tooltip-autocomplete&quot;</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateTooltipClass</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;mousedown&quot;</span><span class="s0">,(</span><span class="s1">s</span><span class="s0">=&gt;{</span><span class="s4">let</span><span class="s0">{</span><span class="s1">options</span><span class="s0">:</span><span class="s1">i</span><span class="s0">}=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">e</span><span class="s0">).</span><span class="s1">open</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">target</span><span class="s0">,</span><span class="s1">n</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">!=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">;</span><span class="s1">e</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">parentNode</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">nodeName</span><span class="s0">==</span><span class="s2">&quot;LI&quot;</span><span class="s0">&amp;&amp;(</span><span class="s1">n</span><span class="s0">=</span><span class="s5">/-(\d+)$/</span><span class="s0">.</span><span class="s1">exec</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">id</span><span class="s0">))&amp;&amp;+</span><span class="s1">n</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]&lt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">applyCompletion</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">[+</span><span class="s1">n</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]]);</span><span class="s1">s</span><span class="s0">.</span><span class="s1">preventDefault</span><span class="s0">();</span><span class="s4">return</span><span class="s0">}}}));</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;focusout&quot;</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stateField</span><span class="s0">,</span><span class="s4">false</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">tooltip</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">).</span><span class="s1">closeOnBlur</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">relatedTarget</span><span class="s0">!=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">contentDOM</span><span class="s0">)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispatch</span><span class="s0">({</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">S</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s4">null</span><span class="s0">)})}));</span><span class="s4">this</span><span class="s0">.</span><span class="s1">showOptions</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">id</span><span class="s0">)}</span><span class="s1">mount</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateSel</span><span class="s0">()}</span><span class="s1">showOptions</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">list</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">list</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">list</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">createListBox</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">));</span><span class="s4">this</span><span class="s0">.</span><span class="s1">list</span><span class="s0">.</span><span class="s1">addEventListener</span><span class="s0">(</span><span class="s2">&quot;scroll&quot;</span><span class="s0">,(()=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">requestMeasure</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">placeInfoReq</span><span class="s0">)}))}</span><span class="s1">update</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">var </span><span class="s1">e</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stateField</span><span class="s0">);</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">startState</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stateField</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateTooltipClass</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">!=</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">options</span><span class="s0">:</span><span class="s1">n</span><span class="s0">,</span><span class="s1">selected</span><span class="s0">:</span><span class="s1">o</span><span class="s0">,</span><span class="s1">disabled</span><span class="s0">:</span><span class="s1">r</span><span class="s0">}=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">open</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">||</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">options</span><span class="s0">!=</span><span class="s1">n</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">=</span><span class="s1">R</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">).</span><span class="s1">maxRenderedOptions</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">showOptions</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">id</span><span class="s0">)}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateSel</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">!=((</span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">)===</span><span class="s4">null</span><span class="s0">||</span><span class="s1">e</span><span class="s0">===</span><span class="s4">void </span><span class="s3">0</span><span class="s0">?</span><span class="s4">void </span><span class="s3">0</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">))</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">toggle</span><span class="s0">(</span><span class="s2">&quot;cm-tooltip-autocomplete-disabled&quot;</span><span class="s0">,!!</span><span class="s1">r</span><span class="s0">)}}</span><span class="s1">updateTooltipClass</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tooltipClass</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">!=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">currentClass</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">currentClass</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s2">&quot; &quot;</span><span class="s0">))</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t of e</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s2">&quot; &quot;</span><span class="s0">))</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">currentClass</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}}</span><span class="s1">positioned</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">space</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">requestMeasure</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">placeInfoReq</span><span class="s0">)}</span><span class="s1">updateSel</span><span class="s0">(){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stateField</span><span class="s0">),</span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">open</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">from</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">to</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">=</span><span class="s1">R</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">).</span><span class="s1">maxRenderedOptions</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">showOptions</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">id</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateSelectedOption</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">)){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">destroyInfo</span><span class="s0">();</span><span class="s4">let</span><span class="s0">{</span><span class="s1">completion</span><span class="s0">:</span><span class="s1">s</span><span class="s0">}=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">options</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">];</span><span class="s4">let</span><span class="s0">{</span><span class="s1">info</span><span class="s0">:</span><span class="s1">i</span><span class="s0">}=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">typeof </span><span class="s1">i</span><span class="s0">===</span><span class="s2">&quot;string&quot;</span><span class="s0">?</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createTextNode</span><span class="s0">(</span><span class="s1">i</span><span class="s0">):</span><span class="s1">i</span><span class="s0">(</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">n</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s2">&quot;then&quot;</span><span class="s4">in </span><span class="s1">n</span><span class="s0">){</span><span class="s1">n</span><span class="s0">.</span><span class="s1">then</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stateField</span><span class="s0">,</span><span class="s4">false</span><span class="s0">)==</span><span class="s1">t</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">addInfoPane</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)})).</span><span class="s1">catch</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">logException</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s2">&quot;completion info&quot;</span><span class="s0">)))}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">addInfoPane</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)}}}</span><span class="s1">addInfoPane</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">destroyInfo</span><span class="s0">();</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">=</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;div&quot;</span><span class="s0">);</span><span class="s1">s</span><span class="s0">.</span><span class="s1">className</span><span class="s0">=</span><span class="s2">&quot;cm-tooltip cm-completionInfo&quot;</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">nodeType</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">){</span><span class="s1">s</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">infoDestroy</span><span class="s0">=</span><span class="s4">null</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">let</span><span class="s0">{</span><span class="s1">dom</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">destroy</span><span class="s0">:</span><span class="s1">i</span><span class="s0">}=</span><span class="s1">t</span><span class="s0">;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">infoDestroy</span><span class="s0">=</span><span class="s1">i</span><span class="s0">||</span><span class="s4">null</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">s</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">requestMeasure</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">placeInfoReq</span><span class="s0">)}</span><span class="s1">updateSelectedOption</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">list</span><span class="s0">.</span><span class="s1">firstChild</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">from</span><span class="s0">;</span><span class="s1">s</span><span class="s0">;</span><span class="s1">s</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">nextSibling</span><span class="s0">,</span><span class="s1">i</span><span class="s0">++){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">nodeName</span><span class="s0">!=</span><span class="s2">&quot;LI&quot;</span><span class="s0">||!</span><span class="s1">s</span><span class="s0">.</span><span class="s1">id</span><span class="s0">){</span><span class="s1">i</span><span class="s0">--}</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">==</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">.</span><span class="s1">hasAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-selected&quot;</span><span class="s0">)){</span><span class="s1">s</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-selected&quot;</span><span class="s0">,</span><span class="s2">&quot;true&quot;</span><span class="s0">);</span><span class="s1">e</span><span class="s0">=</span><span class="s1">s</span><span class="s0">}}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">hasAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-selected&quot;</span><span class="s0">))</span><span class="s1">s</span><span class="s0">.</span><span class="s1">removeAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-selected&quot;</span><span class="s0">)}}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)</span><span class="s1">N</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">list</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">}</span><span class="s1">measureInfo</span><span class="s0">(){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">querySelector</span><span class="s0">(</span><span class="s2">&quot;[aria-selected]&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">||!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">getBoundingClientRect</span><span class="s0">();</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">.</span><span class="s1">getBoundingClientRect</span><span class="s0">();</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getBoundingClientRect</span><span class="s0">();</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">space</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">n</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">ownerDocument</span><span class="s0">.</span><span class="s1">defaultView</span><span class="s0">||</span><span class="s1">window</span><span class="s0">;</span><span class="s1">n</span><span class="s0">={</span><span class="s1">left</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">top</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">right</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">innerWidth</span><span class="s0">,</span><span class="s1">bottom</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">innerHeight</span><span class="s0">}}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">top</span><span class="s0">&gt;</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">)-</span><span class="s3">10</span><span class="s0">||</span><span class="s1">i</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">&lt;</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">top</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">top</span><span class="s0">)+</span><span class="s3">10</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">).</span><span class="s1">positionInfo</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">)}</span><span class="s1">placeInfo</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">cssText</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">style</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">.</span><span class="s1">className</span><span class="s0">=</span><span class="s2">&quot;cm-tooltip cm-completionInfo &quot;</span><span class="s0">+(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">class</span><span class="s0">||</span><span class="s2">&quot;&quot;</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">.</span><span class="s1">style</span><span class="s0">.</span><span class="s1">cssText</span><span class="s0">=</span><span class="s2">&quot;top: -1e6px&quot;</span><span class="s0">}}}</span><span class="s1">createListBox</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">const </span><span class="s1">i</span><span class="s0">=</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;ul&quot;</span><span class="s0">);</span><span class="s1">i</span><span class="s0">.</span><span class="s1">id</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;role&quot;</span><span class="s0">,</span><span class="s2">&quot;listbox&quot;</span><span class="s0">);</span><span class="s1">i</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-expanded&quot;</span><span class="s0">,</span><span class="s2">&quot;true&quot;</span><span class="s0">);</span><span class="s1">i</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;aria-label&quot;</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">phrase</span><span class="s0">(</span><span class="s2">&quot;Completions&quot;</span><span class="s0">));</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">from</span><span class="s0">;</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">to</span><span class="s0">;</span><span class="s1">o</span><span class="s0">++){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">completion</span><span class="s0">:</span><span class="s1">r</span><span class="s0">,</span><span class="s1">match</span><span class="s0">:</span><span class="s1">l</span><span class="s0">}=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">o</span><span class="s0">],{</span><span class="s1">section</span><span class="s0">:</span><span class="s1">a</span><span class="s0">}=</span><span class="s1">r</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">typeof </span><span class="s1">a</span><span class="s0">==</span><span class="s2">&quot;string&quot;</span><span class="s0">?</span><span class="s1">a</span><span class="s0">:</span><span class="s1">a</span><span class="s0">.</span><span class="s1">name</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">!=</span><span class="s1">n</span><span class="s0">&amp;&amp;(</span><span class="s1">o</span><span class="s0">&gt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">from</span><span class="s0">||</span><span class="s1">s</span><span class="s0">.</span><span class="s1">from</span><span class="s0">==</span><span class="s3">0</span><span class="s0">)){</span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">typeof </span><span class="s1">a</span><span class="s0">!=</span><span class="s2">&quot;string&quot;</span><span class="s0">&amp;&amp;</span><span class="s1">a</span><span class="s0">.</span><span class="s1">header</span><span class="s0">){</span><span class="s1">i</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">a</span><span class="s0">.</span><span class="s1">header</span><span class="s0">(</span><span class="s1">a</span><span class="s0">))}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;completion-section&quot;</span><span class="s0">));</span><span class="s1">e</span><span class="s0">.</span><span class="s1">textContent</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}}}</span><span class="s4">const </span><span class="s1">h</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;li&quot;</span><span class="s0">));</span><span class="s1">h</span><span class="s0">.</span><span class="s1">id</span><span class="s0">=</span><span class="s1">e</span><span class="s0">+</span><span class="s2">&quot;-&quot;</span><span class="s0">+</span><span class="s1">o</span><span class="s0">;</span><span class="s1">h</span><span class="s0">.</span><span class="s1">setAttribute</span><span class="s0">(</span><span class="s2">&quot;role&quot;</span><span class="s0">,</span><span class="s2">&quot;option&quot;</span><span class="s0">);</span><span class="s4">let </span><span class="s1">c</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionClass</span><span class="s0">(</span><span class="s1">r</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">c</span><span class="s0">)</span><span class="s1">h</span><span class="s0">.</span><span class="s1">className</span><span class="s0">=</span><span class="s1">c</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">optionContent</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">,</span><span class="s1">l</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)</span><span class="s1">h</span><span class="s0">.</span><span class="s1">appendChild</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">from</span><span class="s0">)</span><span class="s1">i</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;cm-completionListIncompleteTop&quot;</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">to</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s1">i</span><span class="s0">.</span><span class="s1">classList</span><span class="s0">.</span><span class="s1">add</span><span class="s0">(</span><span class="s2">&quot;cm-completionListIncompleteBottom&quot;</span><span class="s0">);</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s1">destroyInfo</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">infoDestroy</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">infoDestroy</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">.</span><span class="s1">remove</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">info</span><span class="s0">=</span><span class="s4">null</span><span class="s0">}}</span><span class="s1">destroy</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">destroyInfo</span><span class="s0">()}}</span><span class="s4">function </span><span class="s1">E</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">s</span><span class="s0">=&gt;</span><span class="s4">new </span><span class="s1">D</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">function </span><span class="s1">N</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getBoundingClientRect</span><span class="s0">();</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">getBoundingClientRect</span><span class="s0">();</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">height</span><span class="s0">/</span><span class="s1">t</span><span class="s0">.</span><span class="s1">offsetHeight</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">top</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">top</span><span class="s0">)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">-=(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">top</span><span class="s0">-</span><span class="s1">i</span><span class="s0">.</span><span class="s1">top</span><span class="s0">)/</span><span class="s1">n</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">&gt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">scrollTop</span><span class="s0">+=(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">-</span><span class="s1">s</span><span class="s0">.</span><span class="s1">bottom</span><span class="s0">)/</span><span class="s1">n</span><span class="s0">}</span><span class="s4">function </span><span class="s1">L</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">boost</span><span class="s0">||</span><span class="s3">0</span><span class="s0">)*</span><span class="s3">100</span><span class="s0">+(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">apply</span><span class="s0">?</span><span class="s3">10</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)+(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">info</span><span class="s0">?</span><span class="s3">5</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)+(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">type</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">function </span><span class="s1">B</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=[];</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">let</span><span class="s0">{</span><span class="s1">section</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">)</span><span class="s1">i</span><span class="s0">=[];</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">typeof </span><span class="s1">e</span><span class="s0">==</span><span class="s2">&quot;string&quot;</span><span class="s0">?</span><span class="s1">e</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">name</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">name</span><span class="s0">==</span><span class="s1">t</span><span class="s0">)))</span><span class="s1">i</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">typeof </span><span class="s1">e</span><span class="s0">==</span><span class="s2">&quot;string&quot;</span><span class="s0">?{</span><span class="s1">name</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}:</span><span class="s1">e</span><span class="s0">)}};</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">h of t</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">.</span><span class="s1">hasResult</span><span class="s0">()){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">h</span><span class="s0">.</span><span class="s1">result</span><span class="s0">.</span><span class="s1">getMatch</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">.</span><span class="s1">result</span><span class="s0">.</span><span class="s1">filter</span><span class="s0">===</span><span class="s4">false</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e of h</span><span class="s0">.</span><span class="s1">result</span><span class="s0">.</span><span class="s1">options</span><span class="s0">){</span><span class="s1">n</span><span class="s0">(</span><span class="s4">new </span><span class="s1">m</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s1">t</span><span class="s0">?</span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">):[],</span><span class="s3">1e9</span><span class="s0">-</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">))}}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">sliceDoc</span><span class="s0">(</span><span class="s1">h</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">to</span><span class="s0">),</span><span class="s1">i</span><span class="s0">;</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">filterStrict</span><span class="s0">?</span><span class="s4">new </span><span class="s1">P</span><span class="s0">(</span><span class="s1">s</span><span class="s0">):</span><span class="s4">new </span><span class="s1">C</span><span class="s0">(</span><span class="s1">s</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e of h</span><span class="s0">.</span><span class="s1">result</span><span class="s0">.</span><span class="s1">options</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">match</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">label</span><span class="s0">)){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">displayLabel</span><span class="s0">?</span><span class="s1">i</span><span class="s0">.</span><span class="s1">matched</span><span class="s0">:</span><span class="s1">t</span><span class="s0">?</span><span class="s1">t</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">matched</span><span class="s0">):[];</span><span class="s1">n</span><span class="s0">(</span><span class="s4">new </span><span class="s1">m</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">score</span><span class="s0">+(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">boost</span><span class="s0">||</span><span class="s3">0</span><span class="s0">)))}}}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">),</span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;{</span><span class="s4">var </span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">;</span><span class="s4">return</span><span class="s0">((</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">rank</span><span class="s0">)!==</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">!==</span><span class="s4">void </span><span class="s3">0</span><span class="s0">?</span><span class="s1">s</span><span class="s0">:</span><span class="s3">1e9</span><span class="s0">)-((</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">rank</span><span class="s0">)!==</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">!==</span><span class="s4">void </span><span class="s3">0</span><span class="s0">?</span><span class="s1">i</span><span class="s0">:</span><span class="s3">1e9</span><span class="s0">)||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">name</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">name</span><span class="s0">?-</span><span class="s3">1</span><span class="s0">:</span><span class="s3">1</span><span class="s0">)};</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s of i</span><span class="s0">.</span><span class="s1">sort</span><span class="s0">(</span><span class="s1">n</span><span class="s0">)){</span><span class="s1">e</span><span class="s0">-=</span><span class="s3">1e5</span><span class="s0">;</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">.</span><span class="s1">name</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">}</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i of s</span><span class="s0">){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">section</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)</span><span class="s1">i</span><span class="s0">.</span><span class="s1">score</span><span class="s0">+=</span><span class="s1">t</span><span class="s0">[</span><span class="s4">typeof </span><span class="s1">e</span><span class="s0">==</span><span class="s2">&quot;string&quot;</span><span class="s0">?</span><span class="s1">e</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">name</span><span class="s0">]}}</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=[],</span><span class="s1">l</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">compareCompletions</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">h of s</span><span class="s0">.</span><span class="s1">sort</span><span class="s0">(((</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">score</span><span class="s0">-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">score</span><span class="s0">||</span><span class="s1">a</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">)))){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">h</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">l</span><span class="s0">||</span><span class="s1">l</span><span class="s0">.</span><span class="s1">label</span><span class="s0">!=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">label</span><span class="s0">||</span><span class="s1">l</span><span class="s0">.</span><span class="s1">detail</span><span class="s0">!=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">detail</span><span class="s0">||</span><span class="s1">l</span><span class="s0">.</span><span class="s1">type</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">type</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s1">l</span><span class="s0">.</span><span class="s1">type</span><span class="s0">!=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">type</span><span class="s0">||</span><span class="s1">l</span><span class="s0">.</span><span class="s1">apply</span><span class="s0">!=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">apply</span><span class="s0">||</span><span class="s1">l</span><span class="s0">.</span><span class="s1">boost</span><span class="s0">!=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">boost</span><span class="s0">)</span><span class="s1">r</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">h</span><span class="s0">);</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">L</span><span class="s0">(</span><span class="s1">h</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">)&gt;</span><span class="s1">L</span><span class="s0">(</span><span class="s1">l</span><span class="s0">))</span><span class="s1">r</span><span class="s0">[</span><span class="s1">r</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">h</span><span class="s0">;</span><span class="s1">l</span><span class="s0">=</span><span class="s1">h</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">}</span><span class="s4">return </span><span class="s1">r</span><span class="s0">}</span><span class="s4">class </span><span class="s1">M</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">attrs</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tooltip</span><span class="s0">=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">timestamp</span><span class="s0">=</span><span class="s1">i</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">=</span><span class="s1">n</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">=</span><span class="s1">o</span><span class="s0">}</span><span class="s1">setSelected</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">||</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s4">this</span><span class="s0">:</span><span class="s4">new </span><span class="s1">M</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">,</span><span class="s1">U</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tooltip</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">timestamp</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">)}</span><span class="s4">static </span><span class="s1">build</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&amp;&amp;!</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isPending</span><span class="s0">)))</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">setDisabled</span><span class="s0">();</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">B</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">r</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return </span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isPending</span><span class="s0">))?</span><span class="s1">i</span><span class="s0">.</span><span class="s1">setDisabled</span><span class="s0">():</span><span class="s4">null</span><span class="s0">;</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">).</span><span class="s1">selectOnOpen</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">!=</span><span class="s1">l</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">!=-</span><span class="s3">1</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">options</span><span class="s0">[</span><span class="s1">i</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">].</span><span class="s1">completion</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">r</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">e</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">[</span><span class="s1">e</span><span class="s0">].</span><span class="s1">completion</span><span class="s0">==</span><span class="s1">t</span><span class="s0">){</span><span class="s1">l</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">break</span><span class="s0">}}</span><span class="s4">return new </span><span class="s1">M</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">U</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">l</span><span class="s0">),{</span><span class="s1">pos</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reduce</span><span class="s0">(((</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">hasResult</span><span class="s0">()?</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">from</span><span class="s0">):</span><span class="s1">t</span><span class="s0">),</span><span class="s3">1e8</span><span class="s0">),</span><span class="s1">create</span><span class="s0">:</span><span class="s1">Y</span><span class="s0">,</span><span class="s1">above</span><span class="s0">:</span><span class="s1">n</span><span class="s0">.</span><span class="s1">aboveCursor</span><span class="s0">},</span><span class="s1">i</span><span class="s0">?</span><span class="s1">i</span><span class="s0">.</span><span class="s1">timestamp</span><span class="s0">:</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">(),</span><span class="s1">l</span><span class="s0">,</span><span class="s4">false</span><span class="s0">)}</span><span class="s1">map</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return new </span><span class="s1">M</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">attrs</span><span class="s0">,</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">assign</span><span class="s0">(</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">assign</span><span class="s0">({},</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tooltip</span><span class="s0">),{</span><span class="s1">pos</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">mapPos</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tooltip</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">)}),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">timestamp</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">)}</span><span class="s1">setDisabled</span><span class="s0">(){</span><span class="s4">return new </span><span class="s1">M</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">options</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">attrs</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tooltip</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">timestamp</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">,</span><span class="s4">true</span><span class="s0">)}}</span><span class="s4">class </span><span class="s1">z</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">id</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">open</span><span class="s0">=</span><span class="s1">s</span><span class="s0">}</span><span class="s4">static </span><span class="s1">start</span><span class="s0">(){</span><span class="s4">return new </span><span class="s1">z</span><span class="s0">(</span><span class="s1">W</span><span class="s0">,</span><span class="s2">&quot;cm-ac-&quot;</span><span class="s0">+</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">random</span><span class="s0">()*</span><span class="s3">2e6</span><span class="s0">).</span><span class="s1">toString</span><span class="s0">(</span><span class="s3">36</span><span class="s0">),</span><span class="s4">null</span><span class="s0">)}</span><span class="s1">update</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">state</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}=</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">);</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">override</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">languageDataAt</span><span class="s0">(</span><span class="s2">&quot;autocomplete&quot;</span><span class="s0">,</span><span class="s1">g</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)).</span><span class="s1">map</span><span class="s0">(</span><span class="s1">w</span><span class="s0">);</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">find</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">source</span><span class="s0">==</span><span class="s1">e</span><span class="s0">))||</span><span class="s4">new </span><span class="s1">q</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">!=</span><span class="s3">0</span><span class="s0">))?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">);</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">update</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)}));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">length</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">every</span><span class="s0">(((</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">t</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">[</span><span class="s1">e</span><span class="s0">])))</span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">open</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">effects</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">is</span><span class="s0">(</span><span class="s1">_</span><span class="s0">)));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">docChanged</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">||</span><span class="s1">n</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">hasResult</span><span class="s0">()&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">.</span><span class="s1">touchesRange</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)))||!</span><span class="s1">F</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">)||</span><span class="s1">r</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">M</span><span class="s0">.</span><span class="s1">build</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">id</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">r</span><span class="s0">);</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">&amp;&amp;!</span><span class="s1">n</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isPending</span><span class="s0">)))</span><span class="s1">o</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">every</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isPending</span><span class="s0">))&amp;&amp;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">hasResult</span><span class="s0">())))</span><span class="s1">n</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">hasResult</span><span class="s0">()?</span><span class="s4">new </span><span class="s1">q</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s3">0</span><span class="s0">):</span><span class="s1">t</span><span class="s0">));</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">l of t</span><span class="s0">.</span><span class="s1">effects</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">is</span><span class="s0">(</span><span class="s1">K</span><span class="s0">))</span><span class="s1">o</span><span class="s0">=</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">setSelected</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">value</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">id</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">open</span><span class="s0">?</span><span class="s4">this</span><span class="s0">:</span><span class="s4">new </span><span class="s1">z</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">id</span><span class="s0">,</span><span class="s1">o</span><span class="s0">)}</span><span class="s1">get tooltip</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">open</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">tooltip</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}</span><span class="s1">get attrs</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">open</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">attrs</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s1">$</span><span class="s0">:</span><span class="s1">j</span><span class="s0">}}</span><span class="s4">function </span><span class="s1">F</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">==</span><span class="s1">e</span><span class="s0">)</span><span class="s4">return true</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;;){</span><span class="s4">while</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;!</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">hasResult</span><span class="s0">())</span><span class="s1">s</span><span class="s0">++;</span><span class="s4">while</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;!</span><span class="s1">e</span><span class="s0">[</span><span class="s1">i</span><span class="s0">].</span><span class="s1">hasResult</span><span class="s0">())</span><span class="s1">i</span><span class="s0">++;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">s</span><span class="s0">==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">||</span><span class="s1">o</span><span class="s0">)</span><span class="s4">return </span><span class="s1">n</span><span class="s0">==</span><span class="s1">o</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">++].</span><span class="s1">result</span><span class="s0">!=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">i</span><span class="s0">++].</span><span class="s1">result</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">}}</span><span class="s4">const </span><span class="s1">$</span><span class="s0">={</span><span class="s2">&quot;aria-autocomplete&quot;</span><span class="s0">:</span><span class="s2">&quot;list&quot;</span><span class="s0">};</span><span class="s4">const </span><span class="s1">j</span><span class="s0">={};</span><span class="s4">function </span><span class="s1">U</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">={</span><span class="s2">&quot;aria-autocomplete&quot;</span><span class="s0">:</span><span class="s2">&quot;list&quot;</span><span class="s0">,</span><span class="s2">&quot;aria-haspopup&quot;</span><span class="s0">:</span><span class="s2">&quot;listbox&quot;</span><span class="s0">,</span><span class="s2">&quot;aria-controls&quot;</span><span class="s0">:</span><span class="s1">t</span><span class="s0">};</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s1">s</span><span class="s0">[</span><span class="s2">&quot;aria-activedescendant&quot;</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">+</span><span class="s2">&quot;-&quot;</span><span class="s0">+</span><span class="s1">e</span><span class="s0">;</span><span class="s4">return </span><span class="s1">s</span><span class="s0">}</span><span class="s4">const </span><span class="s1">W</span><span class="s0">=[];</span><span class="s4">function </span><span class="s1">V</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isUserEvent</span><span class="s0">(</span><span class="s2">&quot;input.complete&quot;</span><span class="s0">)){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">annotation</span><span class="s0">(</span><span class="s1">b</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">activateOnCompletion</span><span class="s0">(</span><span class="s1">s</span><span class="s0">))</span><span class="s4">return </span><span class="s3">4</span><span class="s0">|</span><span class="s3">8</span><span class="s0">}</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isUserEvent</span><span class="s0">(</span><span class="s2">&quot;input.type&quot;</span><span class="s0">);</span><span class="s4">return </span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">activateOnTyping</span><span class="s0">?</span><span class="s3">4</span><span class="s0">|</span><span class="s3">1</span><span class="s0">:</span><span class="s1">s</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isUserEvent</span><span class="s0">(</span><span class="s2">&quot;delete.backward&quot;</span><span class="s0">)?</span><span class="s3">2</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">?</span><span class="s3">8</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">docChanged</span><span class="s0">?</span><span class="s3">16</span><span class="s0">:</span><span class="s3">0</span><span class="s0">}</span><span class="s4">class </span><span class="s1">q</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">false</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">source</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">explicit</span><span class="s0">=</span><span class="s1">s</span><span class="s0">}</span><span class="s1">hasResult</span><span class="s0">(){</span><span class="s4">return false</span><span class="s0">}</span><span class="s1">get isPending</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">==</span><span class="s3">1</span><span class="s0">}</span><span class="s1">update</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">V</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">),</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&amp;</span><span class="s3">8</span><span class="s0">||</span><span class="s1">s</span><span class="s0">&amp;</span><span class="s3">16</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">touches</span><span class="s0">(</span><span class="s1">t</span><span class="s0">))</span><span class="s1">i</span><span class="s0">=</span><span class="s4">new </span><span class="s1">q</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s3">0</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&amp;</span><span class="s3">4</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">state</span><span class="s0">==</span><span class="s3">0</span><span class="s0">)</span><span class="s1">i</span><span class="s0">=</span><span class="s4">new </span><span class="s1">q</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s3">1</span><span class="s0">);</span><span class="s1">i</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">updateFor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n of t</span><span class="s0">.</span><span class="s1">effects</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">is</span><span class="s0">(</span><span class="s1">y</span><span class="s0">))</span><span class="s1">i</span><span class="s0">=</span><span class="s4">new </span><span class="s1">q</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">value</span><span class="s0">);</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">is</span><span class="s0">(</span><span class="s1">S</span><span class="s0">))</span><span class="s1">i</span><span class="s0">=</span><span class="s4">new </span><span class="s1">q</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s3">0</span><span class="s0">);</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">is</span><span class="s0">(</span><span class="s1">_</span><span class="s0">))</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t of n</span><span class="s0">.</span><span class="s1">value</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">source</span><span class="s0">==</span><span class="s1">i</span><span class="s0">.</span><span class="s1">source</span><span class="s0">)</span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s1">updateFor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">)}</span><span class="s1">map</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">}</span><span class="s1">touches</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">.</span><span class="s1">touchesRange</span><span class="s0">(</span><span class="s1">g</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">))}}</span><span class="s4">class </span><span class="s1">H </span><span class="s4">extends </span><span class="s1">q</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">){</span><span class="s4">super</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">3</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">limit</span><span class="s0">=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">result</span><span class="s0">=</span><span class="s1">i</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">from</span><span class="s0">=</span><span class="s1">n</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">to</span><span class="s0">=</span><span class="s1">o</span><span class="s0">}</span><span class="s1">hasResult</span><span class="s0">(){</span><span class="s4">return true</span><span class="s0">}</span><span class="s1">updateFor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">var </span><span class="s1">s</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!(</span><span class="s1">e</span><span class="s0">&amp;</span><span class="s3">3</span><span class="s0">))</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">);</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">result</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">map</span><span class="s0">&amp;&amp;!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">.</span><span class="s1">empty</span><span class="s0">)</span><span class="s1">i</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">);</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">.</span><span class="s1">mapPos</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">from</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">.</span><span class="s1">mapPos</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">to</span><span class="s0">,</span><span class="s3">1</span><span class="s0">);</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">g</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s1">o</span><span class="s0">||!</span><span class="s1">i</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&amp;</span><span class="s3">2</span><span class="s0">&amp;&amp;(</span><span class="s1">g</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">startState</span><span class="s0">)==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">from</span><span class="s0">||</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">limit</span><span class="s0">))</span><span class="s4">return new </span><span class="s1">q</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s1">e</span><span class="s0">&amp;</span><span class="s3">4</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">);</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">.</span><span class="s1">mapPos</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">limit</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">G</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">validFor</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">))</span><span class="s4">return new </span><span class="s1">H</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">explicit</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">update</span><span class="s0">&amp;&amp;(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">update</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s4">new </span><span class="s1">h</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s4">false</span><span class="s0">))))</span><span class="s4">return new </span><span class="s1">H</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">explicit</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,(</span><span class="s1">s</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)!==</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">!==</span><span class="s4">void </span><span class="s3">0</span><span class="s0">?</span><span class="s1">s</span><span class="s0">:</span><span class="s1">g</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">));</span><span class="s4">return new </span><span class="s1">q</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">explicit</span><span class="s0">)}</span><span class="s1">map</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">empty</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">;</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">result</span><span class="s0">.</span><span class="s1">map</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">result</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">result</span><span class="s0">,</span><span class="s1">t</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">result</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">)</span><span class="s4">return new </span><span class="s1">q</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s3">0</span><span class="s0">);</span><span class="s4">return new </span><span class="s1">H</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">explicit</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">mapPos</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">limit</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">result</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">mapPos</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">from</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">mapPos</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">to</span><span class="s0">,</span><span class="s3">1</span><span class="s0">))}</span><span class="s1">touches</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">.</span><span class="s1">touchesRange</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)}}</span><span class="s4">function </span><span class="s1">G</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">sliceDoc</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">return typeof </span><span class="s1">t</span><span class="s0">==</span><span class="s2">&quot;function&quot;</span><span class="s0">?</span><span class="s1">t</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">e</span><span class="s0">):</span><span class="s1">k</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s4">true</span><span class="s0">).</span><span class="s1">test</span><span class="s0">(</span><span class="s1">n</span><span class="s0">)}</span><span class="s4">const </span><span class="s1">_</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">StateEffect</span><span class="s0">.</span><span class="s1">define</span><span class="s0">({</span><span class="s1">map</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))}});</span><span class="s4">const </span><span class="s1">K</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">StateEffect</span><span class="s0">.</span><span class="s1">define</span><span class="s0">();</span><span class="s4">const </span><span class="s1">Q</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">StateField</span><span class="s0">.</span><span class="s1">define</span><span class="s0">({</span><span class="s1">create</span><span class="s0">(){</span><span class="s4">return </span><span class="s1">z</span><span class="s0">.</span><span class="s1">start</span><span class="s0">()},</span><span class="s1">update</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">update</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)},</span><span class="s1">provide</span><span class="s0">:</span><span class="s1">t</span><span class="s0">=&gt;[</span><span class="s1">o</span><span class="s0">.</span><span class="s1">showTooltip</span><span class="s0">.</span><span class="s1">from</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,(</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">tooltip</span><span class="s0">)),</span><span class="s1">o</span><span class="s0">.</span><span class="s1">EditorView</span><span class="s0">.</span><span class="s1">contentAttributes</span><span class="s0">.</span><span class="s1">from</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,(</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">attrs</span><span class="s0">))]});</span><span class="s4">function </span><span class="s1">X</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">const </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">.</span><span class="s1">apply</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">.</span><span class="s1">label</span><span class="s0">;</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">).</span><span class="s1">active</span><span class="s0">.</span><span class="s1">find</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">source</span><span class="s0">==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">source</span><span class="s0">));</span><span class="s4">if</span><span class="s0">(!(</span><span class="s1">i </span><span class="s4">instanceof </span><span class="s1">H</span><span class="s0">))</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">typeof </span><span class="s1">s</span><span class="s0">==</span><span class="s2">&quot;string&quot;</span><span class="s0">)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispatch</span><span class="s0">(</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">assign</span><span class="s0">(</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">assign</span><span class="s0">({},</span><span class="s1">x</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)),{</span><span class="s1">annotations</span><span class="s0">:</span><span class="s1">b</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">)}));</span><span class="s4">else </span><span class="s1">s</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">to</span><span class="s0">);</span><span class="s4">return true</span><span class="s0">}</span><span class="s4">const </span><span class="s1">Y</span><span class="s0">=</span><span class="s1">E</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">,</span><span class="s1">X</span><span class="s0">);</span><span class="s4">function </span><span class="s1">J</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s2">&quot;option&quot;</span><span class="s0">){</span><span class="s4">return </span><span class="s1">s</span><span class="s0">=&gt;{</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">,</span><span class="s4">false</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">||!</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">||</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">||</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">()-</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">timestamp</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">).</span><span class="s1">interactionDelay</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s3">1</span><span class="s0">,</span><span class="s1">r</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">==</span><span class="s2">&quot;page&quot;</span><span class="s0">&amp;&amp;(</span><span class="s1">r</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">getTooltip</span><span class="s0">)(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">tooltip</span><span class="s0">)))</span><span class="s1">n</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">2</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">floor</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">offsetHeight</span><span class="s0">/</span><span class="s1">r</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">querySelector</span><span class="s0">(</span><span class="s2">&quot;li&quot;</span><span class="s0">).</span><span class="s1">offsetHeight</span><span class="s0">)-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">let</span><span class="s0">{</span><span class="s1">length</span><span class="s0">:</span><span class="s1">l</span><span class="s0">}=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">options</span><span class="s0">;</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">?</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">+</span><span class="s1">n</span><span class="s0">*(</span><span class="s1">t</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:-</span><span class="s3">1</span><span class="s0">):</span><span class="s1">t</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s1">l</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">)</span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">==</span><span class="s2">&quot;page&quot;</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s1">l</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s1">l</span><span class="s0">)</span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">==</span><span class="s2">&quot;page&quot;</span><span class="s0">?</span><span class="s1">l</span><span class="s0">-</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">dispatch</span><span class="s0">({</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">K</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">a</span><span class="s0">)});</span><span class="s4">return true</span><span class="s0">}}</span><span class="s4">const </span><span class="s1">Z</span><span class="s0">=</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">,</span><span class="s4">false</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">readOnly</span><span class="s0">||!</span><span class="s1">e</span><span class="s0">||!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">||</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">()-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">timestamp</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">).</span><span class="s1">interactionDelay</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">return </span><span class="s1">X</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">options</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">])};</span><span class="s4">const </span><span class="s1">tt</span><span class="s0">=</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">,</span><span class="s4">false</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispatch</span><span class="s0">({</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">y</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s4">true</span><span class="s0">)});</span><span class="s4">return true</span><span class="s0">};</span><span class="s4">const </span><span class="s1">et</span><span class="s0">=</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">,</span><span class="s4">false</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">||!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">!=</span><span class="s3">0</span><span class="s0">)))</span><span class="s4">return false</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispatch</span><span class="s0">({</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">S</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s4">null</span><span class="s0">)});</span><span class="s4">return true</span><span class="s0">};</span><span class="s4">class </span><span class="s1">st</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">context</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">time</span><span class="s0">=</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updates</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">done</span><span class="s0">=</span><span class="s1">undefined</span><span class="s0">}}</span><span class="s4">const </span><span class="s1">it</span><span class="s0">=</span><span class="s3">50</span><span class="s0">,</span><span class="s1">nt</span><span class="s0">=</span><span class="s3">1e3</span><span class="s0">;</span><span class="s4">const </span><span class="s1">ot</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">ViewPlugin</span><span class="s0">.</span><span class="s1">fromClass</span><span class="s0">(</span><span class="s4">class</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">debounceUpdate</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">running</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">debounceAccept</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pendingStart</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">composing</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e of t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">).</span><span class="s1">active</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isPending</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">startQuery</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s1">update</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">);</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">selectionSet</span><span class="s0">&amp;&amp;!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">docChanged</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">startState</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">)==</span><span class="s1">e</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">transactions</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">V</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&amp;</span><span class="s3">8</span><span class="s0">||(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">||</span><span class="s1">t</span><span class="s0">.</span><span class="s1">docChanged</span><span class="s0">)&amp;&amp;!(</span><span class="s1">e</span><span class="s0">&amp;</span><span class="s3">3</span><span class="s0">)}));</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">l</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">running</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">l</span><span class="s0">++){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">running</span><span class="s0">[</span><span class="s1">l</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">context</span><span class="s0">.</span><span class="s1">abortOnDocChange</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">docChanged</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">updates</span><span class="s0">.</span><span class="s1">length</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">transactions</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">it</span><span class="s0">&amp;&amp;</span><span class="s1">Date</span><span class="s0">.</span><span class="s1">now</span><span class="s0">()-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">time</span><span class="s0">&gt;</span><span class="s1">nt</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t of e</span><span class="s0">.</span><span class="s1">context</span><span class="s0">.</span><span class="s1">abortListeners</span><span class="s0">){</span><span class="s4">try</span><span class="s0">{</span><span class="s1">t</span><span class="s0">()}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">r</span><span class="s0">){(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">logException</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">r</span><span class="s0">)}}</span><span class="s1">e</span><span class="s0">.</span><span class="s1">context</span><span class="s0">.</span><span class="s1">abortListeners</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">running</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">l</span><span class="s0">--,</span><span class="s3">1</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">e</span><span class="s0">.</span><span class="s1">updates</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">...t</span><span class="s0">.</span><span class="s1">transactions</span><span class="s0">)}}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">debounceUpdate</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s1">clearTimeout</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">debounceUpdate</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">transactions</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">effects</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">is</span><span class="s0">(</span><span class="s1">y</span><span class="s0">))))))</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pendingStart</span><span class="s0">=</span><span class="s4">true</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pendingStart</span><span class="s0">?</span><span class="s3">50</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">activateOnTypingDelay</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">debounceUpdate</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isPending</span><span class="s0">&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">running</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">source</span><span class="s0">==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">source</span><span class="s0">))))?</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">startUpdate</span><span class="s0">()),</span><span class="s1">n</span><span class="s0">):-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">composing</span><span class="s0">!=</span><span class="s3">0</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o of t</span><span class="s0">.</span><span class="s1">transactions</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">isUserEvent</span><span class="s0">(</span><span class="s2">&quot;input.type&quot;</span><span class="s0">))</span><span class="s4">this</span><span class="s0">.</span><span class="s1">composing</span><span class="s0">=</span><span class="s3">2</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">composing</span><span class="s0">==</span><span class="s3">2</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">composing</span><span class="s0">=</span><span class="s3">3</span><span class="s0">}}</span><span class="s1">startUpdate</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">debounceUpdate</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pendingStart</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">let</span><span class="s0">{</span><span class="s1">state</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s of e</span><span class="s0">.</span><span class="s1">active</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">isPending</span><span class="s0">&amp;&amp;!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">running</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">source</span><span class="s0">==</span><span class="s1">s</span><span class="s0">.</span><span class="s1">source</span><span class="s0">)))</span><span class="s4">this</span><span class="s0">.</span><span class="s1">startQuery</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">running</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">debounceAccept</span><span class="s0">=</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">accept</span><span class="s0">()),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">).</span><span class="s1">updateSyncTime</span><span class="s0">)}</span><span class="s1">startQuery</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">state</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">g</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">new </span><span class="s1">h</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">explicit</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">);</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">new </span><span class="s1">st</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">running</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">n</span><span class="s0">);</span><span class="s1">Promise</span><span class="s0">.</span><span class="s1">resolve</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">source</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)).</span><span class="s1">then</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">n</span><span class="s0">.</span><span class="s1">context</span><span class="s0">.</span><span class="s1">aborted</span><span class="s0">){</span><span class="s1">n</span><span class="s0">.</span><span class="s1">done</span><span class="s0">=</span><span class="s1">t</span><span class="s0">||</span><span class="s4">null</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">scheduleAccept</span><span class="s0">()}}),(</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">dispatch</span><span class="s0">({</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">S</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s4">null</span><span class="s0">)});(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">logException</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}))}</span><span class="s1">scheduleAccept</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">running</span><span class="s0">.</span><span class="s1">every</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">done</span><span class="s0">!==</span><span class="s1">undefined</span><span class="s0">)))</span><span class="s4">this</span><span class="s0">.</span><span class="s1">accept</span><span class="s0">();</span><span class="s4">else if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">debounceAccept</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">debounceAccept</span><span class="s0">=</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">accept</span><span class="s0">()),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">).</span><span class="s1">updateSyncTime</span><span class="s0">)}</span><span class="s1">accept</span><span class="s0">(){</span><span class="s4">var </span><span class="s1">t</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">debounceAccept</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s1">clearTimeout</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">debounceAccept</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">debounceAccept</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=[];</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">),</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">running</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">n</span><span class="s0">++){</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">running</span><span class="s0">[</span><span class="s1">n</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">done</span><span class="s0">===</span><span class="s1">undefined</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">running</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">n</span><span class="s0">--,</span><span class="s3">1</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">done</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">g</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">updates</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">updates</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">startState</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">);</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">done</span><span class="s0">.</span><span class="s1">from</span><span class="s0">+(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">explicit</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s3">1</span><span class="s0">));</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s4">new </span><span class="s1">H</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">explicit</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">done</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">done</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,(</span><span class="s1">t</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">done</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)!==</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">!==</span><span class="s4">void </span><span class="s3">0</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s1">i</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t of o</span><span class="s0">.</span><span class="s1">updates</span><span class="s0">)</span><span class="s1">r</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">update</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">hasResult</span><span class="s0">()){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">r</span><span class="s0">);</span><span class="s4">continue</span><span class="s0">}}</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">find</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">source</span><span class="s0">==</span><span class="s1">o</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">source</span><span class="s0">));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">.</span><span class="s1">isPending</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">done</span><span class="s0">==</span><span class="s4">null</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">new </span><span class="s1">q</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">source</span><span class="s0">,</span><span class="s3">0</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e of o</span><span class="s0">.</span><span class="s1">updates</span><span class="s0">)</span><span class="s1">t</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">update</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isPending</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">startQuery</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)}}}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">||</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">dispatch</span><span class="s0">({</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">_</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)})}},{</span><span class="s1">eventHandlers</span><span class="s0">:{</span><span class="s1">blur</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">,</span><span class="s4">false</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">tooltip</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">).</span><span class="s1">closeOnBlur</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">&amp;&amp;(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">o</span><span class="s0">.</span><span class="s1">getTooltip</span><span class="s0">)(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">tooltip</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">||!</span><span class="s1">s</span><span class="s0">.</span><span class="s1">dom</span><span class="s0">.</span><span class="s1">contains</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">relatedTarget</span><span class="s0">))</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">dispatch</span><span class="s0">({</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">S</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s4">null</span><span class="s0">)})),</span><span class="s3">10</span><span class="s0">)}},</span><span class="s1">compositionstart</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">composing</span><span class="s0">=</span><span class="s3">1</span><span class="s0">},</span><span class="s1">compositionend</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">composing</span><span class="s0">==</span><span class="s3">3</span><span class="s0">){</span><span class="s1">setTimeout</span><span class="s0">((()=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">view</span><span class="s0">.</span><span class="s1">dispatch</span><span class="s0">({</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">y</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s4">false</span><span class="s0">)})),</span><span class="s3">20</span><span class="s0">)}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">composing</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}}});</span><span class="s4">const </span><span class="s1">rt</span><span class="s0">=</span><span class="s4">typeof </span><span class="s1">navigator</span><span class="s0">==</span><span class="s2">&quot;object&quot;</span><span class="s0">&amp;&amp;</span><span class="s5">/Win/</span><span class="s0">.</span><span class="s1">test</span><span class="s0">(</span><span class="s1">navigator</span><span class="s0">.</span><span class="s1">platform</span><span class="s0">);</span><span class="s4">const </span><span class="s1">lt</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">Prec</span><span class="s0">.</span><span class="s1">highest</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">EditorView</span><span class="s0">.</span><span class="s1">domEventHandlers</span><span class="s0">({</span><span class="s1">keydown</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">,</span><span class="s4">false</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">||!</span><span class="s1">s</span><span class="s0">.</span><span class="s1">open</span><span class="s0">||</span><span class="s1">s</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">||</span><span class="s1">s</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">t</span><span class="s0">.</span><span class="s1">key</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">||</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ctrlKey</span><span class="s0">&amp;&amp;!(</span><span class="s1">rt</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">altKey</span><span class="s0">)||</span><span class="s1">t</span><span class="s0">.</span><span class="s1">metaKey</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">options</span><span class="s0">[</span><span class="s1">s</span><span class="s0">.</span><span class="s1">open</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">];</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">find</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">source</span><span class="s0">==</span><span class="s1">i</span><span class="s0">.</span><span class="s1">source</span><span class="s0">));</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">.</span><span class="s1">commitCharacters</span><span class="s0">||</span><span class="s1">n</span><span class="s0">.</span><span class="s1">result</span><span class="s0">.</span><span class="s1">commitCharacters</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">key</span><span class="s0">)&gt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s1">X</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">return false</span><span class="s0">}}));</span><span class="s4">const </span><span class="s1">at</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">EditorView</span><span class="s0">.</span><span class="s1">baseTheme</span><span class="s0">({</span><span class="s2">&quot;.cm-tooltip.cm-tooltip-autocomplete&quot;</span><span class="s0">:{</span><span class="s2">&quot;&amp; &gt; ul&quot;</span><span class="s0">:{</span><span class="s1">fontFamily</span><span class="s0">:</span><span class="s2">&quot;monospace&quot;</span><span class="s0">,</span><span class="s1">whiteSpace</span><span class="s0">:</span><span class="s2">&quot;nowrap&quot;</span><span class="s0">,</span><span class="s1">overflow</span><span class="s0">:</span><span class="s2">&quot;hidden auto&quot;</span><span class="s0">,</span><span class="s1">maxWidth_fallback</span><span class="s0">:</span><span class="s2">&quot;700px&quot;</span><span class="s0">,</span><span class="s1">maxWidth</span><span class="s0">:</span><span class="s2">&quot;min(700px, 95vw)&quot;</span><span class="s0">,</span><span class="s1">minWidth</span><span class="s0">:</span><span class="s2">&quot;250px&quot;</span><span class="s0">,</span><span class="s1">maxHeight</span><span class="s0">:</span><span class="s2">&quot;10em&quot;</span><span class="s0">,</span><span class="s1">height</span><span class="s0">:</span><span class="s2">&quot;100%&quot;</span><span class="s0">,</span><span class="s1">listStyle</span><span class="s0">:</span><span class="s2">&quot;none&quot;</span><span class="s0">,</span><span class="s1">margin</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">padding</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s2">&quot;&amp; &gt; li, &amp; &gt; completion-section&quot;</span><span class="s0">:{</span><span class="s1">padding</span><span class="s0">:</span><span class="s2">&quot;1px 3px&quot;</span><span class="s0">,</span><span class="s1">lineHeight</span><span class="s0">:</span><span class="s3">1.2</span><span class="s0">},</span><span class="s2">&quot;&amp; &gt; li&quot;</span><span class="s0">:{</span><span class="s1">overflowX</span><span class="s0">:</span><span class="s2">&quot;hidden&quot;</span><span class="s0">,</span><span class="s1">textOverflow</span><span class="s0">:</span><span class="s2">&quot;ellipsis&quot;</span><span class="s0">,</span><span class="s1">cursor</span><span class="s0">:</span><span class="s2">&quot;pointer&quot;</span><span class="s0">},</span><span class="s2">&quot;&amp; &gt; completion-section&quot;</span><span class="s0">:{</span><span class="s1">display</span><span class="s0">:</span><span class="s2">&quot;list-item&quot;</span><span class="s0">,</span><span class="s1">borderBottom</span><span class="s0">:</span><span class="s2">&quot;1px solid silver&quot;</span><span class="s0">,</span><span class="s1">paddingLeft</span><span class="s0">:</span><span class="s2">&quot;0.5em&quot;</span><span class="s0">,</span><span class="s1">opacity</span><span class="s0">:</span><span class="s3">.7</span><span class="s0">}}},</span><span class="s2">&quot;&amp;light .cm-tooltip-autocomplete ul li[aria-selected]&quot;</span><span class="s0">:{</span><span class="s1">background</span><span class="s0">:</span><span class="s2">&quot;#17c&quot;</span><span class="s0">,</span><span class="s1">color</span><span class="s0">:</span><span class="s2">&quot;white&quot;</span><span class="s0">},</span><span class="s2">&quot;&amp;light .cm-tooltip-autocomplete-disabled ul li[aria-selected]&quot;</span><span class="s0">:{</span><span class="s1">background</span><span class="s0">:</span><span class="s2">&quot;#777&quot;</span><span class="s0">},</span><span class="s2">&quot;&amp;dark .cm-tooltip-autocomplete ul li[aria-selected]&quot;</span><span class="s0">:{</span><span class="s1">background</span><span class="s0">:</span><span class="s2">&quot;#347&quot;</span><span class="s0">,</span><span class="s1">color</span><span class="s0">:</span><span class="s2">&quot;white&quot;</span><span class="s0">},</span><span class="s2">&quot;&amp;dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]&quot;</span><span class="s0">:{</span><span class="s1">background</span><span class="s0">:</span><span class="s2">&quot;#444&quot;</span><span class="s0">},</span><span class="s2">&quot;.cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after&quot;</span><span class="s0">:{</span><span class="s1">content</span><span class="s0">:</span><span class="s2">'&quot;&quot;'</span><span class="s0">,</span><span class="s1">opacity</span><span class="s0">:</span><span class="s3">.5</span><span class="s0">,</span><span class="s1">display</span><span class="s0">:</span><span class="s2">&quot;block&quot;</span><span class="s0">,</span><span class="s1">textAlign</span><span class="s0">:</span><span class="s2">&quot;center&quot;</span><span class="s0">},</span><span class="s2">&quot;.cm-tooltip.cm-completionInfo&quot;</span><span class="s0">:{</span><span class="s1">position</span><span class="s0">:</span><span class="s2">&quot;absolute&quot;</span><span class="s0">,</span><span class="s1">padding</span><span class="s0">:</span><span class="s2">&quot;3px 9px&quot;</span><span class="s0">,</span><span class="s1">width</span><span class="s0">:</span><span class="s2">&quot;max-content&quot;</span><span class="s0">,</span><span class="s1">maxWidth</span><span class="s0">:</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s3">400</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">,</span><span class="s1">boxSizing</span><span class="s0">:</span><span class="s2">&quot;border-box&quot;</span><span class="s0">,</span><span class="s1">whiteSpace</span><span class="s0">:</span><span class="s2">&quot;pre-line&quot;</span><span class="s0">},</span><span class="s2">&quot;.cm-completionInfo.cm-completionInfo-left&quot;</span><span class="s0">:{</span><span class="s1">right</span><span class="s0">:</span><span class="s2">&quot;100%&quot;</span><span class="s0">},</span><span class="s2">&quot;.cm-completionInfo.cm-completionInfo-right&quot;</span><span class="s0">:{</span><span class="s1">left</span><span class="s0">:</span><span class="s2">&quot;100%&quot;</span><span class="s0">},</span><span class="s2">&quot;.cm-completionInfo.cm-completionInfo-left-narrow&quot;</span><span class="s0">:{</span><span class="s1">right</span><span class="s0">:</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s3">30</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">},</span><span class="s2">&quot;.cm-completionInfo.cm-completionInfo-right-narrow&quot;</span><span class="s0">:{</span><span class="s1">left</span><span class="s0">:</span><span class="s2">`</span><span class="s1">$</span><span class="s0">{</span><span class="s3">30</span><span class="s0">}</span><span class="s2">px`</span><span class="s0">},</span><span class="s2">&quot;&amp;light .cm-snippetField&quot;</span><span class="s0">:{</span><span class="s1">backgroundColor</span><span class="s0">:</span><span class="s2">&quot;#00000022&quot;</span><span class="s0">},</span><span class="s2">&quot;&amp;dark .cm-snippetField&quot;</span><span class="s0">:{</span><span class="s1">backgroundColor</span><span class="s0">:</span><span class="s2">&quot;#ffffff22&quot;</span><span class="s0">},</span><span class="s2">&quot;.cm-snippetFieldPosition&quot;</span><span class="s0">:{</span><span class="s1">verticalAlign</span><span class="s0">:</span><span class="s2">&quot;text-top&quot;</span><span class="s0">,</span><span class="s1">width</span><span class="s0">:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">height</span><span class="s0">:</span><span class="s2">&quot;1.15em&quot;</span><span class="s0">,</span><span class="s1">display</span><span class="s0">:</span><span class="s2">&quot;inline-block&quot;</span><span class="s0">,</span><span class="s1">margin</span><span class="s0">:</span><span class="s2">&quot;0 -0.7px -.7em&quot;</span><span class="s0">,</span><span class="s1">borderLeft</span><span class="s0">:</span><span class="s2">&quot;1.4px dotted #888&quot;</span><span class="s0">},</span><span class="s2">&quot;.cm-completionMatchedText&quot;</span><span class="s0">:{</span><span class="s1">textDecoration</span><span class="s0">:</span><span class="s2">&quot;underline&quot;</span><span class="s0">},</span><span class="s2">&quot;.cm-completionDetail&quot;</span><span class="s0">:{</span><span class="s1">marginLeft</span><span class="s0">:</span><span class="s2">&quot;0.5em&quot;</span><span class="s0">,</span><span class="s1">fontStyle</span><span class="s0">:</span><span class="s2">&quot;italic&quot;</span><span class="s0">},</span><span class="s2">&quot;.cm-completionIcon&quot;</span><span class="s0">:{</span><span class="s1">fontSize</span><span class="s0">:</span><span class="s2">&quot;90%&quot;</span><span class="s0">,</span><span class="s1">width</span><span class="s0">:</span><span class="s2">&quot;.8em&quot;</span><span class="s0">,</span><span class="s1">display</span><span class="s0">:</span><span class="s2">&quot;inline-block&quot;</span><span class="s0">,</span><span class="s1">textAlign</span><span class="s0">:</span><span class="s2">&quot;center&quot;</span><span class="s0">,</span><span class="s1">paddingRight</span><span class="s0">:</span><span class="s2">&quot;.6em&quot;</span><span class="s0">,</span><span class="s1">opacity</span><span class="s0">:</span><span class="s2">&quot;0.6&quot;</span><span class="s0">,</span><span class="s1">boxSizing</span><span class="s0">:</span><span class="s2">&quot;content-box&quot;</span><span class="s0">},</span><span class="s2">&quot;.cm-completionIcon-function, .cm-completionIcon-method&quot;</span><span class="s0">:{</span><span class="s2">&quot;&amp;:after&quot;</span><span class="s0">:{</span><span class="s1">content</span><span class="s0">:</span><span class="s2">&quot;''&quot;</span><span class="s0">}},</span><span class="s2">&quot;.cm-completionIcon-class&quot;</span><span class="s0">:{</span><span class="s2">&quot;&amp;:after&quot;</span><span class="s0">:{</span><span class="s1">content</span><span class="s0">:</span><span class="s2">&quot;''&quot;</span><span class="s0">}},</span><span class="s2">&quot;.cm-completionIcon-interface&quot;</span><span class="s0">:{</span><span class="s2">&quot;&amp;:after&quot;</span><span class="s0">:{</span><span class="s1">content</span><span class="s0">:</span><span class="s2">&quot;''&quot;</span><span class="s0">}},</span><span class="s2">&quot;.cm-completionIcon-variable&quot;</span><span class="s0">:{</span><span class="s2">&quot;&amp;:after&quot;</span><span class="s0">:{</span><span class="s1">content</span><span class="s0">:</span><span class="s2">&quot;''&quot;</span><span class="s0">}},</span><span class="s2">&quot;.cm-completionIcon-constant&quot;</span><span class="s0">:{</span><span class="s2">&quot;&amp;:after&quot;</span><span class="s0">:{</span><span class="s1">content</span><span class="s0">:</span><span class="s2">&quot;''&quot;</span><span class="s0">}},</span><span class="s2">&quot;.cm-completionIcon-type&quot;</span><span class="s0">:{</span><span class="s2">&quot;&amp;:after&quot;</span><span class="s0">:{</span><span class="s1">content</span><span class="s0">:</span><span class="s2">&quot;''&quot;</span><span class="s0">}},</span><span class="s2">&quot;.cm-completionIcon-enum&quot;</span><span class="s0">:{</span><span class="s2">&quot;&amp;:after&quot;</span><span class="s0">:{</span><span class="s1">content</span><span class="s0">:</span><span class="s2">&quot;''&quot;</span><span class="s0">}},</span><span class="s2">&quot;.cm-completionIcon-property&quot;</span><span class="s0">:{</span><span class="s2">&quot;&amp;:after&quot;</span><span class="s0">:{</span><span class="s1">content</span><span class="s0">:</span><span class="s2">&quot;''&quot;</span><span class="s0">}},</span><span class="s2">&quot;.cm-completionIcon-keyword&quot;</span><span class="s0">:{</span><span class="s2">&quot;&amp;:after&quot;</span><span class="s0">:{</span><span class="s1">content</span><span class="s0">:</span><span class="s2">&quot;''&quot;</span><span class="s0">}},</span><span class="s2">&quot;.cm-completionIcon-namespace&quot;</span><span class="s0">:{</span><span class="s2">&quot;&amp;:after&quot;</span><span class="s0">:{</span><span class="s1">content</span><span class="s0">:</span><span class="s2">&quot;''&quot;</span><span class="s0">}},</span><span class="s2">&quot;.cm-completionIcon-text&quot;</span><span class="s0">:{</span><span class="s2">&quot;&amp;:after&quot;</span><span class="s0">:{</span><span class="s1">content</span><span class="s0">:</span><span class="s2">&quot;'abc'&quot;</span><span class="s0">,</span><span class="s1">fontSize</span><span class="s0">:</span><span class="s2">&quot;50%&quot;</span><span class="s0">,</span><span class="s1">verticalAlign</span><span class="s0">:</span><span class="s2">&quot;middle&quot;</span><span class="s0">}}});</span><span class="s4">class </span><span class="s1">ht</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">field</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">line</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">from</span><span class="s0">=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">to</span><span class="s0">=</span><span class="s1">i</span><span class="s0">}}</span><span class="s4">class </span><span class="s1">ct</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">field</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">from</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">to</span><span class="s0">=</span><span class="s1">s</span><span class="s0">}</span><span class="s1">map</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">mapPos</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">MapMode</span><span class="s0">.</span><span class="s1">TrackDel</span><span class="s0">);</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">mapPos</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">to</span><span class="s0">,</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">MapMode</span><span class="s0">.</span><span class="s1">TrackDel</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">==</span><span class="s4">null</span><span class="s0">||</span><span class="s1">s</span><span class="s0">==</span><span class="s4">null</span><span class="s0">?</span><span class="s4">null</span><span class="s0">:</span><span class="s4">new </span><span class="s1">ct</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">field</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)}}</span><span class="s4">class </span><span class="s1">ft</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fieldPositions</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">instantiate</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=[],</span><span class="s1">i</span><span class="s0">=[</span><span class="s1">e</span><span class="s0">];</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">doc</span><span class="s0">.</span><span class="s1">lineAt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">o</span><span class="s0">=</span><span class="s5">/^\s*/</span><span class="s0">.</span><span class="s1">exec</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">text</span><span class="s0">)[</span><span class="s3">0</span><span class="s0">];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">a of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">lines</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">o</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s5">/^\t*/</span><span class="s0">.</span><span class="s1">exec</span><span class="s0">(</span><span class="s1">a</span><span class="s0">)[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">length</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">n</span><span class="s0">;</span><span class="s1">e</span><span class="s0">++)</span><span class="s1">s</span><span class="s0">+=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">indentUnit</span><span class="s0">);</span><span class="s1">i</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">n</span><span class="s0">);</span><span class="s1">a</span><span class="s0">=</span><span class="s1">s</span><span class="s0">+</span><span class="s1">a</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">n</span><span class="s0">)}</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">a</span><span class="s0">);</span><span class="s1">e</span><span class="s0">+=</span><span class="s1">a</span><span class="s0">.</span><span class="s1">length</span><span class="s0">+</span><span class="s3">1</span><span class="s0">}</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fieldPositions</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s4">new </span><span class="s1">ct</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">,</span><span class="s1">i</span><span class="s0">[</span><span class="s1">t</span><span class="s0">.</span><span class="s1">line</span><span class="s0">]+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s1">i</span><span class="s0">[</span><span class="s1">t</span><span class="s0">.</span><span class="s1">line</span><span class="s0">]+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)));</span><span class="s4">return</span><span class="s0">{</span><span class="s1">text</span><span class="s0">:</span><span class="s1">s</span><span class="s0">,</span><span class="s1">ranges</span><span class="s0">:</span><span class="s1">r</span><span class="s0">}}</span><span class="s4">static </span><span class="s1">parse</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=[];</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=[],</span><span class="s1">i</span><span class="s0">=[],</span><span class="s1">n</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o of t</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s5">/\r\n?|\n/</span><span class="s0">)){</span><span class="s4">while</span><span class="s0">(</span><span class="s1">n</span><span class="s0">=</span><span class="s5">/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/</span><span class="s0">.</span><span class="s1">exec</span><span class="s0">(</span><span class="s1">o</span><span class="s0">)){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">n</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]?+</span><span class="s1">n</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]:</span><span class="s4">null</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">n</span><span class="s0">[</span><span class="s3">2</span><span class="s0">]||</span><span class="s1">n</span><span class="s0">[</span><span class="s3">3</span><span class="s0">]||</span><span class="s2">&quot;&quot;</span><span class="s0">,</span><span class="s1">l</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">replace</span><span class="s0">(</span><span class="s5">/\\[{}]/g</span><span class="s0">,(</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]));</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">?</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">seq</span><span class="s0">==</span><span class="s1">t</span><span class="s0">:</span><span class="s1">a</span><span class="s0">?</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">name</span><span class="s0">==</span><span class="s1">a</span><span class="s0">:</span><span class="s4">false</span><span class="s0">)</span><span class="s1">l</span><span class="s0">=</span><span class="s1">s</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;(</span><span class="s1">t</span><span class="s0">==</span><span class="s4">null</span><span class="s0">||</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">seq</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">seq</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">))</span><span class="s1">s</span><span class="s0">++;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,{</span><span class="s1">seq</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">name</span><span class="s0">:</span><span class="s1">a</span><span class="s0">});</span><span class="s1">l</span><span class="s0">=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t of i</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">&gt;=</span><span class="s1">l</span><span class="s0">)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">++}</span><span class="s1">i</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">new </span><span class="s1">ht</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">index</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">index</span><span class="s0">+</span><span class="s1">a</span><span class="s0">.</span><span class="s1">length</span><span class="s0">));</span><span class="s1">o</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">index</span><span class="s0">)+</span><span class="s1">r</span><span class="s0">+</span><span class="s1">o</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">index</span><span class="s0">+</span><span class="s1">n</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">length</span><span class="s0">)}</span><span class="s1">o</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">replace</span><span class="s0">(</span><span class="s5">/\\([{}])/g</span><span class="s0">,((</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)=&gt;{</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o of i</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">line</span><span class="s0">==</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">from</span><span class="s0">&gt;</span><span class="s1">n</span><span class="s0">){</span><span class="s1">o</span><span class="s0">.</span><span class="s1">from</span><span class="s0">--;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">to</span><span class="s0">--}</span><span class="s4">return </span><span class="s1">e</span><span class="s0">}));</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">o</span><span class="s0">)}</span><span class="s4">return new </span><span class="s1">ft</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}}</span><span class="s4">let </span><span class="s1">ut</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">Decoration</span><span class="s0">.</span><span class="s1">widget</span><span class="s0">({</span><span class="s1">widget</span><span class="s0">:</span><span class="s4">new class extends </span><span class="s1">o</span><span class="s0">.</span><span class="s1">WidgetType</span><span class="s0">{</span><span class="s1">toDOM</span><span class="s0">(){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">document</span><span class="s0">.</span><span class="s1">createElement</span><span class="s0">(</span><span class="s2">&quot;span&quot;</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">className</span><span class="s0">=</span><span class="s2">&quot;cm-snippetFieldPosition&quot;</span><span class="s0">;</span><span class="s4">return </span><span class="s1">t</span><span class="s0">}</span><span class="s1">ignoreEvent</span><span class="s0">(){</span><span class="s4">return false</span><span class="s0">}}});</span><span class="s4">let </span><span class="s1">pt</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">Decoration</span><span class="s0">.</span><span class="s1">mark</span><span class="s0">({</span><span class="s4">class</span><span class="s0">:</span><span class="s2">&quot;cm-snippetField&quot;</span><span class="s0">});</span><span class="s4">class </span><span class="s1">dt</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">deco</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">Decoration</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">from</span><span class="s0">==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">to</span><span class="s0">?</span><span class="s1">ut</span><span class="s0">:</span><span class="s1">pt</span><span class="s0">).</span><span class="s1">range</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">to</span><span class="s0">))))}</span><span class="s1">map</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">i</span><span class="s0">)}</span><span class="s4">return new </span><span class="s1">dt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">)}</span><span class="s1">selectionInsideField</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">.</span><span class="s1">every</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">field</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">active</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">from</span><span class="s0">&lt;=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">from</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">to</span><span class="s0">&gt;=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">to</span><span class="s0">))))}}</span><span class="s4">const </span><span class="s1">mt</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">StateEffect</span><span class="s0">.</span><span class="s1">define</span><span class="s0">({</span><span class="s1">map</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}});</span><span class="s4">const </span><span class="s1">gt</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">StateEffect</span><span class="s0">.</span><span class="s1">define</span><span class="s0">();</span><span class="s4">const </span><span class="s1">kt</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">StateField</span><span class="s0">.</span><span class="s1">define</span><span class="s0">({</span><span class="s1">create</span><span class="s0">(){</span><span class="s4">return null</span><span class="s0">},</span><span class="s1">update</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s of e</span><span class="s0">.</span><span class="s1">effects</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">is</span><span class="s0">(</span><span class="s1">mt</span><span class="s0">))</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">value</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">is</span><span class="s0">(</span><span class="s1">gt</span><span class="s0">)&amp;&amp;</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return new </span><span class="s1">dt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">value</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">docChanged</span><span class="s0">)</span><span class="s1">t</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">&amp;&amp;!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">selectionInsideField</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">))</span><span class="s1">t</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">return </span><span class="s1">t</span><span class="s0">},</span><span class="s1">provide</span><span class="s0">:</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">EditorView</span><span class="s0">.</span><span class="s1">decorations</span><span class="s0">.</span><span class="s1">from</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,(</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">?</span><span class="s1">t</span><span class="s0">.</span><span class="s1">deco</span><span class="s0">:</span><span class="s1">o</span><span class="s0">.</span><span class="s1">Decoration</span><span class="s0">.</span><span class="s1">none</span><span class="s0">))});</span><span class="s4">function </span><span class="s1">bt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">EditorSelection</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">filter</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">==</span><span class="s1">e</span><span class="s0">)).</span><span class="s1">map</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">EditorSelection</span><span class="s0">.</span><span class="s1">range</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">to</span><span class="s0">))))}</span><span class="s4">function </span><span class="s1">xt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">ft</span><span class="s0">.</span><span class="s1">parse</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">return</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">)=&gt;{</span><span class="s4">let</span><span class="s0">{</span><span class="s1">text</span><span class="s0">:</span><span class="s1">r</span><span class="s0">,</span><span class="s1">ranges</span><span class="s0">:</span><span class="s1">l</span><span class="s0">}=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">instantiate</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">n</span><span class="s0">);</span><span class="s4">let </span><span class="s1">a</span><span class="s0">={</span><span class="s1">changes</span><span class="s0">:{</span><span class="s1">from</span><span class="s0">:</span><span class="s1">n</span><span class="s0">,</span><span class="s1">to</span><span class="s0">:</span><span class="s1">o</span><span class="s0">,</span><span class="s1">insert</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">Text</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)},</span><span class="s1">scrollIntoView</span><span class="s0">:</span><span class="s4">true</span><span class="s0">,</span><span class="s1">annotations</span><span class="s0">:</span><span class="s1">s</span><span class="s0">?[</span><span class="s1">b</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">s</span><span class="s0">),</span><span class="s1">i</span><span class="s0">.</span><span class="s1">Transaction</span><span class="s0">.</span><span class="s1">userEvent</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s2">&quot;input.complete&quot;</span><span class="s0">)]:</span><span class="s1">undefined</span><span class="s0">};</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s1">a</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">=</span><span class="s1">bt</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,</span><span class="s3">0</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">))){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">dt</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,</span><span class="s3">0</span><span class="s0">);</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">a</span><span class="s0">.</span><span class="s1">effects</span><span class="s0">=[</span><span class="s1">mt</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">kt</span><span class="s0">,</span><span class="s4">false</span><span class="s0">)===</span><span class="s1">undefined</span><span class="s0">)</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">StateEffect</span><span class="s0">.</span><span class="s1">appendConfig</span><span class="s0">.</span><span class="s1">of</span><span class="s0">([</span><span class="s1">kt</span><span class="s0">,</span><span class="s1">It</span><span class="s0">,</span><span class="s1">Rt</span><span class="s0">,</span><span class="s1">at</span><span class="s0">]))}</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispatch</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">update</span><span class="s0">(</span><span class="s1">a</span><span class="s0">))}}</span><span class="s4">function </span><span class="s1">vt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return</span><span class="s0">({</span><span class="s1">state</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">dispatch</span><span class="s0">:</span><span class="s1">s</span><span class="s0">})=&gt;{</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">kt</span><span class="s0">,</span><span class="s4">false</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">||</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">active</span><span class="s0">==</span><span class="s3">0</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">active</span><span class="s0">+</span><span class="s1">t</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;!</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">field</span><span class="s0">==</span><span class="s1">n</span><span class="s0">+</span><span class="s1">t</span><span class="s0">));</span><span class="s1">s</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">update</span><span class="s0">({</span><span class="s1">selection</span><span class="s0">:</span><span class="s1">bt</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">,</span><span class="s1">n</span><span class="s0">),</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">mt</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">o</span><span class="s0">?</span><span class="s4">null</span><span class="s0">:</span><span class="s4">new </span><span class="s1">dt</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)),</span><span class="s1">scrollIntoView</span><span class="s0">:</span><span class="s4">true</span><span class="s0">}));</span><span class="s4">return true</span><span class="s0">}}</span><span class="s4">const </span><span class="s1">wt</span><span class="s0">=({</span><span class="s1">state</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">dispatch</span><span class="s0">:</span><span class="s1">e</span><span class="s0">})=&gt;{</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">kt</span><span class="s0">,</span><span class="s4">false</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s1">e</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">update</span><span class="s0">({</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">mt</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s4">null</span><span class="s0">)}));</span><span class="s4">return true</span><span class="s0">};</span><span class="s4">const </span><span class="s1">yt</span><span class="s0">=</span><span class="s1">vt</span><span class="s0">(</span><span class="s3">1</span><span class="s0">);</span><span class="s4">const </span><span class="s1">St</span><span class="s0">=</span><span class="s1">vt</span><span class="s0">(-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">function </span><span class="s1">Ct</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">kt</span><span class="s0">,</span><span class="s4">false</span><span class="s0">);</span><span class="s4">return</span><span class="s0">!!(</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">==</span><span class="s1">e</span><span class="s0">.</span><span class="s1">active</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)))}</span><span class="s4">function </span><span class="s1">Pt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">kt</span><span class="s0">,</span><span class="s4">false</span><span class="s0">);</span><span class="s4">return</span><span class="s0">!!(</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">active</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">const </span><span class="s1">Tt</span><span class="s0">=[{</span><span class="s1">key</span><span class="s0">:</span><span class="s2">&quot;Tab&quot;</span><span class="s0">,</span><span class="s1">run</span><span class="s0">:</span><span class="s1">yt</span><span class="s0">,</span><span class="s1">shift</span><span class="s0">:</span><span class="s1">St</span><span class="s0">},{</span><span class="s1">key</span><span class="s0">:</span><span class="s2">&quot;Escape&quot;</span><span class="s0">,</span><span class="s1">run</span><span class="s0">:</span><span class="s1">wt</span><span class="s0">}];</span><span class="s4">const </span><span class="s1">At</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">Facet</span><span class="s0">.</span><span class="s1">define</span><span class="s0">({</span><span class="s1">combine</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s1">t</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]:</span><span class="s1">Tt</span><span class="s0">}});</span><span class="s4">const </span><span class="s1">It</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">Prec</span><span class="s0">.</span><span class="s1">highest</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">keymap</span><span class="s0">.</span><span class="s1">compute</span><span class="s0">([</span><span class="s1">At</span><span class="s0">],(</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">At</span><span class="s0">))));</span><span class="s4">function </span><span class="s1">Ot</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">Object</span><span class="s0">.</span><span class="s1">assign</span><span class="s0">(</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">assign</span><span class="s0">({},</span><span class="s1">e</span><span class="s0">),{</span><span class="s1">apply</span><span class="s0">:</span><span class="s1">xt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)})}</span><span class="s4">const </span><span class="s1">Rt</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">EditorView</span><span class="s0">.</span><span class="s1">domEventHandlers</span><span class="s0">({</span><span class="s1">mousedown</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">kt</span><span class="s0">,</span><span class="s4">false</span><span class="s0">),</span><span class="s1">i</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">||(</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">posAtCoords</span><span class="s0">({</span><span class="s1">x</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">clientX</span><span class="s0">,</span><span class="s1">y</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">clientY</span><span class="s0">}))==</span><span class="s4">null</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">.</span><span class="s1">find</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">from</span><span class="s0">&lt;=</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">to</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">));</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">n</span><span class="s0">||</span><span class="s1">n</span><span class="s0">.</span><span class="s1">field</span><span class="s0">==</span><span class="s1">s</span><span class="s0">.</span><span class="s1">active</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">dispatch</span><span class="s0">({</span><span class="s1">selection</span><span class="s0">:</span><span class="s1">bt</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">field</span><span class="s0">),</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">mt</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">&gt;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">field</span><span class="s0">))?</span><span class="s4">new </span><span class="s1">dt</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">field</span><span class="s0">):</span><span class="s4">null</span><span class="s0">),</span><span class="s1">scrollIntoView</span><span class="s0">:</span><span class="s4">true</span><span class="s0">});</span><span class="s4">return true</span><span class="s0">}});</span><span class="s4">function </span><span class="s1">Dt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">replace</span><span class="s0">(</span><span class="s5">/[\]\-\\]/g</span><span class="s0">,</span><span class="s2">&quot;</span><span class="s4">\\</span><span class="s2">$&amp;&quot;</span><span class="s0">);</span><span class="s4">try</span><span class="s0">{</span><span class="s4">return new </span><span class="s1">RegExp</span><span class="s0">(</span><span class="s2">`[</span><span class="s4">\\</span><span class="s2">p{Alphabetic}</span><span class="s4">\\</span><span class="s2">p{Number}_</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">]+`</span><span class="s0">,</span><span class="s2">&quot;ug&quot;</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">s</span><span class="s0">){</span><span class="s4">return new </span><span class="s1">RegExp</span><span class="s0">(</span><span class="s2">`[w</span><span class="s1">$</span><span class="s0">{</span><span class="s1">e</span><span class="s0">}</span><span class="s2">]`</span><span class="s0">,</span><span class="s2">&quot;g&quot;</span><span class="s0">)}}</span><span class="s4">function </span><span class="s1">Et</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return new </span><span class="s1">RegExp</span><span class="s0">(</span><span class="s1">e</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">source</span><span class="s0">),</span><span class="s1">t</span><span class="s0">.</span><span class="s1">unicode</span><span class="s0">?</span><span class="s2">&quot;u&quot;</span><span class="s0">:</span><span class="s2">&quot;&quot;</span><span class="s0">)}</span><span class="s4">const </span><span class="s1">Nt</span><span class="s0">=</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">);</span><span class="s4">function </span><span class="s1">Lt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">Nt</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]||(</span><span class="s1">Nt</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s4">new </span><span class="s1">WeakMap</span><span class="s0">)}</span><span class="s4">function </span><span class="s1">Bt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">iterLines</span><span class="s0">(),</span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;!</span><span class="s1">o</span><span class="s0">.</span><span class="s1">next</span><span class="s0">().</span><span class="s1">done</span><span class="s0">;){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">value</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}=</span><span class="s1">o</span><span class="s0">,</span><span class="s1">l</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">lastIndex</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s1">l</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">exec</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">[</span><span class="s1">l</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]]&amp;&amp;</span><span class="s1">r</span><span class="s0">+</span><span class="s1">l</span><span class="s0">.</span><span class="s1">index</span><span class="s0">!=</span><span class="s1">n</span><span class="s0">){</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">({</span><span class="s1">type</span><span class="s0">:</span><span class="s2">&quot;text&quot;</span><span class="s0">,</span><span class="s1">label</span><span class="s0">:</span><span class="s1">l</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]});</span><span class="s1">i</span><span class="s0">[</span><span class="s1">l</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]]=</span><span class="s4">true</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;=</span><span class="s3">2e3</span><span class="s0">)</span><span class="s4">return</span><span class="s0">}}</span><span class="s1">r</span><span class="s0">+=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">+</span><span class="s3">1</span><span class="s0">}}</span><span class="s4">function </span><span class="s1">Mt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;=</span><span class="s3">1e3</span><span class="s0">;</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)</span><span class="s4">return </span><span class="s1">r</span><span class="s0">;</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=[],</span><span class="s1">a</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s4">null</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">children</span><span class="s0">){</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r of t</span><span class="s0">.</span><span class="s1">children</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;=</span><span class="s3">1e3</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t of Mt</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">-</span><span class="s1">o</span><span class="s0">,</span><span class="s1">n</span><span class="s0">-</span><span class="s1">o</span><span class="s0">)){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">a</span><span class="s0">[</span><span class="s1">t</span><span class="s0">.</span><span class="s1">label</span><span class="s0">]){</span><span class="s1">a</span><span class="s0">[</span><span class="s1">t</span><span class="s0">.</span><span class="s1">label</span><span class="s0">]=</span><span class="s4">true</span><span class="s0">;</span><span class="s1">l</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}}}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">Bt</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">n</span><span class="s0">-</span><span class="s1">o</span><span class="s0">)}</span><span class="s1">o</span><span class="s0">+=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">length</span><span class="s0">+</span><span class="s3">1</span><span class="s0">}}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">Bt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">l</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s3">2e3</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">l</span><span class="s0">);</span><span class="s4">return </span><span class="s1">l</span><span class="s0">}</span><span class="s4">const </span><span class="s1">zt</span><span class="s0">=</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">languageDataAt</span><span class="s0">(</span><span class="s2">&quot;wordChars&quot;</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">).</span><span class="s1">join</span><span class="s0">(</span><span class="s2">&quot;&quot;</span><span class="s0">);</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">Dt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">matchBefore</span><span class="s0">(</span><span class="s1">Et</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,(</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">+</span><span class="s2">&quot;$&quot;</span><span class="s0">)));</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">&amp;&amp;!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">explicit</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">?</span><span class="s1">i</span><span class="s0">.</span><span class="s1">from</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">Mt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">doc</span><span class="s0">,</span><span class="s1">Lt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">s</span><span class="s0">,</span><span class="s3">5e4</span><span class="s0">,</span><span class="s1">n</span><span class="s0">);</span><span class="s4">return</span><span class="s0">{</span><span class="s1">from</span><span class="s0">:</span><span class="s1">n</span><span class="s0">,</span><span class="s1">options</span><span class="s0">:</span><span class="s1">o</span><span class="s0">,</span><span class="s1">validFor</span><span class="s0">:</span><span class="s1">Et</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,(</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s2">&quot;^&quot;</span><span class="s0">+</span><span class="s1">t</span><span class="s0">))}};</span><span class="s4">const </span><span class="s1">Ft</span><span class="s0">={</span><span class="s1">brackets</span><span class="s0">:[</span><span class="s2">&quot;(&quot;</span><span class="s0">,</span><span class="s2">&quot;[&quot;</span><span class="s0">,</span><span class="s2">&quot;{&quot;</span><span class="s0">,</span><span class="s2">&quot;'&quot;</span><span class="s0">,</span><span class="s2">'&quot;'</span><span class="s0">],</span><span class="s1">before</span><span class="s0">:</span><span class="s2">&quot;)]}:;&gt;&quot;</span><span class="s0">,</span><span class="s1">stringPrefixes</span><span class="s0">:[]};</span><span class="s4">const </span><span class="s1">$t</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">StateEffect</span><span class="s0">.</span><span class="s1">define</span><span class="s0">({</span><span class="s1">map</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">mapPos</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">MapMode</span><span class="s0">.</span><span class="s1">TrackAfter</span><span class="s0">);</span><span class="s4">return </span><span class="s1">s</span><span class="s0">==</span><span class="s4">null</span><span class="s0">?</span><span class="s1">undefined</span><span class="s0">:</span><span class="s1">s</span><span class="s0">}});</span><span class="s4">const </span><span class="s1">jt</span><span class="s0">=</span><span class="s4">new class extends </span><span class="s1">i</span><span class="s0">.</span><span class="s1">RangeValue</span><span class="s0">{};</span><span class="s1">jt</span><span class="s0">.</span><span class="s1">startSide</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s1">jt</span><span class="s0">.</span><span class="s1">endSide</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">const </span><span class="s1">Ut</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">StateField</span><span class="s0">.</span><span class="s1">define</span><span class="s0">({</span><span class="s1">create</span><span class="s0">(){</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">RangeSet</span><span class="s0">.</span><span class="s1">empty</span><span class="s0">},</span><span class="s1">update</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s1">t</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">changes</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">doc</span><span class="s0">.</span><span class="s1">lineAt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">.</span><span class="s1">main</span><span class="s0">.</span><span class="s1">head</span><span class="s0">);</span><span class="s1">t</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">update</span><span class="s0">({</span><span class="s1">filter</span><span class="s0">:</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">from</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">to</span><span class="s0">})}</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s of e</span><span class="s0">.</span><span class="s1">effects</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">is</span><span class="s0">(</span><span class="s1">$t</span><span class="s0">))</span><span class="s1">t</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">update</span><span class="s0">({</span><span class="s1">add</span><span class="s0">:[</span><span class="s1">jt</span><span class="s0">.</span><span class="s1">range</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">value</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">value</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)]});</span><span class="s4">return </span><span class="s1">t</span><span class="s0">}});</span><span class="s4">function </span><span class="s1">Wt</span><span class="s0">(){</span><span class="s4">return</span><span class="s0">[</span><span class="s1">_t</span><span class="s0">,</span><span class="s1">Ut</span><span class="s0">]}</span><span class="s4">const </span><span class="s1">Vt</span><span class="s0">=</span><span class="s2">&quot;()[]{}&lt;&gt;&quot;</span><span class="s0">;</span><span class="s4">function </span><span class="s1">qt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">Vt</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">e</span><span class="s0">+=</span><span class="s3">2</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">Vt</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)==</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return </span><span class="s1">Vt</span><span class="s0">.</span><span class="s1">charAt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s3">1</span><span class="s0">);</span><span class="s4">return</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">fromCodePoint</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s3">128</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s1">t</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)}</span><span class="s4">function </span><span class="s1">Ht</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">languageDataAt</span><span class="s0">(</span><span class="s2">&quot;closeBrackets&quot;</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)[</span><span class="s3">0</span><span class="s0">]||</span><span class="s1">Ft</span><span class="s0">}</span><span class="s4">const </span><span class="s1">Gt</span><span class="s0">=</span><span class="s4">typeof </span><span class="s1">navigator</span><span class="s0">==</span><span class="s2">&quot;object&quot;</span><span class="s0">&amp;&amp;</span><span class="s5">/Android\b/</span><span class="s0">.</span><span class="s1">test</span><span class="s0">(</span><span class="s1">navigator</span><span class="s0">.</span><span class="s1">userAgent</span><span class="s0">);</span><span class="s4">const </span><span class="s1">_t</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">EditorView</span><span class="s0">.</span><span class="s1">inputHandler</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(((</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)=&gt;{</span><span class="s4">if</span><span class="s0">((</span><span class="s1">Gt</span><span class="s0">?</span><span class="s1">t</span><span class="s0">.</span><span class="s1">composing</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">compositionStarted</span><span class="s0">)||</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">readOnly</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">.</span><span class="s1">main</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">2</span><span class="s0">||</span><span class="s1">n</span><span class="s0">.</span><span class="s1">length</span><span class="s0">==</span><span class="s3">2</span><span class="s0">&amp;&amp;(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointSize</span><span class="s0">)((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointAt</span><span class="s0">)(</span><span class="s1">n</span><span class="s0">,</span><span class="s3">0</span><span class="s0">))==</span><span class="s3">1</span><span class="s0">||</span><span class="s1">e</span><span class="s0">!=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">from</span><span class="s0">||</span><span class="s1">s</span><span class="s0">!=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">Xt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">n</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">r</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dispatch</span><span class="s0">(</span><span class="s1">r</span><span class="s0">);</span><span class="s4">return true</span><span class="s0">}));</span><span class="s4">const </span><span class="s1">Kt</span><span class="s0">=({</span><span class="s1">state</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">dispatch</span><span class="s0">:</span><span class="s1">e</span><span class="s0">})=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">readOnly</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">Ht</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">.</span><span class="s1">main</span><span class="s0">.</span><span class="s1">head</span><span class="s0">);</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">brackets</span><span class="s0">||</span><span class="s1">Ft</span><span class="s0">.</span><span class="s1">brackets</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s4">null</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changeByRange</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">empty</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">Zt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">doc</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">head</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o of n</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">==</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">Jt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">doc</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">head</span><span class="s0">)==</span><span class="s1">qt</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointAt</span><span class="s0">)(</span><span class="s1">o</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)))</span><span class="s4">return</span><span class="s0">{</span><span class="s1">changes</span><span class="s0">:{</span><span class="s1">from</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">head</span><span class="s0">-</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">to</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">head</span><span class="s0">+</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">},</span><span class="s1">range</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">EditorSelection</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">head</span><span class="s0">-</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)}}}</span><span class="s4">return</span><span class="s0">{</span><span class="s1">range</span><span class="s0">:</span><span class="s1">o</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}}));</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">o</span><span class="s0">)</span><span class="s1">e</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">update</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,{</span><span class="s1">scrollIntoView</span><span class="s0">:</span><span class="s4">true</span><span class="s0">,</span><span class="s1">userEvent</span><span class="s0">:</span><span class="s2">&quot;delete.backward&quot;</span><span class="s0">}));</span><span class="s4">return</span><span class="s0">!</span><span class="s1">o</span><span class="s0">};</span><span class="s4">const </span><span class="s1">Qt</span><span class="s0">=[{</span><span class="s1">key</span><span class="s0">:</span><span class="s2">&quot;Backspace&quot;</span><span class="s0">,</span><span class="s1">run</span><span class="s0">:</span><span class="s1">Kt</span><span class="s0">}];</span><span class="s4">function </span><span class="s1">Xt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">Ht</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">.</span><span class="s1">main</span><span class="s0">.</span><span class="s1">head</span><span class="s0">);</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">brackets</span><span class="s0">||</span><span class="s1">Ft</span><span class="s0">.</span><span class="s1">brackets</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o of n</span><span class="s0">){</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">qt</span><span class="s0">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointAt</span><span class="s0">)(</span><span class="s1">o</span><span class="s0">,</span><span class="s3">0</span><span class="s0">));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">==</span><span class="s1">o</span><span class="s0">)</span><span class="s4">return </span><span class="s1">r</span><span class="s0">==</span><span class="s1">o</span><span class="s0">?</span><span class="s1">se</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">o</span><span class="s0">+</span><span class="s1">o</span><span class="s0">+</span><span class="s1">o</span><span class="s0">)&gt;-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">s</span><span class="s0">):</span><span class="s1">te</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">before</span><span class="s0">||</span><span class="s1">Ft</span><span class="s0">.</span><span class="s1">before</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">==</span><span class="s1">r</span><span class="s0">&amp;&amp;</span><span class="s1">Yt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">selection</span><span class="s0">.</span><span class="s1">main</span><span class="s0">.</span><span class="s1">from</span><span class="s0">))</span><span class="s4">return </span><span class="s1">ee</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">r</span><span class="s0">)}</span><span class="s4">return null</span><span class="s0">}</span><span class="s4">function </span><span class="s1">Yt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Ut</span><span class="s0">).</span><span class="s1">between</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">doc</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,(</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">==</span><span class="s1">e</span><span class="s0">)</span><span class="s1">s</span><span class="s0">=</span><span class="s4">true</span><span class="s0">}));</span><span class="s4">return </span><span class="s1">s</span><span class="s0">}</span><span class="s4">function </span><span class="s1">Jt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">sliceString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">e</span><span class="s0">+</span><span class="s3">2</span><span class="s0">);</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointSize</span><span class="s0">)((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointAt</span><span class="s0">)(</span><span class="s1">s</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)))}</span><span class="s4">function </span><span class="s1">Zt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">sliceString</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-</span><span class="s3">2</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointSize</span><span class="s0">)((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">codePointAt</span><span class="s0">)(</span><span class="s1">s</span><span class="s0">,</span><span class="s3">0</span><span class="s0">))==</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s1">s</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">1</span><span class="s0">)}</span><span class="s4">function </span><span class="s1">te</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s4">null</span><span class="s0">,</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changeByRange</span><span class="s0">((</span><span class="s1">r</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">r</span><span class="s0">.</span><span class="s1">empty</span><span class="s0">)</span><span class="s4">return</span><span class="s0">{</span><span class="s1">changes</span><span class="s0">:[{</span><span class="s1">insert</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">from</span><span class="s0">:</span><span class="s1">r</span><span class="s0">.</span><span class="s1">from</span><span class="s0">},{</span><span class="s1">insert</span><span class="s0">:</span><span class="s1">s</span><span class="s0">,</span><span class="s1">from</span><span class="s0">:</span><span class="s1">r</span><span class="s0">.</span><span class="s1">to</span><span class="s0">}],</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">$t</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">to</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">),</span><span class="s1">range</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">EditorSelection</span><span class="s0">.</span><span class="s1">range</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">anchor</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">head</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)};</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">Jt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">doc</span><span class="s0">,</span><span class="s1">r</span><span class="s0">.</span><span class="s1">head</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">l</span><span class="s0">||</span><span class="s5">/\s/</span><span class="s0">.</span><span class="s1">test</span><span class="s0">(</span><span class="s1">l</span><span class="s0">)||</span><span class="s1">n</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">l</span><span class="s0">)&gt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s4">return</span><span class="s0">{</span><span class="s1">changes</span><span class="s0">:{</span><span class="s1">insert</span><span class="s0">:</span><span class="s1">e</span><span class="s0">+</span><span class="s1">s</span><span class="s0">,</span><span class="s1">from</span><span class="s0">:</span><span class="s1">r</span><span class="s0">.</span><span class="s1">head</span><span class="s0">},</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">$t</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">head</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">),</span><span class="s1">range</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">EditorSelection</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">head</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)};</span><span class="s4">return</span><span class="s0">{</span><span class="s1">range</span><span class="s0">:</span><span class="s1">o</span><span class="s0">=</span><span class="s1">r</span><span class="s0">}}));</span><span class="s4">return </span><span class="s1">o</span><span class="s0">?</span><span class="s4">null</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">update</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,{</span><span class="s1">scrollIntoView</span><span class="s0">:</span><span class="s4">true</span><span class="s0">,</span><span class="s1">userEvent</span><span class="s0">:</span><span class="s2">&quot;input.type&quot;</span><span class="s0">})}</span><span class="s4">function </span><span class="s1">ee</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">null</span><span class="s0">,</span><span class="s1">o</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changeByRange</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">empty</span><span class="s0">&amp;&amp;</span><span class="s1">Jt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">doc</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">head</span><span class="s0">)==</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return</span><span class="s0">{</span><span class="s1">changes</span><span class="s0">:{</span><span class="s1">from</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">head</span><span class="s0">,</span><span class="s1">to</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">head</span><span class="s0">+</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">insert</span><span class="s0">:</span><span class="s1">s</span><span class="s0">},</span><span class="s1">range</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">EditorSelection</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">head</span><span class="s0">+</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)};</span><span class="s4">return </span><span class="s1">n</span><span class="s0">={</span><span class="s1">range</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}}));</span><span class="s4">return </span><span class="s1">n</span><span class="s0">?</span><span class="s4">null</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">update</span><span class="s0">(</span><span class="s1">o</span><span class="s0">,{</span><span class="s1">scrollIntoView</span><span class="s0">:</span><span class="s4">true</span><span class="s0">,</span><span class="s1">userEvent</span><span class="s0">:</span><span class="s2">&quot;input.type&quot;</span><span class="s0">})}</span><span class="s4">function </span><span class="s1">se</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">){</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">stringPrefixes</span><span class="s0">||</span><span class="s1">Ft</span><span class="s0">.</span><span class="s1">stringPrefixes</span><span class="s0">;</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s4">null</span><span class="s0">,</span><span class="s1">l</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">changeByRange</span><span class="s0">((</span><span class="s1">n</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">n</span><span class="s0">.</span><span class="s1">empty</span><span class="s0">)</span><span class="s4">return</span><span class="s0">{</span><span class="s1">changes</span><span class="s0">:[{</span><span class="s1">insert</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">from</span><span class="s0">:</span><span class="s1">n</span><span class="s0">.</span><span class="s1">from</span><span class="s0">},{</span><span class="s1">insert</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">from</span><span class="s0">:</span><span class="s1">n</span><span class="s0">.</span><span class="s1">to</span><span class="s0">}],</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">$t</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">to</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">),</span><span class="s1">range</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">EditorSelection</span><span class="s0">.</span><span class="s1">range</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">anchor</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">head</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)};</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">head</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s1">Jt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">doc</span><span class="s0">,</span><span class="s1">l</span><span class="s0">),</span><span class="s1">h</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">==</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">ie</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">l</span><span class="s0">)){</span><span class="s4">return</span><span class="s0">{</span><span class="s1">changes</span><span class="s0">:{</span><span class="s1">insert</span><span class="s0">:</span><span class="s1">e</span><span class="s0">+</span><span class="s1">e</span><span class="s0">,</span><span class="s1">from</span><span class="s0">:</span><span class="s1">l</span><span class="s0">},</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">$t</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">l</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">),</span><span class="s1">range</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">EditorSelection</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">(</span><span class="s1">l</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)}}</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">Yt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">l</span><span class="s0">)){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">sliceDoc</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,</span><span class="s1">l</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">*</span><span class="s3">3</span><span class="s0">)==</span><span class="s1">e</span><span class="s0">+</span><span class="s1">e</span><span class="s0">+</span><span class="s1">e</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">?</span><span class="s1">e</span><span class="s0">+</span><span class="s1">e</span><span class="s0">+</span><span class="s1">e</span><span class="s0">:</span><span class="s1">e</span><span class="s0">;</span><span class="s4">return</span><span class="s0">{</span><span class="s1">changes</span><span class="s0">:{</span><span class="s1">from</span><span class="s0">:</span><span class="s1">l</span><span class="s0">,</span><span class="s1">to</span><span class="s0">:</span><span class="s1">l</span><span class="s0">+</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">insert</span><span class="s0">:</span><span class="s1">o</span><span class="s0">},</span><span class="s1">range</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">EditorSelection</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">(</span><span class="s1">l</span><span class="s0">+</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)}}}</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">sliceDoc</span><span class="s0">(</span><span class="s1">l</span><span class="s0">-</span><span class="s3">2</span><span class="s0">*</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">l</span><span class="s0">)==</span><span class="s1">e</span><span class="s0">+</span><span class="s1">e</span><span class="s0">&amp;&amp;(</span><span class="s1">h</span><span class="s0">=</span><span class="s1">oe</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">l</span><span class="s0">-</span><span class="s3">2</span><span class="s0">*</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">o</span><span class="s0">))&gt;-</span><span class="s3">1</span><span class="s0">&amp;&amp;</span><span class="s1">ie</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">h</span><span class="s0">)){</span><span class="s4">return</span><span class="s0">{</span><span class="s1">changes</span><span class="s0">:{</span><span class="s1">insert</span><span class="s0">:</span><span class="s1">e</span><span class="s0">+</span><span class="s1">e</span><span class="s0">+</span><span class="s1">e</span><span class="s0">+</span><span class="s1">e</span><span class="s0">,</span><span class="s1">from</span><span class="s0">:</span><span class="s1">l</span><span class="s0">},</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">$t</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">l</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">),</span><span class="s1">range</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">EditorSelection</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">(</span><span class="s1">l</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)}}</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">charCategorizer</span><span class="s0">(</span><span class="s1">l</span><span class="s0">)(</span><span class="s1">a</span><span class="s0">)!=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">CharCategory</span><span class="s0">.</span><span class="s1">Word</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">oe</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">o</span><span class="s0">)&gt;-</span><span class="s3">1</span><span class="s0">&amp;&amp;!</span><span class="s1">ne</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">o</span><span class="s0">))</span><span class="s4">return</span><span class="s0">{</span><span class="s1">changes</span><span class="s0">:{</span><span class="s1">insert</span><span class="s0">:</span><span class="s1">e</span><span class="s0">+</span><span class="s1">e</span><span class="s0">,</span><span class="s1">from</span><span class="s0">:</span><span class="s1">l</span><span class="s0">},</span><span class="s1">effects</span><span class="s0">:</span><span class="s1">$t</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">l</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">),</span><span class="s1">range</span><span class="s0">:</span><span class="s1">i</span><span class="s0">.</span><span class="s1">EditorSelection</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">(</span><span class="s1">l</span><span class="s0">+</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)}}</span><span class="s4">return</span><span class="s0">{</span><span class="s1">range</span><span class="s0">:</span><span class="s1">r</span><span class="s0">=</span><span class="s1">n</span><span class="s0">}}));</span><span class="s4">return </span><span class="s1">r</span><span class="s0">?</span><span class="s4">null</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">update</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,{</span><span class="s1">scrollIntoView</span><span class="s0">:</span><span class="s4">true</span><span class="s0">,</span><span class="s1">userEvent</span><span class="s0">:</span><span class="s2">&quot;input.type&quot;</span><span class="s0">})}</span><span class="s4">function </span><span class="s1">ie</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">syntaxTree</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">).</span><span class="s1">resolveInner</span><span class="s0">(</span><span class="s1">e</span><span class="s0">+</span><span class="s3">1</span><span class="s0">);</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">parent</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">from</span><span class="s0">==</span><span class="s1">e</span><span class="s0">}</span><span class="s4">function </span><span class="s1">ne</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">syntaxTree</span><span class="s0">)(</span><span class="s1">t</span><span class="s0">).</span><span class="s1">resolveInner</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">reduce</span><span class="s0">(((</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)),</span><span class="s3">0</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s3">5</span><span class="s0">;</span><span class="s1">r</span><span class="s0">++){</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">sliceDoc</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">to</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">from</span><span class="s0">+</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">+</span><span class="s1">o</span><span class="s0">));</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">l</span><span class="s0">||</span><span class="s1">l</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">))&gt;-</span><span class="s3">1</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">firstChild</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">from</span><span class="s0">==</span><span class="s1">n</span><span class="s0">.</span><span class="s1">from</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">to</span><span class="s0">-</span><span class="s1">e</span><span class="s0">.</span><span class="s1">from</span><span class="s0">&gt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">+</span><span class="s1">l</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">sliceDoc</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">to</span><span class="s0">-</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)==</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s1">e</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">firstChild</span><span class="s0">}</span><span class="s4">return true</span><span class="s0">}</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">to</span><span class="s0">==</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">parent</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">a</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s1">n</span><span class="s0">=</span><span class="s1">a</span><span class="s0">}</span><span class="s4">return false</span><span class="s0">}</span><span class="s4">function </span><span class="s1">oe</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">charCategorizer</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">sliceDoc</span><span class="s0">(</span><span class="s1">e</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">))!=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">CharCategory</span><span class="s0">.</span><span class="s1">Word</span><span class="s0">)</span><span class="s4">return </span><span class="s1">e</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o of s</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">-</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">sliceDoc</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)==</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">sliceDoc</span><span class="s0">(</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">s</span><span class="s0">))!=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">CharCategory</span><span class="s0">.</span><span class="s1">Word</span><span class="s0">)</span><span class="s4">return </span><span class="s1">s</span><span class="s0">}</span><span class="s4">return</span><span class="s0">-</span><span class="s3">1</span><span class="s0">}</span><span class="s4">function </span><span class="s1">re</span><span class="s0">(</span><span class="s1">t</span><span class="s0">={}){</span><span class="s4">return</span><span class="s0">[</span><span class="s1">lt</span><span class="s0">,</span><span class="s1">Q</span><span class="s0">,</span><span class="s1">T</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">ot</span><span class="s0">,</span><span class="s1">ae</span><span class="s0">,</span><span class="s1">at</span><span class="s0">]}</span><span class="s4">const </span><span class="s1">le</span><span class="s0">=[{</span><span class="s1">key</span><span class="s0">:</span><span class="s2">&quot;Ctrl-Space&quot;</span><span class="s0">,</span><span class="s1">run</span><span class="s0">:</span><span class="s1">tt</span><span class="s0">},{</span><span class="s1">mac</span><span class="s0">:</span><span class="s2">&quot;Alt-`&quot;</span><span class="s0">,</span><span class="s1">run</span><span class="s0">:</span><span class="s1">tt</span><span class="s0">},{</span><span class="s1">key</span><span class="s0">:</span><span class="s2">&quot;Escape&quot;</span><span class="s0">,</span><span class="s1">run</span><span class="s0">:</span><span class="s1">et</span><span class="s0">},{</span><span class="s1">key</span><span class="s0">:</span><span class="s2">&quot;ArrowDown&quot;</span><span class="s0">,</span><span class="s1">run</span><span class="s0">:</span><span class="s1">J</span><span class="s0">(</span><span class="s4">true</span><span class="s0">)},{</span><span class="s1">key</span><span class="s0">:</span><span class="s2">&quot;ArrowUp&quot;</span><span class="s0">,</span><span class="s1">run</span><span class="s0">:</span><span class="s1">J</span><span class="s0">(</span><span class="s4">false</span><span class="s0">)},{</span><span class="s1">key</span><span class="s0">:</span><span class="s2">&quot;PageDown&quot;</span><span class="s0">,</span><span class="s1">run</span><span class="s0">:</span><span class="s1">J</span><span class="s0">(</span><span class="s4">true</span><span class="s0">,</span><span class="s2">&quot;page&quot;</span><span class="s0">)},{</span><span class="s1">key</span><span class="s0">:</span><span class="s2">&quot;PageUp&quot;</span><span class="s0">,</span><span class="s1">run</span><span class="s0">:</span><span class="s1">J</span><span class="s0">(</span><span class="s4">false</span><span class="s0">,</span><span class="s2">&quot;page&quot;</span><span class="s0">)},{</span><span class="s1">key</span><span class="s0">:</span><span class="s2">&quot;Enter&quot;</span><span class="s0">,</span><span class="s1">run</span><span class="s0">:</span><span class="s1">Z</span><span class="s0">}];</span><span class="s4">const </span><span class="s1">ae</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">Prec</span><span class="s0">.</span><span class="s1">highest</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">keymap</span><span class="s0">.</span><span class="s1">computeN</span><span class="s0">([</span><span class="s1">T</span><span class="s0">],(</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">facet</span><span class="s0">(</span><span class="s1">T</span><span class="s0">).</span><span class="s1">defaultKeymap</span><span class="s0">?[</span><span class="s1">le</span><span class="s0">]:[])));</span><span class="s4">function </span><span class="s1">he</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">,</span><span class="s4">false</span><span class="s0">);</span><span class="s4">return </span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">isPending</span><span class="s0">))?</span><span class="s2">&quot;pending&quot;</span><span class="s0">:</span><span class="s1">e</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">active</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">!=</span><span class="s3">0</span><span class="s0">))?</span><span class="s2">&quot;active&quot;</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}</span><span class="s4">const </span><span class="s1">ce</span><span class="s0">=</span><span class="s4">new </span><span class="s1">WeakMap</span><span class="s0">;</span><span class="s4">function </span><span class="s1">fe</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">var </span><span class="s1">e</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">,</span><span class="s4">false</span><span class="s0">))===</span><span class="s4">null</span><span class="s0">||</span><span class="s1">e</span><span class="s0">===</span><span class="s4">void </span><span class="s3">0</span><span class="s0">?</span><span class="s4">void </span><span class="s3">0</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">||</span><span class="s1">s</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">)</span><span class="s4">return</span><span class="s0">[];</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">ce</span><span class="s0">.</span><span class="s1">get</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">options</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">)</span><span class="s1">ce</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">options</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">options</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">completion</span><span class="s0">)));</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s4">function </span><span class="s1">ue</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">var </span><span class="s1">e</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">,</span><span class="s4">false</span><span class="s0">))===</span><span class="s4">null</span><span class="s0">||</span><span class="s1">e</span><span class="s0">===</span><span class="s4">void </span><span class="s3">0</span><span class="s0">?</span><span class="s4">void </span><span class="s3">0</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">;</span><span class="s4">return </span><span class="s1">s</span><span class="s0">&amp;&amp;!</span><span class="s1">s</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">options</span><span class="s0">[</span><span class="s1">s</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">].</span><span class="s1">completion</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}</span><span class="s4">function </span><span class="s1">pe</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">var </span><span class="s1">e</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">field</span><span class="s0">(</span><span class="s1">Q</span><span class="s0">,</span><span class="s4">false</span><span class="s0">))===</span><span class="s4">null</span><span class="s0">||</span><span class="s1">e</span><span class="s0">===</span><span class="s4">void </span><span class="s3">0</span><span class="s0">?</span><span class="s4">void </span><span class="s3">0</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">open</span><span class="s0">;</span><span class="s4">return </span><span class="s1">s</span><span class="s0">&amp;&amp;!</span><span class="s1">s</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">selected</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}</span><span class="s4">function </span><span class="s1">de</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return </span><span class="s1">K</span><span class="s0">.</span><span class="s1">of</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}},</span><span class="s3">27421</span><span class="s0">:(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)=&gt;{</span><span class="s2">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">d</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,{</span><span class="s1">Aj</span><span class="s0">:()=&gt;</span><span class="s1">O</span><span class="s0">,</span><span class="s1">Lu</span><span class="s0">:()=&gt;</span><span class="s1">g</span><span class="s0">,</span><span class="s1">U1</span><span class="s0">:()=&gt;</span><span class="s1">R</span><span class="s0">,</span><span class="s1">uC</span><span class="s0">:()=&gt;</span><span class="s1">m</span><span class="s0">});</span><span class="s4">var </span><span class="s1">i</span><span class="s0">=</span><span class="s1">s</span><span class="s0">(</span><span class="s3">66575</span><span class="s0">);</span><span class="s4">var </span><span class="s1">n</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">n</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s4">var </span><span class="s1">o</span><span class="s0">=</span><span class="s1">s</span><span class="s0">(</span><span class="s3">65606</span><span class="s0">);</span><span class="s4">class </span><span class="s1">r</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">,</span><span class="s1">r</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">a</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">c</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">=</span><span class="s1">i</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">=</span><span class="s1">n</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">score</span><span class="s0">=</span><span class="s1">o</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">=</span><span class="s1">r</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bufferBase</span><span class="s0">=</span><span class="s1">l</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">=</span><span class="s1">a</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">=</span><span class="s1">h</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">parent</span><span class="s0">=</span><span class="s1">c</span><span class="s0">}</span><span class="s1">toString</span><span class="s0">(){</span><span class="s4">return</span><span class="s2">`[</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">filter</span><span class="s0">(((</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">e</span><span class="s0">%</span><span class="s3">3</span><span class="s0">==</span><span class="s3">0</span><span class="s0">)).</span><span class="s1">concat</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">)}</span><span class="s2">]@</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">score</span><span class="s0">?</span><span class="s2">&quot;!&quot;</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">score</span><span class="s0">:</span><span class="s2">&quot;&quot;</span><span class="s0">}</span><span class="s2">`</span><span class="s0">}</span><span class="s4">static </span><span class="s1">start</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">context</span><span class="s0">;</span><span class="s4">return new </span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,[],</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,[],</span><span class="s3">0</span><span class="s0">,</span><span class="s1">i</span><span class="s0">?</span><span class="s4">new </span><span class="s1">l</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">start</span><span class="s0">):</span><span class="s4">null</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s4">null</span><span class="s0">)}</span><span class="s1">get context</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">context</span><span class="s0">:</span><span class="s4">null</span><span class="s0">}</span><span class="s1">pushState</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bufferBase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s1">reduce</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">var </span><span class="s1">e</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">19</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&amp;</span><span class="s3">65535</span><span class="s0">;</span><span class="s4">let</span><span class="s0">{</span><span class="s1">parser</span><span class="s0">:</span><span class="s1">n</span><span class="s0">}=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">dynamicPrecedence</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">score</span><span class="s0">+=</span><span class="s1">o</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">==</span><span class="s3">0</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pushState</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">getGoto</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s4">true</span><span class="s0">),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">minRepeatTerm</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">storeNode</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">,</span><span class="s3">4</span><span class="s0">,</span><span class="s4">true</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reduceContext</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">);</span><span class="s4">return</span><span class="s0">}</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-(</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)*</span><span class="s3">3</span><span class="s0">-(</span><span class="s1">t</span><span class="s0">&amp;</span><span class="s3">262144</span><span class="s0">?</span><span class="s3">6</span><span class="s0">:</span><span class="s3">0</span><span class="s0">);</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">r</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">[</span><span class="s1">r</span><span class="s0">-</span><span class="s3">2</span><span class="s0">]:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">from</span><span class="s0">,</span><span class="s1">a</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">-</span><span class="s1">l</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">&gt;=</span><span class="s3">2e3</span><span class="s0">&amp;&amp;!((</span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">.</span><span class="s1">types</span><span class="s0">[</span><span class="s1">i</span><span class="s0">])===</span><span class="s4">null</span><span class="s0">||</span><span class="s1">e</span><span class="s0">===</span><span class="s4">void </span><span class="s3">0</span><span class="s0">?</span><span class="s4">void </span><span class="s3">0</span><span class="s0">:</span><span class="s1">e</span><span class="s0">.</span><span class="s1">isAnonymous</span><span class="s0">)){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">lastBigReductionStart</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">bigReductionCount</span><span class="s0">++;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">lastBigReductionSize</span><span class="s0">=</span><span class="s1">a</span><span class="s0">}</span><span class="s4">else if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">lastBigReductionSize</span><span class="s0">&lt;</span><span class="s1">a</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">bigReductionCount</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">lastBigReductionStart</span><span class="s0">=</span><span class="s1">l</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">lastBigReductionSize</span><span class="s0">=</span><span class="s1">a</span><span class="s0">}}</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s1">r</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">[</span><span class="s1">r</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]:</span><span class="s3">0</span><span class="s0">,</span><span class="s1">c</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bufferBase</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">h</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">minRepeatTerm</span><span class="s0">||</span><span class="s1">t</span><span class="s0">&amp;</span><span class="s3">131072</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">stateFlag</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">storeNode</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">l</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">c</span><span class="s0">+</span><span class="s3">4</span><span class="s0">,</span><span class="s4">true</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&amp;</span><span class="s3">262144</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">[</span><span class="s1">r</span><span class="s0">]}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">[</span><span class="s1">r</span><span class="s0">-</span><span class="s3">3</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s1">n</span><span class="s0">.</span><span class="s1">getGoto</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s4">true</span><span class="s0">)}</span><span class="s4">while</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">r</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reduceContext</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">l</span><span class="s0">)}</span><span class="s1">storeNode</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s3">4</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s4">false</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">==</span><span class="s3">0</span><span class="s0">&amp;&amp;(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bufferBase</span><span class="s0">)){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">==</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">parent</span><span class="s0">){</span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bufferBase</span><span class="s0">-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">parent</span><span class="s0">.</span><span class="s1">bufferBase</span><span class="s0">;</span><span class="s1">t</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">parent</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">i</span><span class="s0">-</span><span class="s3">4</span><span class="s0">]==</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">i</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]&gt;-</span><span class="s3">1</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">==</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">i</span><span class="s0">-</span><span class="s3">2</span><span class="s0">]&gt;=</span><span class="s1">e</span><span class="s0">){</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">i</span><span class="s0">-</span><span class="s3">2</span><span class="s0">]=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">return</span><span class="s0">}}}</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">n</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">==</span><span class="s1">s</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">-</span><span class="s3">4</span><span class="s0">]!=</span><span class="s3">0</span><span class="s0">)</span><span class="s4">while</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">-</span><span class="s3">2</span><span class="s0">]&gt;</span><span class="s1">s</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">-</span><span class="s3">4</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">-</span><span class="s3">3</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">+</span><span class="s3">2</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">-</span><span class="s3">2</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">+</span><span class="s3">3</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">-</span><span class="s3">1</span><span class="s0">];</span><span class="s1">n</span><span class="s0">-=</span><span class="s3">4</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&gt;</span><span class="s3">4</span><span class="s0">)</span><span class="s1">i</span><span class="s0">-=</span><span class="s3">4</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">+</span><span class="s3">2</span><span class="s0">]=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">n</span><span class="s0">+</span><span class="s3">3</span><span class="s0">]=</span><span class="s1">i</span><span class="s0">}}</span><span class="s1">shift</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&amp;</span><span class="s3">131072</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pushState</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&amp;</span><span class="s3">65535</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">)}</span><span class="s4">else if</span><span class="s0">((</span><span class="s1">t</span><span class="s0">&amp;</span><span class="s3">262144</span><span class="s0">)==</span><span class="s3">0</span><span class="s0">){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">,{</span><span class="s1">parser</span><span class="s0">:</span><span class="s1">o</span><span class="s0">}=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">||</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">maxNode</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">=</span><span class="s1">i</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">o</span><span class="s0">.</span><span class="s1">stateFlag</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s3">1</span><span class="s0">))</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">=</span><span class="s1">i</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pushState</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">shiftContext</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">maxNode</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s3">4</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">=</span><span class="s1">i</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">shiftContext</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">maxNode</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s3">4</span><span class="s0">)}}</span><span class="s1">apply</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&amp;</span><span class="s3">65536</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reduce</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">else this</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">useNode</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">reused</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">reused</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]!=</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">reused</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s1">s</span><span class="s0">++}</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">=</span><span class="s1">i</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pushState</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateContext</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">tracker</span><span class="s0">.</span><span class="s1">reuse</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">context</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)))}</span><span class="s1">split</span><span class="s0">(){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">;</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">e</span><span class="s0">-</span><span class="s3">2</span><span class="s0">]&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">)</span><span class="s1">e</span><span class="s0">-=</span><span class="s3">4</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">e</span><span class="s0">),</span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bufferBase</span><span class="s0">+</span><span class="s1">e</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bufferBase</span><span class="s0">)</span><span class="s1">t</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">parent</span><span class="s0">;</span><span class="s4">return new </span><span class="s1">r</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(),</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">score</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">recoverByDelete</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">maxNode</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">storeNode</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s3">4</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">storeNode</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">?</span><span class="s3">8</span><span class="s0">:</span><span class="s3">4</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">score</span><span class="s0">-=</span><span class="s3">190</span><span class="s0">}</span><span class="s1">canShift</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">a</span><span class="s0">(</span><span class="s4">this</span><span class="s0">);;){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s3">4</span><span class="s0">)||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">hasAction</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">==</span><span class="s3">0</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">if</span><span class="s0">((</span><span class="s1">s</span><span class="s0">&amp;</span><span class="s3">65536</span><span class="s0">)==</span><span class="s3">0</span><span class="s0">)</span><span class="s4">return true</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">reduce</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)}}</span><span class="s1">recoverByInsert</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;=</span><span class="s3">300</span><span class="s0">)</span><span class="s4">return</span><span class="s0">[];</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">nextStates</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">4</span><span class="s0">&lt;&lt;</span><span class="s3">1</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;=</span><span class="s3">120</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">i</span><span class="s0">+=</span><span class="s3">2</span><span class="s0">){</span><span class="s4">if</span><span class="s0">((</span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">i</span><span class="s0">+</span><span class="s3">1</span><span class="s0">])!=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">hasAction</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">t</span><span class="s0">))</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s1">i</span><span class="s0">],</span><span class="s1">n</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s3">120</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s3">4</span><span class="s0">&lt;&lt;</span><span class="s3">1</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">t</span><span class="s0">+=</span><span class="s3">2</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">+</span><span class="s3">1</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">.</span><span class="s1">some</span><span class="s0">(((</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">e</span><span class="s0">&amp;</span><span class="s3">1</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">==</span><span class="s1">i</span><span class="s0">)))</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">],</span><span class="s1">i</span><span class="s0">)}</span><span class="s1">e</span><span class="s0">=</span><span class="s1">s</span><span class="s0">}</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&lt;</span><span class="s3">4</span><span class="s0">;</span><span class="s1">i</span><span class="s0">+=</span><span class="s3">2</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">i</span><span class="s0">+</span><span class="s3">1</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">split</span><span class="s0">();</span><span class="s1">n</span><span class="s0">.</span><span class="s1">pushState</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">);</span><span class="s1">n</span><span class="s0">.</span><span class="s1">storeNode</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s1">n</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s3">4</span><span class="s0">,</span><span class="s4">true</span><span class="s0">);</span><span class="s1">n</span><span class="s0">.</span><span class="s1">shiftContext</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s1">i</span><span class="s0">],</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">);</span><span class="s1">n</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">score</span><span class="s0">-=</span><span class="s3">200</span><span class="s0">;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">n</span><span class="s0">)}</span><span class="s4">return </span><span class="s1">s</span><span class="s0">}</span><span class="s1">forceReduce</span><span class="s0">(){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">parser</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">;</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s3">5</span><span class="s0">);</span><span class="s4">if</span><span class="s0">((</span><span class="s1">e</span><span class="s0">&amp;</span><span class="s3">65536</span><span class="s0">)==</span><span class="s3">0</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">validAction</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">19</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&amp;</span><span class="s3">65535</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">s</span><span class="s0">*</span><span class="s3">3</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getGoto</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">[</span><span class="s1">n</span><span class="s0">],</span><span class="s1">i</span><span class="s0">,</span><span class="s4">false</span><span class="s0">)&lt;</span><span class="s3">0</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">findForcedReduction</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">==</span><span class="s4">null</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">storeNode</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s3">4</span><span class="s0">,</span><span class="s4">true</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">score</span><span class="s0">-=</span><span class="s3">100</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reduce</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return true</span><span class="s0">}</span><span class="s1">findForcedReduction</span><span class="s0">(){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">parser</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=[];</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">)=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">includes</span><span class="s0">(</span><span class="s1">i</span><span class="s0">))</span><span class="s4">return</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">allActions</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,(</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&amp;(</span><span class="s3">262144</span><span class="s0">|</span><span class="s3">131072</span><span class="s0">));</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&amp;</span><span class="s3">65536</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=(</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">19</span><span class="s0">)-</span><span class="s1">n</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&amp;</span><span class="s3">65535</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">s</span><span class="s0">*</span><span class="s3">3</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">getGoto</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">[</span><span class="s1">n</span><span class="s0">],</span><span class="s1">i</span><span class="s0">,</span><span class="s4">false</span><span class="s0">)&gt;=</span><span class="s3">0</span><span class="s0">)</span><span class="s4">return </span><span class="s1">s</span><span class="s0">&lt;&lt;</span><span class="s3">19</span><span class="s0">|</span><span class="s3">65536</span><span class="s0">|</span><span class="s1">i</span><span class="s0">}}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">s</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">)</span><span class="s4">return </span><span class="s1">t</span><span class="s0">}}))};</span><span class="s4">return </span><span class="s1">s</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}</span><span class="s1">forceAll</span><span class="s0">(){</span><span class="s4">while</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">stateFlag</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s3">2</span><span class="s0">)){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">forceReduce</span><span class="s0">()){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">storeNode</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s3">4</span><span class="s0">,</span><span class="s4">true</span><span class="s0">);</span><span class="s4">break</span><span class="s0">}}</span><span class="s4">return this</span><span class="s0">}</span><span class="s1">get deadEnd</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">!=</span><span class="s3">3</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">let</span><span class="s0">{</span><span class="s1">parser</span><span class="s0">:</span><span class="s1">t</span><span class="s0">}=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">;</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">data</span><span class="s0">[</span><span class="s1">t</span><span class="s0">.</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)]==</span><span class="s3">65535</span><span class="s0">&amp;&amp;!</span><span class="s1">t</span><span class="s0">.</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s3">4</span><span class="s0">)}</span><span class="s1">restart</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">storeNode</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s3">4</span><span class="s0">,</span><span class="s4">true</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">sameState</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">!=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">!=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">e</span><span class="s0">+=</span><span class="s3">3</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]!=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">[</span><span class="s1">e</span><span class="s0">])</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">return true</span><span class="s0">}</span><span class="s1">get parser</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">}</span><span class="s1">dialectEnabled</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">dialect</span><span class="s0">.</span><span class="s1">flags</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]}</span><span class="s1">shiftContext</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateContext</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">tracker</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">context</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))}</span><span class="s1">reduceContext</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateContext</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">tracker</span><span class="s0">.</span><span class="s1">reduce</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">context</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))}</span><span class="s1">emitContext</span><span class="s0">(){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]!=-</span><span class="s3">3</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">hash</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,-</span><span class="s3">3</span><span class="s0">)}</span><span class="s1">emitLookAhead</span><span class="s0">(){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]!=-</span><span class="s3">4</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,-</span><span class="s3">4</span><span class="s0">)}</span><span class="s1">updateContext</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">!=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">context</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">l</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">tracker</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">hash</span><span class="s0">!=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">hash</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">emitContext</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}}</span><span class="s1">setLookAhead</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">emitLookAhead</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}}</span><span class="s1">close</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">tracker</span><span class="s0">.</span><span class="s1">strict</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">emitContext</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">emitLookAhead</span><span class="s0">()}}</span><span class="s4">class </span><span class="s1">l</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tracker</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">context</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">hash</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">strict</span><span class="s0">?</span><span class="s1">t</span><span class="s0">.</span><span class="s1">hash</span><span class="s0">(</span><span class="s1">e</span><span class="s0">):</span><span class="s3">0</span><span class="s0">}}</span><span class="s4">class </span><span class="s1">a</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">base</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}</span><span class="s1">reduce</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&amp;</span><span class="s3">65535</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">&gt;&gt;</span><span class="s3">19</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">==</span><span class="s3">0</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s3">0</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">base</span><span class="s0">+=</span><span class="s3">3</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">base</span><span class="s0">-=(</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)*</span><span class="s3">3</span><span class="s0">}</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">getGoto</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">base</span><span class="s0">-</span><span class="s3">3</span><span class="s0">],</span><span class="s1">e</span><span class="s0">,</span><span class="s4">true</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">state</span><span class="s0">=</span><span class="s1">i</span><span class="s0">}}</span><span class="s4">class </span><span class="s1">h</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">==</span><span class="s3">0</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">maybeNext</span><span class="s0">()}</span><span class="s4">static </span><span class="s1">create</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bufferBase</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">return new </span><span class="s1">h</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">e</span><span class="s0">-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bufferBase</span><span class="s0">)}</span><span class="s1">maybeNext</span><span class="s0">(){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">parent</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">bufferBase</span><span class="s0">-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bufferBase</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">}}</span><span class="s1">get id</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">-</span><span class="s3">4</span><span class="s0">]}</span><span class="s1">get start</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">-</span><span class="s3">3</span><span class="s0">]}</span><span class="s1">get end</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">-</span><span class="s3">2</span><span class="s0">]}</span><span class="s1">get size</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]}</span><span class="s1">next</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">-=</span><span class="s3">4</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">-=</span><span class="s3">4</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">==</span><span class="s3">0</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">maybeNext</span><span class="s0">()}</span><span class="s1">fork</span><span class="s0">(){</span><span class="s4">return new </span><span class="s1">h</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">)}}</span><span class="s4">function </span><span class="s1">c</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s1">Uint16Array</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">typeof </span><span class="s1">t</span><span class="s0">!=</span><span class="s2">&quot;string&quot;</span><span class="s0">)</span><span class="s4">return </span><span class="s1">t</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;){</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;;){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s1">i</span><span class="s0">++),</span><span class="s1">s</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">==</span><span class="s3">126</span><span class="s0">){</span><span class="s1">o</span><span class="s0">=</span><span class="s3">65535</span><span class="s0">;</span><span class="s4">break</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">92</span><span class="s0">)</span><span class="s1">e</span><span class="s0">--;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">34</span><span class="s0">)</span><span class="s1">e</span><span class="s0">--;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">-</span><span class="s3">32</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s3">46</span><span class="s0">){</span><span class="s1">n</span><span class="s0">-=</span><span class="s3">46</span><span class="s0">;</span><span class="s1">s</span><span class="s0">=</span><span class="s4">true</span><span class="s0">}</span><span class="s1">o</span><span class="s0">+=</span><span class="s1">n</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s1">o</span><span class="s0">*=</span><span class="s3">46</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)</span><span class="s1">s</span><span class="s0">[</span><span class="s1">n</span><span class="s0">++]=</span><span class="s1">o</span><span class="s0">;</span><span class="s4">else </span><span class="s1">s</span><span class="s0">=</span><span class="s4">new </span><span class="s1">e</span><span class="s0">(</span><span class="s1">o</span><span class="s0">)}</span><span class="s4">return </span><span class="s1">s</span><span class="s0">}</span><span class="s4">class </span><span class="s1">f</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">end</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">mask</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">context</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}}</span><span class="s4">const </span><span class="s1">u</span><span class="s0">=</span><span class="s4">new </span><span class="s1">f</span><span class="s0">;</span><span class="s4">class </span><span class="s1">p</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">input</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkOff</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">next</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">=</span><span class="s1">u</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rangeIndex</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">from</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">end</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">].</span><span class="s1">to</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">readNext</span><span class="s0">()}</span><span class="s1">resolveOffset</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rangeIndex</span><span class="s0">;</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">+</span><span class="s1">t</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">from</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">[--</span><span class="s1">i</span><span class="s0">];</span><span class="s1">n</span><span class="s0">-=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">from</span><span class="s0">-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">to</span><span class="s0">;</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s4">while</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">to</span><span class="s0">:</span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">to</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">[++</span><span class="s1">i</span><span class="s0">];</span><span class="s1">n</span><span class="s0">+=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">from</span><span class="s0">-</span><span class="s1">s</span><span class="s0">.</span><span class="s1">to</span><span class="s0">;</span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s4">return </span><span class="s1">n</span><span class="s0">}</span><span class="s1">clipPos</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">from</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)</span><span class="s4">return </span><span class="s1">t</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">to</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return </span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">from</span><span class="s0">);</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">end</span><span class="s0">}</span><span class="s1">peek</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkOff</span><span class="s0">+</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">+</span><span class="s1">t</span><span class="s0">;</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">resolveOffset</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">1</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">==</span><span class="s4">null</span><span class="s0">)</span><span class="s4">return</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s1">s</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rangeIndex</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">to</span><span class="s0">&lt;=</span><span class="s1">s</span><span class="s0">)</span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">[++</span><span class="s1">t</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">input</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">=</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">to</span><span class="s0">-</span><span class="s1">s</span><span class="s0">);</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)}}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">=</span><span class="s1">s</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s1">acceptToken</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">resolveOffset</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">):</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">==</span><span class="s4">null</span><span class="s0">||</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">start</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">RangeError</span><span class="s0">(</span><span class="s2">&quot;Token end out of bounds&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">end</span><span class="s0">=</span><span class="s1">s</span><span class="s0">}</span><span class="s1">acceptTokenTo</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">end</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">getChunk</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">chunk</span><span class="s0">:</span><span class="s1">t</span><span class="s0">,</span><span class="s1">chunkPos</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}=</span><span class="s4">this</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkOff</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">input</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">);</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">to</span><span class="s0">?</span><span class="s1">t</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">to</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">):</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkOff</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}}</span><span class="s1">readNext</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkOff</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">getChunk</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkOff</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">next</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">next</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">.</span><span class="s1">charCodeAt</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkOff</span><span class="s0">)}</span><span class="s1">advance</span><span class="s0">(</span><span class="s1">t</span><span class="s0">=</span><span class="s3">1</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkOff</span><span class="s0">+=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">+</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">to</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rangeIndex</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">setDone</span><span class="s0">();</span><span class="s1">t</span><span class="s0">-=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">to</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">[++</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rangeIndex</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">from</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">+=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">readNext</span><span class="s0">()}</span><span class="s1">setDone</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">end</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rangeIndex</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">next</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">}</span><span class="s1">reset</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">=</span><span class="s1">t</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">=</span><span class="s1">u</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">!=</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">end</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">setDone</span><span class="s0">();</span><span class="s4">return this</span><span class="s0">}</span><span class="s4">while</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">from</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">[--</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rangeIndex</span><span class="s0">];</span><span class="s4">while</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">[++</span><span class="s4">this</span><span class="s0">.</span><span class="s1">rangeIndex</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkOff</span><span class="s0">=</span><span class="s1">t</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkOff</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">readNext</span><span class="s0">()}</span><span class="s4">return this</span><span class="s0">}</span><span class="s1">read</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">chunk</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">t</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">,</span><span class="s1">e</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunkPos</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">chunk2</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">(</span><span class="s1">t</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">,</span><span class="s1">e</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">chunk2Pos</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">from</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">range</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">input</span><span class="s0">.</span><span class="s1">read</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">from</span><span class="s0">&gt;=</span><span class="s1">e</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">to</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">)</span><span class="s1">s</span><span class="s0">+=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">input</span><span class="s0">.</span><span class="s1">read</span><span class="s0">(</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">from</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">to</span><span class="s0">,</span><span class="s1">e</span><span class="s0">))}</span><span class="s4">return </span><span class="s1">s</span><span class="s0">}}</span><span class="s4">class </span><span class="s1">d</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">id</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">token</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">parser</span><span class="s0">:</span><span class="s1">s</span><span class="s0">}=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">p</span><span class="s0">;</span><span class="s1">k</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">id</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">data</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">tokenPrecTable</span><span class="s0">)}}</span><span class="s1">d</span><span class="s0">.</span><span class="s1">prototype</span><span class="s0">.</span><span class="s1">contextual</span><span class="s0">=</span><span class="s1">d</span><span class="s0">.</span><span class="s1">prototype</span><span class="s0">.</span><span class="s1">fallback</span><span class="s0">=</span><span class="s1">d</span><span class="s0">.</span><span class="s1">prototype</span><span class="s0">.</span><span class="s1">extend</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">class </span><span class="s1">m</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">precTable</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">elseToken</span><span class="s0">=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">=</span><span class="s4">typeof </span><span class="s1">t</span><span class="s0">==</span><span class="s2">&quot;string&quot;</span><span class="s0">?</span><span class="s1">c</span><span class="s0">(</span><span class="s1">t</span><span class="s0">):</span><span class="s1">t</span><span class="s0">}</span><span class="s1">token</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;;){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">next</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">resolveOffset</span><span class="s0">(</span><span class="s3">1</span><span class="s0">,</span><span class="s3">1</span><span class="s0">);</span><span class="s1">k</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s3">0</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">precTable</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">value</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">elseToken</span><span class="s0">==</span><span class="s4">null</span><span class="s0">)</span><span class="s4">return</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">)</span><span class="s1">i</span><span class="s0">++;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">==</span><span class="s4">null</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">token</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">){</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">token</span><span class="s0">);</span><span class="s1">t</span><span class="s0">.</span><span class="s1">acceptToken</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">elseToken</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}}}</span><span class="s1">m</span><span class="s0">.</span><span class="s1">prototype</span><span class="s0">.</span><span class="s1">contextual</span><span class="s0">=</span><span class="s1">d</span><span class="s0">.</span><span class="s1">prototype</span><span class="s0">.</span><span class="s1">fallback</span><span class="s0">=</span><span class="s1">d</span><span class="s0">.</span><span class="s1">prototype</span><span class="s0">.</span><span class="s1">extend</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">class </span><span class="s1">g</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">={}){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">token</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">contextual</span><span class="s0">=!!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">contextual</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fallback</span><span class="s0">=!!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">fallback</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">extend</span><span class="s0">=!!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">extend</span><span class="s0">}}</span><span class="s4">function </span><span class="s1">k</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">){</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">l</span><span class="s0">=</span><span class="s3">1</span><span class="s0">&lt;&lt;</span><span class="s1">i</span><span class="s0">,{</span><span class="s1">dialect</span><span class="s0">:</span><span class="s1">a</span><span class="s0">}=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">;</span><span class="s1">t</span><span class="s0">:</span><span class="s4">for</span><span class="s0">(;;){</span><span class="s4">if</span><span class="s0">((</span><span class="s1">l</span><span class="s0">&amp;</span><span class="s1">t</span><span class="s0">[</span><span class="s1">r</span><span class="s0">])==</span><span class="s3">0</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">r</span><span class="s0">+</span><span class="s3">1</span><span class="s0">];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">f</span><span class="s0">=</span><span class="s1">r</span><span class="s0">+</span><span class="s3">3</span><span class="s0">;</span><span class="s1">f</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">;</span><span class="s1">f</span><span class="s0">+=</span><span class="s3">2</span><span class="s0">)</span><span class="s4">if</span><span class="s0">((</span><span class="s1">t</span><span class="s0">[</span><span class="s1">f</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]&amp;</span><span class="s1">l</span><span class="s0">)&gt;</span><span class="s3">0</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">f</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">.</span><span class="s1">allows</span><span class="s0">(</span><span class="s1">s</span><span class="s0">)&amp;&amp;(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">value</span><span class="s0">==-</span><span class="s3">1</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">value</span><span class="s0">==</span><span class="s1">s</span><span class="s0">||</span><span class="s1">x</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">token</span><span class="s0">.</span><span class="s1">value</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">o</span><span class="s0">))){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">acceptToken</span><span class="s0">(</span><span class="s1">s</span><span class="s0">);</span><span class="s4">break</span><span class="s0">}}</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">next</span><span class="s0">,</span><span class="s1">h</span><span class="s0">=</span><span class="s3">0</span><span class="s0">,</span><span class="s1">c</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">r</span><span class="s0">+</span><span class="s3">2</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">next</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">c</span><span class="s0">&gt;</span><span class="s1">h</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">+</span><span class="s1">c</span><span class="s0">*</span><span class="s3">3</span><span class="s0">-</span><span class="s3">3</span><span class="s0">]==</span><span class="s3">65535</span><span class="s0">){</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">s</span><span class="s0">+</span><span class="s1">c</span><span class="s0">*</span><span class="s3">3</span><span class="s0">-</span><span class="s3">1</span><span class="s0">];</span><span class="s4">continue </span><span class="s1">t</span><span class="s0">}</span><span class="s4">for</span><span class="s0">(;</span><span class="s1">h</span><span class="s0">&lt;</span><span class="s1">c</span><span class="s0">;){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">h</span><span class="s0">+</span><span class="s1">c</span><span class="s0">&gt;&gt;</span><span class="s3">1</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">s</span><span class="s0">+</span><span class="s1">n</span><span class="s0">+(</span><span class="s1">n</span><span class="s0">&lt;&lt;</span><span class="s3">1</span><span class="s0">);</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">o</span><span class="s0">],</span><span class="s1">a</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">o</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]||</span><span class="s3">65536</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">l</span><span class="s0">)</span><span class="s1">c</span><span class="s0">=</span><span class="s1">n</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">&gt;=</span><span class="s1">a</span><span class="s0">)</span><span class="s1">h</span><span class="s0">=</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;</span><span class="s4">else</span><span class="s0">{</span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">o</span><span class="s0">+</span><span class="s3">2</span><span class="s0">];</span><span class="s1">e</span><span class="s0">.</span><span class="s1">advance</span><span class="s0">();</span><span class="s4">continue </span><span class="s1">t</span><span class="s0">}}</span><span class="s4">break</span><span class="s0">}}</span><span class="s4">function </span><span class="s1">b</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">,</span><span class="s1">n</span><span class="s0">;(</span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">i</span><span class="s0">])!=</span><span class="s3">65535</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">==</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return </span><span class="s1">i</span><span class="s0">-</span><span class="s1">e</span><span class="s0">;</span><span class="s4">return</span><span class="s0">-</span><span class="s3">1</span><span class="s0">}</span><span class="s4">function </span><span class="s1">x</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">b</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return </span><span class="s1">n</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">||</span><span class="s1">b</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)&lt;</span><span class="s1">n</span><span class="s0">}</span><span class="s4">const </span><span class="s1">v</span><span class="s0">=</span><span class="s4">typeof </span><span class="s1">o</span><span class="s0">!=</span><span class="s2">&quot;undefined&quot;</span><span class="s0">&amp;&amp;</span><span class="s1">o</span><span class="s0">.</span><span class="s1">env</span><span class="s0">&amp;&amp;</span><span class="s5">/\bparse\b/</span><span class="s0">.</span><span class="s1">test</span><span class="s0">(</span><span class="s1">o</span><span class="s0">.</span><span class="s1">env</span><span class="s0">.</span><span class="s1">LOG</span><span class="s0">);</span><span class="s4">let </span><span class="s1">w</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">function </span><span class="s1">y</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">cursor</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">IterMode</span><span class="s0">.</span><span class="s1">IncludeAnonymous</span><span class="s0">);</span><span class="s1">n</span><span class="s0">.</span><span class="s1">moveTo</span><span class="s0">(</span><span class="s1">e</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(;;){</span><span class="s4">if</span><span class="s0">(!(</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s1">n</span><span class="s0">.</span><span class="s1">childBefore</span><span class="s0">(</span><span class="s1">e</span><span class="s0">):</span><span class="s1">n</span><span class="s0">.</span><span class="s1">childAfter</span><span class="s0">(</span><span class="s1">e</span><span class="s0">)))</span><span class="s4">for</span><span class="s0">(;;){</span><span class="s4">if</span><span class="s0">((</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s1">n</span><span class="s0">.</span><span class="s1">to</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">:</span><span class="s1">n</span><span class="s0">.</span><span class="s1">from</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">)&amp;&amp;!</span><span class="s1">n</span><span class="s0">.</span><span class="s1">type</span><span class="s0">.</span><span class="s1">isError</span><span class="s0">)</span><span class="s4">return </span><span class="s1">s</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">to</span><span class="s0">-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">-</span><span class="s3">25</span><span class="s0">)):</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">,</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">n</span><span class="s0">.</span><span class="s1">from</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,</span><span class="s1">e</span><span class="s0">+</span><span class="s3">25</span><span class="s0">));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s1">n</span><span class="s0">.</span><span class="s1">prevSibling</span><span class="s0">():</span><span class="s1">n</span><span class="s0">.</span><span class="s1">nextSibling</span><span class="s0">())</span><span class="s4">break</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">n</span><span class="s0">.</span><span class="s1">parent</span><span class="s0">())</span><span class="s4">return </span><span class="s1">s</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}}}</span><span class="s4">class </span><span class="s1">S</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fragments</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fragment</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">safeFrom</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">safeTo</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">trees</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nextFragment</span><span class="s0">()}</span><span class="s1">nextFragment</span><span class="s0">(){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fragment</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">i</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fragments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">?</span><span class="s4">null</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fragments</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">i</span><span class="s0">++];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">safeFrom</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">openStart</span><span class="s0">?</span><span class="s1">y</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">tree</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">from</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">offset</span><span class="s0">,</span><span class="s3">1</span><span class="s0">)-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">offset</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">from</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">safeTo</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">openEnd</span><span class="s0">?</span><span class="s1">y</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">tree</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">to</span><span class="s0">+</span><span class="s1">t</span><span class="s0">.</span><span class="s1">offset</span><span class="s0">,-</span><span class="s3">1</span><span class="s0">)-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">offset</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">to</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">trees</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">trees</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">()}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">trees</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">tree</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">offset</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s3">0</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nextStart</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">safeFrom</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nextStart</span><span class="s0">=</span><span class="s3">1e9</span><span class="s0">}}</span><span class="s1">nodeAt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nextStart</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fragment</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">safeTo</span><span class="s0">&lt;=</span><span class="s1">t</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nextFragment</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fragment</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;;){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">trees</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s3">0</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nextFragment</span><span class="s0">();</span><span class="s4">return null</span><span class="s0">}</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">trees</span><span class="s0">[</span><span class="s1">e</span><span class="s0">],</span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">[</span><span class="s1">e</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">==</span><span class="s1">s</span><span class="s0">.</span><span class="s1">children</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">trees</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">();</span><span class="s4">continue</span><span class="s0">}</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">children</span><span class="s0">[</span><span class="s1">n</span><span class="s0">];</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]+</span><span class="s1">s</span><span class="s0">.</span><span class="s1">positions</span><span class="s0">[</span><span class="s1">n</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nextStart</span><span class="s0">=</span><span class="s1">r</span><span class="s0">;</span><span class="s4">return null</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o </span><span class="s4">instanceof </span><span class="s1">i</span><span class="s0">.</span><span class="s1">Tree</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">==</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">safeFrom</span><span class="s0">)</span><span class="s4">return null</span><span class="s0">;</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">r</span><span class="s0">+</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">safeTo</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">prop</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">NodeProp</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">||</span><span class="s1">t</span><span class="s0">+</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fragment</span><span class="s0">.</span><span class="s1">to</span><span class="s0">)</span><span class="s4">return </span><span class="s1">o</span><span class="s0">}}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]++;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">+</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">safeFrom</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">trees</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">o</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">r</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s3">0</span><span class="s0">)}}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">index</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]++;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nextStart</span><span class="s0">=</span><span class="s1">r</span><span class="s0">+</span><span class="s1">o</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}}}}</span><span class="s4">class </span><span class="s1">C</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokens</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">mainToken</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">actions</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokens</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">tokenizers</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s4">new </span><span class="s1">f</span><span class="s0">))}</span><span class="s1">getActions</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">let</span><span class="s0">{</span><span class="s1">parser</span><span class="s0">:</span><span class="s1">i</span><span class="s0">}=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">p</span><span class="s0">,{</span><span class="s1">tokenizers</span><span class="s0">:</span><span class="s1">n</span><span class="s0">}=</span><span class="s1">i</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s3">3</span><span class="s0">);</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">?</span><span class="s1">t</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">hash</span><span class="s0">:</span><span class="s3">0</span><span class="s0">;</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">a</span><span class="s0">&lt;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">a</span><span class="s0">++){</span><span class="s4">if</span><span class="s0">((</span><span class="s3">1</span><span class="s0">&lt;&lt;</span><span class="s1">a</span><span class="s0">&amp;</span><span class="s1">o</span><span class="s0">)==</span><span class="s3">0</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">n</span><span class="s0">[</span><span class="s1">a</span><span class="s0">],</span><span class="s1">h</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokens</span><span class="s0">[</span><span class="s1">a</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&amp;&amp;!</span><span class="s1">i</span><span class="s0">.</span><span class="s1">fallback</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">contextual</span><span class="s0">||</span><span class="s1">h</span><span class="s0">.</span><span class="s1">start</span><span class="s0">!=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">||</span><span class="s1">h</span><span class="s0">.</span><span class="s1">mask</span><span class="s0">!=</span><span class="s1">o</span><span class="s0">||</span><span class="s1">h</span><span class="s0">.</span><span class="s1">context</span><span class="s0">!=</span><span class="s1">r</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">updateCachedToken</span><span class="s0">(</span><span class="s1">h</span><span class="s0">,</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">);</span><span class="s1">h</span><span class="s0">.</span><span class="s1">mask</span><span class="s0">=</span><span class="s1">o</span><span class="s0">;</span><span class="s1">h</span><span class="s0">.</span><span class="s1">context</span><span class="s0">=</span><span class="s1">r</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">&gt;</span><span class="s1">h</span><span class="s0">.</span><span class="s1">end</span><span class="s0">+</span><span class="s3">25</span><span class="s0">)</span><span class="s1">l</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">max</span><span class="s0">(</span><span class="s1">h</span><span class="s0">.</span><span class="s1">lookAhead</span><span class="s0">,</span><span class="s1">l</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">.</span><span class="s1">value</span><span class="s0">!=</span><span class="s3">0</span><span class="s0">){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">)</span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">addActions</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">end</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">addActions</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">value</span><span class="s0">,</span><span class="s1">h</span><span class="s0">.</span><span class="s1">end</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">.</span><span class="s1">extend</span><span class="s0">){</span><span class="s1">s</span><span class="s0">=</span><span class="s1">h</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&gt;</span><span class="s1">n</span><span class="s0">)</span><span class="s4">break</span><span class="s0">}}}</span><span class="s4">while</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">actions</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">actions</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">setLookAhead</span><span class="s0">(</span><span class="s1">l</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">==</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">end</span><span class="s0">){</span><span class="s1">s</span><span class="s0">=</span><span class="s4">new </span><span class="s1">f</span><span class="s0">;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">eofTerm</span><span class="s0">;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">start</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">end</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">;</span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">addActions</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">value</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">end</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">mainToken</span><span class="s0">=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">actions</span><span class="s0">}</span><span class="s1">getMainToken</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">mainToken</span><span class="s0">)</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">mainToken</span><span class="s0">;</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">f</span><span class="s0">,{</span><span class="s1">pos</span><span class="s0">:</span><span class="s1">s</span><span class="s0">,</span><span class="s1">p</span><span class="s0">:</span><span class="s1">i</span><span class="s0">}=</span><span class="s1">t</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">start</span><span class="s0">=</span><span class="s1">s</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">end</span><span class="s0">=</span><span class="s1">Math</span><span class="s0">.</span><span class="s1">min</span><span class="s0">(</span><span class="s1">s</span><span class="s0">+</span><span class="s3">1</span><span class="s0">,</span><span class="s1">i</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">end</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s1">s</span><span class="s0">==</span><span class="s1">i</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">end</span><span class="s0">?</span><span class="s1">i</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">eofTerm</span><span class="s0">:</span><span class="s3">0</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">}</span><span class="s1">updateCachedToken</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">clipPos</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">token</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">reset</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">),</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">value</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">parser</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">p</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">specialized</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">specialized</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">value</span><span class="s0">){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">specializers</span><span class="s0">[</span><span class="s1">i</span><span class="s0">](</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">read</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">start</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">end</span><span class="s0">),</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">dialect</span><span class="s0">.</span><span class="s1">allows</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&gt;&gt;</span><span class="s3">1</span><span class="s0">)){</span><span class="s4">if</span><span class="s0">((</span><span class="s1">n</span><span class="s0">&amp;</span><span class="s3">1</span><span class="s0">)==</span><span class="s3">0</span><span class="s0">)</span><span class="s1">t</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&gt;&gt;</span><span class="s3">1</span><span class="s0">;</span><span class="s4">else </span><span class="s1">t</span><span class="s0">.</span><span class="s1">extended</span><span class="s0">=</span><span class="s1">n</span><span class="s0">&gt;&gt;</span><span class="s3">1</span><span class="s0">;</span><span class="s4">break</span><span class="s0">}}}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">t</span><span class="s0">.</span><span class="s1">value</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">end</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">clipPos</span><span class="s0">(</span><span class="s1">i</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)}}</span><span class="s1">putAction</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s1">i</span><span class="s0">;</span><span class="s1">n</span><span class="s0">+=</span><span class="s3">3</span><span class="s0">)</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">actions</span><span class="s0">[</span><span class="s1">n</span><span class="s0">]==</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return </span><span class="s1">i</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">actions</span><span class="s0">[</span><span class="s1">i</span><span class="s0">++]=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">actions</span><span class="s0">[</span><span class="s1">i</span><span class="s0">++]=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">actions</span><span class="s0">[</span><span class="s1">i</span><span class="s0">++]=</span><span class="s1">s</span><span class="s0">;</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s1">addActions</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let</span><span class="s0">{</span><span class="s1">state</span><span class="s0">:</span><span class="s1">n</span><span class="s0">}=</span><span class="s1">t</span><span class="s0">,{</span><span class="s1">parser</span><span class="s0">:</span><span class="s1">o</span><span class="s0">}=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">p</span><span class="s0">,{</span><span class="s1">data</span><span class="s0">:</span><span class="s1">r</span><span class="s0">}=</span><span class="s1">o</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">l</span><span class="s0">&lt;</span><span class="s3">2</span><span class="s0">;</span><span class="s1">l</span><span class="s0">++){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s1">n</span><span class="s0">,</span><span class="s1">l</span><span class="s0">?</span><span class="s3">2</span><span class="s0">:</span><span class="s3">1</span><span class="s0">);;</span><span class="s1">t</span><span class="s0">+=</span><span class="s3">3</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]==</span><span class="s3">65535</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">[</span><span class="s1">t</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]==</span><span class="s3">1</span><span class="s0">){</span><span class="s1">t</span><span class="s0">=</span><span class="s1">D</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">+</span><span class="s3">2</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">==</span><span class="s3">0</span><span class="s0">&amp;&amp;</span><span class="s1">r</span><span class="s0">[</span><span class="s1">t</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]==</span><span class="s3">2</span><span class="s0">)</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">putAction</span><span class="s0">(</span><span class="s1">D</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">+</span><span class="s3">2</span><span class="s0">),</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">break</span><span class="s0">}}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]==</span><span class="s1">e</span><span class="s0">)</span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">putAction</span><span class="s0">(</span><span class="s1">D</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">+</span><span class="s3">1</span><span class="s0">),</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}}</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}}</span><span class="s4">class </span><span class="s1">P</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">input</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">=</span><span class="s1">i</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">recovering</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nextStackID</span><span class="s0">=</span><span class="s3">9812</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">minStackPos</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reused</span><span class="s0">=[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stoppedAt</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lastBigReductionStart</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lastBigReductionSize</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bigReductionCount</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">=</span><span class="s4">new </span><span class="s1">p</span><span class="s0">(</span><span class="s1">e</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokens</span><span class="s0">=</span><span class="s4">new </span><span class="s1">C</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">topTerm</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">top</span><span class="s0">[</span><span class="s3">1</span><span class="s0">];</span><span class="s4">let</span><span class="s0">{</span><span class="s1">from</span><span class="s0">:</span><span class="s1">n</span><span class="s0">}=</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stacks</span><span class="s0">=[</span><span class="s1">r</span><span class="s0">.</span><span class="s1">start</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">top</span><span class="s0">[</span><span class="s3">0</span><span class="s0">],</span><span class="s1">n</span><span class="s0">)];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fragments</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">end</span><span class="s0">-</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bufferLength</span><span class="s0">*</span><span class="s3">4</span><span class="s0">?</span><span class="s4">new </span><span class="s1">S</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">):</span><span class="s4">null</span><span class="s0">}</span><span class="s1">get parsedPos</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">minStackPos</span><span class="s0">}</span><span class="s1">advance</span><span class="s0">(){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stacks</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">minStackPos</span><span class="s0">;</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stacks</span><span class="s0">=[];</span><span class="s4">let </span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bigReductionCount</span><span class="s0">&gt;</span><span class="s3">300</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">==</span><span class="s3">1</span><span class="s0">){</span><span class="s4">let</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">forceReduce</span><span class="s0">()&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">[</span><span class="s1">e</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">2</span><span class="s0">]&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lastBigReductionStart</span><span class="s0">){}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bigReductionCount</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">lastBigReductionSize</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">o</span><span class="s0">++){</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">o</span><span class="s0">];</span><span class="s4">for</span><span class="s0">(;;){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokens</span><span class="s0">.</span><span class="s1">mainToken</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">){</span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)}</span><span class="s4">else if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">advanceStack</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)){</span><span class="s4">continue</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">){</span><span class="s1">i</span><span class="s0">=[];</span><span class="s1">n</span><span class="s0">=[]}</span><span class="s1">i</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">r</span><span class="s0">);</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokens</span><span class="s0">.</span><span class="s1">getMainToken</span><span class="s0">(</span><span class="s1">r</span><span class="s0">);</span><span class="s1">n</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">value</span><span class="s0">,</span><span class="s1">t</span><span class="s0">.</span><span class="s1">end</span><span class="s0">)}</span><span class="s4">break</span><span class="s0">}}</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">i</span><span class="s0">&amp;&amp;</span><span class="s1">E</span><span class="s0">(</span><span class="s1">i</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">v</span><span class="s0">)</span><span class="s1">console</span><span class="s0">.</span><span class="s1">log</span><span class="s0">(</span><span class="s2">&quot;Finish with &quot;</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">t</span><span class="s0">));</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">stackToTree</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">strict</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">v</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">)</span><span class="s1">console</span><span class="s0">.</span><span class="s1">log</span><span class="s0">(</span><span class="s2">&quot;Stuck with token &quot;</span><span class="s0">+(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokens</span><span class="s0">.</span><span class="s1">mainToken</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">getName</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokens</span><span class="s0">.</span><span class="s1">mainToken</span><span class="s0">.</span><span class="s1">value</span><span class="s0">):</span><span class="s2">&quot;none&quot;</span><span class="s0">));</span><span class="s4">throw new </span><span class="s1">SyntaxError</span><span class="s0">(</span><span class="s2">&quot;No parse at &quot;</span><span class="s0">+</span><span class="s1">e</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">recovering</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">recovering</span><span class="s0">=</span><span class="s3">5</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">recovering</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stoppedAt</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">pos</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stoppedAt</span><span class="s0">?</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">runRecovery</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">n</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">v</span><span class="s0">)</span><span class="s1">console</span><span class="s0">.</span><span class="s1">log</span><span class="s0">(</span><span class="s2">&quot;Force-finish &quot;</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">t</span><span class="s0">));</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">stackToTree</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">forceAll</span><span class="s0">())}}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">recovering</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">recovering</span><span class="s0">==</span><span class="s3">1</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">recovering</span><span class="s0">*</span><span class="s3">3</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">){</span><span class="s1">s</span><span class="s0">.</span><span class="s1">sort</span><span class="s0">(((</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">)=&gt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">score</span><span class="s0">-</span><span class="s1">t</span><span class="s0">.</span><span class="s1">score</span><span class="s0">));</span><span class="s4">while</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">)</span><span class="s1">s</span><span class="s0">.</span><span class="s1">pop</span><span class="s0">()}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">some</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reducePos</span><span class="s0">&gt;</span><span class="s1">e</span><span class="s0">)))</span><span class="s4">this</span><span class="s0">.</span><span class="s1">recovering</span><span class="s0">--}</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">){</span><span class="s1">t</span><span class="s0">:</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">s</span><span class="s0">[</span><span class="s1">t</span><span class="s0">];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">t</span><span class="s0">+</span><span class="s3">1</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">s</span><span class="s0">[</span><span class="s1">i</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">sameState</span><span class="s0">(</span><span class="s1">n</span><span class="s0">)||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">500</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">500</span><span class="s0">){</span><span class="s4">if</span><span class="s0">((</span><span class="s1">e</span><span class="s0">.</span><span class="s1">score</span><span class="s0">-</span><span class="s1">n</span><span class="s0">.</span><span class="s1">score</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s1">n</span><span class="s0">.</span><span class="s1">buffer</span><span class="s0">.</span><span class="s1">length</span><span class="s0">)&gt;</span><span class="s3">0</span><span class="s0">){</span><span class="s1">s</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">i</span><span class="s0">--,</span><span class="s3">1</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">s</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s1">t</span><span class="s0">--,</span><span class="s3">1</span><span class="s0">);</span><span class="s4">continue </span><span class="s1">t</span><span class="s0">}}}}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">12</span><span class="s0">)</span><span class="s1">s</span><span class="s0">.</span><span class="s1">splice</span><span class="s0">(</span><span class="s3">12</span><span class="s0">,</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">12</span><span class="s0">)}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">minStackPos</span><span class="s0">=</span><span class="s1">s</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">pos</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">o</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">[</span><span class="s1">o</span><span class="s0">].</span><span class="s1">pos</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">minStackPos</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">minStackPos</span><span class="s0">=</span><span class="s1">s</span><span class="s0">[</span><span class="s1">o</span><span class="s0">].</span><span class="s1">pos</span><span class="s0">;</span><span class="s4">return null</span><span class="s0">}</span><span class="s1">stopAt</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stoppedAt</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stoppedAt</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">RangeError</span><span class="s0">(</span><span class="s2">&quot;Can't move stoppedAt forward&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stoppedAt</span><span class="s0">=</span><span class="s1">t</span><span class="s0">}</span><span class="s1">advanceStack</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,{</span><span class="s1">parser</span><span class="s0">:</span><span class="s1">o</span><span class="s0">}=</span><span class="s4">this</span><span class="s0">;</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">v</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)+</span><span class="s2">&quot; -&gt; &quot;</span><span class="s0">:</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stoppedAt</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stoppedAt</span><span class="s0">)</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">forceReduce</span><span class="s0">()?</span><span class="s1">t</span><span class="s0">:</span><span class="s4">null</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fragments</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">tracker</span><span class="s0">.</span><span class="s1">strict</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">?</span><span class="s1">t</span><span class="s0">.</span><span class="s1">curContext</span><span class="s0">.</span><span class="s1">hash</span><span class="s0">:</span><span class="s3">0</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fragments</span><span class="s0">.</span><span class="s1">nodeAt</span><span class="s0">(</span><span class="s1">n</span><span class="s0">);</span><span class="s1">l</span><span class="s0">;){</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">.</span><span class="s1">types</span><span class="s0">[</span><span class="s1">l</span><span class="s0">.</span><span class="s1">type</span><span class="s0">.</span><span class="s1">id</span><span class="s0">]==</span><span class="s1">l</span><span class="s0">.</span><span class="s1">type</span><span class="s0">?</span><span class="s1">o</span><span class="s0">.</span><span class="s1">getGoto</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s1">l</span><span class="s0">.</span><span class="s1">type</span><span class="s0">.</span><span class="s1">id</span><span class="s0">):-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">&gt;-</span><span class="s3">1</span><span class="s0">&amp;&amp;</span><span class="s1">l</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&amp;&amp;(!</span><span class="s1">e</span><span class="s0">||(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">prop</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">NodeProp</span><span class="s0">.</span><span class="s1">contextHash</span><span class="s0">)||</span><span class="s3">0</span><span class="s0">)==</span><span class="s1">s</span><span class="s0">)){</span><span class="s1">t</span><span class="s0">.</span><span class="s1">useNode</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,</span><span class="s1">n</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">v</span><span class="s0">)</span><span class="s1">console</span><span class="s0">.</span><span class="s1">log</span><span class="s0">(</span><span class="s1">r</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)+</span><span class="s2">` (via reuse of </span><span class="s1">$</span><span class="s0">{</span><span class="s1">o</span><span class="s0">.</span><span class="s1">getName</span><span class="s0">(</span><span class="s1">l</span><span class="s0">.</span><span class="s1">type</span><span class="s0">.</span><span class="s1">id</span><span class="s0">)}</span><span class="s2">)`</span><span class="s0">);</span><span class="s4">return true</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(!(</span><span class="s1">l </span><span class="s4">instanceof </span><span class="s1">i</span><span class="s0">.</span><span class="s1">Tree</span><span class="s0">)||</span><span class="s1">l</span><span class="s0">.</span><span class="s1">children</span><span class="s0">.</span><span class="s1">length</span><span class="s0">==</span><span class="s3">0</span><span class="s0">||</span><span class="s1">l</span><span class="s0">.</span><span class="s1">positions</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]&gt;</span><span class="s3">0</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s1">l</span><span class="s0">.</span><span class="s1">children</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a </span><span class="s4">instanceof </span><span class="s1">i</span><span class="s0">.</span><span class="s1">Tree</span><span class="s0">&amp;&amp;</span><span class="s1">l</span><span class="s0">.</span><span class="s1">positions</span><span class="s0">[</span><span class="s3">0</span><span class="s0">]==</span><span class="s3">0</span><span class="s0">)</span><span class="s1">l</span><span class="s0">=</span><span class="s1">a</span><span class="s0">;</span><span class="s4">else break</span><span class="s0">}}</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">o</span><span class="s0">.</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s3">4</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">l</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">){</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reduce</span><span class="s0">(</span><span class="s1">l</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">v</span><span class="s0">)</span><span class="s1">console</span><span class="s0">.</span><span class="s1">log</span><span class="s0">(</span><span class="s1">r</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)+</span><span class="s2">` (via always-reduce </span><span class="s1">$</span><span class="s0">{</span><span class="s1">o</span><span class="s0">.</span><span class="s1">getName</span><span class="s0">(</span><span class="s1">l</span><span class="s0">&amp;</span><span class="s3">65535</span><span class="s0">)}</span><span class="s2">)`</span><span class="s0">);</span><span class="s4">return true</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;=</span><span class="s3">8400</span><span class="s0">){</span><span class="s4">while</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">stack</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">6e3</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">forceReduce</span><span class="s0">()){}}</span><span class="s4">let </span><span class="s1">a</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokens</span><span class="s0">.</span><span class="s1">getActions</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">a</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;){</span><span class="s4">let </span><span class="s1">l</span><span class="s0">=</span><span class="s1">a</span><span class="s0">[</span><span class="s1">i</span><span class="s0">++],</span><span class="s1">h</span><span class="s0">=</span><span class="s1">a</span><span class="s0">[</span><span class="s1">i</span><span class="s0">++],</span><span class="s1">c</span><span class="s0">=</span><span class="s1">a</span><span class="s0">[</span><span class="s1">i</span><span class="s0">++];</span><span class="s4">let </span><span class="s1">f</span><span class="s0">=</span><span class="s1">i</span><span class="s0">==</span><span class="s1">a</span><span class="s0">.</span><span class="s1">length</span><span class="s0">||!</span><span class="s1">s</span><span class="s0">;</span><span class="s4">let </span><span class="s1">u</span><span class="s0">=</span><span class="s1">f</span><span class="s0">?</span><span class="s1">t</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">split</span><span class="s0">();</span><span class="s4">let </span><span class="s1">p</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokens</span><span class="s0">.</span><span class="s1">mainToken</span><span class="s0">;</span><span class="s1">u</span><span class="s0">.</span><span class="s1">apply</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,</span><span class="s1">h</span><span class="s0">,</span><span class="s1">p</span><span class="s0">?</span><span class="s1">p</span><span class="s0">.</span><span class="s1">start</span><span class="s0">:</span><span class="s1">u</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">,</span><span class="s1">c</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">v</span><span class="s0">)</span><span class="s1">console</span><span class="s0">.</span><span class="s1">log</span><span class="s0">(</span><span class="s1">r</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">u</span><span class="s0">)+</span><span class="s2">` (via </span><span class="s1">$</span><span class="s0">{(</span><span class="s1">l</span><span class="s0">&amp;</span><span class="s3">65536</span><span class="s0">)==</span><span class="s3">0</span><span class="s0">?</span><span class="s2">&quot;shift&quot;</span><span class="s0">:</span><span class="s2">`reduce of </span><span class="s1">$</span><span class="s0">{</span><span class="s1">o</span><span class="s0">.</span><span class="s1">getName</span><span class="s0">(</span><span class="s1">l</span><span class="s0">&amp;</span><span class="s3">65535</span><span class="s0">)}</span><span class="s2">`</span><span class="s0">} </span><span class="s2">for </span><span class="s1">$</span><span class="s0">{</span><span class="s1">o</span><span class="s0">.</span><span class="s1">getName</span><span class="s0">(</span><span class="s1">h</span><span class="s0">)} </span><span class="s2">@ </span><span class="s1">$</span><span class="s0">{</span><span class="s1">n</span><span class="s0">}</span><span class="s1">$</span><span class="s0">{</span><span class="s1">u</span><span class="s0">==</span><span class="s1">t</span><span class="s0">?</span><span class="s2">&quot;&quot;</span><span class="s0">:</span><span class="s2">&quot;, split&quot;</span><span class="s0">}</span><span class="s2">)`</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">f</span><span class="s0">)</span><span class="s4">return true</span><span class="s0">;</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">u</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">&gt;</span><span class="s1">n</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">u</span><span class="s0">);</span><span class="s4">else </span><span class="s1">s</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">u</span><span class="s0">)}</span><span class="s4">return false</span><span class="s0">}</span><span class="s1">advanceFully</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(;;){</span><span class="s4">if</span><span class="s0">(!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">advanceStack</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s4">null</span><span class="s0">,</span><span class="s4">null</span><span class="s0">))</span><span class="s4">return false</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">&gt;</span><span class="s1">s</span><span class="s0">){</span><span class="s1">T</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">);</span><span class="s4">return true</span><span class="s0">}}}</span><span class="s1">runRecovery</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">null</span><span class="s0">,</span><span class="s1">n</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">o</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">o</span><span class="s0">++){</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">t</span><span class="s0">[</span><span class="s1">o</span><span class="s0">],</span><span class="s1">l</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">o</span><span class="s0">&lt;&lt;</span><span class="s3">1</span><span class="s0">],</span><span class="s1">a</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[(</span><span class="s1">o</span><span class="s0">&lt;&lt;</span><span class="s3">1</span><span class="s0">)+</span><span class="s3">1</span><span class="s0">];</span><span class="s4">let </span><span class="s1">h</span><span class="s0">=</span><span class="s1">v</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)+</span><span class="s2">&quot; -&gt; &quot;</span><span class="s0">:</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">r</span><span class="s0">.</span><span class="s1">deadEnd</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">n</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">;</span><span class="s1">n</span><span class="s0">=</span><span class="s4">true</span><span class="s0">;</span><span class="s1">r</span><span class="s0">.</span><span class="s1">restart</span><span class="s0">();</span><span class="s4">if</span><span class="s0">(</span><span class="s1">v</span><span class="s0">)</span><span class="s1">console</span><span class="s0">.</span><span class="s1">log</span><span class="s0">(</span><span class="s1">h</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)+</span><span class="s2">&quot; (restarted)&quot;</span><span class="s0">);</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">advanceFully</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)</span><span class="s4">continue</span><span class="s0">}</span><span class="s4">let </span><span class="s1">c</span><span class="s0">=</span><span class="s1">r</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(),</span><span class="s1">f</span><span class="s0">=</span><span class="s1">h</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">c</span><span class="s0">.</span><span class="s1">forceReduce</span><span class="s0">()&amp;&amp;</span><span class="s1">t</span><span class="s0">&lt;</span><span class="s3">10</span><span class="s0">;</span><span class="s1">t</span><span class="s0">++){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">v</span><span class="s0">)</span><span class="s1">console</span><span class="s0">.</span><span class="s1">log</span><span class="s0">(</span><span class="s1">f</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">c</span><span class="s0">)+</span><span class="s2">&quot; (via force-reduce)&quot;</span><span class="s0">);</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">advanceFully</span><span class="s0">(</span><span class="s1">c</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)</span><span class="s4">break</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">v</span><span class="s0">)</span><span class="s1">f</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">c</span><span class="s0">)+</span><span class="s2">&quot; -&gt; &quot;</span><span class="s0">}</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t of r</span><span class="s0">.</span><span class="s1">recoverByInsert</span><span class="s0">(</span><span class="s1">l</span><span class="s0">)){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">v</span><span class="s0">)</span><span class="s1">console</span><span class="s0">.</span><span class="s1">log</span><span class="s0">(</span><span class="s1">h</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)+</span><span class="s2">&quot; (via recover-insert)&quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">advanceFully</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">end</span><span class="s0">&gt;</span><span class="s1">r</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">==</span><span class="s1">r</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">){</span><span class="s1">a</span><span class="s0">++;</span><span class="s1">l</span><span class="s0">=</span><span class="s3">0</span><span class="s0">}</span><span class="s1">r</span><span class="s0">.</span><span class="s1">recoverByDelete</span><span class="s0">(</span><span class="s1">l</span><span class="s0">,</span><span class="s1">a</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">v</span><span class="s0">)</span><span class="s1">console</span><span class="s0">.</span><span class="s1">log</span><span class="s0">(</span><span class="s1">h</span><span class="s0">+</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">r</span><span class="s0">)+</span><span class="s2">` (via recover-delete </span><span class="s1">$</span><span class="s0">{</span><span class="s4">this</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">getName</span><span class="s0">(</span><span class="s1">l</span><span class="s0">)}</span><span class="s2">)`</span><span class="s0">);</span><span class="s1">T</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)}</span><span class="s4">else if</span><span class="s0">(!</span><span class="s1">i</span><span class="s0">||</span><span class="s1">i</span><span class="s0">.</span><span class="s1">score</span><span class="s0">&lt;</span><span class="s1">r</span><span class="s0">.</span><span class="s1">score</span><span class="s0">){</span><span class="s1">i</span><span class="s0">=</span><span class="s1">r</span><span class="s0">}}</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s1">stackToTree</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s1">t</span><span class="s0">.</span><span class="s1">close</span><span class="s0">();</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">Tree</span><span class="s0">.</span><span class="s1">build</span><span class="s0">({</span><span class="s1">buffer</span><span class="s0">:</span><span class="s1">h</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s1">t</span><span class="s0">),</span><span class="s1">nodeSet</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">,</span><span class="s1">topID</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">topTerm</span><span class="s0">,</span><span class="s1">maxBufferLength</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">bufferLength</span><span class="s0">,</span><span class="s1">reused</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reused</span><span class="s0">,</span><span class="s1">start</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">from</span><span class="s0">,</span><span class="s1">length</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">-</span><span class="s4">this</span><span class="s0">.</span><span class="s1">ranges</span><span class="s0">[</span><span class="s3">0</span><span class="s0">].</span><span class="s1">from</span><span class="s0">,</span><span class="s1">minRepeatType</span><span class="s0">:</span><span class="s4">this</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">minRepeatTerm</span><span class="s0">})}</span><span class="s1">stackID</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=(</span><span class="s1">w</span><span class="s0">||(</span><span class="s1">w</span><span class="s0">=</span><span class="s4">new </span><span class="s1">WeakMap</span><span class="s0">)).</span><span class="s1">get</span><span class="s0">(</span><span class="s1">t</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">)</span><span class="s1">w</span><span class="s0">.</span><span class="s1">set</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">=</span><span class="s1">String</span><span class="s0">.</span><span class="s1">fromCodePoint</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nextStackID</span><span class="s0">++));</span><span class="s4">return </span><span class="s1">e</span><span class="s0">+</span><span class="s1">t</span><span class="s0">}}</span><span class="s4">function </span><span class="s1">T</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">==</span><span class="s1">t</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">&amp;&amp;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">sameState</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">].</span><span class="s1">score</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">score</span><span class="s0">)</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">return</span><span class="s0">}}</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">class </span><span class="s1">A</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">source</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">flags</span><span class="s0">=</span><span class="s1">e</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">=</span><span class="s1">s</span><span class="s0">}</span><span class="s1">allows</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return</span><span class="s0">!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">||</span><span class="s4">this</span><span class="s0">.</span><span class="s1">disabled</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]==</span><span class="s3">0</span><span class="s0">}}</span><span class="s4">const </span><span class="s1">I</span><span class="s0">=</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">;</span><span class="s4">class </span><span class="s1">O</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">start</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">start</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">shift</span><span class="s0">||</span><span class="s1">I</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reduce</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reduce</span><span class="s0">||</span><span class="s1">I</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">reuse</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">reuse</span><span class="s0">||</span><span class="s1">I</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">hash</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">hash</span><span class="s0">||(()=&gt;</span><span class="s3">0</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">strict</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">strict</span><span class="s0">!==</span><span class="s4">false</span><span class="s0">}}</span><span class="s4">class </span><span class="s1">R </span><span class="s4">extends </span><span class="s1">i</span><span class="s0">.</span><span class="s1">Parser</span><span class="s0">{</span><span class="s1">constructor</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">super</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">wrappers</span><span class="s0">=[];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">version</span><span class="s0">!=</span><span class="s3">14</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">RangeError</span><span class="s0">(</span><span class="s2">`Parser version (</span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">.</span><span class="s1">version</span><span class="s0">}</span><span class="s2">) doesn't match runtime version (</span><span class="s1">$</span><span class="s0">{</span><span class="s3">14</span><span class="s0">}</span><span class="s2">)`</span><span class="s0">);</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">nodeNames</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s2">&quot; &quot;</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">minRepeatTerm</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">repeatNodeCount</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s2">&quot;&quot;</span><span class="s0">);</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">keys</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">topRules</span><span class="s0">).</span><span class="s1">map</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">topRules</span><span class="s0">[</span><span class="s1">e</span><span class="s0">][</span><span class="s3">1</span><span class="s0">]));</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++)</span><span class="s1">n</span><span class="s0">.</span><span class="s1">push</span><span class="s0">([]);</span><span class="s4">function </span><span class="s1">o</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s1">n</span><span class="s0">[</span><span class="s1">t</span><span class="s0">].</span><span class="s1">push</span><span class="s0">([</span><span class="s1">e</span><span class="s0">,</span><span class="s1">e</span><span class="s0">.</span><span class="s1">deserialize</span><span class="s0">(</span><span class="s1">String</span><span class="s0">(</span><span class="s1">s</span><span class="s0">))])}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">nodeProps</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">l of t</span><span class="s0">.</span><span class="s1">nodeProps</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">l</span><span class="s0">[</span><span class="s3">0</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(</span><span class="s4">typeof </span><span class="s1">t</span><span class="s0">==</span><span class="s2">&quot;string&quot;</span><span class="s0">)</span><span class="s1">t</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">NodeProp</span><span class="s0">[</span><span class="s1">t</span><span class="s0">];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s1">e</span><span class="s0">&lt;</span><span class="s1">l</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">l</span><span class="s0">[</span><span class="s1">e</span><span class="s0">++];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">){</span><span class="s1">o</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">l</span><span class="s0">[</span><span class="s1">e</span><span class="s0">++])}</span><span class="s4">else</span><span class="s0">{</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">l</span><span class="s0">[</span><span class="s1">e</span><span class="s0">+-</span><span class="s1">s</span><span class="s0">];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=-</span><span class="s1">s</span><span class="s0">;</span><span class="s1">n</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">;</span><span class="s1">n</span><span class="s0">--)</span><span class="s1">o</span><span class="s0">(</span><span class="s1">l</span><span class="s0">[</span><span class="s1">e</span><span class="s0">++],</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">);</span><span class="s1">e</span><span class="s0">++}}}</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">=</span><span class="s4">new </span><span class="s1">i</span><span class="s0">.</span><span class="s1">NodeSet</span><span class="s0">(</span><span class="s1">e</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">o</span><span class="s0">)=&gt;</span><span class="s1">i</span><span class="s0">.</span><span class="s1">NodeType</span><span class="s0">.</span><span class="s1">define</span><span class="s0">({</span><span class="s1">name</span><span class="s0">:</span><span class="s1">o</span><span class="s0">&gt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">minRepeatTerm</span><span class="s0">?</span><span class="s1">undefined</span><span class="s0">:</span><span class="s1">e</span><span class="s0">,</span><span class="s1">id</span><span class="s0">:</span><span class="s1">o</span><span class="s0">,</span><span class="s1">props</span><span class="s0">:</span><span class="s1">n</span><span class="s0">[</span><span class="s1">o</span><span class="s0">],</span><span class="s1">top</span><span class="s0">:</span><span class="s1">s</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">o</span><span class="s0">)&gt;-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">error</span><span class="s0">:</span><span class="s1">o</span><span class="s0">==</span><span class="s3">0</span><span class="s0">,</span><span class="s1">skipped</span><span class="s0">:</span><span class="s1">t</span><span class="s0">.</span><span class="s1">skippedNodes</span><span class="s0">&amp;&amp;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">skippedNodes</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">o</span><span class="s0">)&gt;-</span><span class="s3">1</span><span class="s0">}))));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">propSources</span><span class="s0">)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">.</span><span class="s1">extend</span><span class="s0">(</span><span class="s1">...t</span><span class="s0">.</span><span class="s1">propSources</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">strict</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">bufferLength</span><span class="s0">=</span><span class="s1">i</span><span class="s0">.</span><span class="s1">DefaultBufferLength</span><span class="s0">;</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">c</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">tokenData</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">context</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">context</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">specializerSpecs</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">specialized</span><span class="s0">||[];</span><span class="s4">this</span><span class="s0">.</span><span class="s1">specialized</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint16Array</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">specializerSpecs</span><span class="s0">.</span><span class="s1">length</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">specializerSpecs</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++)</span><span class="s4">this</span><span class="s0">.</span><span class="s1">specialized</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">specializerSpecs</span><span class="s0">[</span><span class="s1">i</span><span class="s0">].</span><span class="s1">term</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">specializers</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">specializerSpecs</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(</span><span class="s1">N</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">states</span><span class="s0">=</span><span class="s1">c</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">states</span><span class="s0">,</span><span class="s1">Uint32Array</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">=</span><span class="s1">c</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">stateData</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">goto</span><span class="s0">=</span><span class="s1">c</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">goto</span><span class="s0">);</span><span class="s4">this</span><span class="s0">.</span><span class="s1">maxTerm</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">maxTerm</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokenizers</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">tokenizers</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s4">typeof </span><span class="s1">t</span><span class="s0">==</span><span class="s2">&quot;number&quot;</span><span class="s0">?</span><span class="s4">new </span><span class="s1">d</span><span class="s0">(</span><span class="s1">r</span><span class="s0">,</span><span class="s1">t</span><span class="s0">):</span><span class="s1">t</span><span class="s0">));</span><span class="s4">this</span><span class="s0">.</span><span class="s1">topRules</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">topRules</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dialects</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dialects</span><span class="s0">||{};</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dynamicPrecedences</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dynamicPrecedences</span><span class="s0">||</span><span class="s4">null</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokenPrecTable</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">tokenPrec</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">termNames</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">termNames</span><span class="s0">||</span><span class="s4">null</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">maxNode</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">.</span><span class="s1">types</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dialect</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">parseDialect</span><span class="s0">();</span><span class="s4">this</span><span class="s0">.</span><span class="s1">top</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">topRules</span><span class="s0">[</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">keys</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">topRules</span><span class="s0">)[</span><span class="s3">0</span><span class="s0">]]}</span><span class="s1">createParse</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">new </span><span class="s1">P</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n of </span><span class="s4">this</span><span class="s0">.</span><span class="s1">wrappers</span><span class="s0">)</span><span class="s1">i</span><span class="s0">=</span><span class="s1">n</span><span class="s0">(</span><span class="s1">i</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">);</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s1">getGoto</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">=</span><span class="s4">false</span><span class="s0">){</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">goto</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">e</span><span class="s0">&gt;=</span><span class="s1">i</span><span class="s0">[</span><span class="s3">0</span><span class="s0">])</span><span class="s4">return</span><span class="s0">-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">i</span><span class="s0">[</span><span class="s1">e</span><span class="s0">+</span><span class="s3">1</span><span class="s0">];;){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">i</span><span class="s0">[</span><span class="s1">n</span><span class="s0">++],</span><span class="s1">o</span><span class="s0">=</span><span class="s1">e</span><span class="s0">&amp;</span><span class="s3">1</span><span class="s0">;</span><span class="s4">let </span><span class="s1">r</span><span class="s0">=</span><span class="s1">i</span><span class="s0">[</span><span class="s1">n</span><span class="s0">++];</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">)</span><span class="s4">return </span><span class="s1">r</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">n</span><span class="s0">+(</span><span class="s1">e</span><span class="s0">&gt;&gt;</span><span class="s3">1</span><span class="s0">);</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">;</span><span class="s1">n</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">[</span><span class="s1">n</span><span class="s0">]==</span><span class="s1">t</span><span class="s0">)</span><span class="s4">return </span><span class="s1">r</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">)</span><span class="s4">return</span><span class="s0">-</span><span class="s3">1</span><span class="s0">}}</span><span class="s1">hasAction</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">i</span><span class="s0">&lt;</span><span class="s3">2</span><span class="s0">;</span><span class="s1">i</span><span class="s0">++){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">i</span><span class="s0">?</span><span class="s3">2</span><span class="s0">:</span><span class="s3">1</span><span class="s0">),</span><span class="s1">o</span><span class="s0">;;</span><span class="s1">n</span><span class="s0">+=</span><span class="s3">3</span><span class="s0">){</span><span class="s4">if</span><span class="s0">((</span><span class="s1">o</span><span class="s0">=</span><span class="s1">s</span><span class="s0">[</span><span class="s1">n</span><span class="s0">])==</span><span class="s3">65535</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">[</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]==</span><span class="s3">1</span><span class="s0">)</span><span class="s1">o</span><span class="s0">=</span><span class="s1">s</span><span class="s0">[</span><span class="s1">n</span><span class="s0">=</span><span class="s1">D</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">+</span><span class="s3">2</span><span class="s0">)];</span><span class="s4">else if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">[</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]==</span><span class="s3">2</span><span class="s0">)</span><span class="s4">return </span><span class="s1">D</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">+</span><span class="s3">2</span><span class="s0">);</span><span class="s4">else break</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">o</span><span class="s0">==</span><span class="s1">e</span><span class="s0">||</span><span class="s1">o</span><span class="s0">==</span><span class="s3">0</span><span class="s0">)</span><span class="s4">return </span><span class="s1">D</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)}}</span><span class="s4">return </span><span class="s3">0</span><span class="s0">}</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">states</span><span class="s0">[</span><span class="s1">t</span><span class="s0">*</span><span class="s3">6</span><span class="s0">+</span><span class="s1">e</span><span class="s0">]}</span><span class="s1">stateFlag</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)&amp;</span><span class="s1">e</span><span class="s0">)&gt;</span><span class="s3">0</span><span class="s0">}</span><span class="s1">validAction</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return</span><span class="s0">!!</span><span class="s4">this</span><span class="s0">.</span><span class="s1">allActions</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,(</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">==</span><span class="s1">e</span><span class="s0">?</span><span class="s4">true</span><span class="s0">:</span><span class="s4">null</span><span class="s0">))}</span><span class="s1">allActions</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">4</span><span class="s0">);</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s1">s</span><span class="s0">?</span><span class="s1">e</span><span class="s0">(</span><span class="s1">s</span><span class="s0">):</span><span class="s1">undefined</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">1</span><span class="s0">);</span><span class="s1">i</span><span class="s0">==</span><span class="s4">null</span><span class="s0">;</span><span class="s1">n</span><span class="s0">+=</span><span class="s3">3</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">[</span><span class="s1">n</span><span class="s0">]==</span><span class="s3">65535</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">[</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]==</span><span class="s3">1</span><span class="s0">)</span><span class="s1">n</span><span class="s0">=</span><span class="s1">D</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">,</span><span class="s1">n</span><span class="s0">+</span><span class="s3">2</span><span class="s0">);</span><span class="s4">else break</span><span class="s0">}</span><span class="s1">i</span><span class="s0">=</span><span class="s1">e</span><span class="s0">(</span><span class="s1">D</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">,</span><span class="s1">n</span><span class="s0">+</span><span class="s3">1</span><span class="s0">))}</span><span class="s4">return </span><span class="s1">i</span><span class="s0">}</span><span class="s1">nextStates</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=[];</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">stateSlot</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">1</span><span class="s0">);;</span><span class="s1">s</span><span class="s0">+=</span><span class="s3">3</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]==</span><span class="s3">65535</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">[</span><span class="s1">s</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]==</span><span class="s3">1</span><span class="s0">)</span><span class="s1">s</span><span class="s0">=</span><span class="s1">D</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">,</span><span class="s1">s</span><span class="s0">+</span><span class="s3">2</span><span class="s0">);</span><span class="s4">else break</span><span class="s0">}</span><span class="s4">if</span><span class="s0">((</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">[</span><span class="s1">s</span><span class="s0">+</span><span class="s3">2</span><span class="s0">]&amp;</span><span class="s3">65536</span><span class="s0">&gt;&gt;</span><span class="s3">16</span><span class="s0">)==</span><span class="s3">0</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">[</span><span class="s1">s</span><span class="s0">+</span><span class="s3">1</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">e</span><span class="s0">.</span><span class="s1">some</span><span class="s0">(((</span><span class="s1">e</span><span class="s0">,</span><span class="s1">s</span><span class="s0">)=&gt;</span><span class="s1">s</span><span class="s0">&amp;</span><span class="s3">1</span><span class="s0">&amp;&amp;</span><span class="s1">e</span><span class="s0">==</span><span class="s1">t</span><span class="s0">)))</span><span class="s1">e</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">[</span><span class="s1">s</span><span class="s0">],</span><span class="s1">t</span><span class="s0">)}}</span><span class="s4">return </span><span class="s1">e</span><span class="s0">}</span><span class="s1">configure</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">assign</span><span class="s0">(</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">create</span><span class="s0">(</span><span class="s1">R</span><span class="s0">.</span><span class="s1">prototype</span><span class="s0">),</span><span class="s4">this</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">props</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">.</span><span class="s1">extend</span><span class="s0">(</span><span class="s1">...t</span><span class="s0">.</span><span class="s1">props</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">top</span><span class="s0">){</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">topRules</span><span class="s0">[</span><span class="s1">t</span><span class="s0">.</span><span class="s1">top</span><span class="s0">];</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">)</span><span class="s4">throw new </span><span class="s1">RangeError</span><span class="s0">(</span><span class="s2">`Invalid top rule name </span><span class="s1">$</span><span class="s0">{</span><span class="s1">t</span><span class="s0">.</span><span class="s1">top</span><span class="s0">}</span><span class="s2">`</span><span class="s0">);</span><span class="s1">e</span><span class="s0">.</span><span class="s1">top</span><span class="s0">=</span><span class="s1">s</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">tokenizers</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">tokenizers</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">tokenizers</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((</span><span class="s1">e</span><span class="s0">=&gt;{</span><span class="s4">let </span><span class="s1">s</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">tokenizers</span><span class="s0">.</span><span class="s1">find</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">from</span><span class="s0">==</span><span class="s1">e</span><span class="s0">));</span><span class="s4">return </span><span class="s1">s</span><span class="s0">?</span><span class="s1">s</span><span class="s0">.</span><span class="s1">to</span><span class="s0">:</span><span class="s1">e</span><span class="s0">}));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">specializers</span><span class="s0">){</span><span class="s1">e</span><span class="s0">.</span><span class="s1">specializers</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">specializers</span><span class="s0">.</span><span class="s1">slice</span><span class="s0">();</span><span class="s1">e</span><span class="s0">.</span><span class="s1">specializerSpecs</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">specializerSpecs</span><span class="s0">.</span><span class="s1">map</span><span class="s0">(((</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;{</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">specializers</span><span class="s0">.</span><span class="s1">find</span><span class="s0">((</span><span class="s1">t</span><span class="s0">=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">from</span><span class="s0">==</span><span class="s1">s</span><span class="s0">.</span><span class="s1">external</span><span class="s0">));</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">n</span><span class="s0">)</span><span class="s4">return </span><span class="s1">s</span><span class="s0">;</span><span class="s4">let </span><span class="s1">o</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">assign</span><span class="s0">(</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">assign</span><span class="s0">({},</span><span class="s1">s</span><span class="s0">),{</span><span class="s1">external</span><span class="s0">:</span><span class="s1">n</span><span class="s0">.</span><span class="s1">to</span><span class="s0">});</span><span class="s1">e</span><span class="s0">.</span><span class="s1">specializers</span><span class="s0">[</span><span class="s1">i</span><span class="s0">]=</span><span class="s1">N</span><span class="s0">(</span><span class="s1">o</span><span class="s0">);</span><span class="s4">return </span><span class="s1">o</span><span class="s0">}))}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">contextTracker</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">context</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">contextTracker</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dialect</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">dialect</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">parseDialect</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">dialect</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">strict</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">strict</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">strict</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">wrap</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">wrappers</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">wrappers</span><span class="s0">.</span><span class="s1">concat</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">wrap</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bufferLength</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">)</span><span class="s1">e</span><span class="s0">.</span><span class="s1">bufferLength</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">bufferLength</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">}</span><span class="s1">hasWrappers</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">wrappers</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">0</span><span class="s0">}</span><span class="s1">getName</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">termNames</span><span class="s0">?</span><span class="s4">this</span><span class="s0">.</span><span class="s1">termNames</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]:</span><span class="s1">String</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&lt;=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">maxNode</span><span class="s0">&amp;&amp;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">.</span><span class="s1">types</span><span class="s0">[</span><span class="s1">t</span><span class="s0">].</span><span class="s1">name</span><span class="s0">||</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">get eofTerm</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">maxNode</span><span class="s0">+</span><span class="s3">1</span><span class="s0">}</span><span class="s1">get topNode</span><span class="s0">(){</span><span class="s4">return this</span><span class="s0">.</span><span class="s1">nodeSet</span><span class="s0">.</span><span class="s1">types</span><span class="s0">[</span><span class="s4">this</span><span class="s0">.</span><span class="s1">top</span><span class="s0">[</span><span class="s3">1</span><span class="s0">]]}</span><span class="s1">dynamicPrecedence</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dynamicPrecedences</span><span class="s0">;</span><span class="s4">return </span><span class="s1">e</span><span class="s0">==</span><span class="s4">null</span><span class="s0">?</span><span class="s3">0</span><span class="s0">:</span><span class="s1">e</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]||</span><span class="s3">0</span><span class="s0">}</span><span class="s1">parseDialect</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">Object</span><span class="s0">.</span><span class="s1">keys</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dialects</span><span class="s0">),</span><span class="s1">s</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">map</span><span class="s0">((()=&gt;</span><span class="s4">false</span><span class="s0">));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n of t</span><span class="s0">.</span><span class="s1">split</span><span class="s0">(</span><span class="s2">&quot; &quot;</span><span class="s0">)){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">e</span><span class="s0">.</span><span class="s1">indexOf</span><span class="s0">(</span><span class="s1">n</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">&gt;=</span><span class="s3">0</span><span class="s0">)</span><span class="s1">s</span><span class="s0">[</span><span class="s1">t</span><span class="s0">]=</span><span class="s4">true</span><span class="s0">}</span><span class="s4">let </span><span class="s1">i</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">n</span><span class="s0">=</span><span class="s3">0</span><span class="s0">;</span><span class="s1">n</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">n</span><span class="s0">++)</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">s</span><span class="s0">[</span><span class="s1">n</span><span class="s0">]){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">dialects</span><span class="s0">[</span><span class="s1">e</span><span class="s0">[</span><span class="s1">n</span><span class="s0">]],</span><span class="s1">s</span><span class="s0">;(</span><span class="s1">s</span><span class="s0">=</span><span class="s4">this</span><span class="s0">.</span><span class="s1">data</span><span class="s0">[</span><span class="s1">t</span><span class="s0">++])!=</span><span class="s3">65535</span><span class="s0">;)(</span><span class="s1">i</span><span class="s0">||(</span><span class="s1">i</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Uint8Array</span><span class="s0">(</span><span class="s4">this</span><span class="s0">.</span><span class="s1">maxTerm</span><span class="s0">+</span><span class="s3">1</span><span class="s0">)))[</span><span class="s1">s</span><span class="s0">]=</span><span class="s3">1</span><span class="s0">}</span><span class="s4">return new </span><span class="s1">A</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)}</span><span class="s4">static </span><span class="s1">deserialize</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return new </span><span class="s1">R</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}}</span><span class="s4">function </span><span class="s1">D</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">t</span><span class="s0">[</span><span class="s1">e</span><span class="s0">]|</span><span class="s1">t</span><span class="s0">[</span><span class="s1">e</span><span class="s0">+</span><span class="s3">1</span><span class="s0">]&lt;&lt;</span><span class="s3">16</span><span class="s0">}</span><span class="s4">function </span><span class="s1">E</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s4">for</span><span class="s0">(</span><span class="s4">let </span><span class="s1">s of t</span><span class="s0">){</span><span class="s4">let </span><span class="s1">t</span><span class="s0">=</span><span class="s1">s</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">stoppedAt</span><span class="s0">;</span><span class="s4">if</span><span class="s0">((</span><span class="s1">s</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">==</span><span class="s1">s</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">stream</span><span class="s0">.</span><span class="s1">end</span><span class="s0">||</span><span class="s1">t</span><span class="s0">!=</span><span class="s4">null</span><span class="s0">&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">pos</span><span class="s0">&gt;</span><span class="s1">t</span><span class="s0">)&amp;&amp;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">p</span><span class="s0">.</span><span class="s1">parser</span><span class="s0">.</span><span class="s1">stateFlag</span><span class="s0">(</span><span class="s1">s</span><span class="s0">.</span><span class="s1">state</span><span class="s0">,</span><span class="s3">2</span><span class="s0">)&amp;&amp;(!</span><span class="s1">e</span><span class="s0">||</span><span class="s1">e</span><span class="s0">.</span><span class="s1">score</span><span class="s0">&lt;</span><span class="s1">s</span><span class="s0">.</span><span class="s1">score</span><span class="s0">))</span><span class="s1">e</span><span class="s0">=</span><span class="s1">s</span><span class="s0">}</span><span class="s4">return </span><span class="s1">e</span><span class="s0">}</span><span class="s4">function </span><span class="s1">N</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">t</span><span class="s0">.</span><span class="s1">external</span><span class="s0">){</span><span class="s4">let </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">extend</span><span class="s0">?</span><span class="s3">1</span><span class="s0">:</span><span class="s3">0</span><span class="s0">;</span><span class="s4">return</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)=&gt;</span><span class="s1">t</span><span class="s0">.</span><span class="s1">external</span><span class="s0">(</span><span class="s1">s</span><span class="s0">,</span><span class="s1">i</span><span class="s0">)&lt;&lt;</span><span class="s3">1</span><span class="s0">|</span><span class="s1">e</span><span class="s0">}</span><span class="s4">return </span><span class="s1">t</span><span class="s0">.</span><span class="s1">get</span><span class="s0">}},</span><span class="s3">65606</span><span class="s0">:</span><span class="s1">t</span><span class="s0">=&gt;{</span><span class="s4">var </span><span class="s1">e</span><span class="s0">=</span><span class="s1">t</span><span class="s0">.</span><span class="s1">exports</span><span class="s0">={};</span><span class="s4">var </span><span class="s1">s</span><span class="s0">;</span><span class="s4">var </span><span class="s1">i</span><span class="s0">;</span><span class="s4">function </span><span class="s1">n</span><span class="s0">(){</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;setTimeout has not been defined&quot;</span><span class="s0">)}</span><span class="s4">function </span><span class="s1">o</span><span class="s0">(){</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;clearTimeout has not been defined&quot;</span><span class="s0">)}(</span><span class="s4">function</span><span class="s0">(){</span><span class="s4">try</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s4">typeof </span><span class="s1">setTimeout</span><span class="s0">===</span><span class="s2">&quot;function&quot;</span><span class="s0">){</span><span class="s1">s</span><span class="s0">=</span><span class="s1">setTimeout</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">s</span><span class="s0">=</span><span class="s1">n</span><span class="s0">}}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s1">s</span><span class="s0">=</span><span class="s1">n</span><span class="s0">}</span><span class="s4">try</span><span class="s0">{</span><span class="s4">if</span><span class="s0">(</span><span class="s4">typeof </span><span class="s1">clearTimeout</span><span class="s0">===</span><span class="s2">&quot;function&quot;</span><span class="s0">){</span><span class="s1">i</span><span class="s0">=</span><span class="s1">clearTimeout</span><span class="s0">}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">i</span><span class="s0">=</span><span class="s1">o</span><span class="s0">}}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s1">i</span><span class="s0">=</span><span class="s1">o</span><span class="s0">}})();</span><span class="s4">function </span><span class="s1">r</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">s</span><span class="s0">===</span><span class="s1">setTimeout</span><span class="s0">){</span><span class="s4">return </span><span class="s1">setTimeout</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">((</span><span class="s1">s</span><span class="s0">===</span><span class="s1">n</span><span class="s0">||!</span><span class="s1">s</span><span class="s0">)&amp;&amp;</span><span class="s1">setTimeout</span><span class="s0">){</span><span class="s1">s</span><span class="s0">=</span><span class="s1">setTimeout</span><span class="s0">;</span><span class="s4">return </span><span class="s1">setTimeout</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">try</span><span class="s0">{</span><span class="s4">return </span><span class="s1">s</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">try</span><span class="s0">{</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">call</span><span class="s0">(</span><span class="s4">null</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">s</span><span class="s0">.</span><span class="s1">call</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">t</span><span class="s0">,</span><span class="s3">0</span><span class="s0">)}}}</span><span class="s4">function </span><span class="s1">l</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">i</span><span class="s0">===</span><span class="s1">clearTimeout</span><span class="s0">){</span><span class="s4">return </span><span class="s1">clearTimeout</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">if</span><span class="s0">((</span><span class="s1">i</span><span class="s0">===</span><span class="s1">o</span><span class="s0">||!</span><span class="s1">i</span><span class="s0">)&amp;&amp;</span><span class="s1">clearTimeout</span><span class="s0">){</span><span class="s1">i</span><span class="s0">=</span><span class="s1">clearTimeout</span><span class="s0">;</span><span class="s4">return </span><span class="s1">clearTimeout</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">try</span><span class="s0">{</span><span class="s4">return </span><span class="s1">i</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">try</span><span class="s0">{</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">call</span><span class="s0">(</span><span class="s4">null</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}</span><span class="s4">catch</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s4">return </span><span class="s1">i</span><span class="s0">.</span><span class="s1">call</span><span class="s0">(</span><span class="s4">this</span><span class="s0">,</span><span class="s1">t</span><span class="s0">)}}}</span><span class="s4">var </span><span class="s1">a</span><span class="s0">=[];</span><span class="s4">var </span><span class="s1">h</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">var </span><span class="s1">c</span><span class="s0">;</span><span class="s4">var </span><span class="s1">f</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s4">function </span><span class="s1">u</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(!</span><span class="s1">h</span><span class="s0">||!</span><span class="s1">c</span><span class="s0">){</span><span class="s4">return</span><span class="s0">}</span><span class="s1">h</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s4">if</span><span class="s0">(</span><span class="s1">c</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s1">a</span><span class="s0">=</span><span class="s1">c</span><span class="s0">.</span><span class="s1">concat</span><span class="s0">(</span><span class="s1">a</span><span class="s0">)}</span><span class="s4">else</span><span class="s0">{</span><span class="s1">f</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">}</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">.</span><span class="s1">length</span><span class="s0">){</span><span class="s1">p</span><span class="s0">()}}</span><span class="s4">function </span><span class="s1">p</span><span class="s0">(){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">h</span><span class="s0">){</span><span class="s4">return</span><span class="s0">}</span><span class="s4">var </span><span class="s1">t</span><span class="s0">=</span><span class="s1">r</span><span class="s0">(</span><span class="s1">u</span><span class="s0">);</span><span class="s1">h</span><span class="s0">=</span><span class="s4">true</span><span class="s0">;</span><span class="s4">var </span><span class="s1">e</span><span class="s0">=</span><span class="s1">a</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s4">while</span><span class="s0">(</span><span class="s1">e</span><span class="s0">){</span><span class="s1">c</span><span class="s0">=</span><span class="s1">a</span><span class="s0">;</span><span class="s1">a</span><span class="s0">=[];</span><span class="s4">while</span><span class="s0">(++</span><span class="s1">f</span><span class="s0">&lt;</span><span class="s1">e</span><span class="s0">){</span><span class="s4">if</span><span class="s0">(</span><span class="s1">c</span><span class="s0">){</span><span class="s1">c</span><span class="s0">[</span><span class="s1">f</span><span class="s0">].</span><span class="s1">run</span><span class="s0">()}}</span><span class="s1">f</span><span class="s0">=-</span><span class="s3">1</span><span class="s0">;</span><span class="s1">e</span><span class="s0">=</span><span class="s1">a</span><span class="s0">.</span><span class="s1">length</span><span class="s0">}</span><span class="s1">c</span><span class="s0">=</span><span class="s4">null</span><span class="s0">;</span><span class="s1">h</span><span class="s0">=</span><span class="s4">false</span><span class="s0">;</span><span class="s1">l</span><span class="s0">(</span><span class="s1">t</span><span class="s0">)}</span><span class="s1">e</span><span class="s0">.</span><span class="s1">nextTick</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">var </span><span class="s1">e</span><span class="s0">=</span><span class="s4">new </span><span class="s1">Array</span><span class="s0">(</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">-</span><span class="s3">1</span><span class="s0">);</span><span class="s4">if</span><span class="s0">(</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">&gt;</span><span class="s3">1</span><span class="s0">){</span><span class="s4">for</span><span class="s0">(</span><span class="s4">var </span><span class="s1">s</span><span class="s0">=</span><span class="s3">1</span><span class="s0">;</span><span class="s1">s</span><span class="s0">&lt;</span><span class="s1">arguments</span><span class="s0">.</span><span class="s1">length</span><span class="s0">;</span><span class="s1">s</span><span class="s0">++){</span><span class="s1">e</span><span class="s0">[</span><span class="s1">s</span><span class="s0">-</span><span class="s3">1</span><span class="s0">]=</span><span class="s1">arguments</span><span class="s0">[</span><span class="s1">s</span><span class="s0">]}}</span><span class="s1">a</span><span class="s0">.</span><span class="s1">push</span><span class="s0">(</span><span class="s4">new </span><span class="s1">d</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">));</span><span class="s4">if</span><span class="s0">(</span><span class="s1">a</span><span class="s0">.</span><span class="s1">length</span><span class="s0">===</span><span class="s3">1</span><span class="s0">&amp;&amp;!</span><span class="s1">h</span><span class="s0">){</span><span class="s1">r</span><span class="s0">(</span><span class="s1">p</span><span class="s0">)}};</span><span class="s4">function </span><span class="s1">d</span><span class="s0">(</span><span class="s1">t</span><span class="s0">,</span><span class="s1">e</span><span class="s0">){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fun</span><span class="s0">=</span><span class="s1">t</span><span class="s0">;</span><span class="s4">this</span><span class="s0">.</span><span class="s1">array</span><span class="s0">=</span><span class="s1">e</span><span class="s0">}</span><span class="s1">d</span><span class="s0">.</span><span class="s1">prototype</span><span class="s0">.</span><span class="s1">run</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(){</span><span class="s4">this</span><span class="s0">.</span><span class="s1">fun</span><span class="s0">.</span><span class="s1">apply</span><span class="s0">(</span><span class="s4">null</span><span class="s0">,</span><span class="s4">this</span><span class="s0">.</span><span class="s1">array</span><span class="s0">)};</span><span class="s1">e</span><span class="s0">.</span><span class="s1">title</span><span class="s0">=</span><span class="s2">&quot;browser&quot;</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">browser</span><span class="s0">=</span><span class="s4">true</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">env</span><span class="s0">={};</span><span class="s1">e</span><span class="s0">.</span><span class="s1">argv</span><span class="s0">=[];</span><span class="s1">e</span><span class="s0">.</span><span class="s1">version</span><span class="s0">=</span><span class="s2">&quot;&quot;</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">versions</span><span class="s0">={};</span><span class="s4">function </span><span class="s1">m</span><span class="s0">(){}</span><span class="s1">e</span><span class="s0">.</span><span class="s1">on</span><span class="s0">=</span><span class="s1">m</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">addListener</span><span class="s0">=</span><span class="s1">m</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">once</span><span class="s0">=</span><span class="s1">m</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">off</span><span class="s0">=</span><span class="s1">m</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">removeListener</span><span class="s0">=</span><span class="s1">m</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">removeAllListeners</span><span class="s0">=</span><span class="s1">m</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">emit</span><span class="s0">=</span><span class="s1">m</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">prependListener</span><span class="s0">=</span><span class="s1">m</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">prependOnceListener</span><span class="s0">=</span><span class="s1">m</span><span class="s0">;</span><span class="s1">e</span><span class="s0">.</span><span class="s1">listeners</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">return</span><span class="s0">[]};</span><span class="s1">e</span><span class="s0">.</span><span class="s1">binding</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;process.binding is not supported&quot;</span><span class="s0">)};</span><span class="s1">e</span><span class="s0">.</span><span class="s1">cwd</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(){</span><span class="s4">return</span><span class="s2">&quot;/&quot;</span><span class="s0">};</span><span class="s1">e</span><span class="s0">.</span><span class="s1">chdir</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(</span><span class="s1">t</span><span class="s0">){</span><span class="s4">throw new </span><span class="s1">Error</span><span class="s0">(</span><span class="s2">&quot;process.chdir is not supported&quot;</span><span class="s0">)};</span><span class="s1">e</span><span class="s0">.</span><span class="s1">umask</span><span class="s0">=</span><span class="s4">function</span><span class="s0">(){</span><span class="s4">return </span><span class="s3">0</span><span class="s0">}}}]);</span></pre>
</body>
</html>